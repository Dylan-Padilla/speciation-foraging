<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.52">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dylan Padilla, Martha Munoz, David Skelly   Yale Institute for Biospheric Studies &amp; Yale School of the Environment, New Haven, CT 06511">

<title>Data analysis for: Relative High Fitness and Genome-wide Diversity May Facilitate Active Foragers Diversification</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Data analysis for: Relative High Fitness and Genome-wide Diversity May Facilitate Active Foragers Diversification</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p><a href="https://dylanpadilla.netlify.app/">Dylan Padilla</a>, Martha Munoz, David Skelly <br> Yale Institute for Biospheric Studies &amp; Yale School of the Environment, New Haven, CT 06511 </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p><img src="imgs/yale-logo.png" class="img-fluid"></p>
<p><br></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="do">##  Libraries</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(AICcmodavg)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(ape)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(BAMMtools)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(bayou)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(caper)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">library</span>(car)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="fu">library</span>(diversitree)</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="fu">library</span>(geiger)</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="fu">library</span>(ggplotify)</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="fu">library</span>(grid)</span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="fu">library</span>(hisse)</span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="fu">library</span>(lattice)</span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="fu">library</span>(latticeExtra)</span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="fu">library</span>(nlme)</span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="fu">library</span>(plotrix)</span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="fu">library</span>(png)</span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="fu">library</span>(phytools)</span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="fu">library</span>(raster)</span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="fu">library</span>(TreeSim)</span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="fu">library</span>(vioplot)</span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="fu">library</span>(viridis)</span>
<span id="cb1-28"><a href="#cb1-28"></a></span>
<span id="cb1-29"><a href="#cb1-29"></a></span>
<span id="cb1-30"><a href="#cb1-30"></a><span class="do">## Session info and R version</span></span>
<span id="cb1-31"><a href="#cb1-31"></a></span>
<span id="cb1-32"><a href="#cb1-32"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; R version 4.3.3 (2024-02-29)
&gt; Platform: aarch64-apple-darwin20 (64-bit)
&gt; Running under: macOS 15.3.2
&gt; 
&gt; Matrix products: default
&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib 
&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0
&gt; 
&gt; locale:
&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
&gt; 
&gt; time zone: America/New_York
&gt; tzcode source: internal
&gt; 
&gt; attached base packages:
&gt; [1] grid      stats     graphics  grDevices utils     datasets  methods  
&gt; [8] base     
&gt; 
&gt; other attached packages:
&gt;  [1] viridis_0.6.5       viridisLite_0.4.2   vioplot_0.5.0      
&gt;  [4] zoo_1.8-12          sm_2.2-6.0          TreeSim_2.4        
&gt;  [7] scales_1.3.0        raster_3.6-30       sp_2.1-4           
&gt; [10] png_0.1-8           plotrix_3.8-4       patchwork_1.3.0    
&gt; [13] nlme_3.1-166        MuMIn_1.48.4        latticeExtra_0.6-30
&gt; [16] lattice_0.22-6      hisse_2.1.11        nloptr_2.1.1       
&gt; [19] subplex_1.9         GenSA_1.1.14.1      deSolve_1.40       
&gt; [22] ggplotify_0.1.2     diversitree_0.10-1  cowplot_1.1.3      
&gt; [25] car_3.1-3           carData_3.0-5       caper_1.0.3        
&gt; [28] mvtnorm_1.3-3       MASS_7.3-60.0.1     bayou_2.1          
&gt; [31] coda_0.19-4.1       geiger_2.0.11       phytools_2.4-4     
&gt; [34] maps_3.4.2.1        BAMMtools_2.1.12    ape_5.8-1          
&gt; [37] AICcmodavg_2.3-3   
&gt; 
&gt; loaded via a namespace (and not attached):
&gt;  [1] mnormt_2.1.1            bitops_1.0-9            deldir_2.0-4           
&gt;  [4] gridExtra_2.3           phangorn_2.12.1         rlang_1.1.5            
&gt;  [7] magrittr_2.0.3          compiler_4.3.3          vctrs_0.6.5            
&gt; [10] combinat_0.0-8          quadprog_1.5-8          pkgconfig_2.0.3        
&gt; [13] fastmap_1.2.0           caTools_1.18.3          rmarkdown_2.29         
&gt; [16] xfun_0.52               Rmpfr_1.0-0             clusterGeneration_1.3.8
&gt; [19] jsonlite_1.8.9          gmp_0.7-5               terra_1.8-5            
&gt; [22] jpeg_0.1-10             VGAM_1.1-12             parallel_4.3.3         
&gt; [25] R6_2.6.1                RColorBrewer_1.1-3      denstrip_1.5.4         
&gt; [28] numDeriv_2016.8-1.1     Rcpp_1.0.14             assertthat_0.2.1       
&gt; [31] iterators_1.0.14        knitr_1.49              optimParallel_1.0-2    
&gt; [34] Matrix_1.6-5            splines_4.3.3           nnet_7.3-19            
&gt; [37] igraph_2.1.4            tidyselect_1.2.1        abind_1.4-8            
&gt; [40] yaml_2.3.10             doParallel_1.0.17       gplots_3.2.0           
&gt; [43] codetools_0.2-20        tibble_3.2.1            evaluate_1.0.3         
&gt; [46] gridGraphics_0.5-1      survival_3.8-3          fitdistrplus_1.2-2     
&gt; [49] pillar_1.10.1           KernSmooth_2.23-24      foreach_1.5.2          
&gt; [52] stats4_4.3.3            generics_0.1.3          RCurl_1.98-1.16        
&gt; [55] ggplot2_3.5.1           munsell_0.5.1           gtools_3.9.5           
&gt; [58] xtable_1.8-4            glue_1.8.0              unmarked_1.4.3         
&gt; [61] scatterplot3d_0.3-44    tools_4.3.3             interp_1.1-6           
&gt; [64] data.table_1.16.4       fs_1.6.5                fastmatch_1.1-6        
&gt; [67] colorspace_2.1-1        paleotree_3.4.7         Formula_1.2-5          
&gt; [70] cli_3.6.4               DEoptim_2.2-8           expm_1.0-0             
&gt; [73] dplyr_1.1.4             corpcor_1.6.10          gtable_0.3.6           
&gt; [76] yulab.utils_0.2.0       digest_0.6.37           farver_2.1.2           
&gt; [79] htmlwidgets_1.6.4       htmltools_0.5.8.1       lifecycle_1.0.4        
&gt; [82] corHMM_2.8</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>R.version</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;                _                           
&gt; platform       aarch64-apple-darwin20      
&gt; arch           aarch64                     
&gt; os             darwin20                    
&gt; system         aarch64, darwin20           
&gt; status                                     
&gt; major          4                           
&gt; minor          3.3                         
&gt; year           2024                        
&gt; month          02                          
&gt; day            29                          
&gt; svn rev        86002                       
&gt; language       R                           
&gt; version.string R version 4.3.3 (2024-02-29)
&gt; nickname       Angel Food Cake</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="do">## setting seed for reproducibility</span></span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="do">##set.seed(3487593)</span></span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="do">##  Loading the data</span></span>
<span id="cb5-6"><a href="#cb5-6"></a></span>
<span id="cb5-7"><a href="#cb5-7"></a>raw.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data_Meiri-2024.csv'</span>, <span class="at">as.is =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="fu">str</span>(raw.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 12060 obs. of  28 variables:
&gt;  $ Species                                                                             : chr  "Ablepharus alaicus" "Ablepharus anatolicus" "Ablepharus bivittatus" "Ablepharus budaki" ...
&gt;  $ Order                                                                               : chr  "Squamata" "Squamata" "Squamata" "Squamata" ...
&gt;  $ Family                                                                              : chr  "Scincidae" "Scincidae" "Scincidae" "Scincidae" ...
&gt;  $ Genus                                                                               : chr  "Ablepharus" "Ablepharus" "Ablepharus" "Ablepharus" ...
&gt;  $ Main.biogeographic.region                                                           : chr  "Saharo-Sindian" "Saharo-Sindian" "Saharo-Sindian" "Saharo-Sindian" ...
&gt;  $ Microhabitat                                                                        : chr  "Saxicolous/Terrestrial" "Terrestrial" "Saxicolous" "Terrestrial" ...
&gt;  $ Habitat.type                                                                        : chr  NA NA "Forest/Grassland/Shrubland" "Forest/Shrubland" ...
&gt;  $ Minimal.elevation..m.                                                               : int  NA NA 600 0 150 NA 40 NA 222 NA ...
&gt;  $ Maximum.elevation..m.                                                               : int  NA NA 2900 1700 1700 NA 3000 NA 2710 NA ...
&gt;  $ Diet                                                                                : chr  "Carnivorous" NA "Carnivorous" "Carnivorous" ...
&gt;  $ Active.time                                                                         : chr  "Diurnal" NA "Diurnal" "Diurnal" ...
&gt;  $ Foraging.mode                                                                       : chr  NA NA NA NA ...
&gt;  $ Maximum.Longevity..years.                                                           : num  NA NA NA NA NA NA NA NA NA NA ...
&gt;  $ Maximum.body.mass..g.                                                               : num  NA NA 4.4 2 3 1.5 3.9 NA 0.7 1.2 ...
&gt;  $ Maximum.female.length...SVL...mm..straight.carapace.length.for.turtles...SCL...mm.  : num  NA NA 56.5 36.8 44.4 NA 46 50 NA 61.8 ...
&gt;  $ Maximum.male.length...SVL...mm..straight.carapace.length.for.turtles...SCL...mm.    : num  NA NA NA NA NA NA NA NA NA NA ...
&gt;  $ Maximum.juvenile.length...SVL...mm..straight.carapace.length.for.turtles...SCL...mm.: num  22.1 NA 18.5 NA NA NA 17.5 21.5 14.5 NA ...
&gt;  $ Hatchling.neonate.mass..g.                                                          : num  NA NA NA NA NA NA NA NA NA NA ...
&gt;  $ Reproductive.mode                                                                   : chr  "viviparous" NA "oviparous" "oviparous" ...
&gt;  $ Mean.number.of.offspring.per.litter.or.number.of.eggs.per.clutch                    : num  NA NA 4 3.5 3.5 4.5 4.5 NA 1.5 3 ...
&gt;  $ Smallest.clutch.size                                                                : num  2 NA 2 2 3 NA 1 NA 1 1 ...
&gt;  $ Largest.clutch.size                                                                 : int  7 NA 5 5 4 NA 8 NA 2 4 ...
&gt;  $ Number.of.litters.or.clutches.produced.per.year                                     : num  NA NA NA NA NA NA NA NA NA NA ...
&gt;  $ Egg.length..mm.                                                                     : chr  "No" NA NA NA ...
&gt;  $ Egg.width..mm.                                                                      : chr  "No" NA NA NA ...
&gt;  $ Mean.Tb                                                                             : num  NA NA NA NA NA NA NA NA NA 27.5 ...
&gt;  $ Minimum.Tb                                                                          : num  NA NA NA NA NA NA NA NA NA NA ...
&gt;  $ Maximum.Tb                                                                          : num  NA NA NA NA NA NA NA NA NA NA ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>range.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'area-of-lizard-ranges.csv'</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">str</span>(range.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 6111 obs. of  7 variables:
&gt;  $ Binomial: chr  "Ablepharus budaki" "Ablepharus darvazi" "Ablepharus grayanus" "Ablepharus kitaibelii" ...
&gt;  $ Area    : num  121181 32445 130760 684246 62791 ...
&gt;  $ FID_2   : int  2 4 6 7 10 11 12 13 14 15 ...
&gt;  $ TID     : chr  "R06993" "R06995" "R06997" "R06998" ...
&gt;  $ Group   : chr  "lizard" "lizard" "lizard" "lizard" ...
&gt;  $ Value   : int  1 1 1 1 1 1 1 1 1 1 ...
&gt;  $ area    : num  1.21e+11 3.24e+10 1.31e+11 6.84e+11 6.28e+10 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>area <span class="ot">&lt;-</span> range.data[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">7</span>)]</span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a>lizard.tree <span class="ot">&lt;-</span> <span class="fu">read.tree</span>(<span class="st">'zheng-wiens2016-tree.tre'</span>)</span>
<span id="cb9-4"><a href="#cb9-4"></a></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="do">## Checking out the variables</span></span>
<span id="cb9-6"><a href="#cb9-6"></a></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="fu">unique</span>(raw.data<span class="sc">$</span>Foraging.mode)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] NA      "ACT"   "AMB"   "Mixed"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>raw.data<span class="sc">$</span>Foraging.mode[raw.data<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'ACT'</span>] <span class="ot">&lt;-</span> <span class="st">'active'</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>raw.data<span class="sc">$</span>Foraging.mode[raw.data<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'AMB'</span>] <span class="ot">&lt;-</span> <span class="st">'sit-and-wait'</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>raw.data<span class="sc">$</span>Foraging.mode[raw.data<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'Mixed'</span>] <span class="ot">&lt;-</span> <span class="st">'plastic'</span></span>
<span id="cb11-4"><a href="#cb11-4"></a></span>
<span id="cb11-5"><a href="#cb11-5"></a></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="do">## Filtering the data</span></span>
<span id="cb11-7"><a href="#cb11-7"></a></span>
<span id="cb11-8"><a href="#cb11-8"></a>filt.data <span class="ot">&lt;-</span> raw.data[<span class="sc">!</span><span class="fu">is.na</span>(raw.data<span class="sc">$</span>Foraging.mode), ]</span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="fu">str</span>(filt.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 1806 obs. of  28 variables:
&gt;  $ Species                                                                             : chr  "Ablepharus sikimmensis" "Abronia gadovii" "Abronia juarezi" "Abronia monticola" ...
&gt;  $ Order                                                                               : chr  "Squamata" "Squamata" "Squamata" "Squamata" ...
&gt;  $ Family                                                                              : chr  "Scincidae" "Anguidae" "Anguidae" "Anguidae" ...
&gt;  $ Genus                                                                               : chr  "Ablepharus" "Abronia" "Abronia" "Abronia" ...
&gt;  $ Main.biogeographic.region                                                           : chr  "Oriental" "Neotropic" "Neotropic" "Neotropic" ...
&gt;  $ Microhabitat                                                                        : chr  "Terrestrial" "Arboreal/Terrestrial" "Terrestrial" "Terrestrial" ...
&gt;  $ Habitat.type                                                                        : chr  NA NA NA NA ...
&gt;  $ Minimal.elevation..m.                                                               : int  NA NA NA NA 120 0 2000 NA 150 0 ...
&gt;  $ Maximum.elevation..m.                                                               : int  NA NA NA NA 2410 3000 3000 NA 560 1050 ...
&gt;  $ Diet                                                                                : chr  "Carnivorous" "Carnivorous" "Carnivorous" "Carnivorous" ...
&gt;  $ Active.time                                                                         : chr  "Diurnal" NA "Diurnal" "Diurnal" ...
&gt;  $ Foraging.mode                                                                       : chr  "active" "active" "active" "sit-and-wait" ...
&gt;  $ Maximum.Longevity..years.                                                           : num  NA NA NA NA NA 10.9 NA NA 4.6 NA ...
&gt;  $ Maximum.body.mass..g.                                                               : num  NA NA NA NA 47.9 ...
&gt;  $ Maximum.female.length...SVL...mm..straight.carapace.length.for.turtles...SCL...mm.  : num  51.4 83.6 70.1 74.5 94.5 ...
&gt;  $ Maximum.male.length...SVL...mm..straight.carapace.length.for.turtles...SCL...mm.    : num  NA NA NA NA NA NA NA 235 NA NA ...
&gt;  $ Maximum.juvenile.length...SVL...mm..straight.carapace.length.for.turtles...SCL...mm.: num  19 28.7 25 25 31 34 NA NA 25 NA ...
&gt;  $ Hatchling.neonate.mass..g.                                                          : num  NA NA NA NA NA NA NA 10.3 0.6 NA ...
&gt;  $ Reproductive.mode                                                                   : chr  "oviparous" "viviparous" "viviparous" "viviparous" ...
&gt;  $ Mean.number.of.offspring.per.litter.or.number.of.eggs.per.clutch                    : num  5 NA NA NA 6.4 11.4 NA 3.5 4.9 4 ...
&gt;  $ Smallest.clutch.size                                                                : num  2 2 3 2 3 1 NA 4 3 2 ...
&gt;  $ Largest.clutch.size                                                                 : int  8 12 3 10 10 17 NA 9 8 6 ...
&gt;  $ Number.of.litters.or.clutches.produced.per.year                                     : num  NA NA NA NA NA 1 NA NA 1 NA ...
&gt;  $ Egg.length..mm.                                                                     : chr  NA "No" "No" "No" ...
&gt;  $ Egg.width..mm.                                                                      : chr  NA "No" "No" "No" ...
&gt;  $ Mean.Tb                                                                             : num  29 NA NA 23.7 NA 39.9 29 NA 33.6 NA ...
&gt;  $ Minimum.Tb                                                                          : num  NA NA NA NA NA NA NA NA NA NA ...
&gt;  $ Maximum.Tb                                                                          : num  NA NA NA NA NA NA NA NA NA NA ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">dim</span>(filt.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] 1806   28</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">unique</span>(filt.data<span class="sc">$</span>Foraging.mode)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "active"       "sit-and-wait" "plastic"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="do">## How many species do we have within each</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="do">## foraging behavior category?</span></span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="fu">tapply</span>(<span class="at">X =</span> filt.data<span class="sc">$</span>Species,</span>
<span id="cb17-5"><a href="#cb17-5"></a>       <span class="at">INDEX =</span> <span class="fu">list</span>(filt.data<span class="sc">$</span>Foraging.mode),       length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;       active      plastic sit-and-wait 
&gt;         1136          104          566</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="do">## How many species with data of body mass do we have</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="do">## within each foraging behavior category?</span></span>
<span id="cb19-3"><a href="#cb19-3"></a></span>
<span id="cb19-4"><a href="#cb19-4"></a>((bd.mass <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="at">X =</span> filt.data<span class="sc">$</span>Maximum.body.mass..g.,</span>
<span id="cb19-5"><a href="#cb19-5"></a>                    <span class="at">INDEX =</span> <span class="fu">list</span>(filt.data<span class="sc">$</span>Foraging.mode),</span>
<span id="cb19-6"><a href="#cb19-6"></a>                    <span class="at">FUN =</span> <span class="cf">function</span>(X) <span class="fu">length</span>(<span class="fu">na.omit</span>(X)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;       active      plastic sit-and-wait 
&gt;         1061          103          545</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="do">## How many species with data of Mean.Tb do we have</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="do">## within each foraging behavior category?</span></span>
<span id="cb21-3"><a href="#cb21-3"></a></span>
<span id="cb21-4"><a href="#cb21-4"></a>((mean.tb <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="at">X =</span> filt.data<span class="sc">$</span>Mean.Tb,</span>
<span id="cb21-5"><a href="#cb21-5"></a>                    <span class="at">INDEX =</span> <span class="fu">list</span>(filt.data<span class="sc">$</span>Foraging.mode),</span>
<span id="cb21-6"><a href="#cb21-6"></a>                    <span class="at">FUN =</span> <span class="cf">function</span>(X) <span class="fu">length</span>(<span class="fu">na.omit</span>(X)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;       active      plastic sit-and-wait 
&gt;          330           69          280</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="do">## Merging data of lizard ranges</span></span>
<span id="cb23-2"><a href="#cb23-2"></a></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="fu">names</span>(area)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">'Species'</span></span>
<span id="cb23-4"><a href="#cb23-4"></a>merg.data <span class="ot">&lt;-</span> <span class="fu">merge</span>(filt.data, area, <span class="at">by =</span> <span class="st">'Species'</span>)</span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="fu">str</span>(merg.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 976 obs. of  29 variables:
&gt;  $ Species                                                                             : chr  "Abronia taeniata" "Acanthocercus atricollis" "Acanthocercus yemensis" "Acanthodactylus beershebensis" ...
&gt;  $ Order                                                                               : chr  "Squamata" "Squamata" "Squamata" "Squamata" ...
&gt;  $ Family                                                                              : chr  "Anguidae" "Agamidae" "Agamidae" "Lacertidae" ...
&gt;  $ Genus                                                                               : chr  "Abronia" "Acanthocercus" "Acanthocercus" "Acanthodactylus" ...
&gt;  $ Main.biogeographic.region                                                           : chr  "Neotropic" "Afrotropic" "Saharo-Sindian" "Saharo-Sindian" ...
&gt;  $ Microhabitat                                                                        : chr  "Arboreal" "Arboreal" "Saxicolous" "Terrestrial" ...
&gt;  $ Habitat.type                                                                        : chr  "Forest" "Savanna" "Rocky" "Shrubland" ...
&gt;  $ Minimal.elevation..m.                                                               : int  120 0 2000 150 0 -385 0 0 57 62 ...
&gt;  $ Maximum.elevation..m.                                                               : int  2410 3000 3000 560 1050 2000 300 2500 777 709 ...
&gt;  $ Diet                                                                                : chr  "Carnivorous" "Carnivorous" "Omnivorous" "Carnivorous" ...
&gt;  $ Active.time                                                                         : chr  NA "Diurnal" "Diurnal" "Diurnal" ...
&gt;  $ Foraging.mode                                                                       : chr  "active" "sit-and-wait" "sit-and-wait" "active" ...
&gt;  $ Maximum.Longevity..years.                                                           : num  NA 10.9 NA 4.6 NA 9 NA 2.1 NA NA ...
&gt;  $ Maximum.body.mass..g.                                                               : num  47.9 177.8 87.1 16.6 9.8 ...
&gt;  $ Maximum.female.length...SVL...mm..straight.carapace.length.for.turtles...SCL...mm.  : num  94.5 113.9 95 64.9 52.7 ...
&gt;  $ Maximum.male.length...SVL...mm..straight.carapace.length.for.turtles...SCL...mm.    : num  NA NA NA NA NA NA NA NA NA NA ...
&gt;  $ Maximum.juvenile.length...SVL...mm..straight.carapace.length.for.turtles...SCL...mm.: num  31 34 NA 25 NA 26.5 26 29 NA NA ...
&gt;  $ Hatchling.neonate.mass..g.                                                          : num  NA NA NA 0.6 NA 0.6 NA NA NA NA ...
&gt;  $ Reproductive.mode                                                                   : chr  "viviparous" "oviparous" "oviparous" "oviparous" ...
&gt;  $ Mean.number.of.offspring.per.litter.or.number.of.eggs.per.clutch                    : num  6.4 11.4 NA 4.9 4 4.3 5.5 3.7 NA NA ...
&gt;  $ Smallest.clutch.size                                                                : num  3 1 NA 3 2 1 1 1 NA NA ...
&gt;  $ Largest.clutch.size                                                                 : int  10 17 NA 8 6 8 10 8 NA NA ...
&gt;  $ Number.of.litters.or.clutches.produced.per.year                                     : num  NA 1 NA 1 NA 1 NA 1.5 NA NA ...
&gt;  $ Egg.length..mm.                                                                     : chr  "No" NA NA NA ...
&gt;  $ Egg.width..mm.                                                                      : chr  "No" NA NA NA ...
&gt;  $ Mean.Tb                                                                             : num  NA 39.9 29 33.6 NA 36.2 NA 34.8 NA NA ...
&gt;  $ Minimum.Tb                                                                          : num  NA NA NA NA NA NA NA NA NA NA ...
&gt;  $ Maximum.Tb                                                                          : num  NA NA NA NA NA NA NA NA NA NA ...
&gt;  $ area                                                                                : num  7.72e+09 5.95e+12 4.46e+10 5.38e+09 9.22e+11 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="do">## How many species with distribution range</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="do">##data do we have within each foraging behavior category?</span></span>
<span id="cb25-3"><a href="#cb25-3"></a></span>
<span id="cb25-4"><a href="#cb25-4"></a>((range.area <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="at">X =</span> merg.data<span class="sc">$</span>area,</span>
<span id="cb25-5"><a href="#cb25-5"></a>                       <span class="at">INDEX =</span> <span class="fu">list</span>(merg.data<span class="sc">$</span>Foraging.mode),</span>
<span id="cb25-6"><a href="#cb25-6"></a>                       <span class="at">FUN =</span> <span class="cf">function</span>(X) <span class="fu">length</span>(<span class="fu">na.omit</span>(X)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;       active      plastic sit-and-wait 
&gt;          452           93          431</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="do">## Visualizing the data</span></span>
<span id="cb27-2"><a href="#cb27-2"></a></span>
<span id="cb27-3"><a href="#cb27-3"></a>vis.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(bd.mass, mean.tb, range.area)</span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="fu">colnames</span>(vis.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Active (n = 1136)'</span>,</span>
<span id="cb27-5"><a href="#cb27-5"></a>                        <span class="st">'Plastic (n = 104)'</span>,</span>
<span id="cb27-6"><a href="#cb27-6"></a>                        <span class="st">'Sit-and-wait (n = 566)'</span>)</span>
<span id="cb27-7"><a href="#cb27-7"></a><span class="fu">rownames</span>(vis.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'body mass'</span>, <span class="st">'mean Tb'</span>, <span class="st">'range area'</span>)</span>
<span id="cb27-8"><a href="#cb27-8"></a></span>
<span id="cb27-9"><a href="#cb27-9"></a></span>
<span id="cb27-10"><a href="#cb27-10"></a><span class="fu">barplot</span>(vis.data, <span class="at">beside =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1500</span>),</span>
<span id="cb27-11"><a href="#cb27-11"></a>        <span class="at">las =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="fu">rep</span>(<span class="st">'white'</span>, <span class="dv">3</span>), <span class="at">border =</span> <span class="st">'white'</span>,</span>
<span id="cb27-12"><a href="#cb27-12"></a>        <span class="at">ylab =</span> <span class="st">'Absolut number'</span>, <span class="at">xlab =</span> <span class="st">'Foraging behavior'</span>)</span>
<span id="cb27-13"><a href="#cb27-13"></a></span>
<span id="cb27-14"><a href="#cb27-14"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-15"><a href="#cb27-15"></a></span>
<span id="cb27-16"><a href="#cb27-16"></a><span class="fu">grid</span>()</span>
<span id="cb27-17"><a href="#cb27-17"></a><span class="fu">barplot</span>(vis.data, <span class="at">beside =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1500</span>),</span>
<span id="cb27-18"><a href="#cb27-18"></a>        <span class="at">las =</span> <span class="dv">1</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-19"><a href="#cb27-19"></a><span class="fu">box</span>()</span>
<span id="cb27-20"><a href="#cb27-20"></a></span>
<span id="cb27-21"><a href="#cb27-21"></a><span class="fu">legend</span>(<span class="st">'topleft'</span>, <span class="at">legend =</span> <span class="fu">rownames</span>(vis.data),</span>
<span id="cb27-22"><a href="#cb27-22"></a>       <span class="at">fill =</span> <span class="fu">gray.colors</span>(<span class="dv">3</span>), <span class="at">bty =</span> <span class="st">'n'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="do">## Lineage through time plot</span></span>
<span id="cb28-2"><a href="#cb28-2"></a></span>
<span id="cb28-3"><a href="#cb28-3"></a>filt.data<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">' '</span>, <span class="st">'_'</span>, <span class="fu">as.character</span>(filt.data<span class="sc">$</span>Species))</span>
<span id="cb28-4"><a href="#cb28-4"></a>filt.data<span class="sc">$</span>Species[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "Ablepharus_sikimmensis" "Abronia_gadovii"        "Abronia_juarezi"       
&gt; [4] "Abronia_monticola"      "Abronia_taeniata"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="fu">rownames</span>(filt.data) <span class="ot">&lt;-</span> filt.data<span class="sc">$</span>Species</span>
<span id="cb30-2"><a href="#cb30-2"></a></span>
<span id="cb30-3"><a href="#cb30-3"></a>check <span class="ot">&lt;-</span> <span class="fu">name.check</span>(lizard.tree, filt.data)</span>
<span id="cb30-4"><a href="#cb30-4"></a>rm_phy <span class="ot">&lt;-</span> check<span class="sc">$</span>tree_not_data</span>
<span id="cb30-5"><a href="#cb30-5"></a>rm_dat <span class="ot">&lt;-</span> check<span class="sc">$</span>data_not_tree</span>
<span id="cb30-6"><a href="#cb30-6"></a>pruned.tree <span class="ot">&lt;-</span> <span class="fu">drop.tip</span>(lizard.tree, rm_phy)</span>
<span id="cb30-7"><a href="#cb30-7"></a></span>
<span id="cb30-8"><a href="#cb30-8"></a>pruned.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(filt.data,</span>
<span id="cb30-9"><a href="#cb30-9"></a>                      <span class="at">subset =</span> <span class="fu">rownames</span>(filt.data) <span class="sc">%in%</span> pruned.tree<span class="sc">$</span>tip,</span>
<span id="cb30-10"><a href="#cb30-10"></a>                      <span class="at">select =</span> <span class="fu">names</span>(filt.data))</span>
<span id="cb30-11"><a href="#cb30-11"></a><span class="fu">name.check</span>(pruned.tree, pruned.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "OK"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>pruned.data<span class="sc">$</span>Foraging.mode <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(pruned.data<span class="sc">$</span>Foraging.mode)</span>
<span id="cb32-2"><a href="#cb32-2"></a></span>
<span id="cb32-3"><a href="#cb32-3"></a>map.spp <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(pruned.data)[ , <span class="dv">12</span>]</span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="fu">head</span>(map.spp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;         Acanthocercus_atricollis    Acanthodactylus_beershebensis 
&gt;                   "sit-and-wait"                         "active" 
&gt;        Acanthodactylus_boskianus         Acanthodactylus_cantoris 
&gt;                         "active"                         "active" 
&gt;       Acanthodactylus_erythrurus Acanthodactylus_gongrorhynchatus 
&gt;                        "plastic"                         "active"</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="do">## now let's do our stochastic mapping</span></span>
<span id="cb34-2"><a href="#cb34-2"></a></span>
<span id="cb34-3"><a href="#cb34-3"></a>lizard.maps.ard <span class="ot">&lt;-</span> <span class="fu">make.simmap</span>(pruned.tree, map.spp, <span class="at">model =</span> <span class="st">"ARD"</span>,</span>
<span id="cb34-4"><a href="#cb34-4"></a>                               <span class="at">nsim =</span> <span class="dv">5</span>, <span class="at">pi =</span> <span class="st">'estimated'</span>, <span class="at">Q =</span> <span class="st">'mcmc'</span>)</span>
<span id="cb34-5"><a href="#cb34-5"></a>lizard.maps.sym <span class="ot">&lt;-</span> <span class="fu">make.simmap</span>(pruned.tree, <span class="at">pi =</span> <span class="st">'estimated'</span>,</span>
<span id="cb34-6"><a href="#cb34-6"></a>                               map.spp, <span class="at">Q =</span> <span class="st">'mcmc'</span>, <span class="at">model =</span> <span class="st">"SYM"</span>,</span>
<span id="cb34-7"><a href="#cb34-7"></a>                               <span class="at">nsim =</span> <span class="dv">5</span>)</span>
<span id="cb34-8"><a href="#cb34-8"></a>lizard.maps.er <span class="ot">&lt;-</span> <span class="fu">make.simmap</span>(pruned.tree, map.spp, <span class="at">pi =</span> <span class="st">'estimated'</span>,</span>
<span id="cb34-9"><a href="#cb34-9"></a>                              <span class="at">Q =</span> <span class="st">'mcmc'</span>, <span class="at">model =</span> <span class="st">"ER"</span>,</span>
<span id="cb34-10"><a href="#cb34-10"></a>                              <span class="at">nsim =</span> <span class="dv">5</span>)</span>
<span id="cb34-11"><a href="#cb34-11"></a></span>
<span id="cb34-12"><a href="#cb34-12"></a><span class="do">## model selection based on AIC</span></span>
<span id="cb34-13"><a href="#cb34-13"></a></span>
<span id="cb34-14"><a href="#cb34-14"></a><span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"modER"</span>, <span class="st">"modARD"</span>, <span class="st">"modSYM"</span>),</span>
<span id="cb34-15"><a href="#cb34-15"></a>           <span class="at">AIC =</span> <span class="fu">c</span>(<span class="fu">AIC</span>(lizard.maps.er), <span class="fu">AIC</span>(lizard.maps.ard),</span>
<span id="cb34-16"><a href="#cb34-16"></a>                   <span class="fu">AIC</span>(lizard.maps.sym)), <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-17"><a href="#cb34-17"></a></span>
<span id="cb34-18"><a href="#cb34-18"></a><span class="do">## increasing the simulations</span></span>
<span id="cb34-19"><a href="#cb34-19"></a></span>
<span id="cb34-20"><a href="#cb34-20"></a>lizard.maps.sym <span class="ot">&lt;-</span> <span class="fu">make.simmap</span>(pruned.tree,</span>
<span id="cb34-21"><a href="#cb34-21"></a>                               map.spp, <span class="at">model =</span> <span class="st">"SYM"</span>, <span class="at">nsim =</span> <span class="dv">100000</span>)</span>
<span id="cb34-22"><a href="#cb34-22"></a><span class="fu">save</span>(lizard.maps.sym, <span class="at">file =</span> <span class="st">"stochastic.map.sym.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="do">## convert to tree with unbranching nodes</span></span>
<span id="cb35-2"><a href="#cb35-2"></a></span>
<span id="cb35-3"><a href="#cb35-3"></a>idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lizard.maps.sym), <span class="dv">1</span>)</span>
<span id="cb35-4"><a href="#cb35-4"></a>tt <span class="ot">&lt;-</span> <span class="fu">map.to.singleton</span>(lizard.maps.sym[[idx]])</span>
<span id="cb35-5"><a href="#cb35-5"></a></span>
<span id="cb35-6"><a href="#cb35-6"></a><span class="do">## compute all node heights</span></span>
<span id="cb35-7"><a href="#cb35-7"></a></span>
<span id="cb35-8"><a href="#cb35-8"></a>H <span class="ot">&lt;-</span> <span class="fu">nodeHeights</span>(tt)</span>
<span id="cb35-9"><a href="#cb35-9"></a></span>
<span id="cb35-10"><a href="#cb35-10"></a><span class="do">## pull out heights all all events</span></span>
<span id="cb35-11"><a href="#cb35-11"></a></span>
<span id="cb35-12"><a href="#cb35-12"></a>h <span class="ot">&lt;-</span> <span class="fu">max</span>(H)<span class="sc">-</span><span class="fu">branching.times</span>(tt)</span>
<span id="cb35-13"><a href="#cb35-13"></a></span>
<span id="cb35-14"><a href="#cb35-14"></a><span class="do">## get the states at each event</span></span>
<span id="cb35-15"><a href="#cb35-15"></a></span>
<span id="cb35-16"><a href="#cb35-16"></a>ss <span class="ot">&lt;-</span><span class="fu">setNames</span>(<span class="fu">as.factor</span>(<span class="fu">names</span>(tt<span class="sc">$</span>edge.length)), tt<span class="sc">$</span>edge[ , <span class="dv">2</span>])</span>
<span id="cb35-17"><a href="#cb35-17"></a></span>
<span id="cb35-18"><a href="#cb35-18"></a><span class="do">## create a matrix to count lineages</span></span>
<span id="cb35-19"><a href="#cb35-19"></a></span>
<span id="cb35-20"><a href="#cb35-20"></a>lineages <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="fu">length</span>(h), <span class="fu">length</span>(<span class="fu">levels</span>(<span class="fu">as.factor</span>(map.spp))),</span>
<span id="cb35-21"><a href="#cb35-21"></a>                   <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">names</span>(h), <span class="fu">levels</span>(<span class="fu">as.factor</span>(map.spp))))</span>
<span id="cb35-22"><a href="#cb35-22"></a></span>
<span id="cb35-23"><a href="#cb35-23"></a><span class="do">## count them</span></span>
<span id="cb35-24"><a href="#cb35-24"></a></span>
<span id="cb35-25"><a href="#cb35-25"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(h)){</span>
<span id="cb35-26"><a href="#cb35-26"></a>    ii <span class="ot">&lt;-</span> <span class="fu">intersect</span>(<span class="fu">which</span>(h[i]<span class="sc">&gt;</span>H[ , <span class="dv">1</span>]), <span class="fu">which</span>(h[i]<span class="sc">&lt;=</span>H[ , <span class="dv">2</span>]))</span>
<span id="cb35-27"><a href="#cb35-27"></a>    lineages[i,] <span class="ot">&lt;-</span> <span class="fu">summary</span>(ss[ii])</span>
<span id="cb35-28"><a href="#cb35-28"></a>}</span>
<span id="cb35-29"><a href="#cb35-29"></a></span>
<span id="cb35-30"><a href="#cb35-30"></a><span class="do">## sort by event</span></span>
<span id="cb35-31"><a href="#cb35-31"></a></span>
<span id="cb35-32"><a href="#cb35-32"></a>ii <span class="ot">&lt;-</span> <span class="fu">order</span>(h)</span>
<span id="cb35-33"><a href="#cb35-33"></a>times <span class="ot">&lt;-</span> h[ii]</span>
<span id="cb35-34"><a href="#cb35-34"></a>lineages <span class="ot">&lt;-</span> lineages[ii, ]</span>
<span id="cb35-35"><a href="#cb35-35"></a></span>
<span id="cb35-36"><a href="#cb35-36"></a></span>
<span id="cb35-37"><a href="#cb35-37"></a><span class="do">##png('./imgs/figureS2.png', width = 7, height = 7, units = 'in',</span></span>
<span id="cb35-38"><a href="#cb35-38"></a><span class="do">##    res = 360)</span></span>
<span id="cb35-39"><a href="#cb35-39"></a><span class="do">##pdf('./imgs/figuer1.pdf')</span></span>
<span id="cb35-40"><a href="#cb35-40"></a></span>
<span id="cb35-41"><a href="#cb35-41"></a></span>
<span id="cb35-42"><a href="#cb35-42"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb35-43"><a href="#cb35-43"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb35-44"><a href="#cb35-44"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb35-45"><a href="#cb35-45"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb35-46"><a href="#cb35-46"></a></span>
<span id="cb35-47"><a href="#cb35-47"></a></span>
<span id="cb35-48"><a href="#cb35-48"></a><span class="do">## create plot area</span></span>
<span id="cb35-49"><a href="#cb35-49"></a></span>
<span id="cb35-50"><a href="#cb35-50"></a><span class="fu">plot</span>(<span class="cn">NA</span>, <span class="at">xlim =</span> <span class="fu">range</span>(times), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(lineages)),</span>
<span id="cb35-51"><a href="#cb35-51"></a>     <span class="at">ylab =</span> <span class="st">"Lineages"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb35-52"><a href="#cb35-52"></a>     <span class="at">xlab =</span> <span class="st">"Time (mya)"</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb35-53"><a href="#cb35-53"></a></span>
<span id="cb35-54"><a href="#cb35-54"></a><span class="do">## add lineages through time for each type</span></span>
<span id="cb35-55"><a href="#cb35-55"></a></span>
<span id="cb35-56"><a href="#cb35-56"></a><span class="fu">lines</span>(times, lineages[ , <span class="dv">1</span>], <span class="at">type =</span> <span class="st">"s"</span>,</span>
<span id="cb35-57"><a href="#cb35-57"></a>      <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>)</span>
<span id="cb35-58"><a href="#cb35-58"></a><span class="fu">lines</span>(times, lineages[ , <span class="dv">2</span>], <span class="at">type =</span> <span class="st">"s"</span>,</span>
<span id="cb35-59"><a href="#cb35-59"></a>      <span class="at">col =</span> <span class="st">'green4'</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb35-60"><a href="#cb35-60"></a><span class="fu">lines</span>(times, lineages[ , <span class="dv">3</span>], <span class="at">type =</span> <span class="st">"s"</span>,</span>
<span id="cb35-61"><a href="#cb35-61"></a>      <span class="at">col =</span> <span class="st">'#DCE319FF'</span>, <span class="at">lwd =</span> <span class="dv">4</span>)</span>
<span id="cb35-62"><a href="#cb35-62"></a></span>
<span id="cb35-63"><a href="#cb35-63"></a><span class="do">## superimpose tree</span></span>
<span id="cb35-64"><a href="#cb35-64"></a></span>
<span id="cb35-65"><a href="#cb35-65"></a>cols <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">make.transparent</span>(<span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>), <span class="fl">0.5</span>),</span>
<span id="cb35-66"><a href="#cb35-66"></a>                 <span class="fu">levels</span>(<span class="fu">as.factor</span>(map.spp)))</span>
<span id="cb35-67"><a href="#cb35-67"></a></span>
<span id="cb35-68"><a href="#cb35-68"></a><span class="fu">plot</span>(lizard.maps.sym[[idx]], cols, <span class="at">ftype =</span> <span class="st">"off"</span>, <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb35-69"><a href="#cb35-69"></a>     <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>))</span>
<span id="cb35-70"><a href="#cb35-70"></a>obj<span class="ot">&lt;-</span> <span class="fu">markChanges</span>(lizard.maps.sym[[idx]], <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb35-71"><a href="#cb35-71"></a></span>
<span id="cb35-72"><a href="#cb35-72"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(obj)) <span class="fu">lines</span>(<span class="fu">rep</span>(obj[i,<span class="st">"x"</span>] , <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">0</span>, obj[i,<span class="st">"y"</span>]),</span>
<span id="cb35-73"><a href="#cb35-73"></a>                            <span class="at">lty =</span> <span class="st">"dotted"</span>, <span class="at">col =</span> <span class="fu">make.transparent</span>(<span class="st">"grey"</span>, <span class="fl">0.8</span>))</span>
<span id="cb35-74"><a href="#cb35-74"></a></span>
<span id="cb35-75"><a href="#cb35-75"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="fu">levels</span>(<span class="fu">as.factor</span>(map.spp)), <span class="at">pch =</span> <span class="dv">22</span>,</span>
<span id="cb35-76"><a href="#cb35-76"></a>       <span class="at">pt.bg =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>),</span>
<span id="cb35-77"><a href="#cb35-77"></a>       <span class="at">pt.cex =</span> <span class="fl">1.2</span> , <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb35-78"><a href="#cb35-78"></a></span>
<span id="cb35-79"><a href="#cb35-79"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">nodeHeights</span>(lizard.maps.sym[[idx]])),</span>
<span id="cb35-80"><a href="#cb35-80"></a>                       <span class="at">length.out =</span> <span class="dv">4</span>), <span class="dv">0</span>),</span>
<span id="cb35-81"><a href="#cb35-81"></a>     <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">max</span>(<span class="fu">nodeHeights</span>(lizard.maps.sym[[idx]])), <span class="dv">0</span>,</span>
<span id="cb35-82"><a href="#cb35-82"></a>                       <span class="at">length.out =</span> <span class="dv">4</span>), <span class="dv">0</span>), <span class="at">cex.axis =</span> <span class="fl">0.8</span>)</span>
<span id="cb35-83"><a href="#cb35-83"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">cex.axis =</span> <span class="fl">0.8</span>)</span>
<span id="cb35-84"><a href="#cb35-84"></a><span class="fu">mtext</span>(<span class="st">'A'</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">at =</span> <span class="dv">1200</span>, <span class="at">las =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="dv">3</span>)</span>
<span id="cb35-85"><a href="#cb35-85"></a></span>
<span id="cb35-86"><a href="#cb35-86"></a></span>
<span id="cb35-87"><a href="#cb35-87"></a><span class="do">## create plot area</span></span>
<span id="cb35-88"><a href="#cb35-88"></a></span>
<span id="cb35-89"><a href="#cb35-89"></a><span class="fu">plot</span>(<span class="cn">NA</span>, <span class="at">xlim =</span> <span class="fu">range</span>(times), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(lineages)),</span>
<span id="cb35-90"><a href="#cb35-90"></a>     <span class="at">ylab =</span> <span class="st">"Lineages"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb35-91"><a href="#cb35-91"></a>     <span class="at">xlab =</span> <span class="st">"Time (mya)"</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb35-92"><a href="#cb35-92"></a><span class="fu">grid</span>()</span>
<span id="cb35-93"><a href="#cb35-93"></a></span>
<span id="cb35-94"><a href="#cb35-94"></a><span class="do">## add lineages through time for each type</span></span>
<span id="cb35-95"><a href="#cb35-95"></a></span>
<span id="cb35-96"><a href="#cb35-96"></a><span class="fu">lines</span>(times, lineages[ , <span class="dv">1</span>], <span class="at">type =</span> <span class="st">"s"</span>,</span>
<span id="cb35-97"><a href="#cb35-97"></a>      <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>)</span>
<span id="cb35-98"><a href="#cb35-98"></a><span class="fu">lines</span>(times, lineages[ , <span class="dv">2</span>], <span class="at">type =</span> <span class="st">"s"</span>,</span>
<span id="cb35-99"><a href="#cb35-99"></a>      <span class="at">col =</span> <span class="st">'green4'</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb35-100"><a href="#cb35-100"></a><span class="fu">lines</span>(times, lineages[ , <span class="dv">3</span>], <span class="at">type =</span> <span class="st">"s"</span>,</span>
<span id="cb35-101"><a href="#cb35-101"></a>      <span class="at">col =</span> <span class="st">'#DCE319FF'</span>, <span class="at">lwd =</span> <span class="dv">4</span>)</span>
<span id="cb35-102"><a href="#cb35-102"></a></span>
<span id="cb35-103"><a href="#cb35-103"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="fu">levels</span>(<span class="fu">as.factor</span>(map.spp)),</span>
<span id="cb35-104"><a href="#cb35-104"></a>       <span class="at">pch =</span> <span class="dv">22</span>, <span class="at">pt.bg =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>),</span>
<span id="cb35-105"><a href="#cb35-105"></a>       <span class="at">pt.cex =</span> <span class="fl">1.2</span> , <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb35-106"><a href="#cb35-106"></a></span>
<span id="cb35-107"><a href="#cb35-107"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">nodeHeights</span>(lizard.maps.sym[[idx]])),</span>
<span id="cb35-108"><a href="#cb35-108"></a>                       <span class="at">length.out =</span> <span class="dv">4</span>), <span class="dv">0</span>),</span>
<span id="cb35-109"><a href="#cb35-109"></a>     <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">max</span>(<span class="fu">nodeHeights</span>(lizard.maps.sym[[idx]])), <span class="dv">0</span>,</span>
<span id="cb35-110"><a href="#cb35-110"></a>                       <span class="at">length.out =</span> <span class="dv">4</span>), <span class="dv">0</span>), <span class="at">cex.axis =</span> <span class="fl">0.8</span>)</span>
<span id="cb35-111"><a href="#cb35-111"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">cex.axis =</span> <span class="fl">0.8</span>)</span>
<span id="cb35-112"><a href="#cb35-112"></a><span class="fu">mtext</span>(<span class="st">'B'</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">at =</span> <span class="dv">590</span>, <span class="at">las =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="dv">3</span>)</span>
<span id="cb35-113"><a href="#cb35-113"></a><span class="fu">box</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="do">##dev.off()</span></span>
<span id="cb36-2"><a href="#cb36-2"></a></span>
<span id="cb36-3"><a href="#cb36-3"></a></span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="do">## plotting arc phylogeny for visualization</span></span>
<span id="cb36-5"><a href="#cb36-5"></a></span>
<span id="cb36-6"><a href="#cb36-6"></a><span class="do">##png('./imgs/figure2.png', width = 7, height = 7, units = 'in',</span></span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="do">##    res = 360)</span></span>
<span id="cb36-8"><a href="#cb36-8"></a><span class="do">##pdf('./imgs/figuer1.pdf')</span></span>
<span id="cb36-9"><a href="#cb36-9"></a></span>
<span id="cb36-10"><a href="#cb36-10"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb36-11"><a href="#cb36-11"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb36-12"><a href="#cb36-12"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb36-13"><a href="#cb36-13"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb36-14"><a href="#cb36-14"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb36-15"><a href="#cb36-15"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb36-16"><a href="#cb36-16"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb36-17"><a href="#cb36-17"></a>                <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>,</span>
<span id="cb36-18"><a href="#cb36-18"></a>                <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>,</span>
<span id="cb36-19"><a href="#cb36-19"></a>                <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">7</span>,</span>
<span id="cb36-20"><a href="#cb36-20"></a>                <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">7</span>), <span class="at">nrow =</span> <span class="dv">11</span>, <span class="at">ncol =</span> <span class="dv">6</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb36-21"><a href="#cb36-21"></a></span>
<span id="cb36-22"><a href="#cb36-22"></a>cols <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>),</span>
<span id="cb36-23"><a href="#cb36-23"></a>                 <span class="fu">levels</span>(<span class="fu">as.factor</span>(map.spp)))</span>
<span id="cb36-24"><a href="#cb36-24"></a></span>
<span id="cb36-25"><a href="#cb36-25"></a>arc_height <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb36-26"><a href="#cb36-26"></a>h <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">nodeHeights</span>(pruned.tree))</span>
<span id="cb36-27"><a href="#cb36-27"></a><span class="fu">plotSimmap</span>(lizard.maps.sym[[<span class="dv">1</span>]], <span class="at">colors =</span> cols,</span>
<span id="cb36-28"><a href="#cb36-28"></a>           <span class="at">type =</span> <span class="st">"arc"</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">ftype =</span> <span class="st">"off"</span>,</span>
<span id="cb36-29"><a href="#cb36-29"></a>           <span class="at">arc_height =</span> <span class="fl">0.5</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span><span class="sc">*</span>h, <span class="fl">1.1</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>arc_height)<span class="sc">*</span>h),</span>
<span id="cb36-30"><a href="#cb36-30"></a>           <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="fl">3.2</span>))</span>
<span id="cb36-31"><a href="#cb36-31"></a></span>
<span id="cb36-32"><a href="#cb36-32"></a>labs <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, h, <span class="at">by =</span> <span class="dv">35</span>)</span>
<span id="cb36-33"><a href="#cb36-33"></a><span class="fu">draw.arc</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">radius =</span> h<span class="sc">-</span>labs[<span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(labs)]<span class="sc">+</span><span class="fl">0.5</span><span class="sc">*</span>h,</span>
<span id="cb36-34"><a href="#cb36-34"></a>         <span class="at">angle1 =</span> , <span class="at">angle2 =</span> pi, <span class="at">col =</span> <span class="fu">make.transparent</span>(<span class="st">"blue"</span>,<span class="fl">0.2</span>),</span>
<span id="cb36-35"><a href="#cb36-35"></a>         <span class="at">lty =</span> <span class="st">"dotted"</span>)</span>
<span id="cb36-36"><a href="#cb36-36"></a></span>
<span id="cb36-37"><a href="#cb36-37"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">pos =</span> <span class="sc">-</span><span class="fl">3.5</span>, <span class="at">at =</span> h<span class="sc">-</span><span class="fu">seq</span>(<span class="dv">0</span>, h, <span class="at">by =</span> <span class="dv">35</span>)<span class="sc">+</span><span class="fl">0.5</span><span class="sc">*</span>h,</span>
<span id="cb36-38"><a href="#cb36-38"></a>     <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">0</span>, h, <span class="at">by =</span> <span class="dv">35</span>), <span class="at">cex.axis =</span> <span class="fl">0.5</span>, <span class="at">padj =</span> <span class="sc">-</span><span class="fl">2.5</span>)</span>
<span id="cb36-39"><a href="#cb36-39"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">pos =</span> <span class="sc">-</span><span class="fl">3.5</span>, <span class="at">at =</span> <span class="sc">-</span>h<span class="sc">+</span><span class="fu">seq</span>(<span class="dv">0</span>, h, <span class="at">by =</span> <span class="dv">35</span>)<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span>h,</span>
<span id="cb36-40"><a href="#cb36-40"></a>     <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">0</span>, h, <span class="at">by =</span> <span class="dv">35</span>), <span class="at">cex.axis =</span> <span class="fl">0.5</span>, <span class="at">padj =</span> <span class="sc">-</span><span class="fl">2.5</span>)</span>
<span id="cb36-41"><a href="#cb36-41"></a></span>
<span id="cb36-42"><a href="#cb36-42"></a><span class="fu">legend</span>(<span class="st">'topleft'</span>, <span class="fu">levels</span>(<span class="fu">as.factor</span>(map.spp)), <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb36-43"><a href="#cb36-43"></a>       <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>))</span>
<span id="cb36-44"><a href="#cb36-44"></a></span>
<span id="cb36-45"><a href="#cb36-45"></a></span>
<span id="cb36-46"><a href="#cb36-46"></a><span class="do">## overlaying raster images</span></span>
<span id="cb36-47"><a href="#cb36-47"></a></span>
<span id="cb36-48"><a href="#cb36-48"></a>gek.img <span class="ot">&lt;-</span><span class="fu">readPNG</span>(<span class="st">'imgs/gecko.png'</span>, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-49"><a href="#cb36-49"></a><span class="fu">rasterImage</span>(gek.img, <span class="dv">445</span>, <span class="dv">110</span>, <span class="dv">475</span>, <span class="dv">85</span>)</span>
<span id="cb36-50"><a href="#cb36-50"></a>sci.img <span class="ot">&lt;-</span><span class="fu">readPNG</span>(<span class="st">'imgs/skink.png'</span>, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-51"><a href="#cb36-51"></a><span class="fu">rasterImage</span>(sci.img, <span class="dv">325</span>, <span class="dv">360</span>, <span class="dv">365</span>, <span class="dv">290</span>)</span>
<span id="cb36-52"><a href="#cb36-52"></a>tegu.img <span class="ot">&lt;-</span><span class="fu">readPNG</span>(<span class="st">'imgs/tegu.png'</span>, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-53"><a href="#cb36-53"></a><span class="fu">rasterImage</span>(tegu.img, <span class="dv">205</span>, <span class="dv">375</span>, <span class="dv">275</span>, <span class="dv">450</span>)</span>
<span id="cb36-54"><a href="#cb36-54"></a>var.img <span class="ot">&lt;-</span><span class="fu">readPNG</span>(<span class="st">'imgs/komodo.png'</span>, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-55"><a href="#cb36-55"></a><span class="fu">rasterImage</span>(var.img, <span class="dv">10</span>, <span class="dv">450</span>, <span class="dv">130</span>, <span class="dv">495</span>)</span>
<span id="cb36-56"><a href="#cb36-56"></a>igu.img <span class="ot">&lt;-</span> <span class="fu">readPNG</span>(<span class="st">'imgs/clamy.png'</span>, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-57"><a href="#cb36-57"></a><span class="fu">rasterImage</span>(igu.img, <span class="sc">-</span><span class="dv">170</span>, <span class="dv">470</span>, <span class="sc">-</span><span class="dv">120</span>, <span class="dv">435</span>)</span>
<span id="cb36-58"><a href="#cb36-58"></a>anole.img <span class="ot">&lt;-</span> <span class="fu">readPNG</span>(<span class="st">'imgs/anole.png'</span>, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-59"><a href="#cb36-59"></a><span class="fu">rasterImage</span>(anole.img, <span class="sc">-</span><span class="dv">350</span>, <span class="dv">360</span>, <span class="sc">-</span><span class="dv">310</span>, <span class="dv">320</span>)</span>
<span id="cb36-60"><a href="#cb36-60"></a>boa.img <span class="ot">&lt;-</span> <span class="fu">readPNG</span>(<span class="st">'imgs/boa.png'</span>, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-61"><a href="#cb36-61"></a><span class="fu">rasterImage</span>(boa.img, <span class="sc">-</span><span class="dv">430</span>, <span class="dv">220</span>, <span class="sc">-</span><span class="dv">350</span>, <span class="dv">320</span>)</span>
<span id="cb36-62"><a href="#cb36-62"></a>col.img <span class="ot">&lt;-</span> <span class="fu">readPNG</span>(<span class="st">'imgs/colubrid.png'</span>, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-63"><a href="#cb36-63"></a><span class="fu">rasterImage</span>(col.img, <span class="sc">-</span><span class="dv">490</span>, <span class="dv">90</span>, <span class="sc">-</span><span class="dv">430</span>, <span class="dv">180</span>)</span>
<span id="cb36-64"><a href="#cb36-64"></a></span>
<span id="cb36-65"><a href="#cb36-65"></a></span>
<span id="cb36-66"><a href="#cb36-66"></a><span class="fu">mtext</span>(<span class="st">'A'</span>, <span class="at">at =</span> <span class="sc">-</span><span class="dv">550</span>, <span class="at">side =</span> <span class="dv">3</span>, <span class="at">line =</span> <span class="fl">0.5</span>)</span>
<span id="cb36-67"><a href="#cb36-67"></a></span>
<span id="cb36-68"><a href="#cb36-68"></a><span class="do">## plotting state transitions</span></span>
<span id="cb36-69"><a href="#cb36-69"></a></span>
<span id="cb36-70"><a href="#cb36-70"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">3</span>), <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">2.8</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb36-71"><a href="#cb36-71"></a>    <span class="at">las =</span> <span class="dv">1</span>, <span class="at">col.lab =</span> <span class="st">'white'</span>)</span>
<span id="cb36-72"><a href="#cb36-72"></a></span>
<span id="cb36-73"><a href="#cb36-73"></a>for.density <span class="ot">&lt;-</span> <span class="fu">density</span>(lizard.maps.sym)</span>
<span id="cb36-74"><a href="#cb36-74"></a><span class="fu">plot</span>(for.density, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>),</span>
<span id="cb36-75"><a href="#cb36-75"></a>     <span class="at">transition =</span> for.density<span class="sc">$</span>trans[<span class="dv">1</span>],</span>
<span id="cb36-76"><a href="#cb36-76"></a>     <span class="at">colors =</span> <span class="st">'#39568CFF'</span>, <span class="at">xlab =</span> <span class="st">'Number of transitions'</span>,</span>
<span id="cb36-77"><a href="#cb36-77"></a>     <span class="at">ylab =</span> <span class="st">'Relative frequency'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb36-78"><a href="#cb36-78"></a><span class="fu">plot</span>(for.density, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb36-79"><a href="#cb36-79"></a>     <span class="at">transition =</span> for.density<span class="sc">$</span>trans[<span class="dv">2</span>],</span>
<span id="cb36-80"><a href="#cb36-80"></a>     <span class="at">colors =</span> <span class="st">'#39568CFF'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb36-81"><a href="#cb36-81"></a><span class="fu">plot</span>(for.density, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb36-82"><a href="#cb36-82"></a>     <span class="at">transition =</span> for.density<span class="sc">$</span>trans[<span class="dv">4</span>],</span>
<span id="cb36-83"><a href="#cb36-83"></a>     <span class="at">colors =</span> <span class="st">'green4'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>) </span>
<span id="cb36-84"><a href="#cb36-84"></a><span class="fu">plot</span>(for.density, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb36-85"><a href="#cb36-85"></a>     <span class="at">transition =</span> for.density<span class="sc">$</span>trans[<span class="dv">6</span>],</span>
<span id="cb36-86"><a href="#cb36-86"></a>     <span class="at">colors =</span> <span class="st">'#DCE319FF'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>) </span>
<span id="cb36-87"><a href="#cb36-87"></a><span class="fu">plot</span>(for.density, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb36-88"><a href="#cb36-88"></a>     <span class="at">transition =</span> for.density<span class="sc">$</span>trans[<span class="dv">5</span>],</span>
<span id="cb36-89"><a href="#cb36-89"></a>     <span class="at">colors =</span> <span class="st">'#DCE319FF'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>) </span>
<span id="cb36-90"><a href="#cb36-90"></a><span class="fu">plot</span>(for.density, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb36-91"><a href="#cb36-91"></a>     <span class="at">transition =</span> for.density<span class="sc">$</span>trans[<span class="dv">3</span>],</span>
<span id="cb36-92"><a href="#cb36-92"></a>     <span class="at">colors =</span> <span class="st">'green4'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>) </span>
<span id="cb36-93"><a href="#cb36-93"></a></span>
<span id="cb36-94"><a href="#cb36-94"></a></span>
<span id="cb36-95"><a href="#cb36-95"></a><span class="do">## Modifying axes labels</span></span>
<span id="cb36-96"><a href="#cb36-96"></a></span>
<span id="cb36-97"><a href="#cb36-97"></a><span class="do">## plotting state transitions</span></span>
<span id="cb36-98"><a href="#cb36-98"></a></span>
<span id="cb36-99"><a href="#cb36-99"></a><span class="fu">mtext</span>(<span class="st">'Relative frequency'</span>, <span class="at">at =</span> <span class="sc">-</span><span class="dv">380</span>, <span class="at">line =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb36-100"><a href="#cb36-100"></a><span class="fu">mtext</span>(<span class="st">'B'</span>, <span class="at">at =</span> <span class="sc">-</span><span class="dv">380</span>, <span class="at">line =</span> <span class="dv">17</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb36-101"><a href="#cb36-101"></a><span class="fu">mtext</span>(<span class="st">'Number of transitions'</span>, <span class="at">at =</span> <span class="sc">-</span><span class="dv">130</span>, <span class="at">line =</span> <span class="sc">-</span><span class="fl">11.5</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb36-102"><a href="#cb36-102"></a></span>
<span id="cb36-103"><a href="#cb36-103"></a><span class="do">##dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="do">## setting up data for MuSEE model</span></span>
<span id="cb37-2"><a href="#cb37-2"></a></span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="do">## acording to Reptile database, there are</span></span>
<span id="cb37-4"><a href="#cb37-4"></a><span class="do">## currently 11989 species of squamates</span></span>
<span id="cb37-5"><a href="#cb37-5"></a></span>
<span id="cb37-6"><a href="#cb37-6"></a>((sampling.f <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">tapply</span>(<span class="at">X =</span> pruned.data<span class="sc">$</span>Species,</span>
<span id="cb37-7"><a href="#cb37-7"></a>                                  <span class="at">INDEX =</span> <span class="fu">list</span>(pruned.data<span class="sc">$</span>Foraging.mode),</span>
<span id="cb37-8"><a href="#cb37-8"></a>                                  length)<span class="sc">/</span><span class="dv">11989</span>)))</span>
<span id="cb37-9"><a href="#cb37-9"></a></span>
<span id="cb37-10"><a href="#cb37-10"></a>pruned.data<span class="sc">$</span>Foraging.mode <span class="ot">&lt;-</span> <span class="fu">as.character</span>(pruned.data<span class="sc">$</span>Foraging.mode)</span>
<span id="cb37-11"><a href="#cb37-11"></a>pruned.data<span class="sc">$</span>Foraging.mode[pruned.data<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'active'</span>] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb37-12"><a href="#cb37-12"></a>pruned.data<span class="sc">$</span>Foraging.mode[pruned.data<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'plastic'</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb37-13"><a href="#cb37-13"></a>pruned.data<span class="sc">$</span>Foraging.mode[pruned.data<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'sit-and-wait'</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb37-14"><a href="#cb37-14"></a></span>
<span id="cb37-15"><a href="#cb37-15"></a>pruned.data<span class="sc">$</span>Foraging.mode <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(pruned.data<span class="sc">$</span>Foraging.mode)</span>
<span id="cb37-16"><a href="#cb37-16"></a>pruned.data <span class="ot">&lt;-</span> pruned.data[pruned.tree<span class="sc">$</span>tip.label, ]</span>
<span id="cb37-17"><a href="#cb37-17"></a><span class="fu">data.frame</span>(<span class="at">tree =</span> pruned.tree<span class="sc">$</span>tip.label[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>],</span>
<span id="cb37-18"><a href="#cb37-18"></a>           <span class="at">data =</span> <span class="fu">rownames</span>(pruned.data)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb37-19"><a href="#cb37-19"></a>forg <span class="ot">&lt;-</span> <span class="fu">setNames</span>(pruned.data<span class="sc">$</span>Foraging.mode, <span class="fu">rownames</span>(pruned.data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="do">## writing down our MuSSE likelihood function</span></span>
<span id="cb38-2"><a href="#cb38-2"></a></span>
<span id="cb38-3"><a href="#cb38-3"></a>pruned.tree <span class="ot">&lt;-</span> <span class="fu">force.ultrametric</span>(pruned.tree)</span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="fu">is.ultrametric</span>(pruned.tree)</span>
<span id="cb38-5"><a href="#cb38-5"></a></span>
<span id="cb38-6"><a href="#cb38-6"></a>((lik.musse <span class="ot">&lt;-</span> <span class="fu">make.musse</span>(pruned.tree,</span>
<span id="cb38-7"><a href="#cb38-7"></a>                          forg, <span class="dv">3</span>, <span class="at">sampling.f =</span> sampling.f)))</span>
<span id="cb38-8"><a href="#cb38-8"></a></span>
<span id="cb38-9"><a href="#cb38-9"></a></span>
<span id="cb38-10"><a href="#cb38-10"></a>p <span class="ot">&lt;-</span> <span class="fu">starting.point.musse</span>(pruned.tree, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb38-11"><a href="#cb38-11"></a>p</span>
<span id="cb38-12"><a href="#cb38-12"></a></span>
<span id="cb38-13"><a href="#cb38-13"></a>obj <span class="ot">&lt;-</span> <span class="fu">birthdeath</span>(pruned.tree)</span>
<span id="cb38-14"><a href="#cb38-14"></a><span class="fu">bd</span>(obj)</span>
<span id="cb38-15"><a href="#cb38-15"></a></span>
<span id="cb38-16"><a href="#cb38-16"></a>lik.null<span class="ot">&lt;-</span><span class="fu">constrain</span>(lik.musse,lambda2 <span class="sc">~</span> lambda1, lambda3 <span class="sc">~</span> lambda1, </span>
<span id="cb38-17"><a href="#cb38-17"></a>    mu2 <span class="sc">~</span> mu1, mu3 <span class="sc">~</span> mu1, q13 <span class="sc">~</span> <span class="dv">0</span>, q21 <span class="sc">~</span> q12, q23 <span class="sc">~</span> q12, q31 <span class="sc">~</span> <span class="dv">0</span>, </span>
<span id="cb38-18"><a href="#cb38-18"></a>    q32 <span class="sc">~</span> q12)</span>
<span id="cb38-19"><a href="#cb38-19"></a>lik.null</span>
<span id="cb38-20"><a href="#cb38-20"></a></span>
<span id="cb38-21"><a href="#cb38-21"></a><span class="do">## fitting a model - the null model in a sense - in which</span></span>
<span id="cb38-22"><a href="#cb38-22"></a><span class="do">## all birth &amp; death rates are equal between states,</span></span>
<span id="cb38-23"><a href="#cb38-23"></a><span class="do">## the character evolution is ordered (that is 1&lt;-&gt;2&lt;-&gt;3),</span></span>
<span id="cb38-24"><a href="#cb38-24"></a><span class="do">## and there is a single character transition rate</span></span>
<span id="cb38-25"><a href="#cb38-25"></a></span>
<span id="cb38-26"><a href="#cb38-26"></a>p[<span class="fu">argnames</span>(lik.null)]</span>
<span id="cb38-27"><a href="#cb38-27"></a></span>
<span id="cb38-28"><a href="#cb38-28"></a><span class="do">## fit the model</span></span>
<span id="cb38-29"><a href="#cb38-29"></a>fit.null <span class="ot">&lt;-</span> <span class="fu">find.mle</span>(lik.null, <span class="at">x.init =</span> p[<span class="fu">argnames</span>(lik.null)])</span>
<span id="cb38-30"><a href="#cb38-30"></a>fit.null</span>
<span id="cb38-31"><a href="#cb38-31"></a></span>
<span id="cb38-32"><a href="#cb38-32"></a><span class="do">## most complex model in which all rates of speciation</span></span>
<span id="cb38-33"><a href="#cb38-33"></a><span class="do">## &amp; extinction depend on the character state for our</span></span>
<span id="cb38-34"><a href="#cb38-34"></a><span class="do">## multi-state character</span></span>
<span id="cb38-35"><a href="#cb38-35"></a></span>
<span id="cb38-36"><a href="#cb38-36"></a>fit.full <span class="ot">&lt;-</span> <span class="fu">find.mle</span>(lik.musse, <span class="at">x.init =</span> p[<span class="fu">argnames</span>(lik.musse)])</span>
<span id="cb38-37"><a href="#cb38-37"></a>fit.full</span>
<span id="cb38-38"><a href="#cb38-38"></a></span>
<span id="cb38-39"><a href="#cb38-39"></a><span class="do">## model in which only the speciation rate () varies between states</span></span>
<span id="cb38-40"><a href="#cb38-40"></a></span>
<span id="cb38-41"><a href="#cb38-41"></a><span class="do">## create likelihood function</span></span>
<span id="cb38-42"><a href="#cb38-42"></a></span>
<span id="cb38-43"><a href="#cb38-43"></a>lik.lambda <span class="ot">&lt;-</span> <span class="fu">constrain</span>(lik.musse, mu2 <span class="sc">~</span> mu1, mu3 <span class="sc">~</span> mu1,</span>
<span id="cb38-44"><a href="#cb38-44"></a>                        q21 <span class="sc">~</span> q12, q23 <span class="sc">~</span> q12, q32 <span class="sc">~</span> q12)</span>
<span id="cb38-45"><a href="#cb38-45"></a></span>
<span id="cb38-46"><a href="#cb38-46"></a><span class="do">## fit it</span></span>
<span id="cb38-47"><a href="#cb38-47"></a></span>
<span id="cb38-48"><a href="#cb38-48"></a>fit.lambda <span class="ot">&lt;-</span> <span class="fu">find.mle</span>(lik.lambda, p[<span class="fu">argnames</span>(lik.lambda)])</span>
<span id="cb38-49"><a href="#cb38-49"></a>fit.lambda</span>
<span id="cb38-50"><a href="#cb38-50"></a></span>
<span id="cb38-51"><a href="#cb38-51"></a><span class="do">## model in which extinction rate () varies</span></span>
<span id="cb38-52"><a href="#cb38-52"></a></span>
<span id="cb38-53"><a href="#cb38-53"></a>lik.mu <span class="ot">&lt;-</span> <span class="fu">constrain</span>(lik.musse, lambda2 <span class="sc">~</span> lambda1, lambda3 <span class="sc">~</span> lambda1, </span>
<span id="cb38-54"><a href="#cb38-54"></a>    q13 <span class="sc">~</span> <span class="dv">0</span>, q21 <span class="sc">~</span> q12, q23 <span class="sc">~</span> q12, q31 <span class="sc">~</span> <span class="dv">0</span>, q32 <span class="sc">~</span> q12)</span>
<span id="cb38-55"><a href="#cb38-55"></a>fit.mu <span class="ot">&lt;-</span> <span class="fu">find.mle</span>(lik.mu, p[<span class="fu">argnames</span>(lik.mu)])</span>
<span id="cb38-56"><a href="#cb38-56"></a>fit.mu</span>
<span id="cb38-57"><a href="#cb38-57"></a></span>
<span id="cb38-58"><a href="#cb38-58"></a><span class="do">## a model in which  &amp;  vary, but in which</span></span>
<span id="cb38-59"><a href="#cb38-59"></a><span class="do">## character transitions are ordered</span></span>
<span id="cb38-60"><a href="#cb38-60"></a></span>
<span id="cb38-61"><a href="#cb38-61"></a>lik.lambda.mu <span class="ot">&lt;-</span> <span class="fu">constrain</span>(lik.musse, q13 <span class="sc">~</span> <span class="dv">0</span>, q21 <span class="sc">~</span> q12, q23 <span class="sc">~</span> q12, </span>
<span id="cb38-62"><a href="#cb38-62"></a>    q31 <span class="sc">~</span> <span class="dv">0</span>, q32 <span class="sc">~</span> q12)</span>
<span id="cb38-63"><a href="#cb38-63"></a>fit.lambda.mu <span class="ot">&lt;-</span> <span class="fu">find.mle</span>(lik.lambda.mu, p[<span class="fu">argnames</span>(lik.lambda.mu)])</span>
<span id="cb38-64"><a href="#cb38-64"></a>fit.lambda.mu</span>
<span id="cb38-65"><a href="#cb38-65"></a></span>
<span id="cb38-66"><a href="#cb38-66"></a><span class="do">## a model in which  &amp;  are constant,</span></span>
<span id="cb38-67"><a href="#cb38-67"></a><span class="do">## but in which the transition process is</span></span>
<span id="cb38-68"><a href="#cb38-68"></a><span class="do">## full flexible (i.e., unordered)</span></span>
<span id="cb38-69"><a href="#cb38-69"></a></span>
<span id="cb38-70"><a href="#cb38-70"></a>lik.unordered <span class="ot">&lt;-</span> <span class="fu">constrain</span>(lik.musse, lambda2 <span class="sc">~</span> lambda1,</span>
<span id="cb38-71"><a href="#cb38-71"></a>                           lambda3 <span class="sc">~</span> lambda1, mu2 <span class="sc">~</span> mu1, mu3 <span class="sc">~</span> mu1)</span>
<span id="cb38-72"><a href="#cb38-72"></a>fit.unordered <span class="ot">&lt;-</span> <span class="fu">find.mle</span>(lik.unordered, p[<span class="fu">argnames</span>(lik.unordered)])</span>
<span id="cb38-73"><a href="#cb38-73"></a>fit.unordered</span>
<span id="cb38-74"><a href="#cb38-74"></a></span>
<span id="cb38-75"><a href="#cb38-75"></a><span class="do">## comparing our fitted models</span></span>
<span id="cb38-76"><a href="#cb38-76"></a></span>
<span id="cb38-77"><a href="#cb38-77"></a>AnovaResults <span class="ot">&lt;-</span> <span class="fu">anova</span>(fit.null, </span>
<span id="cb38-78"><a href="#cb38-78"></a>    <span class="at">all.different =</span> fit.full, </span>
<span id="cb38-79"><a href="#cb38-79"></a>    <span class="at">free.lambda =</span> fit.lambda, </span>
<span id="cb38-80"><a href="#cb38-80"></a>    <span class="at">free.mu =</span> fit.mu, </span>
<span id="cb38-81"><a href="#cb38-81"></a>    <span class="at">free.lambda.mu =</span> fit.lambda.mu, </span>
<span id="cb38-82"><a href="#cb38-82"></a>    <span class="at">free.q =</span> fit.unordered)</span>
<span id="cb38-83"><a href="#cb38-83"></a><span class="fu">save</span>(AnovaResults, <span class="at">file =</span> <span class="st">'anova-models.RData'</span>)</span>
<span id="cb38-84"><a href="#cb38-84"></a><span class="fu">aicw</span>(<span class="fu">setNames</span>(AnovaResults<span class="sc">$</span>AIC,<span class="fu">rownames</span>(AnovaResults)))</span>
<span id="cb38-85"><a href="#cb38-85"></a></span>
<span id="cb38-86"><a href="#cb38-86"></a><span class="fu">coef</span>(fit.full)</span>
<span id="cb38-87"><a href="#cb38-87"></a></span>
<span id="cb38-88"><a href="#cb38-88"></a></span>
<span id="cb38-89"><a href="#cb38-89"></a><span class="do">## Bayesian mcmc to get posterior probability distributions</span></span>
<span id="cb38-90"><a href="#cb38-90"></a></span>
<span id="cb38-91"><a href="#cb38-91"></a>prior <span class="ot">&lt;-</span> <span class="fu">make.prior.exponential</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb38-92"><a href="#cb38-92"></a></span>
<span id="cb38-93"><a href="#cb38-93"></a><span class="do">## because of the type of MCMC used by diversitree,</span></span>
<span id="cb38-94"><a href="#cb38-94"></a><span class="do">## is to set a control parameter w. This parameter</span></span>
<span id="cb38-95"><a href="#cb38-95"></a><span class="do">## affects how many function evaluations are required</span></span>
<span id="cb38-96"><a href="#cb38-96"></a><span class="do">## between updates to the MCMC chain; however we need</span></span>
<span id="cb38-97"><a href="#cb38-97"></a><span class="do">## to do some preliminary sampling from the posterior</span></span>
<span id="cb38-98"><a href="#cb38-98"></a><span class="do">## distribution to set it</span></span>
<span id="cb38-99"><a href="#cb38-99"></a></span>
<span id="cb38-100"><a href="#cb38-100"></a>prelim <span class="ot">&lt;-</span> <span class="fu">mcmc</span>(lik.musse, fit.full<span class="sc">$</span>par, <span class="at">nsteps =</span> <span class="dv">100</span>,</span>
<span id="cb38-101"><a href="#cb38-101"></a>               <span class="at">prior =</span> prior, <span class="at">w =</span> <span class="dv">1</span>, <span class="at">print.every =</span> <span class="dv">0</span>)</span>
<span id="cb38-102"><a href="#cb38-102"></a><span class="fu">head</span>(prelim)</span>
<span id="cb38-103"><a href="#cb38-103"></a></span>
<span id="cb38-104"><a href="#cb38-104"></a><span class="do">## Fitzjohn recommends setting w</span></span>
<span id="cb38-105"><a href="#cb38-105"></a></span>
<span id="cb38-106"><a href="#cb38-106"></a>w <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">sapply</span>(prelim[<span class="dv">2</span><span class="sc">:</span>(<span class="fu">ncol</span>(prelim)<span class="sc">-</span><span class="dv">1</span>)],</span>
<span id="cb38-107"><a href="#cb38-107"></a>                 quantile, <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>)))</span>
<span id="cb38-108"><a href="#cb38-108"></a>w</span>
<span id="cb38-109"><a href="#cb38-109"></a></span>
<span id="cb38-110"><a href="#cb38-110"></a><span class="do">## running the mcmc</span></span>
<span id="cb38-111"><a href="#cb38-111"></a></span>
<span id="cb38-112"><a href="#cb38-112"></a>mcmc.fit.full <span class="ot">&lt;-</span> <span class="fu">mcmc</span>(lik.musse, p[<span class="fu">colnames</span>(w)],</span>
<span id="cb38-113"><a href="#cb38-113"></a>                      <span class="at">nsteps =</span> <span class="fl">1e5</span>, <span class="at">prior =</span> prior,</span>
<span id="cb38-114"><a href="#cb38-114"></a>                      <span class="at">w =</span> w, <span class="at">print.every =</span> <span class="dv">1000</span>)</span>
<span id="cb38-115"><a href="#cb38-115"></a><span class="fu">save</span>(mcmc.fit.full, <span class="at">file =</span> <span class="st">"mcmc.fit.full.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="do">## likelihood profile showing how the</span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="do">## likelihood changed through the MCMC run</span></span>
<span id="cb39-3"><a href="#cb39-3"></a></span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="fu">plot</span>(mcmc.fit.full<span class="sc">$</span>i, mcmc.fit.full<span class="sc">$</span>p, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb39-5"><a href="#cb39-5"></a>     <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb39-6"><a href="#cb39-6"></a><span class="fu">grid</span>()</span>
<span id="cb39-7"><a href="#cb39-7"></a></span>
<span id="cb39-8"><a href="#cb39-8"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-9"><a href="#cb39-9"></a><span class="fu">plot</span>(mcmc.fit.full<span class="sc">$</span>i, mcmc.fit.full<span class="sc">$</span>p, <span class="at">type =</span> <span class="st">'l'</span>, <span class="at">xlab =</span> <span class="st">'Generation'</span>,</span>
<span id="cb39-10"><a href="#cb39-10"></a>    <span class="at">ylab =</span> <span class="st">'log(L)'</span>, <span class="at">las =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="do">##png('./imgs/figure2.png', width = 7, height = 7, units = 'in',</span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="do">##    res = 360)</span></span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="do">##pdf('./imgs/figuer2.pdf')</span></span>
<span id="cb40-4"><a href="#cb40-4"></a></span>
<span id="cb40-5"><a href="#cb40-5"></a></span>
<span id="cb40-6"><a href="#cb40-6"></a></span>
<span id="cb40-7"><a href="#cb40-7"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb40-8"><a href="#cb40-8"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>,</span>
<span id="cb40-9"><a href="#cb40-9"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>,</span>
<span id="cb40-10"><a href="#cb40-10"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">ncol =</span> <span class="dv">6</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb40-11"><a href="#cb40-11"></a></span>
<span id="cb40-12"><a href="#cb40-12"></a><span class="do">## computing the mean of our posterior sample,</span></span>
<span id="cb40-13"><a href="#cb40-13"></a><span class="do">## and we can also compute things like the density</span></span>
<span id="cb40-14"><a href="#cb40-14"></a><span class="do">## or the 95% HPD interval, just as we would with</span></span>
<span id="cb40-15"><a href="#cb40-15"></a><span class="do">## any standard Bayesian MCMC</span></span>
<span id="cb40-16"><a href="#cb40-16"></a></span>
<span id="cb40-17"><a href="#cb40-17"></a><span class="fu">colMeans</span>(mcmc.fit.full)[<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(mcmc.fit.full)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;       lambda1       lambda2       lambda3           mu1           mu2 
&gt;  3.905682e-01  2.792552e+00  1.984349e-01  3.254581e-01  2.725914e+00 
&gt;           mu3           q12           q13           q21           q23 
&gt;  1.856608e-01  2.068392e-02  2.458880e-03  2.657543e-03  6.629359e-02 
&gt;           q31           q32             p 
&gt;  6.417547e-04  2.455477e-02 -5.066131e+03</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="do">## speciation rates</span></span>
<span id="cb42-2"><a href="#cb42-2"></a></span>
<span id="cb42-3"><a href="#cb42-3"></a>colors <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>), <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb42-4"><a href="#cb42-4"></a></span>
<span id="cb42-5"><a href="#cb42-5"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb42-6"><a href="#cb42-6"></a><span class="fu">plot</span>(<span class="cn">NA</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb42-7"><a href="#cb42-7"></a>     <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">xlab =</span> <span class="st">''</span>)</span>
<span id="cb42-8"><a href="#cb42-8"></a><span class="fu">grid</span>()</span>
<span id="cb42-9"><a href="#cb42-9"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-10"><a href="#cb42-10"></a><span class="fu">profiles.plot</span>(mcmc.fit.full[ , <span class="fu">grep</span>(<span class="st">'lambda'</span>, <span class="fu">colnames</span>(mcmc.fit.full))],</span>
<span id="cb42-11"><a href="#cb42-11"></a>              <span class="at">col.line =</span> colors, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">legend.pos =</span> <span class="cn">NULL</span>,</span>
<span id="cb42-12"><a href="#cb42-12"></a>              <span class="at">lines.on.top =</span> <span class="cn">FALSE</span>)</span>
<span id="cb42-13"><a href="#cb42-13"></a><span class="fu">legend</span>(<span class="st">'topright'</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">expression</span>(lambda[<span class="dv">1</span>]),</span>
<span id="cb42-14"><a href="#cb42-14"></a>                              <span class="fu">expression</span>(lambda[<span class="dv">2</span>]), <span class="fu">expression</span>(lambda[<span class="dv">3</span>])),</span>
<span id="cb42-15"><a href="#cb42-15"></a>       <span class="at">fil =</span> colors, <span class="at">bty =</span> <span class="st">'n'</span>)</span>
<span id="cb42-16"><a href="#cb42-16"></a></span>
<span id="cb42-17"><a href="#cb42-17"></a><span class="do">## extinction rates</span></span>
<span id="cb42-18"><a href="#cb42-18"></a></span>
<span id="cb42-19"><a href="#cb42-19"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb42-20"><a href="#cb42-20"></a><span class="fu">plot</span>(<span class="cn">NA</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb42-21"><a href="#cb42-21"></a>     <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">xlab =</span> <span class="st">''</span>)</span>
<span id="cb42-22"><a href="#cb42-22"></a><span class="fu">grid</span>()</span>
<span id="cb42-23"><a href="#cb42-23"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-24"><a href="#cb42-24"></a><span class="fu">profiles.plot</span>(mcmc.fit.full[ , <span class="fu">grep</span>(<span class="st">'mu'</span>, <span class="fu">colnames</span>(mcmc.fit.full))], </span>
<span id="cb42-25"><a href="#cb42-25"></a>              <span class="at">col.line =</span> colors, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">legend.pos =</span> <span class="cn">NULL</span>,</span>
<span id="cb42-26"><a href="#cb42-26"></a>              <span class="at">lines.on.top =</span> <span class="cn">FALSE</span>)</span>
<span id="cb42-27"><a href="#cb42-27"></a><span class="fu">legend</span>(<span class="st">'topright'</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">expression</span>(mu[<span class="dv">1</span>]),</span>
<span id="cb42-28"><a href="#cb42-28"></a>                              <span class="fu">expression</span>(mu[<span class="dv">2</span>]), <span class="fu">expression</span>(mu[<span class="dv">3</span>])),</span>
<span id="cb42-29"><a href="#cb42-29"></a>       <span class="at">fill =</span> colors, <span class="at">bty =</span> <span class="st">'n'</span>)</span>
<span id="cb42-30"><a href="#cb42-30"></a></span>
<span id="cb42-31"><a href="#cb42-31"></a><span class="do">## net diversification rates</span></span>
<span id="cb42-32"><a href="#cb42-32"></a></span>
<span id="cb42-33"><a href="#cb42-33"></a>net.div <span class="ot">&lt;-</span> mcmc.fit.full[ , <span class="fu">grep</span>(<span class="st">'lambda'</span>, <span class="fu">colnames</span>(mcmc.fit.full))]<span class="sc">-</span></span>
<span id="cb42-34"><a href="#cb42-34"></a>    mcmc.fit.full[ , <span class="fu">grep</span>(<span class="st">'mu'</span>, <span class="fu">colnames</span>(mcmc.fit.full))]</span>
<span id="cb42-35"><a href="#cb42-35"></a></span>
<span id="cb42-36"><a href="#cb42-36"></a><span class="do">##par(mar = c(5, 7, 2.5, 3.1), mgp = c(2.5, 1, 0), col.lab = 'black')</span></span>
<span id="cb42-37"><a href="#cb42-37"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="fl">0.5</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">col.lab =</span> <span class="st">'black'</span>)</span>
<span id="cb42-38"><a href="#cb42-38"></a><span class="fu">plot</span>(<span class="cn">NA</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">70</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.30</span>),</span>
<span id="cb42-39"><a href="#cb42-39"></a>     <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">xlab =</span> <span class="st">''</span>)</span>
<span id="cb42-40"><a href="#cb42-40"></a><span class="fu">grid</span>()</span>
<span id="cb42-41"><a href="#cb42-41"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-42"><a href="#cb42-42"></a><span class="fu">profiles.plot</span>(net.div,</span>
<span id="cb42-43"><a href="#cb42-43"></a>              <span class="at">xlab =</span> <span class="st">'Net diversification'</span>, <span class="at">ylab =</span> <span class="st">'Probability density'</span>,</span>
<span id="cb42-44"><a href="#cb42-44"></a>              <span class="at">las =</span> <span class="dv">1</span>, <span class="at">legend.pos =</span> <span class="cn">NULL</span>,</span>
<span id="cb42-45"><a href="#cb42-45"></a>              <span class="at">col.line =</span> <span class="fu">setNames</span>(colors, <span class="fu">colnames</span>(net.div)),</span>
<span id="cb42-46"><a href="#cb42-46"></a>              <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb42-47"><a href="#cb42-47"></a><span class="fu">legend</span>(<span class="st">'topright'</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">expression</span>(lambda<span class="sc">-</span>mu[<span class="dv">1</span>]),</span>
<span id="cb42-48"><a href="#cb42-48"></a>                              <span class="fu">expression</span>(lambda<span class="sc">-</span>mu[<span class="dv">2</span>]),</span>
<span id="cb42-49"><a href="#cb42-49"></a>                              <span class="fu">expression</span>(lambda<span class="sc">-</span>mu[<span class="dv">3</span>])),</span>
<span id="cb42-50"><a href="#cb42-50"></a>       <span class="at">fill =</span> colors, <span class="at">bty =</span> <span class="st">'n'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="do">##mtext('C', at = -0.2, side = 3, line = 1.1)</span></span>
<span id="cb43-2"><a href="#cb43-2"></a></span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="do">##dev.off()</span></span>
<span id="cb43-4"><a href="#cb43-4"></a></span>
<span id="cb43-5"><a href="#cb43-5"></a><span class="do">## setting up the data for GLS models. We are using</span></span>
<span id="cb43-6"><a href="#cb43-6"></a><span class="do">## the merg.data table because it contains data on species ranges</span></span>
<span id="cb43-7"><a href="#cb43-7"></a></span>
<span id="cb43-8"><a href="#cb43-8"></a>merg.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(merg.data)</span>
<span id="cb43-9"><a href="#cb43-9"></a>merg.data<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">' '</span>, <span class="st">'_'</span>, <span class="fu">as.character</span>(merg.data<span class="sc">$</span>Species))</span>
<span id="cb43-10"><a href="#cb43-10"></a><span class="fu">rownames</span>(merg.data) <span class="ot">&lt;-</span> merg.data<span class="sc">$</span>Species</span>
<span id="cb43-11"><a href="#cb43-11"></a>check <span class="ot">&lt;-</span> <span class="fu">name.check</span>(lizard.tree, merg.data)</span>
<span id="cb43-12"><a href="#cb43-12"></a>rm_phy <span class="ot">&lt;-</span> check<span class="sc">$</span>tree_not_data</span>
<span id="cb43-13"><a href="#cb43-13"></a>rm_dat <span class="ot">&lt;-</span> check<span class="sc">$</span>data_not_tree</span>
<span id="cb43-14"><a href="#cb43-14"></a>pruned.tree.mrg <span class="ot">&lt;-</span> <span class="fu">drop.tip</span>(lizard.tree, rm_phy)</span>
<span id="cb43-15"><a href="#cb43-15"></a></span>
<span id="cb43-16"><a href="#cb43-16"></a>pruned.data.mrg <span class="ot">&lt;-</span> <span class="fu">subset</span>(merg.data,</span>
<span id="cb43-17"><a href="#cb43-17"></a>                          <span class="at">subset =</span> <span class="fu">rownames</span>(merg.data) <span class="sc">%in%</span> pruned.tree.mrg<span class="sc">$</span>tip,</span>
<span id="cb43-18"><a href="#cb43-18"></a>                          <span class="at">select =</span> <span class="fu">names</span>(merg.data))</span>
<span id="cb43-19"><a href="#cb43-19"></a><span class="fu">name.check</span>(pruned.tree.mrg, pruned.data.mrg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "OK"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>pruned.data.mrg<span class="sc">$</span>rep.output <span class="ot">&lt;-</span> (pruned.data.mrg<span class="sc">$</span>Mean.number.of.offspring.per.litter.or.number.of.eggs.per.clutch)<span class="sc">*</span>(pruned.data.mrg<span class="sc">$</span>Number.of.litters.or.clutches.produced.per.year)</span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="fu">str</span>(pruned.data.mrg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 762 obs. of  30 variables:
&gt;  $ Species                                                                             : chr  "Acanthocercus_atricollis" "Acanthodactylus_beershebensis" "Acanthodactylus_boskianus" "Acanthodactylus_cantoris" ...
&gt;  $ Order                                                                               : chr  "Squamata" "Squamata" "Squamata" "Squamata" ...
&gt;  $ Family                                                                              : chr  "Agamidae" "Lacertidae" "Lacertidae" "Lacertidae" ...
&gt;  $ Genus                                                                               : chr  "Acanthocercus" "Acanthodactylus" "Acanthodactylus" "Acanthodactylus" ...
&gt;  $ Main.biogeographic.region                                                           : chr  "Afrotropic" "Saharo-Sindian" "Saharo-Sindian" "Saharo-Sindian" ...
&gt;  $ Microhabitat                                                                        : chr  "Arboreal" "Terrestrial" "Terrestrial" "Terrestrial" ...
&gt;  $ Habitat.type                                                                        : chr  "Savanna" "Shrubland" "Desert/Shrubland" "Desert/Shrubland" ...
&gt;  $ Minimal.elevation..m.                                                               : int  0 150 -385 0 0 62 NA 0 90 270 ...
&gt;  $ Maximum.elevation..m.                                                               : int  3000 560 2000 300 2500 709 NA 600 100 900 ...
&gt;  $ Diet                                                                                : chr  "Carnivorous" "Carnivorous" "Carnivorous" "Carnivorous" ...
&gt;  $ Active.time                                                                         : chr  "Diurnal" "Diurnal" "Diurnal" "Diurnal" ...
&gt;  $ Foraging.mode                                                                       : chr  "sit-and-wait" "active" "active" "active" ...
&gt;  $ Maximum.Longevity..years.                                                           : num  10.9 4.6 9 NA 2.1 NA NA NA NA 4 ...
&gt;  $ Maximum.body.mass..g.                                                               : num  177.8 16.6 19.5 19.1 13.8 ...
&gt;  $ Maximum.female.length...SVL...mm..straight.carapace.length.for.turtles...SCL...mm.  : num  113.9 64.9 60.1 48 68.6 ...
&gt;  $ Maximum.male.length...SVL...mm..straight.carapace.length.for.turtles...SCL...mm.    : num  NA NA NA NA NA NA NA NA NA NA ...
&gt;  $ Maximum.juvenile.length...SVL...mm..straight.carapace.length.for.turtles...SCL...mm.: num  34 25 26.5 26 29 NA NA NA NA 30 ...
&gt;  $ Hatchling.neonate.mass..g.                                                          : num  NA 0.6 0.6 NA NA NA NA NA NA NA ...
&gt;  $ Reproductive.mode                                                                   : chr  "oviparous" "oviparous" "oviparous" "oviparous" ...
&gt;  $ Mean.number.of.offspring.per.litter.or.number.of.eggs.per.clutch                    : num  11.4 4.9 4.3 5.5 3.7 NA 3.3 NA 4 3.7 ...
&gt;  $ Smallest.clutch.size                                                                : num  1 3 1 1 1 NA 2 NA 4 2 ...
&gt;  $ Largest.clutch.size                                                                 : int  17 8 8 10 8 NA 4 NA 4 7 ...
&gt;  $ Number.of.litters.or.clutches.produced.per.year                                     : num  1 1 1 NA 1.5 NA NA NA NA 4 ...
&gt;  $ Egg.length..mm.                                                                     : chr  NA NA NA NA ...
&gt;  $ Egg.width..mm.                                                                      : chr  NA NA NA NA ...
&gt;  $ Mean.Tb                                                                             : num  39.9 33.6 36.2 NA 34.8 NA NA NA 35.1 35.3 ...
&gt;  $ Minimum.Tb                                                                          : num  NA NA NA NA NA NA NA NA NA NA ...
&gt;  $ Maximum.Tb                                                                          : num  NA NA NA NA NA NA NA NA NA NA ...
&gt;  $ area                                                                                : num  5.95e+12 5.38e+09 1.58e+13 1.42e+12 1.03e+12 ...
&gt;  $ rep.output                                                                          : num  11.4 4.9 4.3 NA 5.55 NA NA NA NA 14.8 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb47-2"><a href="#cb47-2"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb47-3"><a href="#cb47-3"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb47-4"><a href="#cb47-4"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb47-5"><a href="#cb47-5"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb47-6"><a href="#cb47-6"></a></span>
<span id="cb47-7"><a href="#cb47-7"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(pruned.data.mrg<span class="sc">$</span>Maximum.body.mass..g.),</span>
<span id="cb47-8"><a href="#cb47-8"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">border =</span> <span class="st">'white'</span>, <span class="at">col =</span> <span class="st">'white'</span>,</span>
<span id="cb47-9"><a href="#cb47-9"></a>     <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb47-10"><a href="#cb47-10"></a><span class="fu">grid</span>()</span>
<span id="cb47-11"><a href="#cb47-11"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-12"><a href="#cb47-12"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(pruned.data.mrg<span class="sc">$</span>Maximum.body.mass..g.),</span>
<span id="cb47-13"><a href="#cb47-13"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">'Body mass'</span><span class="sc">~</span>(g)))</span>
<span id="cb47-14"><a href="#cb47-14"></a><span class="fu">box</span>()</span>
<span id="cb47-15"><a href="#cb47-15"></a></span>
<span id="cb47-16"><a href="#cb47-16"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(<span class="fu">log10</span>(pruned.data.mrg<span class="sc">$</span>Maximum.body.mass..g.)<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb47-17"><a href="#cb47-17"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">border =</span> <span class="st">'white'</span>, <span class="at">col =</span> <span class="st">'white'</span>,</span>
<span id="cb47-18"><a href="#cb47-18"></a>     <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb47-19"><a href="#cb47-19"></a><span class="fu">grid</span>()</span>
<span id="cb47-20"><a href="#cb47-20"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-21"><a href="#cb47-21"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(<span class="fu">log10</span>(pruned.data.mrg<span class="sc">$</span>Maximum.body.mass..g.)<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb47-22"><a href="#cb47-22"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">'Body mass'</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">+</span><span class="dv">1</span><span class="sc">~</span>(g)))</span>
<span id="cb47-23"><a href="#cb47-23"></a><span class="fu">box</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="do">## transforming the data</span></span>
<span id="cb48-2"><a href="#cb48-2"></a></span>
<span id="cb48-3"><a href="#cb48-3"></a>pruned.data.mrg<span class="sc">$</span>Maximum.body.mass..g. <span class="ot">&lt;-</span> <span class="fu">log10</span>(pruned.data.mrg<span class="sc">$</span>Maximum.body.mass..g.)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb48-4"><a href="#cb48-4"></a></span>
<span id="cb48-5"><a href="#cb48-5"></a></span>
<span id="cb48-6"><a href="#cb48-6"></a></span>
<span id="cb48-7"><a href="#cb48-7"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb48-8"><a href="#cb48-8"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb48-9"><a href="#cb48-9"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb48-10"><a href="#cb48-10"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb48-11"><a href="#cb48-11"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb48-12"><a href="#cb48-12"></a></span>
<span id="cb48-13"><a href="#cb48-13"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(pruned.data.mrg<span class="sc">$</span>Mean.Tb), <span class="at">main =</span> <span class="st">''</span>,</span>
<span id="cb48-14"><a href="#cb48-14"></a>     <span class="at">las =</span> <span class="dv">1</span>, <span class="at">border =</span> <span class="st">'white'</span>, <span class="at">col =</span> <span class="st">'white'</span>,</span>
<span id="cb48-15"><a href="#cb48-15"></a>     <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb48-16"><a href="#cb48-16"></a><span class="fu">grid</span>()</span>
<span id="cb48-17"><a href="#cb48-17"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-18"><a href="#cb48-18"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(pruned.data.mrg<span class="sc">$</span>Mean.Tb), <span class="at">main =</span> <span class="st">''</span>,</span>
<span id="cb48-19"><a href="#cb48-19"></a>     <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">'Mean body temperature'</span><span class="sc">~</span>(<span class="st">'\u00B0C'</span>)))</span>
<span id="cb48-20"><a href="#cb48-20"></a><span class="fu">box</span>()</span>
<span id="cb48-21"><a href="#cb48-21"></a></span>
<span id="cb48-22"><a href="#cb48-22"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(<span class="fu">log10</span>(pruned.data.mrg<span class="sc">$</span>Mean.Tb)), <span class="at">main =</span> <span class="st">''</span>,</span>
<span id="cb48-23"><a href="#cb48-23"></a>     <span class="at">las =</span> <span class="dv">1</span>, <span class="at">border =</span> <span class="st">'white'</span>, <span class="at">col =</span> <span class="st">'white'</span>,</span>
<span id="cb48-24"><a href="#cb48-24"></a>     <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb48-25"><a href="#cb48-25"></a><span class="fu">grid</span>()</span>
<span id="cb48-26"><a href="#cb48-26"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-27"><a href="#cb48-27"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(<span class="fu">log10</span>(pruned.data.mrg<span class="sc">$</span>Mean.Tb)),</span>
<span id="cb48-28"><a href="#cb48-28"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb48-29"><a href="#cb48-29"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">'Mean body temperature'</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(<span class="st">'\u00B0C'</span>)))</span>
<span id="cb48-30"><a href="#cb48-30"></a><span class="fu">box</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-4.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb49-2"><a href="#cb49-2"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb49-3"><a href="#cb49-3"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb49-4"><a href="#cb49-4"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb49-5"><a href="#cb49-5"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb49-6"><a href="#cb49-6"></a></span>
<span id="cb49-7"><a href="#cb49-7"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(pruned.data.mrg<span class="sc">$</span>area),</span>
<span id="cb49-8"><a href="#cb49-8"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">border =</span> <span class="st">'white'</span>,</span>
<span id="cb49-9"><a href="#cb49-9"></a>     <span class="at">col =</span> <span class="st">'white'</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb49-10"><a href="#cb49-10"></a><span class="fu">grid</span>()</span>
<span id="cb49-11"><a href="#cb49-11"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-12"><a href="#cb49-12"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(pruned.data.mrg<span class="sc">$</span>area), <span class="at">main =</span> <span class="st">''</span>,</span>
<span id="cb49-13"><a href="#cb49-13"></a>     <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">'Area of geographic range'</span><span class="sc">~</span>(km<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb49-14"><a href="#cb49-14"></a><span class="fu">box</span>()</span>
<span id="cb49-15"><a href="#cb49-15"></a></span>
<span id="cb49-16"><a href="#cb49-16"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(<span class="fu">log10</span>(pruned.data.mrg<span class="sc">$</span>area)),</span>
<span id="cb49-17"><a href="#cb49-17"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">border =</span> <span class="st">'white'</span>,</span>
<span id="cb49-18"><a href="#cb49-18"></a>     <span class="at">col =</span> <span class="st">'white'</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb49-19"><a href="#cb49-19"></a><span class="fu">grid</span>()</span>
<span id="cb49-20"><a href="#cb49-20"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-21"><a href="#cb49-21"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(<span class="fu">log10</span>(pruned.data.mrg<span class="sc">$</span>area)),</span>
<span id="cb49-22"><a href="#cb49-22"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb49-23"><a href="#cb49-23"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">'Area of geographic range'</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(km<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb49-24"><a href="#cb49-24"></a><span class="fu">box</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-5.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="do">## transforming data</span></span>
<span id="cb50-2"><a href="#cb50-2"></a></span>
<span id="cb50-3"><a href="#cb50-3"></a>pruned.data.mrg<span class="sc">$</span>area <span class="ot">&lt;-</span> <span class="fu">log10</span>(pruned.data.mrg<span class="sc">$</span>area)</span>
<span id="cb50-4"><a href="#cb50-4"></a></span>
<span id="cb50-5"><a href="#cb50-5"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb50-6"><a href="#cb50-6"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb50-7"><a href="#cb50-7"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb50-8"><a href="#cb50-8"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb50-9"><a href="#cb50-9"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb50-10"><a href="#cb50-10"></a></span>
<span id="cb50-11"><a href="#cb50-11"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(pruned.data.mrg<span class="sc">$</span>rep.output),</span>
<span id="cb50-12"><a href="#cb50-12"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">border =</span> <span class="st">'white'</span>,</span>
<span id="cb50-13"><a href="#cb50-13"></a>     <span class="at">col =</span> <span class="st">'white'</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb50-14"><a href="#cb50-14"></a><span class="fu">grid</span>()</span>
<span id="cb50-15"><a href="#cb50-15"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-16"><a href="#cb50-16"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(pruned.data.mrg<span class="sc">$</span>rep.output),</span>
<span id="cb50-17"><a href="#cb50-17"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb50-18"><a href="#cb50-18"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">'Reproductive output'</span>))</span>
<span id="cb50-19"><a href="#cb50-19"></a><span class="fu">box</span>()</span>
<span id="cb50-20"><a href="#cb50-20"></a></span>
<span id="cb50-21"><a href="#cb50-21"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(<span class="fu">log10</span>(pruned.data.mrg<span class="sc">$</span>rep.output)),</span>
<span id="cb50-22"><a href="#cb50-22"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">border =</span> <span class="st">'white'</span>, <span class="at">col =</span> <span class="st">'white'</span>,</span>
<span id="cb50-23"><a href="#cb50-23"></a>     <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb50-24"><a href="#cb50-24"></a><span class="fu">grid</span>()</span>
<span id="cb50-25"><a href="#cb50-25"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-26"><a href="#cb50-26"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(<span class="fu">log10</span>(pruned.data.mrg<span class="sc">$</span>rep.output)),</span>
<span id="cb50-27"><a href="#cb50-27"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">'Reproductive output'</span>))</span>
<span id="cb50-28"><a href="#cb50-28"></a><span class="fu">box</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-6.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="do">## transforming data</span></span>
<span id="cb51-2"><a href="#cb51-2"></a></span>
<span id="cb51-3"><a href="#cb51-3"></a>pruned.data.mrg<span class="sc">$</span>rep.output <span class="ot">&lt;-</span> <span class="fu">log10</span>(pruned.data.mrg<span class="sc">$</span>rep.output)</span>
<span id="cb51-4"><a href="#cb51-4"></a></span>
<span id="cb51-5"><a href="#cb51-5"></a><span class="fu">names</span>(pruned.data.mrg)[<span class="fu">c</span>(<span class="dv">14</span>, <span class="dv">26</span>, <span class="dv">29</span>, <span class="dv">30</span>)] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="st">'Maximum body mass'</span>),</span>
<span id="cb51-6"><a href="#cb51-6"></a>                                               <span class="fu">expression</span>(<span class="st">'Mean body temperature'</span>),</span>
<span id="cb51-7"><a href="#cb51-7"></a>                                               <span class="fu">expression</span>(<span class="st">'Area of geographic range'</span>),</span>
<span id="cb51-8"><a href="#cb51-8"></a>                                               <span class="st">'Reproductive output'</span>)</span>
<span id="cb51-9"><a href="#cb51-9"></a></span>
<span id="cb51-10"><a href="#cb51-10"></a></span>
<span id="cb51-11"><a href="#cb51-11"></a><span class="do">## looking at broad patterns in the data first</span></span>
<span id="cb51-12"><a href="#cb51-12"></a></span>
<span id="cb51-13"><a href="#cb51-13"></a><span class="fu">plot</span>(pruned.data.mrg[<span class="fu">c</span>(<span class="dv">14</span>, <span class="dv">26</span>, <span class="dv">29</span>, <span class="dv">30</span>)], <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">las =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-7.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="do">## fitting phylogenetic generalized least square models</span></span>
<span id="cb52-2"><a href="#cb52-2"></a></span>
<span id="cb52-3"><a href="#cb52-3"></a></span>
<span id="cb52-4"><a href="#cb52-4"></a><span class="fu">tapply</span>(<span class="at">X =</span> pruned.data.mrg<span class="sc">$</span><span class="st">'Maximum body mass'</span>,</span>
<span id="cb52-5"><a href="#cb52-5"></a>       <span class="at">INDEX =</span> <span class="fu">list</span>(pruned.data.mrg<span class="sc">$</span>Foraging.mode),</span>
<span id="cb52-6"><a href="#cb52-6"></a>       <span class="at">FUN =</span> <span class="cf">function</span>(X) <span class="fu">length</span>(<span class="fu">na.omit</span>(X)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;       active      plastic sit-and-wait 
&gt;          332           79          351</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="fu">tapply</span>(<span class="at">X =</span> pruned.data.mrg<span class="sc">$</span><span class="st">'Mean body temperature'</span>,</span>
<span id="cb54-2"><a href="#cb54-2"></a>       <span class="at">INDEX =</span> <span class="fu">list</span>(pruned.data.mrg<span class="sc">$</span>Foraging.mode),</span>
<span id="cb54-3"><a href="#cb54-3"></a>       <span class="at">FUN =</span> <span class="cf">function</span>(X) <span class="fu">length</span>(<span class="fu">na.omit</span>(X)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;       active      plastic sit-and-wait 
&gt;          192           58          234</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="fu">tapply</span>(<span class="at">X =</span> pruned.data.mrg<span class="sc">$</span><span class="st">'Area of geographic range'</span>,</span>
<span id="cb56-2"><a href="#cb56-2"></a>       <span class="at">INDEX =</span> <span class="fu">list</span>(pruned.data.mrg<span class="sc">$</span>Foraging.mode),</span>
<span id="cb56-3"><a href="#cb56-3"></a>       <span class="at">FUN =</span> <span class="cf">function</span>(X) <span class="fu">length</span>(<span class="fu">na.omit</span>(X)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;       active      plastic sit-and-wait 
&gt;          332           79          351</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="fu">tapply</span>(<span class="at">X =</span> pruned.data.mrg<span class="sc">$</span><span class="st">'Reproductive output'</span>,</span>
<span id="cb58-2"><a href="#cb58-2"></a>       <span class="at">INDEX =</span> <span class="fu">list</span>(pruned.data.mrg<span class="sc">$</span>Foraging.mode),</span>
<span id="cb58-3"><a href="#cb58-3"></a>       <span class="at">FUN =</span> <span class="cf">function</span>(X) <span class="fu">length</span>(<span class="fu">na.omit</span>(X)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;       active      plastic sit-and-wait 
&gt;           93           37          121</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="do">## filtering data by body mass and geographic range</span></span>
<span id="cb60-2"><a href="#cb60-2"></a></span>
<span id="cb60-3"><a href="#cb60-3"></a>mass.data <span class="ot">&lt;-</span> pruned.data.mrg[<span class="sc">!</span><span class="fu">is.na</span>(pruned.data.mrg<span class="sc">$</span><span class="st">'Maximum body mass'</span>), ]</span>
<span id="cb60-4"><a href="#cb60-4"></a>range.data <span class="ot">&lt;-</span> pruned.data.mrg[<span class="sc">!</span><span class="fu">is.na</span>(pruned.data.mrg<span class="sc">$</span><span class="st">'Area of geographic range'</span>), ]</span>
<span id="cb60-5"><a href="#cb60-5"></a></span>
<span id="cb60-6"><a href="#cb60-6"></a>mass.range <span class="ot">&lt;-</span> mass.data[mass.data<span class="sc">$</span>Species <span class="sc">%in%</span> range.data<span class="sc">$</span>Species, ]</span>
<span id="cb60-7"><a href="#cb60-7"></a><span class="fu">rownames</span>(mass.range) <span class="ot">&lt;-</span> mass.range<span class="sc">$</span>Species</span>
<span id="cb60-8"><a href="#cb60-8"></a></span>
<span id="cb60-9"><a href="#cb60-9"></a></span>
<span id="cb60-10"><a href="#cb60-10"></a>check <span class="ot">&lt;-</span> <span class="fu">name.check</span>(lizard.tree, mass.range)</span>
<span id="cb60-11"><a href="#cb60-11"></a>rm_phy <span class="ot">&lt;-</span> check<span class="sc">$</span>tree_not_data</span>
<span id="cb60-12"><a href="#cb60-12"></a>rm_dat <span class="ot">&lt;-</span> check<span class="sc">$</span>data_not_tree</span>
<span id="cb60-13"><a href="#cb60-13"></a>tree.mass.range <span class="ot">&lt;-</span> <span class="fu">drop.tip</span>(lizard.tree, rm_phy)</span>
<span id="cb60-14"><a href="#cb60-14"></a></span>
<span id="cb60-15"><a href="#cb60-15"></a>pruned.mass.range <span class="ot">&lt;-</span> <span class="fu">subset</span>(mass.range,</span>
<span id="cb60-16"><a href="#cb60-16"></a>                            <span class="at">subset =</span> <span class="fu">rownames</span>(mass.range) <span class="sc">%in%</span> tree.mass.range<span class="sc">$</span>tip,</span>
<span id="cb60-17"><a href="#cb60-17"></a>                            <span class="at">select =</span> <span class="fu">names</span>(mass.range))</span>
<span id="cb60-18"><a href="#cb60-18"></a><span class="fu">name.check</span>(tree.mass.range, pruned.mass.range)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "OK"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="fu">head</span>(pruned.mass.range[<span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">29</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;                                  Foraging.mode Maximum body mass
&gt; Acanthocercus_atricollis          sit-and-wait          3.249932
&gt; Acanthodactylus_beershebensis           active          2.220108
&gt; Acanthodactylus_boskianus               active          2.290035
&gt; Acanthodactylus_cantoris                active          2.281033
&gt; Acanthodactylus_erythrurus             plastic          2.139879
&gt; Acanthodactylus_gongrorhynchatus        active          1.812913
&gt;                                  Area of geographic range
&gt; Acanthocercus_atricollis                        12.774717
&gt; Acanthodactylus_beershebensis                    9.730783
&gt; Acanthodactylus_boskianus                       13.199259
&gt; Acanthodactylus_cantoris                        12.151685
&gt; Acanthodactylus_erythrurus                      12.012896
&gt; Acanthodactylus_gongrorhynchatus                11.120814</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="do">## looking at body size landscape before running PGLS</span></span>
<span id="cb64-2"><a href="#cb64-2"></a></span>
<span id="cb64-3"><a href="#cb64-3"></a>tree <span class="ot">&lt;-</span> <span class="fu">reorder</span>(tree.mass.range, <span class="st">"postorder"</span>)</span>
<span id="cb64-4"><a href="#cb64-4"></a>tree</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 
&gt; Phylogenetic tree with 762 tips and 761 internal nodes.
&gt; 
&gt; Tip labels:
&gt;   Sphenodon_punctatus, Phyllurus_amnicola, Saltuarius_cornutus, Orraya_occultus, Carphodactylus_laevis, Underwoodisaurus_milii, ...
&gt; 
&gt; Rooted; includes branch length(s).</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="do">## error assumed</span></span>
<span id="cb66-2"><a href="#cb66-2"></a></span>
<span id="cb66-3"><a href="#cb66-3"></a>MEvar <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb66-4"><a href="#cb66-4"></a></span>
<span id="cb66-5"><a href="#cb66-5"></a><span class="do">## data of body mass</span></span>
<span id="cb66-6"><a href="#cb66-6"></a></span>
<span id="cb66-7"><a href="#cb66-7"></a>dat <span class="ot">&lt;-</span> <span class="fu">setNames</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span>,</span>
<span id="cb66-8"><a href="#cb66-8"></a>                <span class="fu">rownames</span>(pruned.mass.range))</span>
<span id="cb66-9"><a href="#cb66-9"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(dat), <span class="dv">0</span>, <span class="fu">sqrt</span>(MEvar))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="do">## Defining prior. Prior for the maximum number</span></span>
<span id="cb67-2"><a href="#cb67-2"></a><span class="do">## of shifts was set as half of the number of branch lengths</span></span>
<span id="cb67-3"><a href="#cb67-3"></a></span>
<span id="cb67-4"><a href="#cb67-4"></a>priorOU <span class="ot">&lt;-</span> <span class="fu">make.prior</span>(tree,</span>
<span id="cb67-5"><a href="#cb67-5"></a>                      <span class="at">dists =</span> <span class="fu">list</span>(<span class="at">dalpha =</span><span class="st">"dhalfcauchy"</span>,</span>
<span id="cb67-6"><a href="#cb67-6"></a>                                   <span class="at">dsig2 =</span> <span class="st">"dhalfcauchy"</span>,</span>
<span id="cb67-7"><a href="#cb67-7"></a>                                   <span class="at">dk =</span> <span class="st">"cdpois"</span>, <span class="at">dtheta =</span> <span class="st">"dnorm"</span>),</span>
<span id="cb67-8"><a href="#cb67-8"></a>                      <span class="at">param =</span> <span class="fu">list</span>(<span class="at">dalpha =</span> <span class="fu">list</span>(<span class="at">scale =</span> <span class="fl">0.1</span>),</span>
<span id="cb67-9"><a href="#cb67-9"></a>                                   <span class="at">dsig2 =</span> <span class="fu">list</span>(<span class="at">scale =</span> <span class="fl">0.1</span>),</span>
<span id="cb67-10"><a href="#cb67-10"></a>                                   <span class="at">dk =</span> <span class="fu">list</span>(<span class="at">lambda =</span> <span class="dv">10</span>,</span>
<span id="cb67-11"><a href="#cb67-11"></a>                                             <span class="at">kmax =</span> <span class="fu">length</span>(tree<span class="sc">$</span>edge.length)<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb67-12"><a href="#cb67-12"></a>                                   <span class="at">dsb =</span> <span class="fu">list</span>(<span class="at">bmax =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="dv">1</span>),</span>
<span id="cb67-13"><a href="#cb67-13"></a>                                   <span class="at">dtheta =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(dat),</span>
<span id="cb67-14"><a href="#cb67-14"></a>                                                 <span class="at">sd =</span> <span class="fl">1.5</span><span class="sc">*</span><span class="fu">sd</span>(dat))))</span>
<span id="cb67-15"><a href="#cb67-15"></a></span>
<span id="cb67-16"><a href="#cb67-16"></a><span class="do">## to run our MCMC, we have to initiate</span></span>
<span id="cb67-17"><a href="#cb67-17"></a><span class="do">## the MCMC chain with some starting values</span></span>
<span id="cb67-18"><a href="#cb67-18"></a></span>
<span id="cb67-19"><a href="#cb67-19"></a>startpars <span class="ot">&lt;-</span> <span class="fu">priorSim</span>(priorOU, tree, <span class="at">plot =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>pars[[<span class="dv">1</span>]]</span>
<span id="cb67-20"><a href="#cb67-20"></a><span class="fu">priorOU</span>(startpars)</span>
<span id="cb67-21"><a href="#cb67-21"></a></span>
<span id="cb67-22"><a href="#cb67-22"></a></span>
<span id="cb67-23"><a href="#cb67-23"></a><span class="do">## let's take what we have and put it into</span></span>
<span id="cb67-24"><a href="#cb67-24"></a><span class="do">## the function bayou.makeMCMC</span></span>
<span id="cb67-25"><a href="#cb67-25"></a></span>
<span id="cb67-26"><a href="#cb67-26"></a>mcmcOU <span class="ot">&lt;-</span> <span class="fu">bayou.makeMCMC</span>(tree, dat, <span class="at">SE =</span> MEvar, <span class="at">prior =</span> priorOU,</span>
<span id="cb67-27"><a href="#cb67-27"></a>    <span class="at">new.dir =</span> <span class="cn">TRUE</span>, <span class="at">outname =</span> <span class="st">"modelOU_r001"</span>, <span class="at">plot.freq =</span> <span class="cn">NULL</span>)</span>
<span id="cb67-28"><a href="#cb67-28"></a></span>
<span id="cb67-29"><a href="#cb67-29"></a><span class="do">## run the MCMC</span></span>
<span id="cb67-30"><a href="#cb67-30"></a></span>
<span id="cb67-31"><a href="#cb67-31"></a>mcmcOU<span class="sc">$</span><span class="fu">run</span>(<span class="dv">100000</span>)</span>
<span id="cb67-32"><a href="#cb67-32"></a></span>
<span id="cb67-33"><a href="#cb67-33"></a><span class="do">## the full MCMC results are written to a set of files.</span></span>
<span id="cb67-34"><a href="#cb67-34"></a><span class="do">## We can load them back in to R as follows</span></span>
<span id="cb67-35"><a href="#cb67-35"></a></span>
<span id="cb67-36"><a href="#cb67-36"></a>chainOU <span class="ot">&lt;-</span> mcmcOU<span class="sc">$</span><span class="fu">load</span>()</span>
<span id="cb67-37"><a href="#cb67-37"></a><span class="fu">save</span>(chainOU, <span class="at">file =</span> <span class="st">'mcmc_modelOU.RData'</span>)</span>
<span id="cb67-38"><a href="#cb67-38"></a></span>
<span id="cb67-39"><a href="#cb67-39"></a><span class="do">## let's take a look at the results. We can set a "burnin"</span></span>
<span id="cb67-40"><a href="#cb67-40"></a><span class="do">## parameter that tells the package coda to discard the</span></span>
<span id="cb67-41"><a href="#cb67-41"></a><span class="do">## first bit of the chain</span></span>
<span id="cb67-42"><a href="#cb67-42"></a></span>
<span id="cb67-43"><a href="#cb67-43"></a>chainOU <span class="ot">&lt;-</span> <span class="fu">set.burnin</span>(chainOU, <span class="fl">0.3</span>)</span>
<span id="cb67-44"><a href="#cb67-44"></a><span class="do">##summary(chainOU)</span></span>
<span id="cb67-45"><a href="#cb67-45"></a><span class="do">##plot(chainOU, auto.layout = FALSE)</span></span>
<span id="cb67-46"><a href="#cb67-46"></a></span>
<span id="cb67-47"><a href="#cb67-47"></a><span class="do">## let's visualize what we have so far. First, we will</span></span>
<span id="cb67-48"><a href="#cb67-48"></a><span class="do">## plot the truth, then 3 alternative ways of visualizing</span></span>
<span id="cb67-49"><a href="#cb67-49"></a><span class="do">## our chain</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="do">## foraging tree</span></span>
<span id="cb68-2"><a href="#cb68-2"></a></span>
<span id="cb68-3"><a href="#cb68-3"></a>a <span class="ot">&lt;-</span> pruned.mass.range<span class="sc">$</span>Species[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"active"</span>]</span>
<span id="cb68-4"><a href="#cb68-4"></a>p <span class="ot">&lt;-</span> pruned.mass.range<span class="sc">$</span>Species[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"plastic"</span>]</span>
<span id="cb68-5"><a href="#cb68-5"></a>sw <span class="ot">&lt;-</span> pruned.mass.range<span class="sc">$</span>Species[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"sit-and-wait"</span>]</span>
<span id="cb68-6"><a href="#cb68-6"></a></span>
<span id="cb68-7"><a href="#cb68-7"></a></span>
<span id="cb68-8"><a href="#cb68-8"></a><span class="do">## paint the edges</span></span>
<span id="cb68-9"><a href="#cb68-9"></a></span>
<span id="cb68-10"><a href="#cb68-10"></a>bt <span class="ot">&lt;-</span> <span class="fu">paintBranches</span>(tree.mass.range, <span class="at">edge =</span></span>
<span id="cb68-11"><a href="#cb68-11"></a>                                         <span class="fu">sapply</span>(sw, match,</span>
<span id="cb68-12"><a href="#cb68-12"></a>                                                tree.mass.range<span class="sc">$</span>tip.label),</span>
<span id="cb68-13"><a href="#cb68-13"></a>                    <span class="at">state =</span> <span class="st">"sit-and-wait"</span>, <span class="at">anc.state =</span> <span class="st">"active"</span>)</span>
<span id="cb68-14"><a href="#cb68-14"></a></span>
<span id="cb68-15"><a href="#cb68-15"></a>bt <span class="ot">&lt;-</span> <span class="fu">paintBranches</span>(bt, <span class="at">edge =</span> <span class="fu">sapply</span>(p, match, bt<span class="sc">$</span>tip.label),</span>
<span id="cb68-16"><a href="#cb68-16"></a>    <span class="at">state =</span> <span class="st">"plastic"</span>, <span class="at">anc.state =</span> <span class="st">"active"</span>)</span>
<span id="cb68-17"><a href="#cb68-17"></a>bt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 
&gt; Phylogenetic tree with 762 tips and 761 internal nodes.
&gt; 
&gt; Tip labels:
&gt;   Sphenodon_punctatus, Phyllurus_amnicola, Saltuarius_cornutus, Orraya_occultus, Carphodactylus_laevis, Underwoodisaurus_milii, ...
&gt; 
&gt; The tree includes a mapped, 3-state discrete character
&gt; with states:
&gt;   active, plastic, sit-and-wait
&gt; 
&gt; Rooted; includes branch lengths.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>cols.bt <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>),</span>
<span id="cb70-2"><a href="#cb70-2"></a>                    <span class="fu">c</span>(<span class="st">'active'</span>, <span class="st">'plastic'</span>, <span class="st">'sit-and-wait'</span>))</span>
<span id="cb70-3"><a href="#cb70-3"></a></span>
<span id="cb70-4"><a href="#cb70-4"></a></span>
<span id="cb70-5"><a href="#cb70-5"></a></span>
<span id="cb70-6"><a href="#cb70-6"></a><span class="fu">phenogram</span>(bt, dat, <span class="at">ftype =</span> <span class="st">'off'</span>,</span>
<span id="cb70-7"><a href="#cb70-7"></a>          <span class="at">fsize =</span> <span class="fl">0.3</span>,</span>
<span id="cb70-8"><a href="#cb70-8"></a>          <span class="at">col =</span> cols.bt,</span>
<span id="cb70-9"><a href="#cb70-9"></a>          <span class="at">xlab =</span> <span class="st">"Time (mya)"</span>,</span>
<span id="cb70-10"><a href="#cb70-10"></a>          <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Maximum body mass"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(g)),</span>
<span id="cb70-11"><a href="#cb70-11"></a>          <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb70-12"><a href="#cb70-12"></a><span class="fu">segments</span>(<span class="at">x0 =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">y0 =</span> <span class="fl">3.8</span>, <span class="at">x1 =</span> <span class="dv">279</span>,</span>
<span id="cb70-13"><a href="#cb70-13"></a>         <span class="at">y1 =</span> <span class="fl">3.8</span>, <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb70-14"><a href="#cb70-14"></a>         <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">'black'</span>, <span class="fl">0.5</span>))</span>
<span id="cb70-15"><a href="#cb70-15"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span>),</span>
<span id="cb70-16"><a href="#cb70-16"></a>            <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb70-17"><a href="#cb70-17"></a>     <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb70-18"><a href="#cb70-18"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(<span class="st">'Maximum body mass'</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(g)), <span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.5</span>)</span>
<span id="cb70-19"><a href="#cb70-19"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">nodeHeights</span>(bt)),</span>
<span id="cb70-20"><a href="#cb70-20"></a>                       <span class="at">length.out =</span> <span class="dv">4</span>), <span class="dv">0</span>),</span>
<span id="cb70-21"><a href="#cb70-21"></a>     <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">max</span>(<span class="fu">nodeHeights</span>(bt)), <span class="dv">0</span>,</span>
<span id="cb70-22"><a href="#cb70-22"></a>                       <span class="at">length.out =</span> <span class="dv">4</span>), <span class="dv">0</span>), <span class="at">cex.axis =</span> <span class="fl">0.8</span>)</span>
<span id="cb70-23"><a href="#cb70-23"></a><span class="fu">mtext</span>(<span class="st">'Time (mya)'</span>, <span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="dv">3</span>)</span>
<span id="cb70-24"><a href="#cb70-24"></a><span class="fu">box</span>()</span>
<span id="cb70-25"><a href="#cb70-25"></a></span>
<span id="cb70-26"><a href="#cb70-26"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">legend =</span> <span class="fu">names</span>(cols.bt), <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb70-27"><a href="#cb70-27"></a>       <span class="at">pt.bg =</span> cols.bt, <span class="at">pt.cex =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb70-28"><a href="#cb70-28"></a>       <span class="at">col =</span> <span class="st">"transparent"</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb71-2"><a href="#cb71-2"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb71-3"><a href="#cb71-3"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb71-4"><a href="#cb71-4"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb71-5"><a href="#cb71-5"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb71-6"><a href="#cb71-6"></a></span>
<span id="cb71-7"><a href="#cb71-7"></a><span class="fu">par</span>(<span class="at">las =</span> <span class="dv">1</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="dv">1</span>))</span>
<span id="cb71-8"><a href="#cb71-8"></a></span>
<span id="cb71-9"><a href="#cb71-9"></a><span class="fu">plotSimmap.mcmc</span>(chainOU, <span class="at">burnin =</span> <span class="fl">0.3</span>, <span class="at">pp.cutoff =</span> <span class="fl">0.3</span>,</span>
<span id="cb71-10"><a href="#cb71-10"></a>                <span class="at">edge.type =</span> <span class="st">'regime'</span>, <span class="at">pal =</span> viridis,</span>
<span id="cb71-11"><a href="#cb71-11"></a>                <span class="at">cex =</span> <span class="fl">0.2</span>, <span class="at">show.tip.label =</span> <span class="cn">FALSE</span>)</span>
<span id="cb71-12"><a href="#cb71-12"></a><span class="do">##nodelabels(cex = 0.3, bg = 'white')</span></span>
<span id="cb71-13"><a href="#cb71-13"></a></span>
<span id="cb71-14"><a href="#cb71-14"></a><span class="fu">legend</span>(<span class="st">'topleft'</span>, <span class="at">legend =</span> <span class="st">'regime'</span>, <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb71-15"><a href="#cb71-15"></a>       <span class="at">pt.bg =</span> <span class="fu">make.transparent</span>(<span class="st">'red'</span>, <span class="fl">0.2</span>),</span>
<span id="cb71-16"><a href="#cb71-16"></a>       <span class="at">col =</span> <span class="st">'black'</span>, <span class="at">bty =</span> <span class="st">'n'</span>, <span class="at">pt.cex =</span> <span class="dv">2</span>)</span>
<span id="cb71-17"><a href="#cb71-17"></a></span>
<span id="cb71-18"><a href="#cb71-18"></a><span class="fu">plot</span>(bt, cols.bt, <span class="at">ftype =</span> <span class="st">"off"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">offset =</span> <span class="fl">0.4</span>,</span>
<span id="cb71-19"><a href="#cb71-19"></a>     <span class="at">direction =</span> <span class="st">"leftwards"</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="dv">1</span>))</span>
<span id="cb71-20"><a href="#cb71-20"></a></span>
<span id="cb71-21"><a href="#cb71-21"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">names</span>(cols.bt), <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb71-22"><a href="#cb71-22"></a>       <span class="at">pt.bg =</span> cols.bt, <span class="at">pt.cex =</span> <span class="fl">1.5</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb71-23"><a href="#cb71-23"></a>       <span class="at">col =</span> <span class="st">"transparent"</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="do">## basic boxplot to look at body size among</span></span>
<span id="cb72-2"><a href="#cb72-2"></a><span class="do">## foraging behavior categories</span></span>
<span id="cb72-3"><a href="#cb72-3"></a></span>
<span id="cb72-4"><a href="#cb72-4"></a><span class="fu">par</span>(<span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb72-5"><a href="#cb72-5"></a></span>
<span id="cb72-6"><a href="#cb72-6"></a><span class="fu">vioplot</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span> <span class="sc">~</span></span>
<span id="cb72-7"><a href="#cb72-7"></a>            pruned.mass.range<span class="sc">$</span>Foraging.mode, <span class="at">border =</span> <span class="cn">NA</span>,</span>
<span id="cb72-8"><a href="#cb72-8"></a>        <span class="at">method =</span> <span class="st">"jitter"</span>, <span class="at">side =</span> <span class="st">"right"</span>, <span class="at">col =</span> <span class="st">"white"</span>,</span>
<span id="cb72-9"><a href="#cb72-9"></a>        <span class="at">las =</span> <span class="dv">1</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>, <span class="at">yaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb72-10"><a href="#cb72-10"></a>        <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">xlab =</span> <span class="st">''</span>)</span>
<span id="cb72-11"><a href="#cb72-11"></a></span>
<span id="cb72-12"><a href="#cb72-12"></a><span class="fu">grid</span>(<span class="at">nx =</span> <span class="cn">NULL</span>, <span class="at">ny =</span> <span class="cn">NULL</span>, <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">"lightgray"</span>, <span class="fl">0.7</span>),</span>
<span id="cb72-13"><a href="#cb72-13"></a>     <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb72-14"><a href="#cb72-14"></a></span>
<span id="cb72-15"><a href="#cb72-15"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb72-16"><a href="#cb72-16"></a></span>
<span id="cb72-17"><a href="#cb72-17"></a><span class="fu">vioplot</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span> <span class="sc">~</span></span>
<span id="cb72-18"><a href="#cb72-18"></a>            pruned.mass.range<span class="sc">$</span>Foraging.mode, <span class="at">border =</span> <span class="cn">NA</span>,</span>
<span id="cb72-19"><a href="#cb72-19"></a>        <span class="at">method =</span> <span class="st">"jitter"</span>, <span class="at">side =</span> <span class="st">"right"</span>,</span>
<span id="cb72-20"><a href="#cb72-20"></a>        <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Maximum body mass"</span>)<span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(g)),</span>
<span id="cb72-21"><a href="#cb72-21"></a>        <span class="at">xlab =</span> <span class="st">"Foraging behavior"</span>, <span class="at">col =</span> <span class="fu">alpha</span>(cols.bt, <span class="fl">0.5</span>), <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb72-22"><a href="#cb72-22"></a></span>
<span id="cb72-23"><a href="#cb72-23"></a><span class="fu">segments</span>(<span class="at">x0 =</span> <span class="dv">1</span>,</span>
<span id="cb72-24"><a href="#cb72-24"></a>         <span class="at">y0 =</span> <span class="fu">mean</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span>[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"active"</span>]),</span>
<span id="cb72-25"><a href="#cb72-25"></a>         <span class="at">x1 =</span> <span class="fl">1.38</span>,</span>
<span id="cb72-26"><a href="#cb72-26"></a>         <span class="at">y1 =</span> <span class="fu">mean</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span>[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"active"</span>]),</span>
<span id="cb72-27"><a href="#cb72-27"></a>         <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"black"</span>)</span>
<span id="cb72-28"><a href="#cb72-28"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">1.45</span>,</span>
<span id="cb72-29"><a href="#cb72-29"></a>     <span class="at">y =</span> <span class="fu">mean</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span>[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"active"</span>]),</span>
<span id="cb72-30"><a href="#cb72-30"></a>     <span class="fu">expression</span>(mu))</span>
<span id="cb72-31"><a href="#cb72-31"></a></span>
<span id="cb72-32"><a href="#cb72-32"></a><span class="fu">segments</span>(<span class="at">x0 =</span> <span class="dv">2</span>,</span>
<span id="cb72-33"><a href="#cb72-33"></a>         <span class="at">y0 =</span> <span class="fu">mean</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span>[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"plastic"</span>]),</span>
<span id="cb72-34"><a href="#cb72-34"></a>         <span class="at">x1 =</span> <span class="fl">2.39</span>,</span>
<span id="cb72-35"><a href="#cb72-35"></a>         <span class="at">y1 =</span> <span class="fu">mean</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span>[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"plastic"</span>]),</span>
<span id="cb72-36"><a href="#cb72-36"></a>         <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"black"</span>)</span>
<span id="cb72-37"><a href="#cb72-37"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">2.45</span>,</span>
<span id="cb72-38"><a href="#cb72-38"></a>     <span class="at">y =</span> <span class="fu">mean</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span>[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"plastic"</span>]),</span>
<span id="cb72-39"><a href="#cb72-39"></a>     <span class="fu">expression</span>(mu))</span>
<span id="cb72-40"><a href="#cb72-40"></a></span>
<span id="cb72-41"><a href="#cb72-41"></a><span class="fu">segments</span>(<span class="at">x0 =</span> <span class="dv">3</span>,</span>
<span id="cb72-42"><a href="#cb72-42"></a>         <span class="at">y0 =</span> <span class="fu">mean</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span>[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"sit-and-wait"</span>]),</span>
<span id="cb72-43"><a href="#cb72-43"></a>         <span class="at">x1 =</span> <span class="fl">3.4</span>,</span>
<span id="cb72-44"><a href="#cb72-44"></a>         <span class="at">y1 =</span> <span class="fu">mean</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span>[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"sit-and-wait"</span>]),</span>
<span id="cb72-45"><a href="#cb72-45"></a>         <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"black"</span>)</span>
<span id="cb72-46"><a href="#cb72-46"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.45</span>,</span>
<span id="cb72-47"><a href="#cb72-47"></a>     <span class="at">y =</span> <span class="fu">mean</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span>[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"sit-and-wait"</span>]),</span>
<span id="cb72-48"><a href="#cb72-48"></a>     <span class="fu">expression</span>(mu))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="fu">names</span>(pruned.mass.range)[<span class="dv">14</span>] <span class="ot">&lt;-</span> <span class="st">'body.mass'</span></span>
<span id="cb73-2"><a href="#cb73-2"></a>pruned.mass.range<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(pruned.mass.range<span class="sc">$</span>Species)</span>
<span id="cb73-3"><a href="#cb73-3"></a>pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(pruned.mass.range<span class="sc">$</span>Foraging.mode)</span>
<span id="cb73-4"><a href="#cb73-4"></a></span>
<span id="cb73-5"><a href="#cb73-5"></a>bd.size.model <span class="ot">&lt;-</span> <span class="fu">gls</span>(body.mass <span class="sc">~</span> Foraging.mode,</span>
<span id="cb73-6"><a href="#cb73-6"></a>                     <span class="at">correlation =</span></span>
<span id="cb73-7"><a href="#cb73-7"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.mass.range,</span>
<span id="cb73-8"><a href="#cb73-8"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb73-9"><a href="#cb73-9"></a>                     <span class="at">data =</span> pruned.mass.range, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb73-10"><a href="#cb73-10"></a><span class="fu">summary</span>(bd.size.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; Generalized least squares fit by maximum likelihood
&gt;   Model: body.mass ~ Foraging.mode 
&gt;   Data: pruned.mass.range 
&gt;        AIC     BIC    logLik
&gt;   1042.576 1061.12 -517.2879
&gt; 
&gt; Correlation Structure: corBrownian
&gt;  Formula: ~Species 
&gt;  Parameter estimate(s):
&gt; numeric(0)
&gt; 
&gt; Coefficients:
&gt;                                Value Std.Error   t-value p-value
&gt; (Intercept)                2.8187339 0.6602947  4.268903  0.0000
&gt; Foraging.modeplastic       0.0644225 0.0530452  1.214483  0.2249
&gt; Foraging.modesit-and-wait -0.0064120 0.0464238 -0.138119  0.8902
&gt; 
&gt;  Correlation: 
&gt;                           (Intr) Frgng.
&gt; Foraging.modeplastic      -0.017       
&gt; Foraging.modesit-and-wait -0.026  0.479
&gt; 
&gt; Standardized residuals:
&gt;        Min         Q1        Med         Q3        Max 
&gt; -1.7038578 -0.7949206 -0.4601368 -0.1063806  2.4265240 
&gt; 
&gt; Residual standard error: 1.300974 
&gt; Degrees of freedom: 762 total; 759 residual</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="do">## Checking homogeneity of variance</span></span>
<span id="cb75-2"><a href="#cb75-2"></a></span>
<span id="cb75-3"><a href="#cb75-3"></a></span>
<span id="cb75-4"><a href="#cb75-4"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb75-5"><a href="#cb75-5"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb75-6"><a href="#cb75-6"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb75-7"><a href="#cb75-7"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb75-8"><a href="#cb75-8"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb75-9"><a href="#cb75-9"></a></span>
<span id="cb75-10"><a href="#cb75-10"></a><span class="fu">par</span>(<span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb75-11"><a href="#cb75-11"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(bd.size.model), <span class="fu">resid</span>(bd.size.model),</span>
<span id="cb75-12"><a href="#cb75-12"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb75-13"><a href="#cb75-13"></a>     <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">xlab =</span> <span class="st">''</span>)</span>
<span id="cb75-14"><a href="#cb75-14"></a></span>
<span id="cb75-15"><a href="#cb75-15"></a><span class="fu">grid</span>()</span>
<span id="cb75-16"><a href="#cb75-16"></a></span>
<span id="cb75-17"><a href="#cb75-17"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb75-18"><a href="#cb75-18"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(bd.size.model), <span class="fu">resid</span>(bd.size.model),</span>
<span id="cb75-19"><a href="#cb75-19"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">"Fitted"</span>,</span>
<span id="cb75-20"><a href="#cb75-20"></a>     <span class="at">ylab =</span> <span class="st">"Residual"</span>, <span class="at">main =</span> <span class="st">"Fitted versus Residuals"</span>,</span>
<span id="cb75-21"><a href="#cb75-21"></a>     <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb75-22"><a href="#cb75-22"></a></span>
<span id="cb75-23"><a href="#cb75-23"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"darkorange"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb75-24"><a href="#cb75-24"></a></span>
<span id="cb75-25"><a href="#cb75-25"></a></span>
<span id="cb75-26"><a href="#cb75-26"></a><span class="do">## Checking normality</span></span>
<span id="cb75-27"><a href="#cb75-27"></a></span>
<span id="cb75-28"><a href="#cb75-28"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(bd.size.model), <span class="at">col =</span> <span class="st">"darkgrey"</span>,</span>
<span id="cb75-29"><a href="#cb75-29"></a>       <span class="at">type =</span> <span class="st">'n'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="st">''</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb75-30"><a href="#cb75-30"></a>       <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb75-31"><a href="#cb75-31"></a></span>
<span id="cb75-32"><a href="#cb75-32"></a><span class="fu">grid</span>()</span>
<span id="cb75-33"><a href="#cb75-33"></a></span>
<span id="cb75-34"><a href="#cb75-34"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb75-35"><a href="#cb75-35"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(bd.size.model), <span class="at">col =</span> <span class="st">"darkgrey"</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb75-36"><a href="#cb75-36"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(bd.size.model), <span class="at">col =</span> <span class="st">"dodgerblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="fu">names</span>(pruned.mass.range)[<span class="dv">29</span>] <span class="ot">&lt;-</span> <span class="st">'range'</span></span>
<span id="cb76-2"><a href="#cb76-2"></a>range.model <span class="ot">&lt;-</span> <span class="fu">gls</span>(range <span class="sc">~</span> Foraging.mode<span class="sc">*</span>body.mass,</span>
<span id="cb76-3"><a href="#cb76-3"></a>                     <span class="at">correlation =</span></span>
<span id="cb76-4"><a href="#cb76-4"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.mass.range,</span>
<span id="cb76-5"><a href="#cb76-5"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb76-6"><a href="#cb76-6"></a>                     <span class="at">data =</span> pruned.mass.range, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb76-7"><a href="#cb76-7"></a></span>
<span id="cb76-8"><a href="#cb76-8"></a>range.model2 <span class="ot">&lt;-</span> <span class="fu">gls</span>(range <span class="sc">~</span> Foraging.mode <span class="sc">+</span> body.mass,</span>
<span id="cb76-9"><a href="#cb76-9"></a>                     <span class="at">correlation =</span></span>
<span id="cb76-10"><a href="#cb76-10"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.mass.range,</span>
<span id="cb76-11"><a href="#cb76-11"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb76-12"><a href="#cb76-12"></a>                     <span class="at">data =</span> pruned.mass.range, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb76-13"><a href="#cb76-13"></a></span>
<span id="cb76-14"><a href="#cb76-14"></a>range.model3 <span class="ot">&lt;-</span> <span class="fu">gls</span>(range <span class="sc">~</span> Foraging.mode,</span>
<span id="cb76-15"><a href="#cb76-15"></a>                     <span class="at">correlation =</span></span>
<span id="cb76-16"><a href="#cb76-16"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.mass.range,</span>
<span id="cb76-17"><a href="#cb76-17"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb76-18"><a href="#cb76-18"></a>                     <span class="at">data =</span> pruned.mass.range, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb76-19"><a href="#cb76-19"></a></span>
<span id="cb76-20"><a href="#cb76-20"></a>range.model4 <span class="ot">&lt;-</span> <span class="fu">gls</span>(range <span class="sc">~</span> body.mass,</span>
<span id="cb76-21"><a href="#cb76-21"></a>                     <span class="at">correlation =</span></span>
<span id="cb76-22"><a href="#cb76-22"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.mass.range,</span>
<span id="cb76-23"><a href="#cb76-23"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb76-24"><a href="#cb76-24"></a>                    <span class="at">data =</span> pruned.mass.range, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb76-25"><a href="#cb76-25"></a></span>
<span id="cb76-26"><a href="#cb76-26"></a></span>
<span id="cb76-27"><a href="#cb76-27"></a>range.models <span class="ot">&lt;-</span> <span class="fu">anova</span>(range.model, range.model2, range.model3, range.model4)</span>
<span id="cb76-28"><a href="#cb76-28"></a></span>
<span id="cb76-29"><a href="#cb76-29"></a><span class="fu">round</span>(<span class="fu">aicw</span>(<span class="fu">setNames</span>(range.models<span class="sc">$</span>AIC,</span>
<span id="cb76-30"><a href="#cb76-30"></a>              <span class="fu">rownames</span>(range.models))), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;                   fit  delta     w
&gt; range.model  2623.615  0.698 0.414
&gt; range.model2 2622.917  0.000 0.586
&gt; range.model3 2649.756 26.838 0.000
&gt; range.model4 2639.278 16.361 0.000</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="fu">summary</span>(range.model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; Generalized least squares fit by maximum likelihood
&gt;   Model: range ~ Foraging.mode + body.mass 
&gt;   Data: pruned.mass.range 
&gt;        AIC      BIC    logLik
&gt;   2622.917 2646.097 -1306.459
&gt; 
&gt; Correlation Structure: corBrownian
&gt;  Formula: ~Species 
&gt;  Parameter estimate(s):
&gt; numeric(0)
&gt; 
&gt; Coefficients:
&gt;                              Value Std.Error  t-value p-value
&gt; (Intercept)               8.890145 1.8834600 4.720114  0.0000
&gt; Foraging.modeplastic      0.272607 0.1496699 1.821389  0.0689
&gt; Foraging.modesit-and-wait 0.590752 0.1308618 4.514318  0.0000
&gt; body.mass                 0.553234 0.1023165 5.407086  0.0000
&gt; 
&gt;  Correlation: 
&gt;                           (Intr) Frgng. Frg.--
&gt; Foraging.modeplastic      -0.010              
&gt; Foraging.modesit-and-wait -0.026  0.478       
&gt; body.mass                 -0.153 -0.044  0.005
&gt; 
&gt; Standardized residuals:
&gt;         Min          Q1         Med          Q3         Max 
&gt; -1.28965879  0.05141853  0.29342139  0.48274651  0.92129142 
&gt; 
&gt; Residual standard error: 3.664786 
&gt; Degrees of freedom: 762 total; 758 residual</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="do">## plotting results of the model</span></span>
<span id="cb80-2"><a href="#cb80-2"></a></span>
<span id="cb80-3"><a href="#cb80-3"></a><span class="do">##png('./imgs/figureS1.png', width = 7, height = 7, units = 'in',</span></span>
<span id="cb80-4"><a href="#cb80-4"></a><span class="do">##    res = 360)</span></span>
<span id="cb80-5"><a href="#cb80-5"></a><span class="do">##pdf('./imgs/figuerS1.pdf')</span></span>
<span id="cb80-6"><a href="#cb80-6"></a></span>
<span id="cb80-7"><a href="#cb80-7"></a></span>
<span id="cb80-8"><a href="#cb80-8"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>)</span>
<span id="cb80-9"><a href="#cb80-9"></a></span>
<span id="cb80-10"><a href="#cb80-10"></a><span class="fu">dim</span>(pruned.mass.range)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] 762  30</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a>pred.mod <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">body.mass =</span> <span class="fu">seq</span>(<span class="fu">min</span>(pruned.mass.range<span class="sc">$</span>body.mass),</span>
<span id="cb82-2"><a href="#cb82-2"></a>                                       <span class="fu">max</span>(pruned.mass.range<span class="sc">$</span>body.mass),</span>
<span id="cb82-3"><a href="#cb82-3"></a>                                       <span class="at">len =</span> <span class="dv">762</span>),</span>
<span id="cb82-4"><a href="#cb82-4"></a>                       <span class="at">Foraging.mode =</span> pruned.mass.range<span class="sc">$</span>Foraging.mode,</span>
<span id="cb82-5"><a href="#cb82-5"></a>                       <span class="at">row.names =</span> <span class="fu">rownames</span>(pruned.mass.range))</span>
<span id="cb82-6"><a href="#cb82-6"></a>pred.mod<span class="sc">$</span>range <span class="ot">&lt;-</span> <span class="fu">predict</span>(range.model2, pred.mod,</span>
<span id="cb82-7"><a href="#cb82-7"></a>                          <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>fit</span>
<span id="cb82-8"><a href="#cb82-8"></a>pred.mod<span class="sc">$</span>se <span class="ot">&lt;-</span> <span class="fu">predict</span>(range.model2, pred.mod,</span>
<span id="cb82-9"><a href="#cb82-9"></a>                       <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>se.fit</span>
<span id="cb82-10"><a href="#cb82-10"></a><span class="fu">head</span>(pred.mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;                                  body.mass Foraging.mode    range       se
&gt; Acanthocercus_atricollis         0.6020600  sit-and-wait 9.813977 1.876168
&gt; Acanthodactylus_beershebensis    0.6092058        active 9.227179 1.874928
&gt; Acanthodactylus_boskianus        0.6163516        active 9.231132 1.874840
&gt; Acanthodactylus_cantoris         0.6234973        active 9.235085 1.874752
&gt; Acanthodactylus_erythrurus       0.6306431       plastic 9.511646 1.878896
&gt; Acanthodactylus_gongrorhynchatus 0.6377889        active 9.242992 1.874577</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>active <span class="ot">&lt;-</span> pred.mod[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'active'</span>, ]</span>
<span id="cb84-2"><a href="#cb84-2"></a>plastic <span class="ot">&lt;-</span> pred.mod[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'plastic'</span>, ]</span>
<span id="cb84-3"><a href="#cb84-3"></a>sit.and.wait <span class="ot">&lt;-</span> pred.mod[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'sit-and-wait'</span>, ]</span>
<span id="cb84-4"><a href="#cb84-4"></a></span>
<span id="cb84-5"><a href="#cb84-5"></a><span class="fu">par</span>(<span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb84-6"><a href="#cb84-6"></a></span>
<span id="cb84-7"><a href="#cb84-7"></a><span class="fu">plot</span>(range <span class="sc">~</span> body.mass, <span class="at">data =</span> pruned.mass.range,</span>
<span id="cb84-8"><a href="#cb84-8"></a>     <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">bg =</span> cols[<span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(pruned.mass.range<span class="sc">$</span>Foraging.mode))],</span>
<span id="cb84-9"><a href="#cb84-9"></a>     <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>, <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb84-10"><a href="#cb84-10"></a>     <span class="at">type =</span> <span class="st">'n'</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb84-11"><a href="#cb84-11"></a></span>
<span id="cb84-12"><a href="#cb84-12"></a><span class="fu">grid</span>(<span class="at">nx =</span> <span class="cn">NULL</span>, <span class="at">ny =</span> <span class="cn">NULL</span>, <span class="at">col =</span> <span class="st">"lightgray"</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb84-13"><a href="#cb84-13"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-14"><a href="#cb84-14"></a></span>
<span id="cb84-15"><a href="#cb84-15"></a><span class="fu">plot</span>(range <span class="sc">~</span> body.mass, <span class="at">data =</span> pruned.mass.range,</span>
<span id="cb84-16"><a href="#cb84-16"></a>     <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">bg =</span> cols[<span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(pruned.mass.range<span class="sc">$</span>Foraging.mode))],</span>
<span id="cb84-17"><a href="#cb84-17"></a>     <span class="at">col =</span> <span class="st">'black'</span>, <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb84-18"><a href="#cb84-18"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">"Maximum body mass"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(g)),</span>
<span id="cb84-19"><a href="#cb84-19"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Area of geographic range"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(km<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb84-20"><a href="#cb84-20"></a>     <span class="at">type =</span> <span class="st">'p'</span>)</span>
<span id="cb84-21"><a href="#cb84-21"></a></span>
<span id="cb84-22"><a href="#cb84-22"></a><span class="fu">lines</span>(active<span class="sc">$</span>range <span class="sc">~</span> active<span class="sc">$</span>body.mass,</span>
<span id="cb84-23"><a href="#cb84-23"></a>      <span class="at">data =</span> active, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>)</span>
<span id="cb84-24"><a href="#cb84-24"></a></span>
<span id="cb84-25"><a href="#cb84-25"></a><span class="fu">lines</span>(plastic<span class="sc">$</span>range <span class="sc">~</span> plastic<span class="sc">$</span>body.mass,</span>
<span id="cb84-26"><a href="#cb84-26"></a>      <span class="at">data =</span> plastic, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'green4'</span>)</span>
<span id="cb84-27"><a href="#cb84-27"></a></span>
<span id="cb84-28"><a href="#cb84-28"></a><span class="fu">lines</span>(sit.and.wait<span class="sc">$</span>range <span class="sc">~</span> sit.and.wait<span class="sc">$</span>body.mass,</span>
<span id="cb84-29"><a href="#cb84-29"></a>      <span class="at">data =</span> sit.and.wait, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>)</span>
<span id="cb84-30"><a href="#cb84-30"></a></span>
<span id="cb84-31"><a href="#cb84-31"></a><span class="fu">legend</span>(<span class="st">'bottomright'</span>,</span>
<span id="cb84-32"><a href="#cb84-32"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">'active'</span>, <span class="st">'plastic'</span>, <span class="st">'sit-and-wait'</span>),</span>
<span id="cb84-33"><a href="#cb84-33"></a>       <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">pt.bg =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>),</span>
<span id="cb84-34"><a href="#cb84-34"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>), <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb84-35"><a href="#cb84-35"></a>       <span class="at">bty =</span> <span class="st">'n'</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="do">##dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="do">## Checking homogeneity of variance</span></span>
<span id="cb86-2"><a href="#cb86-2"></a></span>
<span id="cb86-3"><a href="#cb86-3"></a></span>
<span id="cb86-4"><a href="#cb86-4"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb86-5"><a href="#cb86-5"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb86-6"><a href="#cb86-6"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb86-7"><a href="#cb86-7"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb86-8"><a href="#cb86-8"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb86-9"><a href="#cb86-9"></a></span>
<span id="cb86-10"><a href="#cb86-10"></a><span class="fu">par</span>(<span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb86-11"><a href="#cb86-11"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(range.model2), <span class="fu">resid</span>(range.model2),</span>
<span id="cb86-12"><a href="#cb86-12"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb86-13"><a href="#cb86-13"></a>     <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">xlab =</span> <span class="st">''</span>)</span>
<span id="cb86-14"><a href="#cb86-14"></a></span>
<span id="cb86-15"><a href="#cb86-15"></a><span class="fu">grid</span>()</span>
<span id="cb86-16"><a href="#cb86-16"></a></span>
<span id="cb86-17"><a href="#cb86-17"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-18"><a href="#cb86-18"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(range.model2), <span class="fu">resid</span>(range.model2),</span>
<span id="cb86-19"><a href="#cb86-19"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">"Fitted"</span>,</span>
<span id="cb86-20"><a href="#cb86-20"></a>     <span class="at">ylab =</span> <span class="st">"Residual"</span>, <span class="at">main =</span> <span class="st">"Fitted versus Residuals"</span>,</span>
<span id="cb86-21"><a href="#cb86-21"></a>     <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb86-22"><a href="#cb86-22"></a></span>
<span id="cb86-23"><a href="#cb86-23"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"darkorange"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb86-24"><a href="#cb86-24"></a></span>
<span id="cb86-25"><a href="#cb86-25"></a></span>
<span id="cb86-26"><a href="#cb86-26"></a><span class="do">## Checking normality</span></span>
<span id="cb86-27"><a href="#cb86-27"></a></span>
<span id="cb86-28"><a href="#cb86-28"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(range.model2), <span class="at">col =</span> <span class="st">"darkgrey"</span>,</span>
<span id="cb86-29"><a href="#cb86-29"></a>       <span class="at">type =</span> <span class="st">'n'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="st">''</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb86-30"><a href="#cb86-30"></a>       <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb86-31"><a href="#cb86-31"></a></span>
<span id="cb86-32"><a href="#cb86-32"></a><span class="fu">grid</span>()</span>
<span id="cb86-33"><a href="#cb86-33"></a></span>
<span id="cb86-34"><a href="#cb86-34"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-35"><a href="#cb86-35"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(range.model2), <span class="at">col =</span> <span class="st">"darkgrey"</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb86-36"><a href="#cb86-36"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(range.model2), <span class="at">col =</span> <span class="st">"dodgerblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="do">## setting up the data for modeling the reproductive output</span></span>
<span id="cb87-2"><a href="#cb87-2"></a></span>
<span id="cb87-3"><a href="#cb87-3"></a>rep.data <span class="ot">&lt;-</span> pruned.data.mrg[<span class="sc">!</span><span class="fu">is.na</span>(pruned.data.mrg<span class="sc">$</span><span class="st">'Reproductive output'</span>), ]</span>
<span id="cb87-4"><a href="#cb87-4"></a></span>
<span id="cb87-5"><a href="#cb87-5"></a></span>
<span id="cb87-6"><a href="#cb87-6"></a>check <span class="ot">&lt;-</span> <span class="fu">name.check</span>(lizard.tree, rep.data)</span>
<span id="cb87-7"><a href="#cb87-7"></a>rm_phy <span class="ot">&lt;-</span> check<span class="sc">$</span>tree_not_data</span>
<span id="cb87-8"><a href="#cb87-8"></a>rm_dat <span class="ot">&lt;-</span> check<span class="sc">$</span>data_not_tree</span>
<span id="cb87-9"><a href="#cb87-9"></a>tree.rep <span class="ot">&lt;-</span> <span class="fu">drop.tip</span>(lizard.tree, rm_phy)</span>
<span id="cb87-10"><a href="#cb87-10"></a></span>
<span id="cb87-11"><a href="#cb87-11"></a>data.rep.out <span class="ot">&lt;-</span> <span class="fu">subset</span>(rep.data,</span>
<span id="cb87-12"><a href="#cb87-12"></a>                      <span class="at">subset =</span> <span class="fu">rownames</span>(rep.data) <span class="sc">%in%</span> tree.rep<span class="sc">$</span>tip,</span>
<span id="cb87-13"><a href="#cb87-13"></a>                      <span class="at">select =</span> <span class="fu">names</span>(rep.data))</span>
<span id="cb87-14"><a href="#cb87-14"></a><span class="fu">name.check</span>(tree.rep, data.rep.out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "OK"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="fu">names</span>(data.rep.out)[<span class="dv">30</span>] <span class="ot">&lt;-</span> <span class="st">'repro.output'</span></span>
<span id="cb89-2"><a href="#cb89-2"></a><span class="fu">names</span>(data.rep.out)[<span class="dv">14</span>] <span class="ot">&lt;-</span> <span class="st">'body.mass'</span></span>
<span id="cb89-3"><a href="#cb89-3"></a><span class="fu">names</span>(data.rep.out)[<span class="dv">29</span>] <span class="ot">&lt;-</span> <span class="st">'range'</span></span>
<span id="cb89-4"><a href="#cb89-4"></a><span class="fu">head</span>(data.rep.out[ , <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">29</span>, <span class="dv">30</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;                               Foraging.mode body.mass     range repro.output
&gt; Acanthocercus_atricollis       sit-and-wait  3.249932 12.774717    1.0569049
&gt; Acanthodactylus_beershebensis        active  2.220108  9.730783    0.6901961
&gt; Acanthodactylus_boskianus            active  2.290035 13.199259    0.6334685
&gt; Acanthodactylus_erythrurus          plastic  2.139879 12.012896    0.7442930
&gt; Acanthodactylus_pardalis       sit-and-wait  2.021189 11.253532    1.1702617
&gt; Acanthodactylus_schreiberi           active  2.269513  9.957076    0.8750613</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="do">## fitting models</span></span>
<span id="cb91-2"><a href="#cb91-2"></a></span>
<span id="cb91-3"><a href="#cb91-3"></a>repro.model1 <span class="ot">&lt;-</span> <span class="fu">gls</span>(repro.output <span class="sc">~</span> Foraging.mode<span class="sc">*</span>body.mass<span class="sc">*</span>range,</span>
<span id="cb91-4"><a href="#cb91-4"></a>                     <span class="at">correlation =</span></span>
<span id="cb91-5"><a href="#cb91-5"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.rep,</span>
<span id="cb91-6"><a href="#cb91-6"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb91-7"><a href="#cb91-7"></a>                     <span class="at">data =</span> data.rep.out, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb91-8"><a href="#cb91-8"></a></span>
<span id="cb91-9"><a href="#cb91-9"></a></span>
<span id="cb91-10"><a href="#cb91-10"></a>repro.model2 <span class="ot">&lt;-</span> <span class="fu">gls</span>(repro.output <span class="sc">~</span> Foraging.mode<span class="sc">*</span>body.mass <span class="sc">+</span></span>
<span id="cb91-11"><a href="#cb91-11"></a>                        range,</span>
<span id="cb91-12"><a href="#cb91-12"></a>                     <span class="at">correlation =</span></span>
<span id="cb91-13"><a href="#cb91-13"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.rep,</span>
<span id="cb91-14"><a href="#cb91-14"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb91-15"><a href="#cb91-15"></a>                     <span class="at">data =</span> data.rep.out, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb91-16"><a href="#cb91-16"></a></span>
<span id="cb91-17"><a href="#cb91-17"></a></span>
<span id="cb91-18"><a href="#cb91-18"></a>repro.model3 <span class="ot">&lt;-</span> <span class="fu">gls</span>(repro.output <span class="sc">~</span> Foraging.mode<span class="sc">*</span>range <span class="sc">+</span></span>
<span id="cb91-19"><a href="#cb91-19"></a>                        body.mass,</span>
<span id="cb91-20"><a href="#cb91-20"></a>                     <span class="at">correlation =</span></span>
<span id="cb91-21"><a href="#cb91-21"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.rep,</span>
<span id="cb91-22"><a href="#cb91-22"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb91-23"><a href="#cb91-23"></a>                     <span class="at">data =</span> data.rep.out, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb91-24"><a href="#cb91-24"></a></span>
<span id="cb91-25"><a href="#cb91-25"></a>repro.model4 <span class="ot">&lt;-</span> <span class="fu">gls</span>(repro.output <span class="sc">~</span> Foraging.mode <span class="sc">+</span> range <span class="sc">+</span></span>
<span id="cb91-26"><a href="#cb91-26"></a>                        body.mass,</span>
<span id="cb91-27"><a href="#cb91-27"></a>                     <span class="at">correlation =</span></span>
<span id="cb91-28"><a href="#cb91-28"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.rep,</span>
<span id="cb91-29"><a href="#cb91-29"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb91-30"><a href="#cb91-30"></a>                     <span class="at">data =</span> data.rep.out, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb91-31"><a href="#cb91-31"></a></span>
<span id="cb91-32"><a href="#cb91-32"></a></span>
<span id="cb91-33"><a href="#cb91-33"></a>repro.model5 <span class="ot">&lt;-</span> <span class="fu">gls</span>(repro.output <span class="sc">~</span> Foraging.mode <span class="sc">+</span></span>
<span id="cb91-34"><a href="#cb91-34"></a>                        body.mass,</span>
<span id="cb91-35"><a href="#cb91-35"></a>                     <span class="at">correlation =</span></span>
<span id="cb91-36"><a href="#cb91-36"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.rep,</span>
<span id="cb91-37"><a href="#cb91-37"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb91-38"><a href="#cb91-38"></a>                     <span class="at">data =</span> data.rep.out, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb91-39"><a href="#cb91-39"></a></span>
<span id="cb91-40"><a href="#cb91-40"></a>repro.model6 <span class="ot">&lt;-</span> <span class="fu">gls</span>(repro.output <span class="sc">~</span> Foraging.mode <span class="sc">+</span></span>
<span id="cb91-41"><a href="#cb91-41"></a>                        range,</span>
<span id="cb91-42"><a href="#cb91-42"></a>                     <span class="at">correlation =</span></span>
<span id="cb91-43"><a href="#cb91-43"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.rep,</span>
<span id="cb91-44"><a href="#cb91-44"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb91-45"><a href="#cb91-45"></a>                     <span class="at">data =</span> data.rep.out, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb91-46"><a href="#cb91-46"></a></span>
<span id="cb91-47"><a href="#cb91-47"></a>repro.model7 <span class="ot">&lt;-</span> <span class="fu">gls</span>(repro.output <span class="sc">~</span> Foraging.mode,</span>
<span id="cb91-48"><a href="#cb91-48"></a>                     <span class="at">correlation =</span></span>
<span id="cb91-49"><a href="#cb91-49"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.rep,</span>
<span id="cb91-50"><a href="#cb91-50"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb91-51"><a href="#cb91-51"></a>                     <span class="at">data =</span> data.rep.out, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb91-52"><a href="#cb91-52"></a></span>
<span id="cb91-53"><a href="#cb91-53"></a>repro.model8 <span class="ot">&lt;-</span> <span class="fu">gls</span>(repro.output <span class="sc">~</span> range,</span>
<span id="cb91-54"><a href="#cb91-54"></a>                     <span class="at">correlation =</span></span>
<span id="cb91-55"><a href="#cb91-55"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.rep,</span>
<span id="cb91-56"><a href="#cb91-56"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb91-57"><a href="#cb91-57"></a>                     <span class="at">data =</span> data.rep.out, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb91-58"><a href="#cb91-58"></a></span>
<span id="cb91-59"><a href="#cb91-59"></a>repro.model9 <span class="ot">&lt;-</span> <span class="fu">gls</span>(repro.output <span class="sc">~</span> body.mass,</span>
<span id="cb91-60"><a href="#cb91-60"></a>                     <span class="at">correlation =</span></span>
<span id="cb91-61"><a href="#cb91-61"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.rep,</span>
<span id="cb91-62"><a href="#cb91-62"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb91-63"><a href="#cb91-63"></a>                     <span class="at">data =</span> data.rep.out, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb91-64"><a href="#cb91-64"></a></span>
<span id="cb91-65"><a href="#cb91-65"></a></span>
<span id="cb91-66"><a href="#cb91-66"></a></span>
<span id="cb91-67"><a href="#cb91-67"></a>repro.models <span class="ot">&lt;-</span> <span class="fu">anova</span>(repro.model1, repro.model2,</span>
<span id="cb91-68"><a href="#cb91-68"></a>                      repro.model3, repro.model4,</span>
<span id="cb91-69"><a href="#cb91-69"></a>                      repro.model5, repro.model6,</span>
<span id="cb91-70"><a href="#cb91-70"></a>                      repro.model7, repro.model8,</span>
<span id="cb91-71"><a href="#cb91-71"></a>                      repro.model9)</span>
<span id="cb91-72"><a href="#cb91-72"></a></span>
<span id="cb91-73"><a href="#cb91-73"></a><span class="fu">round</span>(<span class="fu">aicw</span>(<span class="fu">setNames</span>(repro.models<span class="sc">$</span>AIC,</span>
<span id="cb91-74"><a href="#cb91-74"></a>              <span class="fu">rownames</span>(repro.models))), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;                  fit  delta     w
&gt; repro.model1 116.322  2.030 0.220
&gt; repro.model2 114.292  0.000 0.607
&gt; repro.model3 118.512  4.220 0.074
&gt; repro.model4 118.191  3.899 0.086
&gt; repro.model5 122.023  7.731 0.013
&gt; repro.model6 147.388 33.096 0.000
&gt; repro.model7 149.598 35.306 0.000
&gt; repro.model8 174.707 60.414 0.000
&gt; repro.model9 141.216 26.924 0.000</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a><span class="fu">summary</span>(repro.model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; Generalized least squares fit by maximum likelihood
&gt;   Model: repro.output ~ Foraging.mode * body.mass + range 
&gt;   Data: data.rep.out 
&gt;        AIC      BIC    logLik
&gt;   114.2921 142.4957 -49.14605
&gt; 
&gt; Correlation Structure: corBrownian
&gt;  Formula: ~Species 
&gt;  Parameter estimate(s):
&gt; numeric(0)
&gt; 
&gt; Coefficients:
&gt;                                           Value  Std.Error   t-value p-value
&gt; (Intercept)                         -0.16682759 0.29380719 -0.567813  0.5707
&gt; Foraging.modeplastic                -0.24536741 0.15637163 -1.569130  0.1179
&gt; Foraging.modesit-and-wait           -0.09719447 0.16788757 -0.578926  0.5632
&gt; body.mass                            0.15921899 0.04177824  3.811051  0.0002
&gt; range                                0.04836201 0.01670401  2.895234  0.0041
&gt; Foraging.modeplastic:body.mass       0.13414099 0.05151956  2.603690  0.0098
&gt; Foraging.modesit-and-wait:body.mass  0.00569717 0.05660216  0.100653  0.9199
&gt; 
&gt;  Correlation: 
&gt;                                     (Intr) Frgng. Frg.-- bdy.ms range  Frg.:.
&gt; Foraging.modeplastic                -0.077                                   
&gt; Foraging.modesit-and-wait           -0.173  0.400                            
&gt; body.mass                           -0.344  0.434  0.541                     
&gt; range                               -0.623 -0.200 -0.144 -0.099              
&gt; Foraging.modeplastic:body.mass       0.040 -0.943 -0.360 -0.460  0.231       
&gt; Foraging.modesit-and-wait:body.mass  0.131 -0.360 -0.941 -0.535  0.152  0.395
&gt; 
&gt; Standardized residuals:
&gt;        Min         Q1        Med         Q3        Max 
&gt; -1.3043952 -0.2057326  0.1922350  0.5591492  2.0896291 
&gt; 
&gt; Residual standard error: 0.5943681 
&gt; Degrees of freedom: 251 total; 244 residual</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="do">## plotting results of the model</span></span>
<span id="cb95-2"><a href="#cb95-2"></a></span>
<span id="cb95-3"><a href="#cb95-3"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>)</span>
<span id="cb95-4"><a href="#cb95-4"></a></span>
<span id="cb95-5"><a href="#cb95-5"></a><span class="fu">dim</span>(data.rep.out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] 251  30</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a>pred.mod <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">body.mass =</span> <span class="fu">seq</span>(<span class="fu">min</span>(data.rep.out<span class="sc">$</span>body.mass),</span>
<span id="cb97-2"><a href="#cb97-2"></a>                                       <span class="fu">max</span>(data.rep.out<span class="sc">$</span>body.mass), <span class="at">len =</span> <span class="dv">251</span>),</span>
<span id="cb97-3"><a href="#cb97-3"></a>                       <span class="at">range =</span> <span class="fu">seq</span>(<span class="fu">min</span>(data.rep.out<span class="sc">$</span>range), <span class="fu">max</span>(data.rep.out<span class="sc">$</span>range),</span>
<span id="cb97-4"><a href="#cb97-4"></a>                                   <span class="at">len =</span> <span class="dv">251</span>), <span class="at">Foraging.mode =</span> data.rep.out<span class="sc">$</span>Foraging.mode,</span>
<span id="cb97-5"><a href="#cb97-5"></a>                       <span class="at">row.names =</span> <span class="fu">rownames</span>(data.rep.out))</span>
<span id="cb97-6"><a href="#cb97-6"></a>pred.mod<span class="sc">$</span>rep.out <span class="ot">&lt;-</span> <span class="fu">predict</span>(repro.model2, pred.mod,</span>
<span id="cb97-7"><a href="#cb97-7"></a>                            <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>fit</span>
<span id="cb97-8"><a href="#cb97-8"></a>pred.mod<span class="sc">$</span>se <span class="ot">&lt;-</span> <span class="fu">predict</span>(repro.model2, pred.mod,</span>
<span id="cb97-9"><a href="#cb97-9"></a>                       <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>se.fit</span>
<span id="cb97-10"><a href="#cb97-10"></a><span class="fu">head</span>(pred.mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;                               body.mass    range Foraging.mode   rep.out
&gt; Acanthocercus_atricollis      0.9030900 8.318229  sit-and-wait 0.2871984
&gt; Acanthodactylus_beershebensis 0.9236376 8.338003        active 0.3834757
&gt; Acanthodactylus_boskianus     0.9441853 8.357777        active 0.3877035
&gt; Acanthodactylus_erythrurus    0.9647329 8.377551       plastic 0.2759742
&gt; Acanthodactylus_pardalis      0.9852805 8.397325  sit-and-wait 0.3045782
&gt; Acanthodactylus_schreiberi    1.0058282 8.417099        active 0.4003872
&gt;                                      se
&gt; Acanthocercus_atricollis      0.2218068
&gt; Acanthodactylus_beershebensis 0.2175603
&gt; Acanthodactylus_boskianus     0.2171878
&gt; Acanthodactylus_erythrurus    0.2268224
&gt; Acanthodactylus_pardalis      0.2198318
&gt; Acanthodactylus_schreiberi    0.2160884</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a>active <span class="ot">&lt;-</span> pred.mod[data.rep.out<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'active'</span>, ]</span>
<span id="cb99-2"><a href="#cb99-2"></a>plastic <span class="ot">&lt;-</span> pred.mod[data.rep.out<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'plastic'</span>, ]</span>
<span id="cb99-3"><a href="#cb99-3"></a>sit.and.wait <span class="ot">&lt;-</span> pred.mod[data.rep.out<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'sit-and-wait'</span>, ]</span>
<span id="cb99-4"><a href="#cb99-4"></a></span>
<span id="cb99-5"><a href="#cb99-5"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb99-6"><a href="#cb99-6"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb99-7"><a href="#cb99-7"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb99-8"><a href="#cb99-8"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb99-9"><a href="#cb99-9"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb99-10"><a href="#cb99-10"></a></span>
<span id="cb99-11"><a href="#cb99-11"></a></span>
<span id="cb99-12"><a href="#cb99-12"></a><span class="do">##png('./imgs/figure3.png', width = 7, height = 7, units = 'in',</span></span>
<span id="cb99-13"><a href="#cb99-13"></a><span class="do">##    res = 360)</span></span>
<span id="cb99-14"><a href="#cb99-14"></a><span class="do">##pdf('./imgs/figuer3.pdf')</span></span>
<span id="cb99-15"><a href="#cb99-15"></a></span>
<span id="cb99-16"><a href="#cb99-16"></a></span>
<span id="cb99-17"><a href="#cb99-17"></a><span class="fu">plot</span>(repro.output <span class="sc">~</span> body.mass, <span class="at">data =</span> data.rep.out,</span>
<span id="cb99-18"><a href="#cb99-18"></a>     <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb99-19"><a href="#cb99-19"></a>     <span class="at">bg =</span> cols[<span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(data.rep.out<span class="sc">$</span>Foraging.mode))],</span>
<span id="cb99-20"><a href="#cb99-20"></a>     <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>, <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb99-21"><a href="#cb99-21"></a>     <span class="at">type =</span> <span class="st">'n'</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb99-22"><a href="#cb99-22"></a></span>
<span id="cb99-23"><a href="#cb99-23"></a><span class="fu">grid</span>(<span class="at">nx =</span> <span class="cn">NULL</span>, <span class="at">ny =</span> <span class="cn">NULL</span>, <span class="at">col =</span> <span class="st">"lightgray"</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb99-24"><a href="#cb99-24"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb99-25"><a href="#cb99-25"></a></span>
<span id="cb99-26"><a href="#cb99-26"></a><span class="fu">plot</span>(repro.output <span class="sc">~</span> body.mass, <span class="at">data =</span> data.rep.out,</span>
<span id="cb99-27"><a href="#cb99-27"></a>     <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb99-28"><a href="#cb99-28"></a>     <span class="at">bg =</span> cols[<span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(data.rep.out<span class="sc">$</span>Foraging.mode))],</span>
<span id="cb99-29"><a href="#cb99-29"></a>     <span class="at">col =</span> <span class="st">'black'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">"Maximum body mass"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(g)),</span>
<span id="cb99-30"><a href="#cb99-30"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Clutch size"</span><span class="sc">~</span>x<span class="sc">~</span><span class="st">"clutches per year"</span>), <span class="at">type =</span> <span class="st">'p'</span>)</span>
<span id="cb99-31"><a href="#cb99-31"></a></span>
<span id="cb99-32"><a href="#cb99-32"></a><span class="fu">lines</span>(active<span class="sc">$</span>rep.out <span class="sc">~</span> active<span class="sc">$</span>body.mass,</span>
<span id="cb99-33"><a href="#cb99-33"></a>      <span class="at">data =</span> active, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>)</span>
<span id="cb99-34"><a href="#cb99-34"></a></span>
<span id="cb99-35"><a href="#cb99-35"></a><span class="fu">lines</span>(plastic<span class="sc">$</span>rep.out <span class="sc">~</span> plastic<span class="sc">$</span>body.mass,</span>
<span id="cb99-36"><a href="#cb99-36"></a>      <span class="at">data =</span> plastic, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'green4'</span>)</span>
<span id="cb99-37"><a href="#cb99-37"></a></span>
<span id="cb99-38"><a href="#cb99-38"></a><span class="fu">lines</span>(sit.and.wait<span class="sc">$</span>rep.out <span class="sc">~</span> sit.and.wait<span class="sc">$</span>body.mass,</span>
<span id="cb99-39"><a href="#cb99-39"></a>      <span class="at">data =</span> sit.and.wait, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>)</span>
<span id="cb99-40"><a href="#cb99-40"></a></span>
<span id="cb99-41"><a href="#cb99-41"></a><span class="fu">legend</span>(<span class="st">'bottomright'</span>,</span>
<span id="cb99-42"><a href="#cb99-42"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">'active'</span>, <span class="st">'plastic'</span>,</span>
<span id="cb99-43"><a href="#cb99-43"></a>                  <span class="st">'sit-and-wait'</span>), <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb99-44"><a href="#cb99-44"></a>       <span class="at">pt.bg =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>),</span>
<span id="cb99-45"><a href="#cb99-45"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>), <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb99-46"><a href="#cb99-46"></a>       <span class="at">bty =</span> <span class="st">'n'</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb99-47"><a href="#cb99-47"></a></span>
<span id="cb99-48"><a href="#cb99-48"></a><span class="do">##dev.off()</span></span>
<span id="cb99-49"><a href="#cb99-49"></a></span>
<span id="cb99-50"><a href="#cb99-50"></a></span>
<span id="cb99-51"><a href="#cb99-51"></a><span class="fu">plot</span>(repro.output <span class="sc">~</span> range, <span class="at">data =</span> data.rep.out,</span>
<span id="cb99-52"><a href="#cb99-52"></a>     <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb99-53"><a href="#cb99-53"></a>     <span class="at">bg =</span> cols[<span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(data.rep.out<span class="sc">$</span>Foraging.mode))],</span>
<span id="cb99-54"><a href="#cb99-54"></a>     <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb99-55"><a href="#cb99-55"></a>     <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">''</span>,</span>
<span id="cb99-56"><a href="#cb99-56"></a>     <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb99-57"><a href="#cb99-57"></a>     <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb99-58"><a href="#cb99-58"></a></span>
<span id="cb99-59"><a href="#cb99-59"></a><span class="fu">grid</span>(<span class="at">nx =</span> <span class="cn">NULL</span>, <span class="at">ny =</span> <span class="cn">NULL</span>,</span>
<span id="cb99-60"><a href="#cb99-60"></a>     <span class="at">col =</span> <span class="st">"lightgray"</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb99-61"><a href="#cb99-61"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb99-62"><a href="#cb99-62"></a></span>
<span id="cb99-63"><a href="#cb99-63"></a><span class="fu">plot</span>(repro.output <span class="sc">~</span> range, <span class="at">data =</span> data.rep.out,</span>
<span id="cb99-64"><a href="#cb99-64"></a>     <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">bg =</span> cols[<span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(data.rep.out<span class="sc">$</span>Foraging.mode))],</span>
<span id="cb99-65"><a href="#cb99-65"></a>     <span class="at">col =</span> <span class="st">'black'</span>, <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb99-66"><a href="#cb99-66"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">"Area of geographic range"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(km<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb99-67"><a href="#cb99-67"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Clutch size"</span><span class="sc">~</span>x<span class="sc">~</span><span class="st">"clutches per year"</span>),</span>
<span id="cb99-68"><a href="#cb99-68"></a>     <span class="at">type =</span> <span class="st">'p'</span>)</span>
<span id="cb99-69"><a href="#cb99-69"></a></span>
<span id="cb99-70"><a href="#cb99-70"></a><span class="fu">lines</span>(active<span class="sc">$</span>rep.out <span class="sc">~</span> active<span class="sc">$</span>range,</span>
<span id="cb99-71"><a href="#cb99-71"></a>      <span class="at">data =</span> active,</span>
<span id="cb99-72"><a href="#cb99-72"></a>      <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>)</span>
<span id="cb99-73"><a href="#cb99-73"></a></span>
<span id="cb99-74"><a href="#cb99-74"></a><span class="fu">lines</span>(plastic<span class="sc">$</span>rep.out <span class="sc">~</span> plastic<span class="sc">$</span>range,</span>
<span id="cb99-75"><a href="#cb99-75"></a>      <span class="at">data =</span> plastic,</span>
<span id="cb99-76"><a href="#cb99-76"></a>      <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'green4'</span>)</span>
<span id="cb99-77"><a href="#cb99-77"></a></span>
<span id="cb99-78"><a href="#cb99-78"></a><span class="fu">lines</span>(sit.and.wait<span class="sc">$</span>rep.out <span class="sc">~</span> sit.and.wait<span class="sc">$</span>range,</span>
<span id="cb99-79"><a href="#cb99-79"></a>      <span class="at">data =</span> sit.and.wait,</span>
<span id="cb99-80"><a href="#cb99-80"></a>      <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>)</span>
<span id="cb99-81"><a href="#cb99-81"></a></span>
<span id="cb99-82"><a href="#cb99-82"></a><span class="fu">legend</span>(<span class="st">'topleft'</span>,</span>
<span id="cb99-83"><a href="#cb99-83"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">'active'</span>, <span class="st">'plastic'</span>,</span>
<span id="cb99-84"><a href="#cb99-84"></a>                  <span class="st">'sit-and-wait'</span>),</span>
<span id="cb99-85"><a href="#cb99-85"></a>       <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">pt.bg =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>,</span>
<span id="cb99-86"><a href="#cb99-86"></a>                           <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>),</span>
<span id="cb99-87"><a href="#cb99-87"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>,</span>
<span id="cb99-88"><a href="#cb99-88"></a>               <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>),</span>
<span id="cb99-89"><a href="#cb99-89"></a>       <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">'n'</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="do">## Checking homogeneity of variance</span></span>
<span id="cb100-2"><a href="#cb100-2"></a></span>
<span id="cb100-3"><a href="#cb100-3"></a></span>
<span id="cb100-4"><a href="#cb100-4"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb100-5"><a href="#cb100-5"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb100-6"><a href="#cb100-6"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb100-7"><a href="#cb100-7"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb100-8"><a href="#cb100-8"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb100-9"><a href="#cb100-9"></a></span>
<span id="cb100-10"><a href="#cb100-10"></a><span class="fu">par</span>(<span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb100-11"><a href="#cb100-11"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(repro.model2), <span class="fu">resid</span>(repro.model2),</span>
<span id="cb100-12"><a href="#cb100-12"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb100-13"><a href="#cb100-13"></a>     <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">xlab =</span> <span class="st">''</span>)</span>
<span id="cb100-14"><a href="#cb100-14"></a></span>
<span id="cb100-15"><a href="#cb100-15"></a><span class="fu">grid</span>()</span>
<span id="cb100-16"><a href="#cb100-16"></a></span>
<span id="cb100-17"><a href="#cb100-17"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb100-18"><a href="#cb100-18"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(repro.model2), <span class="fu">resid</span>(repro.model2),</span>
<span id="cb100-19"><a href="#cb100-19"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">"Fitted"</span>,</span>
<span id="cb100-20"><a href="#cb100-20"></a>     <span class="at">ylab =</span> <span class="st">"Residual"</span>, <span class="at">main =</span> <span class="st">"Fitted versus Residuals"</span>,</span>
<span id="cb100-21"><a href="#cb100-21"></a>     <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb100-22"><a href="#cb100-22"></a></span>
<span id="cb100-23"><a href="#cb100-23"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"darkorange"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb100-24"><a href="#cb100-24"></a></span>
<span id="cb100-25"><a href="#cb100-25"></a></span>
<span id="cb100-26"><a href="#cb100-26"></a><span class="do">## Checking normality</span></span>
<span id="cb100-27"><a href="#cb100-27"></a></span>
<span id="cb100-28"><a href="#cb100-28"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(repro.model2), <span class="at">col =</span> <span class="st">"darkgrey"</span>,</span>
<span id="cb100-29"><a href="#cb100-29"></a>       <span class="at">type =</span> <span class="st">'n'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="st">''</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb100-30"><a href="#cb100-30"></a>       <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb100-31"><a href="#cb100-31"></a></span>
<span id="cb100-32"><a href="#cb100-32"></a><span class="fu">grid</span>()</span>
<span id="cb100-33"><a href="#cb100-33"></a></span>
<span id="cb100-34"><a href="#cb100-34"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb100-35"><a href="#cb100-35"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(repro.model2), <span class="at">col =</span> <span class="st">"darkgrey"</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb100-36"><a href="#cb100-36"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(repro.model2), <span class="at">col =</span> <span class="st">"dodgerblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a><span class="do">## setting up the data for modeling the body temperature</span></span>
<span id="cb101-2"><a href="#cb101-2"></a></span>
<span id="cb101-3"><a href="#cb101-3"></a>tb.data <span class="ot">&lt;-</span> pruned.data.mrg[<span class="sc">!</span><span class="fu">is.na</span>(pruned.data.mrg<span class="sc">$</span><span class="st">'Mean body temperature'</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(pruned.data.mrg<span class="sc">$</span><span class="st">'Reproductive output'</span>), ]</span>
<span id="cb101-4"><a href="#cb101-4"></a></span>
<span id="cb101-5"><a href="#cb101-5"></a>check <span class="ot">&lt;-</span> <span class="fu">name.check</span>(lizard.tree, tb.data)</span>
<span id="cb101-6"><a href="#cb101-6"></a>rm_phy <span class="ot">&lt;-</span> check<span class="sc">$</span>tree_not_data</span>
<span id="cb101-7"><a href="#cb101-7"></a>rm_dat <span class="ot">&lt;-</span> check<span class="sc">$</span>data_not_tree</span>
<span id="cb101-8"><a href="#cb101-8"></a>tree.tb <span class="ot">&lt;-</span> <span class="fu">drop.tip</span>(lizard.tree, rm_phy)</span>
<span id="cb101-9"><a href="#cb101-9"></a></span>
<span id="cb101-10"><a href="#cb101-10"></a>data.tb <span class="ot">&lt;-</span> <span class="fu">subset</span>(tb.data,</span>
<span id="cb101-11"><a href="#cb101-11"></a>                      <span class="at">subset =</span> <span class="fu">rownames</span>(tb.data) <span class="sc">%in%</span> tree.tb<span class="sc">$</span>tip,</span>
<span id="cb101-12"><a href="#cb101-12"></a>                      <span class="at">select =</span> <span class="fu">names</span>(tb.data))</span>
<span id="cb101-13"><a href="#cb101-13"></a><span class="fu">name.check</span>(tree.tb, data.tb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "OK"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a><span class="fu">names</span>(data.tb)[<span class="dv">30</span>] <span class="ot">&lt;-</span> <span class="st">'repro.output'</span></span>
<span id="cb103-2"><a href="#cb103-2"></a><span class="fu">names</span>(data.tb)[<span class="dv">14</span>] <span class="ot">&lt;-</span> <span class="st">'body.mass'</span></span>
<span id="cb103-3"><a href="#cb103-3"></a><span class="fu">names</span>(data.tb)[<span class="dv">26</span>] <span class="ot">&lt;-</span> <span class="st">'mean.tb'</span></span>
<span id="cb103-4"><a href="#cb103-4"></a><span class="fu">names</span>(data.tb)[<span class="dv">29</span>] <span class="ot">&lt;-</span> <span class="st">'range'</span></span>
<span id="cb103-5"><a href="#cb103-5"></a></span>
<span id="cb103-6"><a href="#cb103-6"></a><span class="fu">head</span>(data.tb[ , <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">26</span>, <span class="dv">29</span>, <span class="dv">30</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;                               Foraging.mode body.mass mean.tb     range
&gt; Acanthocercus_atricollis       sit-and-wait  3.249932    39.9 12.774717
&gt; Acanthodactylus_beershebensis        active  2.220108    33.6  9.730783
&gt; Acanthodactylus_boskianus            active  2.290035    36.2 13.199259
&gt; Acanthodactylus_erythrurus          plastic  2.139879    34.8 12.012896
&gt; Acanthodactylus_pardalis       sit-and-wait  2.021189    35.3 11.253532
&gt; Acanthodactylus_schreiberi           active  2.269513    36.0  9.957076
&gt;                               repro.output
&gt; Acanthocercus_atricollis         1.0569049
&gt; Acanthodactylus_beershebensis    0.6901961
&gt; Acanthodactylus_boskianus        0.6334685
&gt; Acanthodactylus_erythrurus       0.7442930
&gt; Acanthodactylus_pardalis         1.1702617
&gt; Acanthodactylus_schreiberi       0.8750613</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="fu">dim</span>(data.tb[ , <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">26</span>, <span class="dv">29</span>, <span class="dv">30</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] 214   5</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a><span class="do">## fitting models</span></span>
<span id="cb107-2"><a href="#cb107-2"></a></span>
<span id="cb107-3"><a href="#cb107-3"></a>tb.model1 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode<span class="sc">*</span>body.mass<span class="sc">*</span>range<span class="sc">*</span>repro.output,</span>
<span id="cb107-4"><a href="#cb107-4"></a>                     <span class="at">correlation =</span></span>
<span id="cb107-5"><a href="#cb107-5"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb107-6"><a href="#cb107-6"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb107-7"><a href="#cb107-7"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb107-8"><a href="#cb107-8"></a></span>
<span id="cb107-9"><a href="#cb107-9"></a>tb.model2 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode<span class="sc">*</span>body.mass <span class="sc">+</span> range <span class="sc">+</span></span>
<span id="cb107-10"><a href="#cb107-10"></a>                repro.output,</span>
<span id="cb107-11"><a href="#cb107-11"></a>                     <span class="at">correlation =</span></span>
<span id="cb107-12"><a href="#cb107-12"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb107-13"><a href="#cb107-13"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb107-14"><a href="#cb107-14"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb107-15"><a href="#cb107-15"></a></span>
<span id="cb107-16"><a href="#cb107-16"></a>tb.model3 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode<span class="sc">*</span>range <span class="sc">+</span> body.mass <span class="sc">+</span></span>
<span id="cb107-17"><a href="#cb107-17"></a>                repro.output,</span>
<span id="cb107-18"><a href="#cb107-18"></a>                     <span class="at">correlation =</span></span>
<span id="cb107-19"><a href="#cb107-19"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb107-20"><a href="#cb107-20"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb107-21"><a href="#cb107-21"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb107-22"><a href="#cb107-22"></a></span>
<span id="cb107-23"><a href="#cb107-23"></a>tb.model4 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode<span class="sc">*</span>repro.output <span class="sc">+</span> body.mass <span class="sc">+</span></span>
<span id="cb107-24"><a href="#cb107-24"></a>                range,</span>
<span id="cb107-25"><a href="#cb107-25"></a>                     <span class="at">correlation =</span></span>
<span id="cb107-26"><a href="#cb107-26"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb107-27"><a href="#cb107-27"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb107-28"><a href="#cb107-28"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb107-29"><a href="#cb107-29"></a></span>
<span id="cb107-30"><a href="#cb107-30"></a>tb.model5 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode <span class="sc">+</span> repro.output <span class="sc">+</span> body.mass <span class="sc">+</span></span>
<span id="cb107-31"><a href="#cb107-31"></a>                range,</span>
<span id="cb107-32"><a href="#cb107-32"></a>                     <span class="at">correlation =</span></span>
<span id="cb107-33"><a href="#cb107-33"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb107-34"><a href="#cb107-34"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb107-35"><a href="#cb107-35"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb107-36"><a href="#cb107-36"></a></span>
<span id="cb107-37"><a href="#cb107-37"></a>tb.model6 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode <span class="sc">+</span> repro.output <span class="sc">+</span> body.mass,</span>
<span id="cb107-38"><a href="#cb107-38"></a>                     <span class="at">correlation =</span></span>
<span id="cb107-39"><a href="#cb107-39"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb107-40"><a href="#cb107-40"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb107-41"><a href="#cb107-41"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb107-42"><a href="#cb107-42"></a></span>
<span id="cb107-43"><a href="#cb107-43"></a>tb.model7 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode <span class="sc">+</span> repro.output <span class="sc">+</span> range,</span>
<span id="cb107-44"><a href="#cb107-44"></a>                     <span class="at">correlation =</span></span>
<span id="cb107-45"><a href="#cb107-45"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb107-46"><a href="#cb107-46"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb107-47"><a href="#cb107-47"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb107-48"><a href="#cb107-48"></a></span>
<span id="cb107-49"><a href="#cb107-49"></a>tb.model8 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode <span class="sc">+</span> body.mass <span class="sc">+</span> range,</span>
<span id="cb107-50"><a href="#cb107-50"></a>                     <span class="at">correlation =</span></span>
<span id="cb107-51"><a href="#cb107-51"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb107-52"><a href="#cb107-52"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb107-53"><a href="#cb107-53"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb107-54"><a href="#cb107-54"></a></span>
<span id="cb107-55"><a href="#cb107-55"></a>tb.model9 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode <span class="sc">+</span> range,</span>
<span id="cb107-56"><a href="#cb107-56"></a>                     <span class="at">correlation =</span></span>
<span id="cb107-57"><a href="#cb107-57"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb107-58"><a href="#cb107-58"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb107-59"><a href="#cb107-59"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb107-60"><a href="#cb107-60"></a></span>
<span id="cb107-61"><a href="#cb107-61"></a>tb.model10 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode <span class="sc">+</span> repro.output,</span>
<span id="cb107-62"><a href="#cb107-62"></a>                     <span class="at">correlation =</span></span>
<span id="cb107-63"><a href="#cb107-63"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb107-64"><a href="#cb107-64"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb107-65"><a href="#cb107-65"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb107-66"><a href="#cb107-66"></a></span>
<span id="cb107-67"><a href="#cb107-67"></a>tb.model11 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode <span class="sc">+</span> body.mass,</span>
<span id="cb107-68"><a href="#cb107-68"></a>                     <span class="at">correlation =</span></span>
<span id="cb107-69"><a href="#cb107-69"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb107-70"><a href="#cb107-70"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb107-71"><a href="#cb107-71"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb107-72"><a href="#cb107-72"></a></span>
<span id="cb107-73"><a href="#cb107-73"></a>tb.model12 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode,</span>
<span id="cb107-74"><a href="#cb107-74"></a>                     <span class="at">correlation =</span></span>
<span id="cb107-75"><a href="#cb107-75"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb107-76"><a href="#cb107-76"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb107-77"><a href="#cb107-77"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb107-78"><a href="#cb107-78"></a></span>
<span id="cb107-79"><a href="#cb107-79"></a>tb.model13 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> body.mass,</span>
<span id="cb107-80"><a href="#cb107-80"></a>                     <span class="at">correlation =</span></span>
<span id="cb107-81"><a href="#cb107-81"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb107-82"><a href="#cb107-82"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb107-83"><a href="#cb107-83"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb107-84"><a href="#cb107-84"></a></span>
<span id="cb107-85"><a href="#cb107-85"></a>tb.model14 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> range,</span>
<span id="cb107-86"><a href="#cb107-86"></a>                     <span class="at">correlation =</span></span>
<span id="cb107-87"><a href="#cb107-87"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb107-88"><a href="#cb107-88"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb107-89"><a href="#cb107-89"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb107-90"><a href="#cb107-90"></a></span>
<span id="cb107-91"><a href="#cb107-91"></a>tb.model15 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> repro.output,</span>
<span id="cb107-92"><a href="#cb107-92"></a>                     <span class="at">correlation =</span></span>
<span id="cb107-93"><a href="#cb107-93"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb107-94"><a href="#cb107-94"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb107-95"><a href="#cb107-95"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb107-96"><a href="#cb107-96"></a></span>
<span id="cb107-97"><a href="#cb107-97"></a></span>
<span id="cb107-98"><a href="#cb107-98"></a>tb.models <span class="ot">&lt;-</span> <span class="fu">anova</span>(tb.model1, tb.model2,</span>
<span id="cb107-99"><a href="#cb107-99"></a>                   tb.model3, tb.model4,</span>
<span id="cb107-100"><a href="#cb107-100"></a>                   tb.model5, tb.model6,</span>
<span id="cb107-101"><a href="#cb107-101"></a>                   tb.model7, tb.model8,</span>
<span id="cb107-102"><a href="#cb107-102"></a>                   tb.model9, tb.model10,</span>
<span id="cb107-103"><a href="#cb107-103"></a>                   tb.model11, tb.model12,</span>
<span id="cb107-104"><a href="#cb107-104"></a>                   tb.model13, tb.model14,</span>
<span id="cb107-105"><a href="#cb107-105"></a>                   tb.model15)</span>
<span id="cb107-106"><a href="#cb107-106"></a></span>
<span id="cb107-107"><a href="#cb107-107"></a><span class="fu">round</span>(<span class="fu">aicw</span>(<span class="fu">setNames</span>(tb.models<span class="sc">$</span>AIC,</span>
<span id="cb107-108"><a href="#cb107-108"></a>              <span class="fu">rownames</span>(tb.models))), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;                 fit  delta     w
&gt; tb.model1  1163.539 20.396 0.000
&gt; tb.model2  1144.763  1.620 0.118
&gt; tb.model3  1149.211  6.068 0.013
&gt; tb.model4  1150.423  7.280 0.007
&gt; tb.model5  1146.938  3.795 0.040
&gt; tb.model6  1149.513  6.371 0.011
&gt; tb.model7  1145.072  1.929 0.101
&gt; tb.model8  1144.951  1.808 0.107
&gt; tb.model9  1143.143  0.000 0.264
&gt; tb.model10 1147.837  4.694 0.025
&gt; tb.model11 1147.611  4.468 0.028
&gt; tb.model12 1145.850  2.708 0.068
&gt; tb.model13 1148.534  5.391 0.018
&gt; tb.model14 1143.865  0.722 0.184
&gt; tb.model15 1148.660  5.517 0.017</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a><span class="fu">summary</span>(tb.model9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; Generalized least squares fit by maximum likelihood
&gt;   Model: mean.tb ~ Foraging.mode + range 
&gt;   Data: data.tb 
&gt;        AIC      BIC    logLik
&gt;   1143.143 1159.973 -566.5714
&gt; 
&gt; Correlation Structure: corBrownian
&gt;  Formula: ~Species 
&gt;  Parameter estimate(s):
&gt; numeric(0)
&gt; 
&gt; Coefficients:
&gt;                               Value Std.Error   t-value p-value
&gt; (Intercept)               25.862488  3.224684  8.020162  0.0000
&gt; Foraging.modeplastic      -1.322477  0.622849 -2.123270  0.0349
&gt; Foraging.modesit-and-wait -1.218553  0.704097 -1.730662  0.0850
&gt; range                      0.426039  0.197130  2.161211  0.0318
&gt; 
&gt;  Correlation: 
&gt;                           (Intr) Frgng. Frg.--
&gt; Foraging.modeplastic      -0.122              
&gt; Foraging.modesit-and-wait -0.070  0.668       
&gt; range                     -0.714  0.038 -0.065
&gt; 
&gt; Standardized residuals:
&gt;        Min         Q1        Med         Q3        Max 
&gt; -2.1490470 -0.2101333  0.2998825  0.7455291  1.5353387 
&gt; 
&gt; Residual standard error: 6.850236 
&gt; Degrees of freedom: 214 total; 210 residual</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="do">## plotting results of the model</span></span>
<span id="cb111-2"><a href="#cb111-2"></a></span>
<span id="cb111-3"><a href="#cb111-3"></a><span class="do">##png('./imgs/figure4.png', width = 7, height = 7, units = 'in',</span></span>
<span id="cb111-4"><a href="#cb111-4"></a><span class="do">##    res = 360)</span></span>
<span id="cb111-5"><a href="#cb111-5"></a><span class="do">##pdf('./imgs/figuer4.pdf')</span></span>
<span id="cb111-6"><a href="#cb111-6"></a></span>
<span id="cb111-7"><a href="#cb111-7"></a></span>
<span id="cb111-8"><a href="#cb111-8"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>)</span>
<span id="cb111-9"><a href="#cb111-9"></a></span>
<span id="cb111-10"><a href="#cb111-10"></a><span class="fu">dim</span>(data.tb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] 214  30</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a>pred.mod <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">range =</span> <span class="fu">seq</span>(<span class="fu">min</span>(data.tb<span class="sc">$</span>range),</span>
<span id="cb113-2"><a href="#cb113-2"></a>                                   <span class="fu">max</span>(data.tb<span class="sc">$</span>range),</span>
<span id="cb113-3"><a href="#cb113-3"></a>                                   <span class="at">len =</span> <span class="dv">214</span>),</span>
<span id="cb113-4"><a href="#cb113-4"></a>                       <span class="at">Foraging.mode =</span> data.tb<span class="sc">$</span>Foraging.mode,</span>
<span id="cb113-5"><a href="#cb113-5"></a>                       <span class="at">row.names =</span> <span class="fu">rownames</span>(data.tb))</span>
<span id="cb113-6"><a href="#cb113-6"></a>pred.mod<span class="sc">$</span>mean.tb <span class="ot">&lt;-</span> <span class="fu">predict</span>(tb.model9, pred.mod,</span>
<span id="cb113-7"><a href="#cb113-7"></a>                            <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>fit</span>
<span id="cb113-8"><a href="#cb113-8"></a>pred.mod<span class="sc">$</span>se <span class="ot">&lt;-</span> <span class="fu">predict</span>(tb.model9, pred.mod,</span>
<span id="cb113-9"><a href="#cb113-9"></a>                       <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>se.fit</span>
<span id="cb113-10"><a href="#cb113-10"></a><span class="fu">head</span>(pred.mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;                                  range Foraging.mode  mean.tb       se
&gt; Acanthocercus_atricollis      8.318229  sit-and-wait 28.18782 2.358390
&gt; Acanthodactylus_beershebensis 8.341438        active 29.41627 2.351247
&gt; Acanthodactylus_boskianus     8.364647        active 29.42615 2.349969
&gt; Acanthodactylus_erythrurus    8.387856       plastic 28.11356 2.343486
&gt; Acanthodactylus_pardalis      8.411065  sit-and-wait 28.22738 2.352951
&gt; Acanthodactylus_schreiberi    8.434274        active 29.45582 2.346185</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a>active <span class="ot">&lt;-</span> pred.mod[data.tb<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'active'</span>, ]</span>
<span id="cb115-2"><a href="#cb115-2"></a>plastic <span class="ot">&lt;-</span> pred.mod[data.tb<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'plastic'</span>, ]</span>
<span id="cb115-3"><a href="#cb115-3"></a>sit.and.wait <span class="ot">&lt;-</span> pred.mod[data.tb<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'sit-and-wait'</span>, ]</span>
<span id="cb115-4"><a href="#cb115-4"></a></span>
<span id="cb115-5"><a href="#cb115-5"></a></span>
<span id="cb115-6"><a href="#cb115-6"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb115-7"><a href="#cb115-7"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb115-8"><a href="#cb115-8"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb115-9"><a href="#cb115-9"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb115-10"><a href="#cb115-10"></a></span>
<span id="cb115-11"><a href="#cb115-11"></a></span>
<span id="cb115-12"><a href="#cb115-12"></a><span class="fu">par</span>(<span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb115-13"><a href="#cb115-13"></a></span>
<span id="cb115-14"><a href="#cb115-14"></a><span class="fu">plot</span>(mean.tb <span class="sc">~</span> range, <span class="at">data =</span> data.tb,</span>
<span id="cb115-15"><a href="#cb115-15"></a>     <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb115-16"><a href="#cb115-16"></a>     <span class="at">bg =</span> cols[<span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(data.tb<span class="sc">$</span>Foraging.mode))],</span>
<span id="cb115-17"><a href="#cb115-17"></a>     <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>, <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb115-18"><a href="#cb115-18"></a>     <span class="at">type =</span> <span class="st">'n'</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb115-19"><a href="#cb115-19"></a></span>
<span id="cb115-20"><a href="#cb115-20"></a><span class="fu">grid</span>(<span class="at">nx =</span> <span class="cn">NULL</span>, <span class="at">ny =</span> <span class="cn">NULL</span>, <span class="at">col =</span> <span class="st">"lightgray"</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb115-21"><a href="#cb115-21"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb115-22"><a href="#cb115-22"></a></span>
<span id="cb115-23"><a href="#cb115-23"></a><span class="fu">plot</span>(mean.tb <span class="sc">~</span> range, <span class="at">data =</span> data.tb,</span>
<span id="cb115-24"><a href="#cb115-24"></a>     <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb115-25"><a href="#cb115-25"></a>     <span class="at">bg =</span> cols[<span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(data.tb<span class="sc">$</span>Foraging.mode))],</span>
<span id="cb115-26"><a href="#cb115-26"></a>     <span class="at">col =</span> <span class="st">'black'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">"Area of geographic range"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(km<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb115-27"><a href="#cb115-27"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Mean body temperature"</span><span class="sc">~</span>(<span class="st">'\u00B0C'</span>)), <span class="at">type =</span> <span class="st">'p'</span>)</span>
<span id="cb115-28"><a href="#cb115-28"></a></span>
<span id="cb115-29"><a href="#cb115-29"></a><span class="fu">lines</span>(active<span class="sc">$</span>mean.tb <span class="sc">~</span> active<span class="sc">$</span>range,</span>
<span id="cb115-30"><a href="#cb115-30"></a>      <span class="at">data =</span> active, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>)</span>
<span id="cb115-31"><a href="#cb115-31"></a></span>
<span id="cb115-32"><a href="#cb115-32"></a><span class="fu">lines</span>(plastic<span class="sc">$</span>mean.tb <span class="sc">~</span> plastic<span class="sc">$</span>range,</span>
<span id="cb115-33"><a href="#cb115-33"></a>      <span class="at">data =</span> plastic, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'green4'</span>)</span>
<span id="cb115-34"><a href="#cb115-34"></a></span>
<span id="cb115-35"><a href="#cb115-35"></a><span class="fu">lines</span>(sit.and.wait<span class="sc">$</span>mean.tb <span class="sc">~</span> sit.and.wait<span class="sc">$</span>range,</span>
<span id="cb115-36"><a href="#cb115-36"></a>      <span class="at">data =</span> sit.and.wait, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>)</span>
<span id="cb115-37"><a href="#cb115-37"></a></span>
<span id="cb115-38"><a href="#cb115-38"></a><span class="fu">legend</span>(<span class="st">'bottomright'</span>,</span>
<span id="cb115-39"><a href="#cb115-39"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">'active'</span>, <span class="st">'plastic'</span>,</span>
<span id="cb115-40"><a href="#cb115-40"></a>                  <span class="st">'sit-and-wait'</span>), <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb115-41"><a href="#cb115-41"></a>       <span class="at">pt.bg =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>),</span>
<span id="cb115-42"><a href="#cb115-42"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>), <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb115-43"><a href="#cb115-43"></a>       <span class="at">bty =</span> <span class="st">'n'</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb115-44"><a href="#cb115-44"></a><span class="fu">mtext</span>(<span class="st">'A'</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.7</span>, <span class="at">at =</span> <span class="dv">45</span>, <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb115-45"><a href="#cb115-45"></a></span>
<span id="cb115-46"><a href="#cb115-46"></a></span>
<span id="cb115-47"><a href="#cb115-47"></a><span class="do">## Distribution of residuals</span></span>
<span id="cb115-48"><a href="#cb115-48"></a></span>
<span id="cb115-49"><a href="#cb115-49"></a>res.act <span class="ot">&lt;-</span> <span class="fu">density</span>(<span class="fu">residuals</span>(tb.model9)[data.tb<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"active"</span>])</span>
<span id="cb115-50"><a href="#cb115-50"></a>res.pla <span class="ot">&lt;-</span> <span class="fu">density</span>(<span class="fu">residuals</span>(tb.model9)[data.tb<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"plastic"</span>])</span>
<span id="cb115-51"><a href="#cb115-51"></a>res.sit <span class="ot">&lt;-</span> <span class="fu">density</span>(<span class="fu">residuals</span>(tb.model9)[data.tb<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"sit-and-wait"</span>])</span>
<span id="cb115-52"><a href="#cb115-52"></a></span>
<span id="cb115-53"><a href="#cb115-53"></a><span class="fu">plot</span>(<span class="cn">NA</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(res.act<span class="sc">$</span>y)),</span>
<span id="cb115-54"><a href="#cb115-54"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fu">min</span>(res.pla<span class="sc">$</span>x), <span class="fu">max</span>(res.pla<span class="sc">$</span>x)),</span>
<span id="cb115-55"><a href="#cb115-55"></a>     <span class="at">ann =</span> <span class="cn">FALSE</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">xaxt =</span> <span class="st">"n"</span>,</span>
<span id="cb115-56"><a href="#cb115-56"></a>     <span class="at">yaxt =</span> <span class="st">"n"</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb115-57"><a href="#cb115-57"></a><span class="fu">grid</span>()</span>
<span id="cb115-58"><a href="#cb115-58"></a></span>
<span id="cb115-59"><a href="#cb115-59"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>, <span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb115-60"><a href="#cb115-60"></a><span class="fu">plot</span>(res.act, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(res.act<span class="sc">$</span>y)),</span>
<span id="cb115-61"><a href="#cb115-61"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fu">min</span>(res.pla<span class="sc">$</span>x), <span class="fu">max</span>(res.pla<span class="sc">$</span>x)),</span>
<span id="cb115-62"><a href="#cb115-62"></a>     <span class="at">xlab =</span> <span class="st">'Residuals'</span>,</span>
<span id="cb115-63"><a href="#cb115-63"></a>     <span class="at">ylab =</span> <span class="st">'Density'</span>,</span>
<span id="cb115-64"><a href="#cb115-64"></a>     <span class="at">type =</span> <span class="st">'n'</span>, <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb115-65"><a href="#cb115-65"></a></span>
<span id="cb115-66"><a href="#cb115-66"></a><span class="fu">polygon</span>(res.act,</span>
<span id="cb115-67"><a href="#cb115-67"></a>        <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">'#39568CFF'</span>, <span class="fl">0.3</span>),</span>
<span id="cb115-68"><a href="#cb115-68"></a>        <span class="at">border =</span> <span class="cn">FALSE</span>)</span>
<span id="cb115-69"><a href="#cb115-69"></a><span class="fu">polygon</span>(res.pla,</span>
<span id="cb115-70"><a href="#cb115-70"></a>        <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">'green4'</span>, <span class="fl">0.3</span>),</span>
<span id="cb115-71"><a href="#cb115-71"></a>        <span class="at">border =</span> <span class="cn">FALSE</span>)</span>
<span id="cb115-72"><a href="#cb115-72"></a><span class="fu">polygon</span>(res.sit,</span>
<span id="cb115-73"><a href="#cb115-73"></a>        <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">'#DCE319FF'</span>, <span class="fl">0.3</span>),</span>
<span id="cb115-74"><a href="#cb115-74"></a>        <span class="at">border =</span> <span class="cn">FALSE</span>)</span>
<span id="cb115-75"><a href="#cb115-75"></a></span>
<span id="cb115-76"><a href="#cb115-76"></a><span class="fu">legend</span>(<span class="st">'topleft'</span>,</span>
<span id="cb115-77"><a href="#cb115-77"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">'active'</span>, <span class="st">'plastic'</span>,</span>
<span id="cb115-78"><a href="#cb115-78"></a>                  <span class="st">'sit-and-wait'</span>),</span>
<span id="cb115-79"><a href="#cb115-79"></a>       <span class="at">fill =</span> <span class="fu">alpha</span>(<span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>,</span>
<span id="cb115-80"><a href="#cb115-80"></a>                      <span class="st">'#DCE319FF'</span>), <span class="fl">0.3</span>),</span>
<span id="cb115-81"><a href="#cb115-81"></a>       <span class="at">bty =</span> <span class="st">'n'</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb115-82"><a href="#cb115-82"></a><span class="fu">mtext</span>(<span class="st">'B'</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">3.1</span>, <span class="at">at =</span> <span class="fl">0.127</span>, <span class="at">las =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a><span class="do">##dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a><span class="do">## Checking homogeneity of variance</span></span>
<span id="cb117-2"><a href="#cb117-2"></a></span>
<span id="cb117-3"><a href="#cb117-3"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb117-4"><a href="#cb117-4"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb117-5"><a href="#cb117-5"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb117-6"><a href="#cb117-6"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb117-7"><a href="#cb117-7"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb117-8"><a href="#cb117-8"></a></span>
<span id="cb117-9"><a href="#cb117-9"></a><span class="fu">par</span>(<span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb117-10"><a href="#cb117-10"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(tb.model9), <span class="fu">resid</span>(tb.model9),</span>
<span id="cb117-11"><a href="#cb117-11"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb117-12"><a href="#cb117-12"></a>     <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">xlab =</span> <span class="st">''</span>)</span>
<span id="cb117-13"><a href="#cb117-13"></a></span>
<span id="cb117-14"><a href="#cb117-14"></a><span class="fu">grid</span>()</span>
<span id="cb117-15"><a href="#cb117-15"></a></span>
<span id="cb117-16"><a href="#cb117-16"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb117-17"><a href="#cb117-17"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(tb.model9), <span class="fu">resid</span>(tb.model9),</span>
<span id="cb117-18"><a href="#cb117-18"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">"Fitted"</span>,</span>
<span id="cb117-19"><a href="#cb117-19"></a>     <span class="at">ylab =</span> <span class="st">"Residual"</span>, <span class="at">main =</span> <span class="st">"Fitted versus Residuals"</span>,</span>
<span id="cb117-20"><a href="#cb117-20"></a>     <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb117-21"><a href="#cb117-21"></a></span>
<span id="cb117-22"><a href="#cb117-22"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"darkorange"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb117-23"><a href="#cb117-23"></a></span>
<span id="cb117-24"><a href="#cb117-24"></a></span>
<span id="cb117-25"><a href="#cb117-25"></a><span class="do">## Checking normality</span></span>
<span id="cb117-26"><a href="#cb117-26"></a></span>
<span id="cb117-27"><a href="#cb117-27"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(tb.model9), <span class="at">col =</span> <span class="st">"darkgrey"</span>,</span>
<span id="cb117-28"><a href="#cb117-28"></a>       <span class="at">type =</span> <span class="st">'n'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="st">''</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb117-29"><a href="#cb117-29"></a>       <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb117-30"><a href="#cb117-30"></a></span>
<span id="cb117-31"><a href="#cb117-31"></a><span class="fu">grid</span>()</span>
<span id="cb117-32"><a href="#cb117-32"></a></span>
<span id="cb117-33"><a href="#cb117-33"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb117-34"><a href="#cb117-34"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(tb.model9), <span class="at">col =</span> <span class="st">"darkgrey"</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb117-35"><a href="#cb117-35"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(tb.model9), <span class="at">col =</span> <span class="st">"dodgerblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a>genomes <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"squamates-comparative-genomic-data.tsv"</span>,</span>
<span id="cb118-2"><a href="#cb118-2"></a>                      <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb118-3"><a href="#cb118-3"></a></span>
<span id="cb118-4"><a href="#cb118-4"></a><span class="fu">names</span>(genomes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;  [1] "Assembly.Accession"                        
&gt;  [2] "Assembly.Name"                             
&gt;  [3] "Organism.Name"                             
&gt;  [4] "Organism.Taxonomic.ID"                     
&gt;  [5] "Organism.Infraspecific.Names.Breed"        
&gt;  [6] "Organism.Infraspecific.Names.Strain"       
&gt;  [7] "Organism.Infraspecific.Names.Cultivar"     
&gt;  [8] "Organism.Infraspecific.Names.Ecotype"      
&gt;  [9] "Organism.Infraspecific.Names.Isolate"      
&gt; [10] "Organism.Infraspecific.Names.Sex"          
&gt; [11] "Annotation.Name"                           
&gt; [12] "Assembly.Stats.Total.Sequence.Length"      
&gt; [13] "Assembly.Stats.Total.Number.of.Chromosomes"
&gt; [14] "Assembly.Level"                            
&gt; [15] "Assembly.Release.Date"                     
&gt; [16] "WGS.project.accession"                     
&gt; [17] "Assembly.Stats.Contig.N50"                 
&gt; [18] "Assembly.Stats.Scaffold.N50"               
&gt; [19] "Assembly.Stats.Number.of.Scaffolds"        
&gt; [20] "Annotation.BUSCO.Complete"                 
&gt; [21] "Annotation.BUSCO.Single.Copy"              
&gt; [22] "Annotation.BUSCO.Duplicated"               
&gt; [23] "Annotation.BUSCO.Fragmented"               
&gt; [24] "Annotation.BUSCO.Missing"                  
&gt; [25] "Annotation.BUSCO.Lineage"                  
&gt; [26] "Assembly.Sequencing.Tech"                  
&gt; [27] "Annotation.Count.Gene.Total"               
&gt; [28] "Annotation.Count.Gene.Protein.coding"      
&gt; [29] "Annotation.Count.Gene.Pseudogene"          
&gt; [30] "Type.Material.Display.Text"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a>genome.annotation <span class="ot">&lt;-</span> genomes[ , <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">12</span><span class="sc">:</span><span class="dv">14</span>, <span class="dv">17</span><span class="sc">:</span><span class="dv">18</span>, <span class="dv">21</span><span class="sc">:</span><span class="dv">22</span>, <span class="dv">27</span><span class="sc">:</span><span class="dv">29</span>)]</span>
<span id="cb120-2"><a href="#cb120-2"></a></span>
<span id="cb120-3"><a href="#cb120-3"></a><span class="fu">names</span>(genome.annotation) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'species'</span>, <span class="st">'genome.size'</span>, <span class="st">'chr.number'</span>, <span class="st">'assem.level'</span>, <span class="st">'contig.N50'</span>,</span>
<span id="cb120-4"><a href="#cb120-4"></a>                              <span class="st">'scaffold.N50'</span>,</span>
<span id="cb120-5"><a href="#cb120-5"></a>                              <span class="st">'BUSCO.single.copy'</span>,</span>
<span id="cb120-6"><a href="#cb120-6"></a>                              <span class="st">'BUSCO.duplicate'</span>,</span>
<span id="cb120-7"><a href="#cb120-7"></a>                              <span class="st">'total.gene.number'</span>,</span>
<span id="cb120-8"><a href="#cb120-8"></a>                              <span class="st">'protein.coding.genes'</span>,</span>
<span id="cb120-9"><a href="#cb120-9"></a>                              <span class="st">'pseudogene.number'</span>)</span>
<span id="cb120-10"><a href="#cb120-10"></a><span class="fu">head</span>(genome.annotation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;               species genome.size chr.number assem.level contig.N50
&gt; 1        Laudakia wui  1779364323         18  Chromosome  170066346
&gt; 2   Furcifer pardalis  1609777135         11  Chromosome  158731830
&gt; 3 Anolis carolinensis  1850740401          8  Chromosome   26091274
&gt; 4 Anolis carolinensis  1850740401          8  Chromosome   26091274
&gt; 5       Anolis sagrei  1950830970         15  Chromosome   43146625
&gt; 6       Anolis sagrei  1950830970         15  Chromosome   43146625
&gt;   scaffold.N50 BUSCO.single.copy BUSCO.duplicate total.gene.number
&gt; 1    273178261                NA              NA                NA
&gt; 2    184669281                NA              NA                NA
&gt; 3    288964324                NA              NA                NA
&gt; 4    288964324         0.9536096      0.02005348             27148
&gt; 5    249210491                NA              NA                NA
&gt; 6    249210491         0.9332888      0.04024064             23363
&gt;   protein.coding.genes pseudogene.number
&gt; 1                   NA                NA
&gt; 2                   NA                NA
&gt; 3                   NA                NA
&gt; 4                20447               628
&gt; 5                   NA                NA
&gt; 6                20130              1009</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a>genome.annotation<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">' '</span>, <span class="st">'_'</span>,</span>
<span id="cb122-2"><a href="#cb122-2"></a>                                  genome.annotation<span class="sc">$</span>species)</span>
<span id="cb122-3"><a href="#cb122-3"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Crotalus_viridis_viridis"</span>] <span class="ot">&lt;-</span> <span class="st">"Crotalus_viridis"</span></span>
<span id="cb122-4"><a href="#cb122-4"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Elgaria_multicarinata_webbii"</span>] <span class="ot">&lt;-</span> <span class="st">"Elgaria_multicarinata"</span></span>
<span id="cb122-5"><a href="#cb122-5"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Coluber_constrictor_foxii"</span>] <span class="ot">&lt;-</span> <span class="st">"Coluber_constrictor"</span></span>
<span id="cb122-6"><a href="#cb122-6"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Diadophis_punctatus_similis"</span>] <span class="ot">&lt;-</span> <span class="st">"Diadophis_punctatus"</span></span>
<span id="cb122-7"><a href="#cb122-7"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Pituophis_catenifer_annectens"</span>] <span class="ot">&lt;-</span> <span class="st">"Pituophis_catenifer"</span></span>
<span id="cb122-8"><a href="#cb122-8"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Plestiodon_gilberti_rubricaudatus"</span>] <span class="ot">&lt;-</span> <span class="st">"Plestiodon_gilberti"</span></span>
<span id="cb122-9"><a href="#cb122-9"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Aspidoscelis_tigris_stejnegeri"</span>] <span class="ot">&lt;-</span> <span class="st">"Aspidoscelis_tigris"</span></span>
<span id="cb122-10"><a href="#cb122-10"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Varanus_salvator_macromaculatus"</span>] <span class="ot">&lt;-</span> <span class="st">"Varanus_salvator"</span></span>
<span id="cb122-11"><a href="#cb122-11"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Podarcis_muralis_nigriventris"</span>] <span class="ot">&lt;-</span> <span class="st">"Podarcis_muralis"</span></span>
<span id="cb122-12"><a href="#cb122-12"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Dibamus_cf._smithi"</span>] <span class="ot">&lt;-</span> <span class="st">"Dibamus_smithi"</span></span>
<span id="cb122-13"><a href="#cb122-13"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Thamnophis_sirtalis_fitchi"</span>] <span class="ot">&lt;-</span> <span class="st">"Thamnophis_sirtalis"</span></span>
<span id="cb122-14"><a href="#cb122-14"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Elgaria_multicarinata_webbii"</span>] <span class="ot">&lt;-</span> <span class="st">"Elgaria_multicarinata"</span></span>
<span id="cb122-15"><a href="#cb122-15"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Coluber_constrictor_foxii"</span>] <span class="ot">&lt;-</span> <span class="st">"Coluber_constrictor"</span></span>
<span id="cb122-16"><a href="#cb122-16"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Diadophis_punctatus_similis"</span>] <span class="ot">&lt;-</span> <span class="st">"Diadophis_punctatus"</span></span>
<span id="cb122-17"><a href="#cb122-17"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Pituophis_catenifer_annectens"</span>] <span class="ot">&lt;-</span> <span class="st">"Pituophis_catenifer"</span></span>
<span id="cb122-18"><a href="#cb122-18"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Pituophis_catenifer_pumilus"</span>] <span class="ot">&lt;-</span> <span class="st">"Pituophis_catenifer"</span></span>
<span id="cb122-19"><a href="#cb122-19"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Vipera_berus_berus"</span>] <span class="ot">&lt;-</span> <span class="st">"Vipera_berus"</span></span>
<span id="cb122-20"><a href="#cb122-20"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Plestiodon_gilberti_rubricaudatus"</span>] <span class="ot">&lt;-</span> <span class="st">"Plestiodon_gilberti"</span></span>
<span id="cb122-21"><a href="#cb122-21"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Aspidoscelis_tigris_stejnegeri"</span>] <span class="ot">&lt;-</span> <span class="st">"Aspidoscelis_tigris"</span></span>
<span id="cb122-22"><a href="#cb122-22"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Natrix_helvetica_helvetica"</span>] <span class="ot">&lt;-</span> <span class="st">"Natrix_helvetica"</span></span>
<span id="cb122-23"><a href="#cb122-23"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Anolis_sagrei_ordinatus"</span>] <span class="ot">&lt;-</span> <span class="st">"Anolis_sagrei"</span></span>
<span id="cb122-24"><a href="#cb122-24"></a></span>
<span id="cb122-25"><a href="#cb122-25"></a>geno.size <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(genome.annotation<span class="sc">$</span>genome.size, <span class="at">by =</span> <span class="fu">list</span>(genome.annotation<span class="sc">$</span>species), mean)</span>
<span id="cb122-26"><a href="#cb122-26"></a><span class="fu">names</span>(geno.size) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Species'</span>, <span class="st">'genome.size'</span>)</span>
<span id="cb122-27"><a href="#cb122-27"></a><span class="fu">rownames</span>(geno.size) <span class="ot">&lt;-</span> geno.size<span class="sc">$</span>Species</span>
<span id="cb122-28"><a href="#cb122-28"></a></span>
<span id="cb122-29"><a href="#cb122-29"></a>check <span class="ot">&lt;-</span> <span class="fu">name.check</span>(lizard.tree, geno.size)</span>
<span id="cb122-30"><a href="#cb122-30"></a>rm_phy <span class="ot">&lt;-</span> check<span class="sc">$</span>tree_not_data</span>
<span id="cb122-31"><a href="#cb122-31"></a>rm_dat <span class="ot">&lt;-</span> check<span class="sc">$</span>data_not_tree</span>
<span id="cb122-32"><a href="#cb122-32"></a>geno.size.tree <span class="ot">&lt;-</span> <span class="fu">drop.tip</span>(lizard.tree, rm_phy)</span>
<span id="cb122-33"><a href="#cb122-33"></a></span>
<span id="cb122-34"><a href="#cb122-34"></a>pruned.geno.size.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(geno.size,</span>
<span id="cb122-35"><a href="#cb122-35"></a>                      <span class="at">subset =</span> <span class="fu">rownames</span>(geno.size) <span class="sc">%in%</span> geno.size.tree<span class="sc">$</span>tip,</span>
<span id="cb122-36"><a href="#cb122-36"></a>                      <span class="at">select =</span> <span class="fu">names</span>(geno.size))</span>
<span id="cb122-37"><a href="#cb122-37"></a><span class="fu">name.check</span>(geno.size.tree, pruned.geno.size.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "OK"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1"></a><span class="fu">str</span>(pruned.geno.size.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 220 obs. of  2 variables:
&gt;  $ Species    : chr  "Acanthocercus_atricollis" "Acrochordus_granulatus" "Agama_doriae" "Agama_finchi" ...
&gt;  $ genome.size: num  1.71e+09 1.32e+09 1.58e+09 1.33e+09 1.31e+09 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1"></a>geno.size.tree</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 
&gt; Phylogenetic tree with 220 tips and 219 internal nodes.
&gt; 
&gt; Tip labels:
&gt;   Correlophus_ciliatus, Coleonyx_elegans, Eublepharis_macularius, Euleptes_europaea, Gonatodes_alexandermendesi, Sphaerodactylus_glaucus, ...
&gt; 
&gt; Rooted; includes branch length(s).</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1"></a>pruned.geno.size.data <span class="ot">&lt;-</span> <span class="fu">merge</span>(pruned.geno.size.data, pruned.data, <span class="at">by =</span> <span class="st">'Species'</span>)</span>
<span id="cb128-2"><a href="#cb128-2"></a></span>
<span id="cb128-3"><a href="#cb128-3"></a><span class="fu">tapply</span>(<span class="at">X =</span> pruned.geno.size.data<span class="sc">$</span>Species,</span>
<span id="cb128-4"><a href="#cb128-4"></a>       <span class="at">INDEX =</span> <span class="fu">list</span>(pruned.geno.size.data<span class="sc">$</span>Foraging.mode),</span>
<span id="cb128-5"><a href="#cb128-5"></a>       <span class="at">FUN =</span> <span class="cf">function</span>(X) <span class="fu">length</span>(<span class="fu">na.omit</span>(X)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;       active      plastic sit-and-wait 
&gt;           58           12           29</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1"></a><span class="fu">rownames</span>(pruned.geno.size.data) <span class="ot">&lt;-</span> pruned.geno.size.data<span class="sc">$</span>Species</span>
<span id="cb130-2"><a href="#cb130-2"></a><span class="fu">names</span>(pruned.geno.size.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;  [1] "Species"                                                                             
&gt;  [2] "genome.size"                                                                         
&gt;  [3] "Order"                                                                               
&gt;  [4] "Family"                                                                              
&gt;  [5] "Genus"                                                                               
&gt;  [6] "Main.biogeographic.region"                                                           
&gt;  [7] "Microhabitat"                                                                        
&gt;  [8] "Habitat.type"                                                                        
&gt;  [9] "Minimal.elevation..m."                                                               
&gt; [10] "Maximum.elevation..m."                                                               
&gt; [11] "Diet"                                                                                
&gt; [12] "Active.time"                                                                         
&gt; [13] "Foraging.mode"                                                                       
&gt; [14] "Maximum.Longevity..years."                                                           
&gt; [15] "Maximum.body.mass..g."                                                               
&gt; [16] "Maximum.female.length...SVL...mm..straight.carapace.length.for.turtles...SCL...mm."  
&gt; [17] "Maximum.male.length...SVL...mm..straight.carapace.length.for.turtles...SCL...mm."    
&gt; [18] "Maximum.juvenile.length...SVL...mm..straight.carapace.length.for.turtles...SCL...mm."
&gt; [19] "Hatchling.neonate.mass..g."                                                          
&gt; [20] "Reproductive.mode"                                                                   
&gt; [21] "Mean.number.of.offspring.per.litter.or.number.of.eggs.per.clutch"                    
&gt; [22] "Smallest.clutch.size"                                                                
&gt; [23] "Largest.clutch.size"                                                                 
&gt; [24] "Number.of.litters.or.clutches.produced.per.year"                                     
&gt; [25] "Egg.length..mm."                                                                     
&gt; [26] "Egg.width..mm."                                                                      
&gt; [27] "Mean.Tb"                                                                             
&gt; [28] "Minimum.Tb"                                                                          
&gt; [29] "Maximum.Tb"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1"></a><span class="fu">names</span>(pruned.geno.size.data)[<span class="dv">15</span>] <span class="ot">&lt;-</span> <span class="st">'max.body.mass'</span></span>
<span id="cb132-2"><a href="#cb132-2"></a>pruned.geno.size.data<span class="sc">$</span>max.body.mass <span class="ot">&lt;-</span> <span class="fu">log10</span>(pruned.geno.size.data<span class="sc">$</span>max.body.mass)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb132-3"><a href="#cb132-3"></a>pruned.geno.size.data<span class="sc">$</span>genome.size <span class="ot">&lt;-</span> <span class="fu">log10</span>(pruned.geno.size.data<span class="sc">$</span>genome.size)</span>
<span id="cb132-4"><a href="#cb132-4"></a><span class="fu">head</span>(pruned.geno.size.data[ , <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">13</span>, <span class="dv">15</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;                                           Species genome.size Foraging.mode
&gt; Acanthocercus_atricollis Acanthocercus_atricollis    9.234190  sit-and-wait
&gt; Acrochordus_granulatus     Acrochordus_granulatus    9.122068        active
&gt; Agkistrodon_piscivorus     Agkistrodon_piscivorus    9.116082        active
&gt; Ahaetulla_nasuta                 Ahaetulla_nasuta    9.159714        active
&gt; Aipysurus_laevis                 Aipysurus_laevis    9.316883        active
&gt; Ameiva_ameiva                       Ameiva_ameiva    9.252196        active
&gt;                          max.body.mass
&gt; Acanthocercus_atricollis      3.249932
&gt; Acrochordus_granulatus        3.478133
&gt; Agkistrodon_piscivorus        4.522835
&gt; Ahaetulla_nasuta              3.833338
&gt; Aipysurus_laevis              4.126586
&gt; Ameiva_ameiva                 3.480007</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1"></a><span class="do">## modeling genome size among foraging behavior categories</span></span>
<span id="cb134-2"><a href="#cb134-2"></a></span>
<span id="cb134-3"><a href="#cb134-3"></a>gs.model1 <span class="ot">&lt;-</span> <span class="fu">gls</span>(genome.size <span class="sc">~</span> Foraging.mode<span class="sc">*</span>max.body.mass,</span>
<span id="cb134-4"><a href="#cb134-4"></a>                 <span class="at">correlation =</span></span>
<span id="cb134-5"><a href="#cb134-5"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> geno.size.tree,</span>
<span id="cb134-6"><a href="#cb134-6"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb134-7"><a href="#cb134-7"></a>                     <span class="at">data =</span> pruned.geno.size.data, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb134-8"><a href="#cb134-8"></a></span>
<span id="cb134-9"><a href="#cb134-9"></a></span>
<span id="cb134-10"><a href="#cb134-10"></a>gs.model2 <span class="ot">&lt;-</span> <span class="fu">gls</span>(genome.size <span class="sc">~</span> Foraging.mode <span class="sc">+</span> max.body.mass,</span>
<span id="cb134-11"><a href="#cb134-11"></a>                 <span class="at">correlation =</span></span>
<span id="cb134-12"><a href="#cb134-12"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> geno.size.tree,</span>
<span id="cb134-13"><a href="#cb134-13"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb134-14"><a href="#cb134-14"></a>                     <span class="at">data =</span> pruned.geno.size.data, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb134-15"><a href="#cb134-15"></a></span>
<span id="cb134-16"><a href="#cb134-16"></a></span>
<span id="cb134-17"><a href="#cb134-17"></a>gs.model3 <span class="ot">&lt;-</span> <span class="fu">gls</span>(genome.size <span class="sc">~</span> Foraging.mode,</span>
<span id="cb134-18"><a href="#cb134-18"></a>                 <span class="at">correlation =</span></span>
<span id="cb134-19"><a href="#cb134-19"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> geno.size.tree,</span>
<span id="cb134-20"><a href="#cb134-20"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb134-21"><a href="#cb134-21"></a>                 <span class="at">data =</span> pruned.geno.size.data, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb134-22"><a href="#cb134-22"></a></span>
<span id="cb134-23"><a href="#cb134-23"></a></span>
<span id="cb134-24"><a href="#cb134-24"></a>gs.model4 <span class="ot">&lt;-</span> <span class="fu">gls</span>(genome.size <span class="sc">~</span> max.body.mass,</span>
<span id="cb134-25"><a href="#cb134-25"></a>                 <span class="at">correlation =</span></span>
<span id="cb134-26"><a href="#cb134-26"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> geno.size.tree,</span>
<span id="cb134-27"><a href="#cb134-27"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb134-28"><a href="#cb134-28"></a>                     <span class="at">data =</span> pruned.geno.size.data, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb134-29"><a href="#cb134-29"></a></span>
<span id="cb134-30"><a href="#cb134-30"></a></span>
<span id="cb134-31"><a href="#cb134-31"></a></span>
<span id="cb134-32"><a href="#cb134-32"></a>gs.models <span class="ot">&lt;-</span> <span class="fu">anova</span>(gs.model1, gs.model2,</span>
<span id="cb134-33"><a href="#cb134-33"></a>                   gs.model3, gs.model4)</span>
<span id="cb134-34"><a href="#cb134-34"></a><span class="fu">round</span>(<span class="fu">aicw</span>(<span class="fu">setNames</span>(gs.models<span class="sc">$</span>AIC,</span>
<span id="cb134-35"><a href="#cb134-35"></a>                    <span class="fu">rownames</span>(gs.models))), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;                fit  delta     w
&gt; gs.model1 -183.671  0.000 0.952
&gt; gs.model2 -176.567  7.104 0.027
&gt; gs.model3 -175.743  7.928 0.018
&gt; gs.model4 -171.936 11.736 0.003</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1"></a>gs.lmodel1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(genome.size <span class="sc">~</span> Foraging.mode<span class="sc">*</span>max.body.mass,</span>
<span id="cb136-2"><a href="#cb136-2"></a>                 <span class="at">data =</span> pruned.geno.size.data)</span>
<span id="cb136-3"><a href="#cb136-3"></a><span class="fu">summary</span>(gs.model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; Generalized least squares fit by maximum likelihood
&gt;   Model: genome.size ~ Foraging.mode * max.body.mass 
&gt;   Data: pruned.geno.size.data 
&gt;         AIC       BIC   logLik
&gt;   -183.6711 -165.5053 98.83557
&gt; 
&gt; Correlation Structure: corBrownian
&gt;  Formula: ~Species 
&gt;  Parameter estimate(s):
&gt; numeric(0)
&gt; 
&gt; Coefficients:
&gt;                                             Value  Std.Error   t-value p-value
&gt; (Intercept)                              9.197477 0.07191465 127.89435  0.0000
&gt; Foraging.modeplastic                     0.165830 0.10861698   1.52674  0.1302
&gt; Foraging.modesit-and-wait               -0.113060 0.07824508  -1.44494  0.1518
&gt; max.body.mass                            0.017984 0.01300250   1.38313  0.1699
&gt; Foraging.modeplastic:max.body.mass      -0.047350 0.02574590  -1.83912  0.0691
&gt; Foraging.modesit-and-wait:max.body.mass  0.045629 0.02200016   2.07405  0.0408
&gt; 
&gt;  Correlation: 
&gt;                                         (Intr) Frgng. Frg.-- mx.bd. Fr.:..
&gt; Foraging.modeplastic                    -0.265                            
&gt; Foraging.modesit-and-wait               -0.300  0.266                     
&gt; max.body.mass                           -0.585  0.273  0.353              
&gt; Foraging.modeplastic:max.body.mass       0.250 -0.961 -0.307 -0.301       
&gt; Foraging.modesit-and-wait:max.body.mass  0.249 -0.219 -0.946 -0.352  0.305
&gt; 
&gt; Standardized residuals:
&gt;        Min         Q1        Med         Q3        Max 
&gt; -1.7117468 -0.5801413 -0.2588864  0.2296806  1.4662310 
&gt; 
&gt; Residual standard error: 0.1650008 
&gt; Degrees of freedom: 99 total; 93 residual</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1"></a><span class="fu">summary</span>(gs.lmodel1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 
&gt; Call:
&gt; lm(formula = genome.size ~ Foraging.mode * max.body.mass, data = pruned.geno.size.data)
&gt; 
&gt; Residuals:
&gt;       Min        1Q    Median        3Q       Max 
&gt; -0.270266 -0.037798 -0.001989  0.043396  0.201111 
&gt; 
&gt; Coefficients:
&gt;                                          Estimate Std. Error t value Pr(&gt;|t|)
&gt; (Intercept)                              9.188271   0.037249 246.673  &lt; 2e-16
&gt; Foraging.modeplastic                     0.333540   0.079544   4.193 6.27e-05
&gt; Foraging.modesit-and-wait                0.184223   0.059722   3.085 0.002684
&gt; max.body.mass                            0.004927   0.010781   0.457 0.648741
&gt; Foraging.modeplastic:max.body.mass      -0.073530   0.021608  -3.403 0.000985
&gt; Foraging.modesit-and-wait:max.body.mass -0.042431   0.017960  -2.363 0.020234
&gt;                                            
&gt; (Intercept)                             ***
&gt; Foraging.modeplastic                    ***
&gt; Foraging.modesit-and-wait               ** 
&gt; max.body.mass                              
&gt; Foraging.modeplastic:max.body.mass      ***
&gt; Foraging.modesit-and-wait:max.body.mass *  
&gt; ---
&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
&gt; 
&gt; Residual standard error: 0.08031 on 93 degrees of freedom
&gt; Multiple R-squared:  0.2673,  Adjusted R-squared:  0.2279 
&gt; F-statistic: 6.786 on 5 and 93 DF,  p-value: 1.956e-05</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1"></a><span class="do">## estimating differences in genome size mean among foraging</span></span>
<span id="cb140-2"><a href="#cb140-2"></a><span class="do">## behavior categories</span></span>
<span id="cb140-3"><a href="#cb140-3"></a></span>
<span id="cb140-4"><a href="#cb140-4"></a><span class="fu">anova</span>(gs.model1, gs.lmodel1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;            Model df       AIC       BIC    logLik
&gt; gs.model1      1  7 -183.6711 -165.5053  98.83557
&gt; gs.lmodel1     2  7 -210.5668 -192.4010 112.28340</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1"></a><span class="do">## running an anova over the most likely model</span></span>
<span id="cb142-2"><a href="#cb142-2"></a></span>
<span id="cb142-3"><a href="#cb142-3"></a><span class="fu">anova</span>(gs.lmodel1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; Analysis of Variance Table
&gt; 
&gt; Response: genome.size
&gt;                             Df  Sum Sq  Mean Sq F value   Pr(&gt;F)   
&gt; Foraging.mode                2 0.08695 0.043475  6.7405 0.001846 **
&gt; max.body.mass                1 0.04441 0.044410  6.8855 0.010157 * 
&gt; Foraging.mode:max.body.mass  2 0.08747 0.043736  6.7810 0.001782 **
&gt; Residuals                   93 0.59983 0.006450                    
&gt; ---
&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1"></a><span class="do">## computing genome size mean among foraging behavior categories</span></span>
<span id="cb144-2"><a href="#cb144-2"></a></span>
<span id="cb144-3"><a href="#cb144-3"></a><span class="fu">tapply</span>(pruned.geno.size.data<span class="sc">$</span>genome.size,</span>
<span id="cb144-4"><a href="#cb144-4"></a>       <span class="fu">list</span>(pruned.geno.size.data<span class="sc">$</span>Foraging.mode), mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;       active      plastic sit-and-wait 
&gt;     9.204597     9.278739     9.256992</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1"></a><span class="do">## plotting raw data</span></span>
<span id="cb146-2"><a href="#cb146-2"></a></span>
<span id="cb146-3"><a href="#cb146-3"></a></span>
<span id="cb146-4"><a href="#cb146-4"></a><span class="fu">dim</span>(pruned.geno.size.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] 99 29</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1"></a>pred.mod <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">max.body.mass =</span> <span class="fu">seq</span>(<span class="fu">min</span>(pruned.geno.size.data<span class="sc">$</span>max.body.mass),</span>
<span id="cb148-2"><a href="#cb148-2"></a>                                       <span class="fu">max</span>(pruned.geno.size.data<span class="sc">$</span>max.body.mass),</span>
<span id="cb148-3"><a href="#cb148-3"></a>                                       <span class="at">len =</span> <span class="dv">99</span>),</span>
<span id="cb148-4"><a href="#cb148-4"></a>                       <span class="at">Foraging.mode =</span> pruned.geno.size.data<span class="sc">$</span>Foraging.mode,</span>
<span id="cb148-5"><a href="#cb148-5"></a>                       <span class="at">row.names =</span> <span class="fu">rownames</span>(pruned.geno.size.data))</span>
<span id="cb148-6"><a href="#cb148-6"></a></span>
<span id="cb148-7"><a href="#cb148-7"></a>pred.mod<span class="sc">$</span>genome.size <span class="ot">&lt;-</span> <span class="fu">predict</span>(gs.lmodel1, pred.mod,</span>
<span id="cb148-8"><a href="#cb148-8"></a>                          <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>fit</span>
<span id="cb148-9"><a href="#cb148-9"></a>pred.mod<span class="sc">$</span>se <span class="ot">&lt;-</span> <span class="fu">predict</span>(gs.lmodel1, pred.mod,</span>
<span id="cb148-10"><a href="#cb148-10"></a>                       <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>se.fit</span>
<span id="cb148-11"><a href="#cb148-11"></a></span>
<span id="cb148-12"><a href="#cb148-12"></a></span>
<span id="cb148-13"><a href="#cb148-13"></a></span>
<span id="cb148-14"><a href="#cb148-14"></a><span class="do">## Plotting results of the model</span></span>
<span id="cb148-15"><a href="#cb148-15"></a></span>
<span id="cb148-16"><a href="#cb148-16"></a></span>
<span id="cb148-17"><a href="#cb148-17"></a></span>
<span id="cb148-18"><a href="#cb148-18"></a><span class="do">##png('./imgs/figure5.png', width = 7, height = 7, units = 'in',</span></span>
<span id="cb148-19"><a href="#cb148-19"></a><span class="do">##    res = 360)</span></span>
<span id="cb148-20"><a href="#cb148-20"></a><span class="do">##pdf('./imgs/figuer5.pdf')</span></span>
<span id="cb148-21"><a href="#cb148-21"></a></span>
<span id="cb148-22"><a href="#cb148-22"></a></span>
<span id="cb148-23"><a href="#cb148-23"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>)</span>
<span id="cb148-24"><a href="#cb148-24"></a></span>
<span id="cb148-25"><a href="#cb148-25"></a></span>
<span id="cb148-26"><a href="#cb148-26"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(genome.size <span class="sc">~</span> max.body.mass <span class="sc">|</span> Foraging.mode,</span>
<span id="cb148-27"><a href="#cb148-27"></a>       <span class="at">data =</span> pruned.geno.size.data,</span>
<span id="cb148-28"><a href="#cb148-28"></a>       <span class="at">par.settings =</span> <span class="fu">list</span>(<span class="at">layout.widths =</span></span>
<span id="cb148-29"><a href="#cb148-29"></a>                               <span class="fu">list</span>(<span class="at">ylab.axis.padding =</span> <span class="dv">1</span>)),</span>
<span id="cb148-30"><a href="#cb148-30"></a>       <span class="at">superpose =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">"p"</span>,</span>
<span id="cb148-31"><a href="#cb148-31"></a>       <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Genome size"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(Mb)),       </span>
<span id="cb148-32"><a href="#cb148-32"></a>       <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">"Maximum body mass"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(g)),</span>
<span id="cb148-33"><a href="#cb148-33"></a>       <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">grid =</span> <span class="cn">TRUE</span>,</span>
<span id="cb148-34"><a href="#cb148-34"></a>       <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">strip =</span> <span class="cn">TRUE</span>, <span class="at">group =</span> Foraging.mode,</span>
<span id="cb148-35"><a href="#cb148-35"></a>       <span class="at">col =</span> cols, <span class="at">aspect =</span> <span class="fl">0.77</span>, <span class="at">bg =</span> <span class="st">"black"</span>,</span>
<span id="cb148-36"><a href="#cb148-36"></a>       <span class="at">scale =</span> <span class="fu">list</span>(<span class="at">alternating =</span> <span class="dv">1</span>, <span class="at">tck =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)))</span>
<span id="cb148-37"><a href="#cb148-37"></a></span>
<span id="cb148-38"><a href="#cb148-38"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(genome.size <span class="sc">~</span> max.body.mass <span class="sc">|</span> Foraging.mode,</span>
<span id="cb148-39"><a href="#cb148-39"></a>       <span class="at">data =</span> pred.mod,</span>
<span id="cb148-40"><a href="#cb148-40"></a>       <span class="at">superpose =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">"l"</span>,</span>
<span id="cb148-41"><a href="#cb148-41"></a>       <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Genome size"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(Mb)),       </span>
<span id="cb148-42"><a href="#cb148-42"></a>       <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">grid =</span> <span class="cn">FALSE</span>,</span>
<span id="cb148-43"><a href="#cb148-43"></a>       <span class="at">col.line =</span> <span class="fu">c</span>(<span class="st">"#39568CFF"</span>, <span class="st">"green4"</span>, <span class="st">"#DCE319FF"</span>),</span>
<span id="cb148-44"><a href="#cb148-44"></a>       <span class="at">strip =</span> <span class="cn">TRUE</span>, <span class="at">group =</span> Foraging.mode,</span>
<span id="cb148-45"><a href="#cb148-45"></a>       <span class="at">col =</span> cols, <span class="at">aspect =</span> <span class="fl">0.77</span>, <span class="at">bg =</span> <span class="st">"black"</span>,</span>
<span id="cb148-46"><a href="#cb148-46"></a>       <span class="at">scale =</span> <span class="fu">list</span>(<span class="at">alternating =</span> <span class="dv">1</span>, <span class="at">tck =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)))</span>
<span id="cb148-47"><a href="#cb148-47"></a></span>
<span id="cb148-48"><a href="#cb148-48"></a></span>
<span id="cb148-49"><a href="#cb148-49"></a>plot1 <span class="sc">+</span> <span class="fu">as.layer</span>(plot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1"></a><span class="do">##dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1"></a>gc.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"squamate-gc-values.csv"</span>)</span>
<span id="cb150-2"><a href="#cb150-2"></a><span class="fu">str</span>(gc.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 420 obs. of  11 variables:
&gt;  $ Class      : chr  "Reptilia" "Reptilia" "Reptilia" "Reptilia" ...
&gt;  $ Order      : chr  "Crocodylia" "Crocodylia" "Crocodylia" "Crocodylia" ...
&gt;  $ Family     : chr  "Alligatoridae" "Alligatoridae" "Alligatoridae" "Alligatoridae" ...
&gt;  $ Species    : chr  "Alligator mississippiensis" "Alligator mississippiensis" "Caiman crocodilus" "Caiman crocodilus" ...
&gt;  $ Common.Name: chr  "American alligator" "American alligator" "Spectacled caiman" "Spectacled caiman" ...
&gt;  $ C.value    : num  2.49 2.66 2.68 2.82 3.01 3.91 1.35 2.84 3.95 2.84 ...
&gt;  $ Ch..Num    : chr  "32" "" "42" "" ...
&gt;  $ Method     : chr  "FD" "FCM" "FD" "FD" ...
&gt;  $ Cell.Type  : chr  "RBC" "RBC" "RBC" "RBC" ...
&gt;  $ Std.Sp.    : chr  "GD" "HS,\xcaOM" "PS" "HS" ...
&gt;  $ Refs       : chr  "324" "598" "368" "14" ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1"></a>gc.mean.data <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(gc.data<span class="sc">$</span>C.value,</span>
<span id="cb152-2"><a href="#cb152-2"></a>                          <span class="at">by =</span> <span class="fu">list</span>(gc.data<span class="sc">$</span>Species), mean)</span>
<span id="cb152-3"><a href="#cb152-3"></a><span class="fu">names</span>(gc.mean.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Species'</span>, <span class="st">'c.value'</span>)</span>
<span id="cb152-4"><a href="#cb152-4"></a>gc.mean.data<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, gc.mean.data<span class="sc">$</span>Species)</span>
<span id="cb152-5"><a href="#cb152-5"></a><span class="fu">rownames</span>(gc.mean.data) <span class="ot">&lt;-</span> gc.mean.data<span class="sc">$</span>Species</span>
<span id="cb152-6"><a href="#cb152-6"></a></span>
<span id="cb152-7"><a href="#cb152-7"></a>check <span class="ot">&lt;-</span> <span class="fu">name.check</span>(lizard.tree, gc.mean.data)</span>
<span id="cb152-8"><a href="#cb152-8"></a>rm_phy <span class="ot">&lt;-</span> check<span class="sc">$</span>tree_not_data</span>
<span id="cb152-9"><a href="#cb152-9"></a>rm_dat <span class="ot">&lt;-</span> check<span class="sc">$</span>data_not_tree</span>
<span id="cb152-10"><a href="#cb152-10"></a>gc.mean.data.tree <span class="ot">&lt;-</span> <span class="fu">drop.tip</span>(lizard.tree, rm_phy)</span>
<span id="cb152-11"><a href="#cb152-11"></a></span>
<span id="cb152-12"><a href="#cb152-12"></a>pruned.gc.mean.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(gc.mean.data,</span>
<span id="cb152-13"><a href="#cb152-13"></a>                      <span class="at">subset =</span> <span class="fu">rownames</span>(gc.mean.data) <span class="sc">%in%</span> gc.mean.data.tree<span class="sc">$</span>tip,</span>
<span id="cb152-14"><a href="#cb152-14"></a>                      <span class="at">select =</span> <span class="fu">names</span>(gc.mean.data))</span>
<span id="cb152-15"><a href="#cb152-15"></a><span class="fu">name.check</span>(gc.mean.data.tree, pruned.gc.mean.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "OK"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1"></a><span class="fu">str</span>(pruned.gc.mean.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 180 obs. of  2 variables:
&gt;  $ Species: chr  "Acanthodactylus_pardalis" "Acanthosaura_crucigera" "Agama_agama" "Agama_atra" ...
&gt;  $ c.value: num  1.44 1.45 1.7 1.47 1.51 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1"></a>gc.mean.data.tree</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 
&gt; Phylogenetic tree with 180 tips and 179 internal nodes.
&gt; 
&gt; Tip labels:
&gt;   Chelydra_serpentina, Alligator_mississippiensis, Sphenodon_punctatus, Lialis_burtonis, Coleonyx_brevis, Coleonyx_variegatus, ...
&gt; 
&gt; Rooted; includes branch length(s).</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1"></a>pruned.gc.data <span class="ot">&lt;-</span> <span class="fu">merge</span>(pruned.gc.mean.data, pruned.data, <span class="at">by =</span> <span class="st">'Species'</span>)</span>
<span id="cb158-2"><a href="#cb158-2"></a></span>
<span id="cb158-3"><a href="#cb158-3"></a><span class="fu">tapply</span>(<span class="at">X =</span> pruned.gc.data<span class="sc">$</span>Species,</span>
<span id="cb158-4"><a href="#cb158-4"></a>       <span class="at">INDEX =</span> <span class="fu">list</span>(pruned.gc.data<span class="sc">$</span>Foraging.mode),</span>
<span id="cb158-5"><a href="#cb158-5"></a>       <span class="at">FUN =</span> <span class="cf">function</span>(X) <span class="fu">length</span>(<span class="fu">na.omit</span>(X)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;       active      plastic sit-and-wait 
&gt;           41           15           38</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1"></a><span class="fu">rownames</span>(pruned.gc.data) <span class="ot">&lt;-</span> pruned.gc.data<span class="sc">$</span>Species</span>
<span id="cb160-2"><a href="#cb160-2"></a><span class="fu">names</span>(pruned.gc.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;  [1] "Species"                                                                             
&gt;  [2] "c.value"                                                                             
&gt;  [3] "Order"                                                                               
&gt;  [4] "Family"                                                                              
&gt;  [5] "Genus"                                                                               
&gt;  [6] "Main.biogeographic.region"                                                           
&gt;  [7] "Microhabitat"                                                                        
&gt;  [8] "Habitat.type"                                                                        
&gt;  [9] "Minimal.elevation..m."                                                               
&gt; [10] "Maximum.elevation..m."                                                               
&gt; [11] "Diet"                                                                                
&gt; [12] "Active.time"                                                                         
&gt; [13] "Foraging.mode"                                                                       
&gt; [14] "Maximum.Longevity..years."                                                           
&gt; [15] "Maximum.body.mass..g."                                                               
&gt; [16] "Maximum.female.length...SVL...mm..straight.carapace.length.for.turtles...SCL...mm."  
&gt; [17] "Maximum.male.length...SVL...mm..straight.carapace.length.for.turtles...SCL...mm."    
&gt; [18] "Maximum.juvenile.length...SVL...mm..straight.carapace.length.for.turtles...SCL...mm."
&gt; [19] "Hatchling.neonate.mass..g."                                                          
&gt; [20] "Reproductive.mode"                                                                   
&gt; [21] "Mean.number.of.offspring.per.litter.or.number.of.eggs.per.clutch"                    
&gt; [22] "Smallest.clutch.size"                                                                
&gt; [23] "Largest.clutch.size"                                                                 
&gt; [24] "Number.of.litters.or.clutches.produced.per.year"                                     
&gt; [25] "Egg.length..mm."                                                                     
&gt; [26] "Egg.width..mm."                                                                      
&gt; [27] "Mean.Tb"                                                                             
&gt; [28] "Minimum.Tb"                                                                          
&gt; [29] "Maximum.Tb"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1"></a><span class="fu">names</span>(pruned.gc.data)[<span class="dv">15</span>] <span class="ot">&lt;-</span> <span class="st">'max.body.mass'</span></span>
<span id="cb162-2"><a href="#cb162-2"></a>pruned.gc.data<span class="sc">$</span>max.body.mass <span class="ot">&lt;-</span> <span class="fu">log10</span>(pruned.gc.data<span class="sc">$</span>max.body.mass)</span>
<span id="cb162-3"><a href="#cb162-3"></a><span class="fu">head</span>(pruned.gc.data[ , <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">13</span>, <span class="dv">15</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;                                               Species  c.value Foraging.mode
&gt; Acanthodactylus_pardalis     Acanthodactylus_pardalis 1.440000  sit-and-wait
&gt; Agama_agama                               Agama_agama 1.696667  sit-and-wait
&gt; Agama_atra                                 Agama_atra 1.470000  sit-and-wait
&gt; Agkistrodon_contortrix         Agkistrodon_contortrix 1.370000  sit-and-wait
&gt; Ahaetulla_nasuta                     Ahaetulla_nasuta 2.070000        active
&gt; Alligator_mississippiensis Alligator_mississippiensis 2.575000       plastic
&gt;                            max.body.mass
&gt; Acanthodactylus_pardalis        1.021189
&gt; Agama_agama                     2.070038
&gt; Agama_atra                      1.980003
&gt; Agkistrodon_contortrix          3.096284
&gt; Ahaetulla_nasuta                2.833338
&gt; Alligator_mississippiensis      4.792392</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1"></a><span class="do">## modeling genome size among foraging behavior categories</span></span>
<span id="cb164-2"><a href="#cb164-2"></a></span>
<span id="cb164-3"><a href="#cb164-3"></a>gc.model1 <span class="ot">&lt;-</span> <span class="fu">gls</span>(c.value <span class="sc">~</span> Foraging.mode<span class="sc">*</span>max.body.mass,</span>
<span id="cb164-4"><a href="#cb164-4"></a>                 <span class="at">correlation =</span></span>
<span id="cb164-5"><a href="#cb164-5"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gc.mean.data.tree,</span>
<span id="cb164-6"><a href="#cb164-6"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb164-7"><a href="#cb164-7"></a>                     <span class="at">data =</span> pruned.gc.data, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb164-8"><a href="#cb164-8"></a></span>
<span id="cb164-9"><a href="#cb164-9"></a></span>
<span id="cb164-10"><a href="#cb164-10"></a>gc.model2 <span class="ot">&lt;-</span> <span class="fu">gls</span>(c.value <span class="sc">~</span> Foraging.mode <span class="sc">+</span> max.body.mass,</span>
<span id="cb164-11"><a href="#cb164-11"></a>                 <span class="at">correlation =</span></span>
<span id="cb164-12"><a href="#cb164-12"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gc.mean.data.tree,</span>
<span id="cb164-13"><a href="#cb164-13"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb164-14"><a href="#cb164-14"></a>                     <span class="at">data =</span> pruned.gc.data, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb164-15"><a href="#cb164-15"></a></span>
<span id="cb164-16"><a href="#cb164-16"></a></span>
<span id="cb164-17"><a href="#cb164-17"></a>gc.model3 <span class="ot">&lt;-</span> <span class="fu">gls</span>(c.value <span class="sc">~</span> Foraging.mode,</span>
<span id="cb164-18"><a href="#cb164-18"></a>                 <span class="at">correlation =</span></span>
<span id="cb164-19"><a href="#cb164-19"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gc.mean.data.tree,</span>
<span id="cb164-20"><a href="#cb164-20"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb164-21"><a href="#cb164-21"></a>                 <span class="at">data =</span> pruned.gc.data, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb164-22"><a href="#cb164-22"></a></span>
<span id="cb164-23"><a href="#cb164-23"></a></span>
<span id="cb164-24"><a href="#cb164-24"></a>gc.model4 <span class="ot">&lt;-</span> <span class="fu">gls</span>(c.value <span class="sc">~</span> max.body.mass,</span>
<span id="cb164-25"><a href="#cb164-25"></a>                 <span class="at">correlation =</span></span>
<span id="cb164-26"><a href="#cb164-26"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gc.mean.data.tree,</span>
<span id="cb164-27"><a href="#cb164-27"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb164-28"><a href="#cb164-28"></a>                     <span class="at">data =</span> pruned.gc.data, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb164-29"><a href="#cb164-29"></a></span>
<span id="cb164-30"><a href="#cb164-30"></a></span>
<span id="cb164-31"><a href="#cb164-31"></a></span>
<span id="cb164-32"><a href="#cb164-32"></a>gc.models <span class="ot">&lt;-</span> <span class="fu">anova</span>(gc.model1, gc.model2,</span>
<span id="cb164-33"><a href="#cb164-33"></a>                   gc.model3, gc.model4)</span>
<span id="cb164-34"><a href="#cb164-34"></a><span class="fu">round</span>(<span class="fu">aicw</span>(<span class="fu">setNames</span>(gc.models<span class="sc">$</span>AIC,</span>
<span id="cb164-35"><a href="#cb164-35"></a>                    <span class="fu">rownames</span>(gc.models))), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;               fit delta     w
&gt; gc.model1 145.619 5.358 0.052
&gt; gc.model2 144.076 3.815 0.112
&gt; gc.model3 144.668 4.406 0.083
&gt; gc.model4 140.261 0.000 0.753</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1"></a>gc.lmodel4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(c.value <span class="sc">~</span> max.body.mass,</span>
<span id="cb166-2"><a href="#cb166-2"></a>                 <span class="at">data =</span> pruned.gc.data)</span>
<span id="cb166-3"><a href="#cb166-3"></a><span class="fu">summary</span>(gc.model4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; Generalized least squares fit by maximum likelihood
&gt;   Model: c.value ~ max.body.mass 
&gt;   Data: pruned.gc.data 
&gt;        AIC      BIC    logLik
&gt;   140.2613 147.8912 -67.13066
&gt; 
&gt; Correlation Structure: corBrownian
&gt;  Formula: ~Species 
&gt;  Parameter estimate(s):
&gt; numeric(0)
&gt; 
&gt; Coefficients:
&gt;                   Value Std.Error  t-value p-value
&gt; (Intercept)   2.3978725 0.5032127 4.765127  0.0000
&gt; max.body.mass 0.1205095 0.0776448 1.552061  0.1241
&gt; 
&gt;  Correlation: 
&gt;               (Intr)
&gt; max.body.mass -0.482
&gt; 
&gt; Standardized residuals:
&gt;        Min         Q1        Med         Q3        Max 
&gt; -1.7033103 -0.9427286 -0.6175664 -0.2420427  2.2999645 
&gt; 
&gt; Residual standard error: 0.9737379 
&gt; Degrees of freedom: 94 total; 92 residual</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1"></a><span class="fu">summary</span>(gc.lmodel4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 
&gt; Call:
&gt; lm(formula = c.value ~ max.body.mass, data = pruned.gc.data)
&gt; 
&gt; Residuals:
&gt;      Min       1Q   Median       3Q      Max 
&gt; -1.06007 -0.38909 -0.05091  0.27048  2.80224 
&gt; 
&gt; Coefficients:
&gt;               Estimate Std. Error t value Pr(&gt;|t|)    
&gt; (Intercept)    1.98259    0.12286  16.137   &lt;2e-16 ***
&gt; max.body.mass  0.07152    0.04913   1.456    0.149    
&gt; ---
&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
&gt; 
&gt; Residual standard error: 0.5411 on 92 degrees of freedom
&gt; Multiple R-squared:  0.02251, Adjusted R-squared:  0.01189 
&gt; F-statistic: 2.119 on 1 and 92 DF,  p-value: 0.1489</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1"></a><span class="do">## estimating differences in genome size mean among foraging</span></span>
<span id="cb170-2"><a href="#cb170-2"></a><span class="do">## behavior categories</span></span>
<span id="cb170-3"><a href="#cb170-3"></a></span>
<span id="cb170-4"><a href="#cb170-4"></a><span class="fu">anova</span>(gc.model4, gc.lmodel4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;            Model df      AIC      BIC    logLik
&gt; gc.model4      1  3 140.2613 147.8912 -67.13066
&gt; gc.lmodel4     2  3 155.2727 162.9026 -74.63636</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1"></a><span class="do">## computing genome size mean among foraging behavior categories</span></span>
<span id="cb172-2"><a href="#cb172-2"></a></span>
<span id="cb172-3"><a href="#cb172-3"></a><span class="fu">tapply</span>(pruned.gc.data<span class="sc">$</span>c.value,</span>
<span id="cb172-4"><a href="#cb172-4"></a>       <span class="fu">list</span>(pruned.gc.data<span class="sc">$</span>Foraging.mode), mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;       active      plastic sit-and-wait 
&gt;     2.087429     2.215889     2.171513</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1"></a><span class="do">## plotting raw data</span></span>
<span id="cb174-2"><a href="#cb174-2"></a></span>
<span id="cb174-3"><a href="#cb174-3"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>)</span>
<span id="cb174-4"><a href="#cb174-4"></a></span>
<span id="cb174-5"><a href="#cb174-5"></a><span class="fu">xyplot</span>(c.value <span class="sc">~</span> max.body.mass <span class="sc">|</span> Foraging.mode,</span>
<span id="cb174-6"><a href="#cb174-6"></a>       <span class="at">data =</span> pruned.gc.data,</span>
<span id="cb174-7"><a href="#cb174-7"></a>       <span class="at">superpose =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"r"</span>),</span>
<span id="cb174-8"><a href="#cb174-8"></a>       <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"C-value"</span>),</span>
<span id="cb174-9"><a href="#cb174-9"></a>       <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">"Maximum body mass"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(g)),</span>
<span id="cb174-10"><a href="#cb174-10"></a>       <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">grid =</span> <span class="cn">TRUE</span>,</span>
<span id="cb174-11"><a href="#cb174-11"></a>       <span class="at">col.line =</span> <span class="fu">c</span>(<span class="st">"#39568CFF"</span>, <span class="st">"green4"</span>, <span class="st">"#DCE319FF"</span>),</span>
<span id="cb174-12"><a href="#cb174-12"></a>       <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">strip =</span> <span class="cn">TRUE</span>, <span class="at">group =</span> Foraging.mode,</span>
<span id="cb174-13"><a href="#cb174-13"></a>       <span class="at">col =</span> cols, <span class="at">aspect =</span> <span class="fl">0.77</span>, <span class="at">bg =</span> <span class="st">"black"</span>,</span>
<span id="cb174-14"><a href="#cb174-14"></a>       <span class="at">scale =</span> <span class="fu">list</span>(<span class="at">alternating =</span> <span class="dv">1</span>, <span class="at">tck =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1"></a>geno.alt.data <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">'genome_size_alternative.tsv'</span>,</span>
<span id="cb175-2"><a href="#cb175-2"></a>                        <span class="at">sep =</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span>)</span>
<span id="cb175-3"><a href="#cb175-3"></a><span class="fu">str</span>(geno.alt.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 384 obs. of  14 variables:
&gt;  $ taxon_id          : int  179908 91908 91909 373863 186588 1768100 8585 2563697 911496 8773 ...
&gt;  $ taxon_rank        : chr  "species" "species" "species" "species" ...
&gt;  $ scientific_name   : chr  "Chamaeleo calyptratus" "Chamaeleo dilepis" "Chamaeleo gracilis" "Chamaeleo laevigatus" ...
&gt;  $ assembly_id       : chr  "GCA_043643385.1" "GCA_043090425.1" "GCA_044758725.1" "GCA_044335405.1" ...
&gt;  $ gene_count        : int  NA NA NA NA NA NA NA NA NA NA ...
&gt;  $ assembly_level    : chr  "Chromosome" "Scaffold" "Scaffold" "Scaffold" ...
&gt;  $ assembly_span     : num  1.80e+09 1.79e+09 1.88e+09 1.91e+09 1.68e+09 ...
&gt;  $ contig_n50        : int  14096519 9578 6897 8372 2720 4622328 36526383 1528028 2440 1596756 ...
&gt;  $ scaffold_n50      : int  278718720 12659 8507 10563 3012 NA 174378910 1579101 29801607 NA ...
&gt;  $ contig_count      : int  1033 523505 920875 936478 1493175 1221 284 12847 1666908 4303 ...
&gt;  $ scaffold_count    : int  487 476822 869906 889497 1448590 NA 209 12760 1377332 NA ...
&gt;  $ chromosome_count  : int  12 NA NA NA NA NA 18 NA NA NA ...
&gt;  $ gc_percent        : num  43 42.5 43 42.5 41.5 41.5 41.5 41.5 43 40 ...
&gt;  $ busco_completeness: num  NA NA NA NA NA NA NA NA NA NA ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1"></a>geno.alt.data <span class="ot">&lt;-</span> geno.alt.data[<span class="sc">!</span><span class="fu">is.na</span>(geno.alt.data<span class="sc">$</span>assembly_span), ]</span>
<span id="cb177-2"><a href="#cb177-2"></a></span>
<span id="cb177-3"><a href="#cb177-3"></a></span>
<span id="cb177-4"><a href="#cb177-4"></a>geno.mean.alt <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(geno.alt.data<span class="sc">$</span>assembly_span,</span>
<span id="cb177-5"><a href="#cb177-5"></a>                           <span class="at">by =</span> <span class="fu">list</span>(geno.alt.data<span class="sc">$</span>scientific_name),</span>
<span id="cb177-6"><a href="#cb177-6"></a>                           mean)</span>
<span id="cb177-7"><a href="#cb177-7"></a><span class="fu">names</span>(geno.mean.alt) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Species'</span>, <span class="st">'genome.size'</span>)</span>
<span id="cb177-8"><a href="#cb177-8"></a>geno.mean.alt<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, geno.mean.alt<span class="sc">$</span>Species)</span>
<span id="cb177-9"><a href="#cb177-9"></a><span class="fu">rownames</span>(geno.mean.alt) <span class="ot">&lt;-</span> geno.mean.alt<span class="sc">$</span>Species</span>
<span id="cb177-10"><a href="#cb177-10"></a></span>
<span id="cb177-11"><a href="#cb177-11"></a>check <span class="ot">&lt;-</span> <span class="fu">name.check</span>(lizard.tree, geno.mean.alt)</span>
<span id="cb177-12"><a href="#cb177-12"></a>rm_phy <span class="ot">&lt;-</span> check<span class="sc">$</span>tree_not_data</span>
<span id="cb177-13"><a href="#cb177-13"></a>rm_dat <span class="ot">&lt;-</span> check<span class="sc">$</span>data_not_tree</span>
<span id="cb177-14"><a href="#cb177-14"></a>geno.mean.alt.tree <span class="ot">&lt;-</span> <span class="fu">drop.tip</span>(lizard.tree, rm_phy)</span>
<span id="cb177-15"><a href="#cb177-15"></a></span>
<span id="cb177-16"><a href="#cb177-16"></a>pruned.geno.mean.alt <span class="ot">&lt;-</span> <span class="fu">subset</span>(geno.mean.alt,</span>
<span id="cb177-17"><a href="#cb177-17"></a>                      <span class="at">subset =</span> <span class="fu">rownames</span>(geno.mean.alt) <span class="sc">%in%</span> geno.mean.alt.tree<span class="sc">$</span>tip,</span>
<span id="cb177-18"><a href="#cb177-18"></a>                      <span class="at">select =</span> <span class="fu">names</span>(geno.mean.alt))</span>
<span id="cb177-19"><a href="#cb177-19"></a><span class="fu">name.check</span>(geno.mean.alt.tree, pruned.geno.mean.alt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "OK"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1"></a><span class="fu">str</span>(pruned.geno.mean.alt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 216 obs. of  2 variables:
&gt;  $ Species    : chr  "Acanthocercus_atricollis" "Acrochordus_granulatus" "Agama_doriae" "Agama_finchi" ...
&gt;  $ genome.size: num  1.71e+09 1.32e+09 1.58e+09 1.33e+09 1.31e+09 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1"></a>geno.mean.alt.tree</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 
&gt; Phylogenetic tree with 216 tips and 215 internal nodes.
&gt; 
&gt; Tip labels:
&gt;   Correlophus_ciliatus, Coleonyx_elegans, Eublepharis_macularius, Euleptes_europaea, Gonatodes_alexandermendesi, Sphaerodactylus_glaucus, ...
&gt; 
&gt; Rooted; includes branch length(s).</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1"></a>pruned.geno.alt <span class="ot">&lt;-</span> <span class="fu">merge</span>(pruned.geno.mean.alt, pruned.data, <span class="at">by =</span> <span class="st">'Species'</span>)</span>
<span id="cb183-2"><a href="#cb183-2"></a></span>
<span id="cb183-3"><a href="#cb183-3"></a><span class="fu">tapply</span>(<span class="at">X =</span> pruned.geno.alt<span class="sc">$</span>Species,</span>
<span id="cb183-4"><a href="#cb183-4"></a>       <span class="at">INDEX =</span> <span class="fu">list</span>(pruned.geno.alt<span class="sc">$</span>Foraging.mode),</span>
<span id="cb183-5"><a href="#cb183-5"></a>       <span class="at">FUN =</span> <span class="cf">function</span>(X) <span class="fu">length</span>(<span class="fu">na.omit</span>(X)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;       active      plastic sit-and-wait 
&gt;           55           11           30</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1"></a><span class="fu">rownames</span>(pruned.geno.alt) <span class="ot">&lt;-</span> pruned.geno.alt<span class="sc">$</span>Species</span>
<span id="cb185-2"><a href="#cb185-2"></a><span class="fu">names</span>(pruned.geno.alt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;  [1] "Species"                                                                             
&gt;  [2] "genome.size"                                                                         
&gt;  [3] "Order"                                                                               
&gt;  [4] "Family"                                                                              
&gt;  [5] "Genus"                                                                               
&gt;  [6] "Main.biogeographic.region"                                                           
&gt;  [7] "Microhabitat"                                                                        
&gt;  [8] "Habitat.type"                                                                        
&gt;  [9] "Minimal.elevation..m."                                                               
&gt; [10] "Maximum.elevation..m."                                                               
&gt; [11] "Diet"                                                                                
&gt; [12] "Active.time"                                                                         
&gt; [13] "Foraging.mode"                                                                       
&gt; [14] "Maximum.Longevity..years."                                                           
&gt; [15] "Maximum.body.mass..g."                                                               
&gt; [16] "Maximum.female.length...SVL...mm..straight.carapace.length.for.turtles...SCL...mm."  
&gt; [17] "Maximum.male.length...SVL...mm..straight.carapace.length.for.turtles...SCL...mm."    
&gt; [18] "Maximum.juvenile.length...SVL...mm..straight.carapace.length.for.turtles...SCL...mm."
&gt; [19] "Hatchling.neonate.mass..g."                                                          
&gt; [20] "Reproductive.mode"                                                                   
&gt; [21] "Mean.number.of.offspring.per.litter.or.number.of.eggs.per.clutch"                    
&gt; [22] "Smallest.clutch.size"                                                                
&gt; [23] "Largest.clutch.size"                                                                 
&gt; [24] "Number.of.litters.or.clutches.produced.per.year"                                     
&gt; [25] "Egg.length..mm."                                                                     
&gt; [26] "Egg.width..mm."                                                                      
&gt; [27] "Mean.Tb"                                                                             
&gt; [28] "Minimum.Tb"                                                                          
&gt; [29] "Maximum.Tb"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1"></a><span class="fu">names</span>(pruned.geno.alt)[<span class="dv">15</span>] <span class="ot">&lt;-</span> <span class="st">'max.body.mass'</span></span>
<span id="cb187-2"><a href="#cb187-2"></a>pruned.geno.alt<span class="sc">$</span>max.body.mass <span class="ot">&lt;-</span> <span class="fu">log10</span>(pruned.geno.alt<span class="sc">$</span>max.body.mass)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb187-3"><a href="#cb187-3"></a>pruned.geno.alt<span class="sc">$</span>genome.size <span class="ot">&lt;-</span> <span class="fu">log10</span>(pruned.geno.alt<span class="sc">$</span>genome.size)</span>
<span id="cb187-4"><a href="#cb187-4"></a><span class="fu">head</span>(pruned.geno.alt[ , <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">13</span>, <span class="dv">15</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;                                           Species genome.size Foraging.mode
&gt; Acanthocercus_atricollis Acanthocercus_atricollis    9.234190  sit-and-wait
&gt; Acrochordus_granulatus     Acrochordus_granulatus    9.122068        active
&gt; Agkistrodon_piscivorus     Agkistrodon_piscivorus    9.116082        active
&gt; Ahaetulla_nasuta                 Ahaetulla_nasuta    9.159714        active
&gt; Aipysurus_laevis                 Aipysurus_laevis    9.316883        active
&gt; Ameiva_ameiva                       Ameiva_ameiva    9.252196        active
&gt;                          max.body.mass
&gt; Acanthocercus_atricollis      3.249932
&gt; Acrochordus_granulatus        3.478133
&gt; Agkistrodon_piscivorus        4.522835
&gt; Ahaetulla_nasuta              3.833338
&gt; Aipysurus_laevis              4.126586
&gt; Ameiva_ameiva                 3.480007</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1"></a><span class="do">## modeling genome size among foraging behavior categories</span></span>
<span id="cb189-2"><a href="#cb189-2"></a></span>
<span id="cb189-3"><a href="#cb189-3"></a>gs.alt1 <span class="ot">&lt;-</span> <span class="fu">gls</span>(genome.size <span class="sc">~</span> Foraging.mode<span class="sc">*</span>max.body.mass,</span>
<span id="cb189-4"><a href="#cb189-4"></a>                 <span class="at">correlation =</span></span>
<span id="cb189-5"><a href="#cb189-5"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> geno.mean.alt.tree,</span>
<span id="cb189-6"><a href="#cb189-6"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb189-7"><a href="#cb189-7"></a>                     <span class="at">data =</span> pruned.geno.alt, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb189-8"><a href="#cb189-8"></a></span>
<span id="cb189-9"><a href="#cb189-9"></a></span>
<span id="cb189-10"><a href="#cb189-10"></a>gs.alt2 <span class="ot">&lt;-</span> <span class="fu">gls</span>(genome.size <span class="sc">~</span> Foraging.mode <span class="sc">+</span> max.body.mass,</span>
<span id="cb189-11"><a href="#cb189-11"></a>                 <span class="at">correlation =</span></span>
<span id="cb189-12"><a href="#cb189-12"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> geno.mean.alt.tree,</span>
<span id="cb189-13"><a href="#cb189-13"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb189-14"><a href="#cb189-14"></a>                     <span class="at">data =</span> pruned.geno.alt, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb189-15"><a href="#cb189-15"></a></span>
<span id="cb189-16"><a href="#cb189-16"></a></span>
<span id="cb189-17"><a href="#cb189-17"></a>gs.alt3 <span class="ot">&lt;-</span> <span class="fu">gls</span>(genome.size <span class="sc">~</span> Foraging.mode,</span>
<span id="cb189-18"><a href="#cb189-18"></a>                 <span class="at">correlation =</span></span>
<span id="cb189-19"><a href="#cb189-19"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> geno.mean.alt.tree,</span>
<span id="cb189-20"><a href="#cb189-20"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb189-21"><a href="#cb189-21"></a>                 <span class="at">data =</span> pruned.geno.alt, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb189-22"><a href="#cb189-22"></a></span>
<span id="cb189-23"><a href="#cb189-23"></a></span>
<span id="cb189-24"><a href="#cb189-24"></a>gs.alt4 <span class="ot">&lt;-</span> <span class="fu">gls</span>(genome.size <span class="sc">~</span> max.body.mass,</span>
<span id="cb189-25"><a href="#cb189-25"></a>                 <span class="at">correlation =</span></span>
<span id="cb189-26"><a href="#cb189-26"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> geno.mean.alt.tree,</span>
<span id="cb189-27"><a href="#cb189-27"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb189-28"><a href="#cb189-28"></a>                     <span class="at">data =</span> pruned.geno.alt, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb189-29"><a href="#cb189-29"></a></span>
<span id="cb189-30"><a href="#cb189-30"></a></span>
<span id="cb189-31"><a href="#cb189-31"></a></span>
<span id="cb189-32"><a href="#cb189-32"></a>gs.alts <span class="ot">&lt;-</span> <span class="fu">anova</span>(gs.alt1, gs.alt2,</span>
<span id="cb189-33"><a href="#cb189-33"></a>                   gs.alt3, gs.alt4)</span>
<span id="cb189-34"><a href="#cb189-34"></a><span class="fu">round</span>(<span class="fu">aicw</span>(<span class="fu">setNames</span>(gs.alts<span class="sc">$</span>AIC,</span>
<span id="cb189-35"><a href="#cb189-35"></a>                    <span class="fu">rownames</span>(gs.alts))), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;              fit  delta     w
&gt; gs.alt1 -155.524  0.000 0.987
&gt; gs.alt2 -145.859  9.665 0.008
&gt; gs.alt3 -144.917 10.607 0.005
&gt; gs.alt4 -134.102 21.422 0.000</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1"></a>gs.lalt1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(genome.size <span class="sc">~</span> Foraging.mode<span class="sc">*</span>max.body.mass,</span>
<span id="cb191-2"><a href="#cb191-2"></a>                 <span class="at">data =</span> pruned.geno.alt)</span>
<span id="cb191-3"><a href="#cb191-3"></a><span class="fu">summary</span>(gs.alt1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; Generalized least squares fit by maximum likelihood
&gt;   Model: genome.size ~ Foraging.mode * max.body.mass 
&gt;   Data: pruned.geno.alt 
&gt;         AIC       BIC   logLik
&gt;   -155.5237 -137.5733 84.76185
&gt; 
&gt; Correlation Structure: corBrownian
&gt;  Formula: ~Species 
&gt;  Parameter estimate(s):
&gt; numeric(0)
&gt; 
&gt; Coefficients:
&gt;                                             Value  Std.Error   t-value p-value
&gt; (Intercept)                              9.202573 0.08117893 113.36160  0.0000
&gt; Foraging.modeplastic                     0.164068 0.12907079   1.27115  0.2070
&gt; Foraging.modesit-and-wait               -0.160497 0.08853348  -1.81284  0.0732
&gt; max.body.mass                            0.018472 0.01481512   1.24684  0.2157
&gt; Foraging.modeplastic:max.body.mass      -0.054507 0.03067567  -1.77689  0.0790
&gt; Foraging.modesit-and-wait:max.body.mass  0.063031 0.02498212   2.52306  0.0134
&gt; 
&gt;  Correlation: 
&gt;                                         (Intr) Frgng. Frg.-- mx.bd. Fr.:..
&gt; Foraging.modeplastic                    -0.250                            
&gt; Foraging.modesit-and-wait               -0.306  0.272                     
&gt; max.body.mass                           -0.587  0.271  0.365              
&gt; Foraging.modeplastic:max.body.mass       0.243 -0.961 -0.318 -0.310       
&gt; Foraging.modesit-and-wait:max.body.mass  0.258 -0.226 -0.946 -0.370  0.318
&gt; 
&gt; Standardized residuals:
&gt;        Min         Q1        Med         Q3        Max 
&gt; -2.0481082 -0.6204185 -0.2838241  0.2057147  1.3882693 
&gt; 
&gt; Residual standard error: 0.1853698 
&gt; Degrees of freedom: 96 total; 90 residual</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1"></a><span class="fu">summary</span>(gs.lalt1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 
&gt; Call:
&gt; lm(formula = genome.size ~ Foraging.mode * max.body.mass, data = pruned.geno.alt)
&gt; 
&gt; Residuals:
&gt;      Min       1Q   Median       3Q      Max 
&gt; -0.38416 -0.03971 -0.00178  0.04479  0.20197 
&gt; 
&gt; Coefficients:
&gt;                                          Estimate Std. Error t value Pr(&gt;|t|)
&gt; (Intercept)                              9.195035   0.042679 215.449  &lt; 2e-16
&gt; Foraging.modeplastic                     0.344046   0.089672   3.837 0.000231
&gt; Foraging.modesit-and-wait                0.178154   0.066377   2.684 0.008659
&gt; max.body.mass                            0.003001   0.012541   0.239 0.811417
&gt; Foraging.modeplastic:max.body.mass      -0.077644   0.024205  -3.208 0.001854
&gt; Foraging.modesit-and-wait:max.body.mass -0.041127   0.019912  -2.066 0.041750
&gt;                                            
&gt; (Intercept)                             ***
&gt; Foraging.modeplastic                    ***
&gt; Foraging.modesit-and-wait               ** 
&gt; max.body.mass                              
&gt; Foraging.modeplastic:max.body.mass      ** 
&gt; Foraging.modesit-and-wait:max.body.mass *  
&gt; ---
&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
&gt; 
&gt; Residual standard error: 0.0882 on 90 degrees of freedom
&gt; Multiple R-squared:  0.239,   Adjusted R-squared:  0.1967 
&gt; F-statistic: 5.652 on 5 and 90 DF,  p-value: 0.000141</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1"></a><span class="do">## estimating differences in genome size mean among foraging</span></span>
<span id="cb195-2"><a href="#cb195-2"></a><span class="do">## behavior categories</span></span>
<span id="cb195-3"><a href="#cb195-3"></a></span>
<span id="cb195-4"><a href="#cb195-4"></a><span class="fu">anova</span>(gs.alt1, gs.lalt1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;          Model df       AIC       BIC   logLik
&gt; gs.alt1      1  7 -155.5237 -137.5733 84.76185
&gt; gs.lalt1     2  7 -185.9664 -168.0159 99.98319</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1"></a><span class="do">## running anova over the most likely model</span></span>
<span id="cb197-2"><a href="#cb197-2"></a></span>
<span id="cb197-3"><a href="#cb197-3"></a><span class="fu">anova</span>(gs.lalt1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; Analysis of Variance Table
&gt; 
&gt; Response: genome.size
&gt;                             Df  Sum Sq  Mean Sq F value   Pr(&gt;F)   
&gt; Foraging.mode                2 0.07099 0.035495  4.5629 0.012957 * 
&gt; max.body.mass                1 0.05976 0.059757  7.6818 0.006778 **
&gt; Foraging.mode:max.body.mass  2 0.08908 0.044539  5.7255 0.004564 **
&gt; Residuals                   90 0.70011 0.007779                    
&gt; ---
&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1"></a><span class="do">## computing genome size mean among foraging behavior categories</span></span>
<span id="cb199-2"><a href="#cb199-2"></a></span>
<span id="cb199-3"><a href="#cb199-3"></a><span class="fu">tapply</span>(pruned.geno.alt<span class="sc">$</span>genome.size,</span>
<span id="cb199-4"><a href="#cb199-4"></a>       <span class="fu">list</span>(pruned.geno.alt<span class="sc">$</span>Foraging.mode), mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;       active      plastic sit-and-wait 
&gt;     9.204843     9.271399     9.254318</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1"></a><span class="do">## plotting raw data</span></span>
<span id="cb201-2"><a href="#cb201-2"></a></span>
<span id="cb201-3"><a href="#cb201-3"></a><span class="fu">dim</span>(pruned.geno.alt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] 96 29</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1"></a>pred.mod <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">max.body.mass =</span> <span class="fu">seq</span>(<span class="fu">min</span>(pruned.geno.alt<span class="sc">$</span>max.body.mass),</span>
<span id="cb203-2"><a href="#cb203-2"></a>                                       <span class="fu">max</span>(pruned.geno.alt<span class="sc">$</span>max.body.mass),</span>
<span id="cb203-3"><a href="#cb203-3"></a>                                       <span class="at">len =</span> <span class="dv">96</span>),</span>
<span id="cb203-4"><a href="#cb203-4"></a>                       <span class="at">Foraging.mode =</span> pruned.geno.alt<span class="sc">$</span>Foraging.mode,</span>
<span id="cb203-5"><a href="#cb203-5"></a>                       <span class="at">row.names =</span> <span class="fu">rownames</span>(pruned.geno.alt))</span>
<span id="cb203-6"><a href="#cb203-6"></a></span>
<span id="cb203-7"><a href="#cb203-7"></a>pred.mod<span class="sc">$</span>genome.size <span class="ot">&lt;-</span> <span class="fu">predict</span>(gs.lalt1, pred.mod,</span>
<span id="cb203-8"><a href="#cb203-8"></a>                          <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>fit</span>
<span id="cb203-9"><a href="#cb203-9"></a>pred.mod<span class="sc">$</span>se <span class="ot">&lt;-</span> <span class="fu">predict</span>(gs.lalt1, pred.mod,</span>
<span id="cb203-10"><a href="#cb203-10"></a>                       <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>se.fit</span>
<span id="cb203-11"><a href="#cb203-11"></a></span>
<span id="cb203-12"><a href="#cb203-12"></a></span>
<span id="cb203-13"><a href="#cb203-13"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>)</span>
<span id="cb203-14"><a href="#cb203-14"></a></span>
<span id="cb203-15"><a href="#cb203-15"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(genome.size <span class="sc">~</span> max.body.mass <span class="sc">|</span> Foraging.mode,</span>
<span id="cb203-16"><a href="#cb203-16"></a>       <span class="at">data =</span> pruned.geno.alt,</span>
<span id="cb203-17"><a href="#cb203-17"></a>       <span class="at">superpose =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">"p"</span>,</span>
<span id="cb203-18"><a href="#cb203-18"></a>       <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Genome size"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(Mb)),</span>
<span id="cb203-19"><a href="#cb203-19"></a>       <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">"Maximum body mass"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">+</span><span class="dv">1</span><span class="sc">~</span>(g)),</span>
<span id="cb203-20"><a href="#cb203-20"></a>       <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">grid =</span> <span class="cn">TRUE</span>,</span>
<span id="cb203-21"><a href="#cb203-21"></a>       <span class="at">col.line =</span> <span class="fu">c</span>(<span class="st">"#39568CFF"</span>, <span class="st">"green4"</span>, <span class="st">"#DCE319FF"</span>),</span>
<span id="cb203-22"><a href="#cb203-22"></a>       <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">strip =</span> <span class="cn">TRUE</span>, <span class="at">group =</span> Foraging.mode,</span>
<span id="cb203-23"><a href="#cb203-23"></a>       <span class="at">col =</span> cols, <span class="at">aspect =</span> <span class="fl">0.77</span>, <span class="at">bg =</span> <span class="st">"black"</span>,</span>
<span id="cb203-24"><a href="#cb203-24"></a>       <span class="at">scale =</span> <span class="fu">list</span>(<span class="at">alternating =</span> <span class="dv">1</span>, <span class="at">tck =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)))</span>
<span id="cb203-25"><a href="#cb203-25"></a></span>
<span id="cb203-26"><a href="#cb203-26"></a></span>
<span id="cb203-27"><a href="#cb203-27"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(genome.size <span class="sc">~</span> max.body.mass <span class="sc">|</span> Foraging.mode,</span>
<span id="cb203-28"><a href="#cb203-28"></a>       <span class="at">data =</span> pred.mod,</span>
<span id="cb203-29"><a href="#cb203-29"></a>       <span class="at">superpose =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">"l"</span>,</span>
<span id="cb203-30"><a href="#cb203-30"></a>       <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">grid =</span> <span class="cn">FALSE</span>,</span>
<span id="cb203-31"><a href="#cb203-31"></a>       <span class="at">col.line =</span> <span class="fu">c</span>(<span class="st">"#39568CFF"</span>, <span class="st">"green4"</span>, <span class="st">"#DCE319FF"</span>),</span>
<span id="cb203-32"><a href="#cb203-32"></a>       <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">strip =</span> <span class="cn">TRUE</span>, <span class="at">group =</span> Foraging.mode,</span>
<span id="cb203-33"><a href="#cb203-33"></a>       <span class="at">col =</span> cols, <span class="at">aspect =</span> <span class="fl">0.77</span>, <span class="at">bg =</span> <span class="st">"black"</span>,</span>
<span id="cb203-34"><a href="#cb203-34"></a>       <span class="at">scale =</span> <span class="fu">list</span>(<span class="at">alternating =</span> <span class="dv">1</span>, <span class="at">tck =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)))</span>
<span id="cb203-35"><a href="#cb203-35"></a></span>
<span id="cb203-36"><a href="#cb203-36"></a>plot1 <span class="sc">+</span> <span class="fu">as.layer</span>(plot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1"></a><span class="do">## model diagnosis</span></span>
<span id="cb204-2"><a href="#cb204-2"></a></span>
<span id="cb204-3"><a href="#cb204-3"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb204-4"><a href="#cb204-4"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb204-5"><a href="#cb204-5"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb204-6"><a href="#cb204-6"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb204-7"><a href="#cb204-7"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb204-8"><a href="#cb204-8"></a></span>
<span id="cb204-9"><a href="#cb204-9"></a><span class="fu">par</span>(<span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb204-10"><a href="#cb204-10"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(gs.lmodel1), <span class="fu">resid</span>(gs.lmodel1),</span>
<span id="cb204-11"><a href="#cb204-11"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb204-12"><a href="#cb204-12"></a>     <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">xlab =</span> <span class="st">''</span>)</span>
<span id="cb204-13"><a href="#cb204-13"></a></span>
<span id="cb204-14"><a href="#cb204-14"></a><span class="fu">grid</span>()</span>
<span id="cb204-15"><a href="#cb204-15"></a></span>
<span id="cb204-16"><a href="#cb204-16"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb204-17"><a href="#cb204-17"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(gs.lmodel1), <span class="fu">resid</span>(gs.lmodel1),</span>
<span id="cb204-18"><a href="#cb204-18"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">"Fitted"</span>,</span>
<span id="cb204-19"><a href="#cb204-19"></a>     <span class="at">ylab =</span> <span class="st">"Residual"</span>, <span class="at">main =</span> <span class="st">"Fitted versus Residuals"</span>,</span>
<span id="cb204-20"><a href="#cb204-20"></a>     <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb204-21"><a href="#cb204-21"></a></span>
<span id="cb204-22"><a href="#cb204-22"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"darkorange"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb204-23"><a href="#cb204-23"></a></span>
<span id="cb204-24"><a href="#cb204-24"></a></span>
<span id="cb204-25"><a href="#cb204-25"></a><span class="do">## Checking normality</span></span>
<span id="cb204-26"><a href="#cb204-26"></a></span>
<span id="cb204-27"><a href="#cb204-27"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(gs.lmodel1), <span class="at">col =</span> <span class="st">"darkgrey"</span>,</span>
<span id="cb204-28"><a href="#cb204-28"></a>       <span class="at">type =</span> <span class="st">'n'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="st">''</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb204-29"><a href="#cb204-29"></a>       <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb204-30"><a href="#cb204-30"></a></span>
<span id="cb204-31"><a href="#cb204-31"></a><span class="fu">grid</span>()</span>
<span id="cb204-32"><a href="#cb204-32"></a></span>
<span id="cb204-33"><a href="#cb204-33"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb204-34"><a href="#cb204-34"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(gs.lmodel1), <span class="at">col =</span> <span class="st">"darkgrey"</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb204-35"><a href="#cb204-35"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(gs.lmodel1), <span class="at">col =</span> <span class="st">"dodgerblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1"></a><span class="do">## setting up the data of protein coding genes</span></span>
<span id="cb205-2"><a href="#cb205-2"></a></span>
<span id="cb205-3"><a href="#cb205-3"></a><span class="fu">names</span>(genome.annotation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;  [1] "species"              "genome.size"          "chr.number"          
&gt;  [4] "assem.level"          "contig.N50"           "scaffold.N50"        
&gt;  [7] "BUSCO.single.copy"    "BUSCO.duplicate"      "total.gene.number"   
&gt; [10] "protein.coding.genes" "pseudogene.number"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1"></a>new.mat <span class="ot">&lt;-</span> genome.annotation[<span class="sc">!</span><span class="fu">is.na</span>(genome.annotation<span class="sc">$</span>protein.coding.genes), ]</span>
<span id="cb207-2"><a href="#cb207-2"></a><span class="fu">names</span>(new.mat)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">'Species'</span></span>
<span id="cb207-3"><a href="#cb207-3"></a><span class="fu">dim</span>(new.mat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] 43 11</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1"></a>gen.mat <span class="ot">&lt;-</span> <span class="fu">merge</span>(pruned.data, new.mat, <span class="at">by =</span> <span class="st">'Species'</span>)</span>
<span id="cb209-2"><a href="#cb209-2"></a>gen.mat <span class="ot">&lt;-</span> gen.mat[ , <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">29</span>, <span class="dv">36</span><span class="sc">:</span><span class="dv">38</span>)]</span>
<span id="cb209-3"><a href="#cb209-3"></a><span class="fu">names</span>(gen.mat)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">'max.body.mass'</span></span>
<span id="cb209-4"><a href="#cb209-4"></a></span>
<span id="cb209-5"><a href="#cb209-5"></a>cod.mat <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(gen.mat[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">7</span>)], <span class="fu">list</span>(gen.mat<span class="sc">$</span>Species, gen.mat<span class="sc">$</span>Foraging.mode), mean)</span>
<span id="cb209-6"><a href="#cb209-6"></a><span class="fu">names</span>(cod.mat)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Species'</span>, <span class="st">'Foraging.mode'</span>)</span>
<span id="cb209-7"><a href="#cb209-7"></a><span class="fu">rownames</span>(cod.mat) <span class="ot">&lt;-</span> cod.mat<span class="sc">$</span>Species</span>
<span id="cb209-8"><a href="#cb209-8"></a></span>
<span id="cb209-9"><a href="#cb209-9"></a>check <span class="ot">&lt;-</span> <span class="fu">name.check</span>(lizard.tree, cod.mat)</span>
<span id="cb209-10"><a href="#cb209-10"></a>rm_phy <span class="ot">&lt;-</span> check<span class="sc">$</span>tree_not_data</span>
<span id="cb209-11"><a href="#cb209-11"></a>rm_dat <span class="ot">&lt;-</span> check<span class="sc">$</span>data_not_tree</span>
<span id="cb209-12"><a href="#cb209-12"></a>gen.tree <span class="ot">&lt;-</span> <span class="fu">drop.tip</span>(lizard.tree, rm_phy)</span>
<span id="cb209-13"><a href="#cb209-13"></a></span>
<span id="cb209-14"><a href="#cb209-14"></a>prot.mat <span class="ot">&lt;-</span> <span class="fu">subset</span>(cod.mat,</span>
<span id="cb209-15"><a href="#cb209-15"></a>                      <span class="at">subset =</span> <span class="fu">rownames</span>(cod.mat) <span class="sc">%in%</span> gen.tree<span class="sc">$</span>tip,</span>
<span id="cb209-16"><a href="#cb209-16"></a>                      <span class="at">select =</span> <span class="fu">names</span>(cod.mat))</span>
<span id="cb209-17"><a href="#cb209-17"></a><span class="fu">name.check</span>(gen.tree, prot.mat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; [1] "OK"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1"></a><span class="fu">str</span>(prot.mat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 20 obs. of  6 variables:
&gt;  $ Species             : chr  "Lacerta_agilis" "Ophiophagus_hannah" "Pituophis_catenifer" "Podarcis_lilfordi" ...
&gt;  $ Foraging.mode       : Factor w/ 3 levels "active","plastic",..: 1 1 1 1 1 1 2 2 2 2 ...
&gt;  $ max.body.mass       : num  33.9 17723.3 1586.3 12.3 377.2 ...
&gt;  $ genome.size         : num  1.39e+09 1.59e+09 1.68e+09 1.46e+09 1.67e+09 ...
&gt;  $ total.gene.number   : num  23190 18579 19833 991319 21688 ...
&gt;  $ protein.coding.genes: num  20325 18445 17434 25676 18900 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1"></a>gen.tree</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 
&gt; Phylogenetic tree with 20 tips and 19 internal nodes.
&gt; 
&gt; Tip labels:
&gt;   Eublepharis_macularius, Heteronotia_binoei, Hemicordylus_capensis, Podarcis_lilfordi, Lacerta_agilis, Zootoca_vivipara, ...
&gt; 
&gt; Rooted; includes branch length(s).</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1"></a>log.prot.mat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">apply</span>(prot.mat[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)], <span class="dv">2</span>, log10))</span>
<span id="cb215-2"><a href="#cb215-2"></a>log.prot.mat<span class="sc">$</span>Species <span class="ot">&lt;-</span> prot.mat<span class="sc">$</span>Species</span>
<span id="cb215-3"><a href="#cb215-3"></a>log.prot.mat<span class="sc">$</span>Foraging.mode <span class="ot">&lt;-</span> prot.mat<span class="sc">$</span>Foraging.mode</span>
<span id="cb215-4"><a href="#cb215-4"></a>log.prot.mat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;                              max.body.mass genome.size total.gene.number
&gt; Lacerta_agilis                   1.5301997    9.143448          4.365301
&gt; Ophiophagus_hannah               4.2485446    9.202509          4.269022
&gt; Pituophis_catenifer              3.2003853    9.226053          4.297388
&gt; Podarcis_lilfordi                1.0899051    9.164378          5.996213
&gt; Thamnophis_elegans               2.5765717    9.223286          4.336220
&gt; Thamnophis_sirtalis              2.9356584    9.153784          4.302677
&gt; Elgaria_multicarinata            2.0700379    9.252974          4.337419
&gt; Heteronotia_binoei               0.5563025    9.420525          4.404320
&gt; Pantherophis_guttatus            2.7353593    9.232369          4.414823
&gt; Pogona_vitticeps                 2.7599699    9.234688          4.342304
&gt; Varanus_komodoensis              5.0399999    9.178386          4.286995
&gt; Anolis_carolinensis              0.9395193    9.261247          4.392934
&gt; Anolis_sagrei                    0.9395193    9.287494          4.362501
&gt; Crotalus_adamanteus              3.8825644    9.216668          4.053789
&gt; Eublepharis_macularius           2.0599419    9.349740          4.380663
&gt; Hemicordylus_capensis            1.5599066    9.360736          4.493305
&gt; Phrynosoma_platyrhinos           1.4393327    9.279174          4.514707
&gt; Protobothrops_mucrosquamatus     3.0289777    9.223719          4.349608
&gt; Sceloporus_undulatus             1.3891661    9.280005          4.370013
&gt; Zootoca_vivipara                 1.0293838    9.162045          4.358449
&gt;                              protein.coding.genes                      Species
&gt; Lacerta_agilis                           4.308031               Lacerta_agilis
&gt; Ophiophagus_hannah                       4.265879           Ophiophagus_hannah
&gt; Pituophis_catenifer                      4.241397          Pituophis_catenifer
&gt; Podarcis_lilfordi                        4.409527            Podarcis_lilfordi
&gt; Thamnophis_elegans                       4.276462           Thamnophis_elegans
&gt; Thamnophis_sirtalis                      4.268695          Thamnophis_sirtalis
&gt; Elgaria_multicarinata                    4.291435        Elgaria_multicarinata
&gt; Heteronotia_binoei                       4.315593           Heteronotia_binoei
&gt; Pantherophis_guttatus                    4.300650        Pantherophis_guttatus
&gt; Pogona_vitticeps                         4.276255             Pogona_vitticeps
&gt; Varanus_komodoensis                      4.258410          Varanus_komodoensis
&gt; Anolis_carolinensis                      4.298842          Anolis_carolinensis
&gt; Anolis_sagrei                            4.302298                Anolis_sagrei
&gt; Crotalus_adamanteus                      4.053789          Crotalus_adamanteus
&gt; Eublepharis_macularius                   4.311097       Eublepharis_macularius
&gt; Hemicordylus_capensis                    4.327134        Hemicordylus_capensis
&gt; Phrynosoma_platyrhinos                   4.224015       Phrynosoma_platyrhinos
&gt; Protobothrops_mucrosquamatus             4.311923 Protobothrops_mucrosquamatus
&gt; Sceloporus_undulatus                     4.298962         Sceloporus_undulatus
&gt; Zootoca_vivipara                         4.306157             Zootoca_vivipara
&gt;                              Foraging.mode
&gt; Lacerta_agilis                      active
&gt; Ophiophagus_hannah                  active
&gt; Pituophis_catenifer                 active
&gt; Podarcis_lilfordi                   active
&gt; Thamnophis_elegans                  active
&gt; Thamnophis_sirtalis                 active
&gt; Elgaria_multicarinata              plastic
&gt; Heteronotia_binoei                 plastic
&gt; Pantherophis_guttatus              plastic
&gt; Pogona_vitticeps                   plastic
&gt; Varanus_komodoensis                plastic
&gt; Anolis_carolinensis           sit-and-wait
&gt; Anolis_sagrei                 sit-and-wait
&gt; Crotalus_adamanteus           sit-and-wait
&gt; Eublepharis_macularius        sit-and-wait
&gt; Hemicordylus_capensis         sit-and-wait
&gt; Phrynosoma_platyrhinos        sit-and-wait
&gt; Protobothrops_mucrosquamatus  sit-and-wait
&gt; Sceloporus_undulatus          sit-and-wait
&gt; Zootoca_vivipara              sit-and-wait</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1"></a>log.prot.mat <span class="ot">&lt;-</span> log.prot.mat[log.prot.mat<span class="sc">$</span>protein.coding.genes <span class="sc">&lt;</span> <span class="fl">4.35</span> <span class="sc">&amp;</span> log.prot.mat<span class="sc">$</span>protein.coding.genes <span class="sc">&gt;</span> <span class="fl">4.23</span>, ]</span>
<span id="cb217-2"><a href="#cb217-2"></a></span>
<span id="cb217-3"><a href="#cb217-3"></a></span>
<span id="cb217-4"><a href="#cb217-4"></a>gene.model1 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> Foraging.mode<span class="sc">*</span>max.body.mass <span class="sc">+</span></span>
<span id="cb217-5"><a href="#cb217-5"></a>                    total.gene.number <span class="sc">+</span> genome.size,</span>
<span id="cb217-6"><a href="#cb217-6"></a>    <span class="at">correlation =</span></span>
<span id="cb217-7"><a href="#cb217-7"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb217-8"><a href="#cb217-8"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb217-9"><a href="#cb217-9"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb217-10"><a href="#cb217-10"></a></span>
<span id="cb217-11"><a href="#cb217-11"></a></span>
<span id="cb217-12"><a href="#cb217-12"></a>gene.model2 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> Foraging.mode<span class="sc">*</span>total.gene.number <span class="sc">+</span></span>
<span id="cb217-13"><a href="#cb217-13"></a>                    max.body.mass <span class="sc">+</span> genome.size,</span>
<span id="cb217-14"><a href="#cb217-14"></a>                 <span class="at">correlation =</span></span>
<span id="cb217-15"><a href="#cb217-15"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb217-16"><a href="#cb217-16"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb217-17"><a href="#cb217-17"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb217-18"><a href="#cb217-18"></a></span>
<span id="cb217-19"><a href="#cb217-19"></a>gene.model3 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> Foraging.mode<span class="sc">*</span>genome.size <span class="sc">+</span></span>
<span id="cb217-20"><a href="#cb217-20"></a>                    max.body.mass <span class="sc">+</span> total.gene.number,</span>
<span id="cb217-21"><a href="#cb217-21"></a>                 <span class="at">correlation =</span></span>
<span id="cb217-22"><a href="#cb217-22"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb217-23"><a href="#cb217-23"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb217-24"><a href="#cb217-24"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb217-25"><a href="#cb217-25"></a></span>
<span id="cb217-26"><a href="#cb217-26"></a>gene.model4 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> Foraging.mode <span class="sc">+</span> genome.size <span class="sc">+</span></span>
<span id="cb217-27"><a href="#cb217-27"></a>                    max.body.mass <span class="sc">+</span> total.gene.number,</span>
<span id="cb217-28"><a href="#cb217-28"></a>                 <span class="at">correlation =</span></span>
<span id="cb217-29"><a href="#cb217-29"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb217-30"><a href="#cb217-30"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb217-31"><a href="#cb217-31"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb217-32"><a href="#cb217-32"></a></span>
<span id="cb217-33"><a href="#cb217-33"></a>gene.model5 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> Foraging.mode <span class="sc">+</span> genome.size <span class="sc">+</span></span>
<span id="cb217-34"><a href="#cb217-34"></a>                    max.body.mass,</span>
<span id="cb217-35"><a href="#cb217-35"></a>                 <span class="at">correlation =</span></span>
<span id="cb217-36"><a href="#cb217-36"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb217-37"><a href="#cb217-37"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb217-38"><a href="#cb217-38"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb217-39"><a href="#cb217-39"></a></span>
<span id="cb217-40"><a href="#cb217-40"></a>gene.model6 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> Foraging.mode <span class="sc">+</span> genome.size <span class="sc">+</span></span>
<span id="cb217-41"><a href="#cb217-41"></a>                    total.gene.number,</span>
<span id="cb217-42"><a href="#cb217-42"></a>                 <span class="at">correlation =</span></span>
<span id="cb217-43"><a href="#cb217-43"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb217-44"><a href="#cb217-44"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb217-45"><a href="#cb217-45"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb217-46"><a href="#cb217-46"></a></span>
<span id="cb217-47"><a href="#cb217-47"></a>gene.model7 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> Foraging.mode <span class="sc">+</span> genome.size,</span>
<span id="cb217-48"><a href="#cb217-48"></a>                 <span class="at">correlation =</span></span>
<span id="cb217-49"><a href="#cb217-49"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb217-50"><a href="#cb217-50"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb217-51"><a href="#cb217-51"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb217-52"><a href="#cb217-52"></a></span>
<span id="cb217-53"><a href="#cb217-53"></a>gene.model8 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> Foraging.mode <span class="sc">+</span> total.gene.number,</span>
<span id="cb217-54"><a href="#cb217-54"></a>                 <span class="at">correlation =</span></span>
<span id="cb217-55"><a href="#cb217-55"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb217-56"><a href="#cb217-56"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb217-57"><a href="#cb217-57"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb217-58"><a href="#cb217-58"></a></span>
<span id="cb217-59"><a href="#cb217-59"></a>gene.model9 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> Foraging.mode <span class="sc">+</span> max.body.mass,</span>
<span id="cb217-60"><a href="#cb217-60"></a>                 <span class="at">correlation =</span></span>
<span id="cb217-61"><a href="#cb217-61"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb217-62"><a href="#cb217-62"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb217-63"><a href="#cb217-63"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb217-64"><a href="#cb217-64"></a></span>
<span id="cb217-65"><a href="#cb217-65"></a>gene.model10 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> Foraging.mode,</span>
<span id="cb217-66"><a href="#cb217-66"></a>                 <span class="at">correlation =</span></span>
<span id="cb217-67"><a href="#cb217-67"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb217-68"><a href="#cb217-68"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb217-69"><a href="#cb217-69"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb217-70"><a href="#cb217-70"></a></span>
<span id="cb217-71"><a href="#cb217-71"></a>gene.model11 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> max.body.mass,</span>
<span id="cb217-72"><a href="#cb217-72"></a>                 <span class="at">correlation =</span></span>
<span id="cb217-73"><a href="#cb217-73"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb217-74"><a href="#cb217-74"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb217-75"><a href="#cb217-75"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb217-76"><a href="#cb217-76"></a></span>
<span id="cb217-77"><a href="#cb217-77"></a>gene.model12 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> total.gene.number,</span>
<span id="cb217-78"><a href="#cb217-78"></a>                 <span class="at">correlation =</span></span>
<span id="cb217-79"><a href="#cb217-79"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb217-80"><a href="#cb217-80"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb217-81"><a href="#cb217-81"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb217-82"><a href="#cb217-82"></a></span>
<span id="cb217-83"><a href="#cb217-83"></a>gene.model13 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> genome.size,</span>
<span id="cb217-84"><a href="#cb217-84"></a>                 <span class="at">correlation =</span></span>
<span id="cb217-85"><a href="#cb217-85"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb217-86"><a href="#cb217-86"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb217-87"><a href="#cb217-87"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb217-88"><a href="#cb217-88"></a></span>
<span id="cb217-89"><a href="#cb217-89"></a></span>
<span id="cb217-90"><a href="#cb217-90"></a></span>
<span id="cb217-91"><a href="#cb217-91"></a>gene.models <span class="ot">&lt;-</span> <span class="fu">anova</span>(gene.model1, gene.model2,</span>
<span id="cb217-92"><a href="#cb217-92"></a>                   gene.model3, gene.model4,</span>
<span id="cb217-93"><a href="#cb217-93"></a>                   gene.model5, gene.model6,</span>
<span id="cb217-94"><a href="#cb217-94"></a>                   gene.model7, gene.model8,</span>
<span id="cb217-95"><a href="#cb217-95"></a>                   gene.model9, gene.model10,</span>
<span id="cb217-96"><a href="#cb217-96"></a>                   gene.model11, gene.model12,</span>
<span id="cb217-97"><a href="#cb217-97"></a>                   gene.model13)</span>
<span id="cb217-98"><a href="#cb217-98"></a></span>
<span id="cb217-99"><a href="#cb217-99"></a><span class="fu">round</span>(<span class="fu">aicw</span>(<span class="fu">setNames</span>(gene.models<span class="sc">$</span>AIC,</span>
<span id="cb217-100"><a href="#cb217-100"></a>              <span class="fu">rownames</span>(gene.models))), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;                  fit  delta     w
&gt; gene.model1  -88.546  0.798 0.184
&gt; gene.model2  -87.280  2.064 0.098
&gt; gene.model3  -85.222  4.122 0.035
&gt; gene.model4  -85.957  3.387 0.050
&gt; gene.model5  -76.267 13.077 0.000
&gt; gene.model6  -87.845  1.499 0.129
&gt; gene.model7  -74.923 14.421 0.000
&gt; gene.model8  -88.986  0.358 0.229
&gt; gene.model9  -78.249 11.095 0.001
&gt; gene.model10 -75.910 13.434 0.000
&gt; gene.model11 -67.592 21.752 0.000
&gt; gene.model12 -89.344  0.000 0.274
&gt; gene.model13 -64.012 25.332 0.000</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1"></a><span class="fu">summary</span>(gene.model12)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; Generalized least squares fit by maximum likelihood
&gt;   Model: protein.coding.genes ~ total.gene.number 
&gt;   Data: log.prot.mat 
&gt;         AIC      BIC   logLik
&gt;   -89.34404 -86.8444 47.67202
&gt; 
&gt; Correlation Structure: corBrownian
&gt;  Formula: ~Species 
&gt;  Parameter estimate(s):
&gt; numeric(0)
&gt; 
&gt; Coefficients:
&gt;                       Value  Std.Error   t-value p-value
&gt; (Intercept)       2.4981165 0.23470754 10.643529       0
&gt; total.gene.number 0.4117624 0.05362393  7.678706       0
&gt; 
&gt;  Correlation: 
&gt;                   (Intr)
&gt; total.gene.number -0.999
&gt; 
&gt; Standardized residuals:
&gt;         Min          Q1         Med          Q3         Max 
&gt; -1.32525374 -0.41034443  0.07271242  0.46434568  1.15239905 
&gt; 
&gt; Residual standard error: 0.0197866 
&gt; Degrees of freedom: 17 total; 15 residual</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1"></a><span class="fu">par</span>(<span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">2.8</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb221-2"><a href="#cb221-2"></a></span>
<span id="cb221-3"><a href="#cb221-3"></a><span class="fu">plot</span>(protein.coding.genes <span class="sc">~</span> total.gene.number, <span class="at">data =</span> log.prot.mat,</span>
<span id="cb221-4"><a href="#cb221-4"></a>     <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb221-5"><a href="#cb221-5"></a>     <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>, <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb221-6"><a href="#cb221-6"></a>     <span class="at">type =</span> <span class="st">'n'</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb221-7"><a href="#cb221-7"></a></span>
<span id="cb221-8"><a href="#cb221-8"></a><span class="fu">grid</span>(<span class="at">nx =</span> <span class="cn">NULL</span>, <span class="at">ny =</span> <span class="cn">NULL</span>, <span class="at">col =</span> <span class="st">"lightgray"</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb221-9"><a href="#cb221-9"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb221-10"><a href="#cb221-10"></a></span>
<span id="cb221-11"><a href="#cb221-11"></a><span class="fu">plot</span>(protein.coding.genes <span class="sc">~</span> total.gene.number, <span class="at">data =</span> log.prot.mat,</span>
<span id="cb221-12"><a href="#cb221-12"></a>     <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">bg =</span> cols[<span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(log.prot.mat<span class="sc">$</span>Foraging.mode))],</span>
<span id="cb221-13"><a href="#cb221-13"></a>     <span class="at">col =</span> <span class="st">'black'</span>, <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb221-14"><a href="#cb221-14"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(log[<span class="dv">10</span>]<span class="sc">~</span><span class="st">"Total gene number"</span>),</span>
<span id="cb221-15"><a href="#cb221-15"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(log[<span class="dv">10</span>]<span class="sc">~</span><span class="st">"Protein-coding genes"</span>),</span>
<span id="cb221-16"><a href="#cb221-16"></a>     <span class="at">type =</span> <span class="st">'p'</span>)</span>
<span id="cb221-17"><a href="#cb221-17"></a></span>
<span id="cb221-18"><a href="#cb221-18"></a><span class="fu">abline</span>(<span class="fu">coef</span>(gene.model12)[<span class="dv">1</span>], <span class="fu">coef</span>(gene.model12)[<span class="dv">2</span>],</span>
<span id="cb221-19"><a href="#cb221-19"></a>      <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'black'</span>)</span>
<span id="cb221-20"><a href="#cb221-20"></a></span>
<span id="cb221-21"><a href="#cb221-21"></a><span class="fu">legend</span>(<span class="st">'topleft'</span>,</span>
<span id="cb221-22"><a href="#cb221-22"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">'active'</span>, <span class="st">'plastic'</span>, <span class="st">'sit-and-wait'</span>),</span>
<span id="cb221-23"><a href="#cb221-23"></a>       <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">pt.bg =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>),</span>
<span id="cb221-24"><a href="#cb221-24"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>), <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb221-25"><a href="#cb221-25"></a>       <span class="at">bty =</span> <span class="st">'n'</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1"></a><span class="do">## model diagnosis</span></span>
<span id="cb222-2"><a href="#cb222-2"></a></span>
<span id="cb222-3"><a href="#cb222-3"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb222-4"><a href="#cb222-4"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb222-5"><a href="#cb222-5"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb222-6"><a href="#cb222-6"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb222-7"><a href="#cb222-7"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb222-8"><a href="#cb222-8"></a></span>
<span id="cb222-9"><a href="#cb222-9"></a><span class="fu">par</span>(<span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb222-10"><a href="#cb222-10"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(gene.model12), <span class="fu">resid</span>(gene.model12),</span>
<span id="cb222-11"><a href="#cb222-11"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb222-12"><a href="#cb222-12"></a>     <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">xlab =</span> <span class="st">''</span>)</span>
<span id="cb222-13"><a href="#cb222-13"></a></span>
<span id="cb222-14"><a href="#cb222-14"></a><span class="fu">grid</span>()</span>
<span id="cb222-15"><a href="#cb222-15"></a></span>
<span id="cb222-16"><a href="#cb222-16"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb222-17"><a href="#cb222-17"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(gene.model12), <span class="fu">resid</span>(gene.model12),</span>
<span id="cb222-18"><a href="#cb222-18"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">"Fitted"</span>,</span>
<span id="cb222-19"><a href="#cb222-19"></a>     <span class="at">ylab =</span> <span class="st">"Residual"</span>, <span class="at">main =</span> <span class="st">"Fitted versus Residuals"</span>,</span>
<span id="cb222-20"><a href="#cb222-20"></a>     <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb222-21"><a href="#cb222-21"></a></span>
<span id="cb222-22"><a href="#cb222-22"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"darkorange"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb222-23"><a href="#cb222-23"></a></span>
<span id="cb222-24"><a href="#cb222-24"></a></span>
<span id="cb222-25"><a href="#cb222-25"></a><span class="do">## Checking normality</span></span>
<span id="cb222-26"><a href="#cb222-26"></a></span>
<span id="cb222-27"><a href="#cb222-27"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(gene.model12), <span class="at">col =</span> <span class="st">"darkgrey"</span>,</span>
<span id="cb222-28"><a href="#cb222-28"></a>       <span class="at">type =</span> <span class="st">'n'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="st">''</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb222-29"><a href="#cb222-29"></a>       <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb222-30"><a href="#cb222-30"></a></span>
<span id="cb222-31"><a href="#cb222-31"></a><span class="fu">grid</span>()</span>
<span id="cb222-32"><a href="#cb222-32"></a></span>
<span id="cb222-33"><a href="#cb222-33"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb222-34"><a href="#cb222-34"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(gene.model12), <span class="at">col =</span> <span class="st">"darkgrey"</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb222-35"><a href="#cb222-35"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(gene.model12), <span class="at">col =</span> <span class="st">"dodgerblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1"></a><span class="do">## looking for species with multiple genomes</span></span>
<span id="cb223-2"><a href="#cb223-2"></a></span>
<span id="cb223-3"><a href="#cb223-3"></a>dupl.genomes <span class="ot">&lt;-</span> <span class="fu">tapply</span>(genomes<span class="sc">$</span>Assembly.Accession,</span>
<span id="cb223-4"><a href="#cb223-4"></a>                       <span class="fu">list</span>(genomes<span class="sc">$</span>Organism.Name), length)</span>
<span id="cb223-5"><a href="#cb223-5"></a>((mult.genomes <span class="ot">&lt;-</span> dupl.genomes[dupl.genomes <span class="sc">&gt;</span> <span class="dv">2</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;           Anolis carolinensis                 Anolis sagrei 
&gt;                             4                             3 
&gt;           Bradypodion pumilum                Candoia aspera 
&gt;                             3                             3 
&gt;  Elgaria multicarinata webbii        Erythrolamprus reginae 
&gt;                             3                             4 
&gt;             Euleptes europaea         Hemicordylus capensis 
&gt;                             3                             3 
&gt;                Lacerta agilis             Notechis scutatus 
&gt;                             3                             3 
&gt;         Pantherophis guttatus Pituophis catenifer annectens 
&gt;                             5                             3 
&gt;              Podarcis muralis             Podarcis raffonei 
&gt;                             4                             3 
&gt;              Podarcis siculus              Pogona vitticeps 
&gt;                             3                             3 
&gt;           Pseudonaja textilis            Rhineura floridana 
&gt;                             3                             3 
&gt;           Sistrurus catenatus            Thamnophis elegans 
&gt;                             3                             3 
&gt;            Tiliqua scincoides           Varanus komodoensis 
&gt;                             4                             3 
&gt;              Zootoca vivipara 
&gt;                             5</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1"></a>spp <span class="ot">&lt;-</span> <span class="fu">names</span>(mult.genomes)</span>
<span id="cb225-2"><a href="#cb225-2"></a></span>
<span id="cb225-3"><a href="#cb225-3"></a><span class="do">## getting the accession number of the genomes</span></span>
<span id="cb225-4"><a href="#cb225-4"></a></span>
<span id="cb225-5"><a href="#cb225-5"></a>obj <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb225-6"><a href="#cb225-6"></a><span class="cf">for</span>(i <span class="cf">in</span> spp){</span>
<span id="cb225-7"><a href="#cb225-7"></a>    row <span class="ot">&lt;-</span> genomes[genomes<span class="sc">$</span>Organism.Name <span class="sc">==</span> i, ]</span>
<span id="cb225-8"><a href="#cb225-8"></a>    obj <span class="ot">&lt;-</span> <span class="fu">rbind</span>(obj, row)</span>
<span id="cb225-9"><a href="#cb225-9"></a>}</span>
<span id="cb225-10"><a href="#cb225-10"></a>obj[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">16</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;     Assembly.Accession                  Assembly.Name
&gt; 3      GCA_035594765.1                 rAnoCar3.1.pri
&gt; 4      GCF_035594765.1                 rAnoCar3.1.pri
&gt; 398    GCF_000090745.2                      AnoCar2.0
&gt; 399    GCA_000090745.2                      AnoCar2.0
&gt; 5      GCA_037176765.1                   rAnoSag1.mat
&gt; 6      GCF_037176765.1                   rAnoSag1.mat
&gt; 323    GCA_037176775.1                   rAnoSag1.pat
&gt; 162    GCA_035047305.1                      BraPum1.0
&gt; 331    GCA_047715955.1                  rBraPum1.hap2
&gt; 332    GCA_047715975.1                  rBraPum1.hap1
&gt; 38     GCA_035149785.1                  rCanAsp1.hap2
&gt; 39     GCF_035149785.1                  rCanAsp1.hap2
&gt; 377    GCA_035125265.1                  rCanAsp1.hap1
&gt; 19     GCA_023053635.2                 rElgMul1.1.pri
&gt; 20     GCF_023053635.1                 rElgMul1.1.pri
&gt; 355    GCA_023053675.2                 rElgMul1.1.alt
&gt; 52     GCA_031021105.1                  rEryReg1.hap1
&gt; 53     GCF_031021105.1                  rEryReg1.hap1
&gt; 381    GCA_031021085.1                  rEryReg1.hap2
&gt; 384    GCA_031001685.1                  rEryReg1.hap3
&gt; 41     GCA_029931775.1                  rEulEur1.hap1
&gt; 42     GCF_029931775.1                  rEulEur1.hap1
&gt; 378    GCA_029931755.1                  rEulEur1.hap2
&gt; 32     GCA_027244095.1                 rHemCap1.1.pri
&gt; 33     GCF_027244095.1                 rHemCap1.1.pri
&gt; 388    GCA_027244105.1                 rHemCap1.1.alt
&gt; 49     GCA_009819535.1                   rLacAgi1.pri
&gt; 50     GCF_009819535.1                   rLacAgi1.pri
&gt; 386    GCA_009819545.1                   rLacAgi1.alt
&gt; 119    GCA_900518725.1                    TS10Xv2-PRI
&gt; 120    GCF_900518725.1                    TS10Xv2-PRI
&gt; 364    GCA_900608555.1                    TS10Xv2-ALT
&gt; 89     GCA_029531705.1                 CU_Pguttatus_1
&gt; 90     GCF_029531705.1                 CU_Pguttatus_1
&gt; 342    GCA_046118575.1                   ASM4611857v1
&gt; 404    GCA_001185365.2               UNIGE_PanGut_3.0
&gt; 405    GCF_001185365.1               UNIGE_PanGut_3.0
&gt; 130    GCA_029215685.1                rPitCat1.0.hap2
&gt; 131    GCF_029215685.1                rPitCat1.0.hap2
&gt; 369    GCA_029215655.1                rPitCat1.0.hap1
&gt; 16     GCA_004329235.1                     PodMur_1.0
&gt; 17     GCF_004329235.1                     PodMur_1.0
&gt; 324    GCA_964188315.1              rPodMur119.hap1.1
&gt; 350    GCA_964188365.1              rPodMur119.hap2.1
&gt; 22     GCA_027172205.1                   rPodRaf1.pri
&gt; 23     GCF_027172205.1                   rPodRaf1.pri
&gt; 363    GCA_027172095.1                   rPodRaf1.alt
&gt; 15     GCA_964188175.1                rPodSic1.hap1.1
&gt; 349    GCA_964188395.1                rPodSic1.hap2.1
&gt; 352    GCA_034642415.1                  UCBerk_Psic_1
&gt; 85     GCA_900067755.1                         pvi1.1
&gt; 86     GCF_900067755.1                         pvi1.1
&gt; 322    GCA_047335585.1                         Pvi2.1
&gt; 142    GCA_900518735.1                   EBS10Xv2-PRI
&gt; 143    GCF_900518735.1                   EBS10Xv2-PRI
&gt; 389    GCA_900608585.1                   EBS10Xv2-ALT
&gt; 44     GCA_030035675.1                  rRhiFlo1.hap2
&gt; 45     GCF_030035675.1                  rRhiFlo1.hap2
&gt; 379    GCA_030035715.1                  rRhiFlo1.hap1
&gt; 11     GCA_039880765.1                  rSisCat1_p1.0
&gt; 344    GCA_039880715.1                  rSisCat1_a1.0
&gt; 345    GCA_037127405.1                 Scatenatus_1.1
&gt; 13     GCA_009769535.1                   rThaEle1.pri
&gt; 14     GCF_009769535.1                   rThaEle1.pri
&gt; 351    GCA_009769695.1                   rThaEle1.alt
&gt; 24     GCA_035046505.1                  rTilSci1.hap2
&gt; 25     GCF_035046505.1                  rTilSci1.hap2
&gt; 327    GCA_035046495.1                  rTilSci1.hap1
&gt; 368    GCA_047292575.1                   ASM4729257v1
&gt; 114    GCA_004798865.1                    ASM479886v1
&gt; 115    GCF_004798865.1                    ASM479886v1
&gt; 365    GCA_007859595.1                  VCOM_VKom_1.0
&gt; 28     GCA_963506605.1                     rZooViv1.1
&gt; 29     GCF_963506605.1                     rZooViv1.1
&gt; 362    GCA_963506595.1 rZooViv1.1 alternate haplotype
&gt; 400    GCA_011800845.1                      UG_Zviv_1
&gt; 401    GCF_011800845.1                      UG_Zviv_1
&gt;                     Organism.Name Organism.Taxonomic.ID
&gt; 3             Anolis carolinensis                 28377
&gt; 4             Anolis carolinensis                 28377
&gt; 398           Anolis carolinensis                 28377
&gt; 399           Anolis carolinensis                 28377
&gt; 5                   Anolis sagrei                 38937
&gt; 6                   Anolis sagrei                 38937
&gt; 323                 Anolis sagrei                 38937
&gt; 162           Bradypodion pumilum                179887
&gt; 331           Bradypodion pumilum                179887
&gt; 332           Bradypodion pumilum                179887
&gt; 38                 Candoia aspera                 51853
&gt; 39                 Candoia aspera                 51853
&gt; 377                Candoia aspera                 51853
&gt; 19   Elgaria multicarinata webbii                159646
&gt; 20   Elgaria multicarinata webbii                159646
&gt; 355  Elgaria multicarinata webbii                159646
&gt; 52         Erythrolamprus reginae                121349
&gt; 53         Erythrolamprus reginae                121349
&gt; 381        Erythrolamprus reginae                121349
&gt; 384        Erythrolamprus reginae                121349
&gt; 41              Euleptes europaea                460621
&gt; 42              Euleptes europaea                460621
&gt; 378             Euleptes europaea                460621
&gt; 32          Hemicordylus capensis                884348
&gt; 33          Hemicordylus capensis                884348
&gt; 388         Hemicordylus capensis                884348
&gt; 49                 Lacerta agilis                 80427
&gt; 50                 Lacerta agilis                 80427
&gt; 386                Lacerta agilis                 80427
&gt; 119             Notechis scutatus                  8663
&gt; 120             Notechis scutatus                  8663
&gt; 364             Notechis scutatus                  8663
&gt; 89          Pantherophis guttatus                 94885
&gt; 90          Pantherophis guttatus                 94885
&gt; 342         Pantherophis guttatus                 94885
&gt; 404         Pantherophis guttatus                 94885
&gt; 405         Pantherophis guttatus                 94885
&gt; 130 Pituophis catenifer annectens                 94852
&gt; 131 Pituophis catenifer annectens                 94852
&gt; 369 Pituophis catenifer annectens                 94852
&gt; 16               Podarcis muralis                 64176
&gt; 17               Podarcis muralis                 64176
&gt; 324              Podarcis muralis                 64176
&gt; 350              Podarcis muralis                 64176
&gt; 22              Podarcis raffonei                 65483
&gt; 23              Podarcis raffonei                 65483
&gt; 363             Podarcis raffonei                 65483
&gt; 15               Podarcis siculus                 65484
&gt; 349              Podarcis siculus                 65484
&gt; 352              Podarcis siculus                 65484
&gt; 85               Pogona vitticeps                103695
&gt; 86               Pogona vitticeps                103695
&gt; 322              Pogona vitticeps                103695
&gt; 142           Pseudonaja textilis                  8673
&gt; 143           Pseudonaja textilis                  8673
&gt; 389           Pseudonaja textilis                  8673
&gt; 44             Rhineura floridana                261503
&gt; 45             Rhineura floridana                261503
&gt; 379            Rhineura floridana                261503
&gt; 11            Sistrurus catenatus                  8756
&gt; 344           Sistrurus catenatus                  8756
&gt; 345           Sistrurus catenatus                  8756
&gt; 13             Thamnophis elegans                 35005
&gt; 14             Thamnophis elegans                 35005
&gt; 351            Thamnophis elegans                 35005
&gt; 24             Tiliqua scincoides                 71010
&gt; 25             Tiliqua scincoides                 71010
&gt; 327            Tiliqua scincoides                 71010
&gt; 368            Tiliqua scincoides                 71010
&gt; 114           Varanus komodoensis                 61221
&gt; 115           Varanus komodoensis                 61221
&gt; 365           Varanus komodoensis                 61221
&gt; 28               Zootoca vivipara                  8524
&gt; 29               Zootoca vivipara                  8524
&gt; 362              Zootoca vivipara                  8524
&gt; 400              Zootoca vivipara                  8524
&gt; 401              Zootoca vivipara                  8524
&gt;                                       Annotation.Name Assembly.Level
&gt; 3                                                         Chromosome
&gt; 4                          GCF_035594765.1-RS_2024_02     Chromosome
&gt; 398   NCBI Anolis carolinensis Annotation Release 102     Chromosome
&gt; 399                                                       Chromosome
&gt; 5                                                         Chromosome
&gt; 6                          GCF_037176765.1-RS_2024_08     Chromosome
&gt; 323                                                       Chromosome
&gt; 162                                                         Scaffold
&gt; 331                                                       Chromosome
&gt; 332                                                       Chromosome
&gt; 38                                                        Chromosome
&gt; 39                         GCF_035149785.1-RS_2024_02     Chromosome
&gt; 377                                                         Scaffold
&gt; 19                                                        Chromosome
&gt; 20                         GCF_023053635.1-RS_2024_02     Chromosome
&gt; 355                                                         Scaffold
&gt; 52                                                        Chromosome
&gt; 53                         GCF_031021105.1-RS_2024_12     Chromosome
&gt; 381                                                           Contig
&gt; 384                                                           Contig
&gt; 41                                                        Chromosome
&gt; 42                         GCF_029931775.1-RS_2023_06     Chromosome
&gt; 378                                                         Scaffold
&gt; 32                                                        Chromosome
&gt; 33                         GCF_027244095.1-RS_2023_02     Chromosome
&gt; 388                                                           Contig
&gt; 49                                                        Chromosome
&gt; 50         NCBI Lacerta agilis Annotation Release 100     Chromosome
&gt; 386                                                         Scaffold
&gt; 119                                                         Scaffold
&gt; 120     NCBI Notechis scutatus Annotation Release 100       Scaffold
&gt; 364                                                         Scaffold
&gt; 89                                                          Scaffold
&gt; 90                         GCF_029531705.1-RS_2023_10       Scaffold
&gt; 342                                                         Scaffold
&gt; 404                                                         Scaffold
&gt; 405 NCBI Pantherophis guttatus Annotation Release 100       Scaffold
&gt; 130                                                         Scaffold
&gt; 131                        GCF_029215685.1-RS_2025_01       Scaffold
&gt; 369                                                         Scaffold
&gt; 16                                                        Chromosome
&gt; 17       NCBI Podarcis muralis Annotation Release 100     Chromosome
&gt; 324                                                       Chromosome
&gt; 350                                                         Scaffold
&gt; 22                                                        Chromosome
&gt; 23                         GCF_027172205.1-RS_2023_02     Chromosome
&gt; 363                                                         Scaffold
&gt; 15                                                        Chromosome
&gt; 349                                                         Scaffold
&gt; 352                                                         Scaffold
&gt; 85                                                          Scaffold
&gt; 86       NCBI Pogona vitticeps Annotation Release 100       Scaffold
&gt; 322                                                       Chromosome
&gt; 142                                                         Scaffold
&gt; 143   NCBI Pseudonaja textilis Annotation Release 100       Scaffold
&gt; 389                                                         Scaffold
&gt; 44                                                        Chromosome
&gt; 45                         GCF_030035675.1-RS_2023_12     Chromosome
&gt; 379                                                         Scaffold
&gt; 11                                                        Chromosome
&gt; 344                                                         Scaffold
&gt; 345                                                         Scaffold
&gt; 13                                                        Chromosome
&gt; 14     NCBI Thamnophis elegans Annotation Release 100     Chromosome
&gt; 351                                                         Scaffold
&gt; 24                                                        Chromosome
&gt; 25                         GCF_035046505.1-RS_2024_07     Chromosome
&gt; 327                                                       Chromosome
&gt; 368                                                         Scaffold
&gt; 114      Annotation submitted by Gladstone Institutes       Scaffold
&gt; 115   NCBI Varanus komodoensis Annotation Release 100       Scaffold
&gt; 365                                                         Scaffold
&gt; 28                                                        Chromosome
&gt; 29                         GCF_963506605.1-RS_2023_10     Chromosome
&gt; 362                                                           Contig
&gt; 400                                                       Chromosome
&gt; 401      NCBI Zootoca vivipara Annotation Release 100     Chromosome
&gt;     WGS.project.accession
&gt; 3                JAWQEF01
&gt; 4                JAWQEF01
&gt; 398                AAWZ02
&gt; 399                AAWZ02
&gt; 5                JBBBDO01
&gt; 6                JBBBDO01
&gt; 323              JBBBDP01
&gt; 162              JAWDJD01
&gt; 331              JBLFLG01
&gt; 332              JBLFLF01
&gt; 38               JAYKKZ01
&gt; 39               JAYKKZ01
&gt; 377              JAYKKY01
&gt; 19               JALIGS02
&gt; 20               JALIGS02
&gt; 355              JALIGT02
&gt; 52               JAVGWQ01
&gt; 53               JAVGWQ01
&gt; 381              JAVGWR01
&gt; 384              JAVGWS01
&gt; 41               JARABC01
&gt; 42               JARABC01
&gt; 378              JARABB01
&gt; 32               JAPMAM01
&gt; 33               JAPMAM01
&gt; 388              JAPMAN01
&gt; 49                 WNMS01
&gt; 50                 WNMS01
&gt; 386                WNMT01
&gt; 119                ULFQ01
&gt; 120                ULFQ01
&gt; 364                UWZA01
&gt; 89               JAKNRS01
&gt; 90               JAKNRS01
&gt; 342              JBJNIC01
&gt; 404                JTLQ02
&gt; 405                JTLQ02
&gt; 130              JARCGV01
&gt; 131              JARCGV01
&gt; 369              JARCGU01
&gt; 16                 SIRZ01
&gt; 17                 SIRZ01
&gt; 324              CAXLPC01
&gt; 350              CAXLPD01
&gt; 22               JAPYJY01
&gt; 23               JAPYJY01
&gt; 363              JAPYJZ01
&gt; 15               CAXLOV01
&gt; 349              CAXLPE01
&gt; 352              JAXCMG01
&gt; 85                 CEMB01
&gt; 86                 CEMB01
&gt; 322              JBJJNW01
&gt; 142                ULFR01
&gt; 143                ULFR01
&gt; 389                UWYZ01
&gt; 44               JASFZN01
&gt; 45               JASFZN01
&gt; 379              JASFZO01
&gt; 11               JBAIFV01
&gt; 344              JBAIFW01
&gt; 345              JASPKD01
&gt; 13                 WNNA01
&gt; 14                 WNNA01
&gt; 351                WNNB01
&gt; 24               JAYFUK01
&gt; 25               JAYFUK01
&gt; 327              JAYFUJ01
&gt; 368              JBKOJL01
&gt; 114                SJPD01
&gt; 115                SJPD01
&gt; 365                VEXN01
&gt; 28               CAUOQL01
&gt; 29               CAUOQL01
&gt; 362              CAUOQM01
&gt; 400              JAATIO01
&gt; 401              JAATIO01</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1"></a><span class="do">## determining how many species per foraging behavior</span></span>
<span id="cb227-2"><a href="#cb227-2"></a><span class="do">## category we have</span></span>
<span id="cb227-3"><a href="#cb227-3"></a></span>
<span id="cb227-4"><a href="#cb227-4"></a>spp <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">' '</span>, <span class="st">'_'</span>, spp)</span>
<span id="cb227-5"><a href="#cb227-5"></a>mult.genomes.forg <span class="ot">&lt;-</span> pruned.data[pruned.data<span class="sc">$</span>Species <span class="sc">%in%</span> spp, ]</span>
<span id="cb227-6"><a href="#cb227-6"></a>mult.genomes.forg[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">12</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;                                     Species Foraging.mode
&gt; Anolis_carolinensis     Anolis_carolinensis  sit-and-wait
&gt; Anolis_sagrei                 Anolis_sagrei  sit-and-wait
&gt; Bradypodion_pumilum     Bradypodion_pumilum       plastic
&gt; Hemicordylus_capensis Hemicordylus_capensis  sit-and-wait
&gt; Lacerta_agilis               Lacerta_agilis        active
&gt; Pantherophis_guttatus Pantherophis_guttatus       plastic
&gt; Pogona_vitticeps           Pogona_vitticeps       plastic
&gt; Thamnophis_elegans       Thamnophis_elegans        active
&gt; Varanus_komodoensis     Varanus_komodoensis       plastic
&gt; Zootoca_vivipara           Zootoca_vivipara  sit-and-wait</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1"></a>sagrei.nd <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">'A.sagrei_pi.windowed.pi'</span>, <span class="at">sep =</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span>)</span>
<span id="cb229-2"><a href="#cb229-2"></a><span class="fu">str</span>(sagrei.nd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 183715 obs. of  5 variables:
&gt;  $ CHROM     : chr  "CM073870.1" "CM073870.1" "CM073870.1" "CM073870.1" ...
&gt;  $ BIN_START : int  10001 30001 40001 50001 60001 70001 80001 90001 100001 110001 ...
&gt;  $ BIN_END   : int  20000 40000 50000 60000 70000 80000 90000 100000 110000 120000 ...
&gt;  $ N_VARIANTS: int  17 3 18 17 13 19 22 32 18 18 ...
&gt;  $ PI        : num  0.000717 0.000167 0.00095 0.001067 0.000683 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1"></a>sagrei.td <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">'A.sagrei_D.Tajima.D'</span>, <span class="at">sep =</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span>)</span>
<span id="cb231-2"><a href="#cb231-2"></a><span class="fu">str</span>(sagrei.td)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 195018 obs. of  4 variables:
&gt;  $ CHROM    : chr  "CM073870.1" "CM073870.1" "CM073870.1" "CM073870.1" ...
&gt;  $ BIN_START: int  10000 20000 30000 40000 50000 60000 70000 80000 90000 100000 ...
&gt;  $ N_SNPS   : int  17 0 3 18 17 13 19 22 32 16 ...
&gt;  $ TajimaD  : num  0.434 NaN 0.168 2.272 1.534 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1"></a>carolinensis.nd <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">'A.carolinensis.pop_pi.windowed.pi'</span>, <span class="at">sep =</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span>)</span>
<span id="cb233-2"><a href="#cb233-2"></a><span class="fu">str</span>(carolinensis.nd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 180680 obs. of  5 variables:
&gt;  $ CHROM     : chr  "CM069367.1" "CM069367.1" "CM069367.1" "CM069367.1" ...
&gt;  $ BIN_START : int  1 10001 20001 30001 40001 50001 60001 70001 80001 90001 ...
&gt;  $ BIN_END   : int  10000 20000 30000 40000 50000 60000 70000 80000 90000 100000 ...
&gt;  $ N_VARIANTS: int  168 80 150 193 168 184 260 185 134 98 ...
&gt;  $ PI        : num  0.0067 0.00318 0.00515 0.00704 0.00639 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1"></a>carolinensis.td <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">'A.carolinensis.pop_D.Tajima.D'</span>, <span class="at">sep =</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span>)</span>
<span id="cb235-2"><a href="#cb235-2"></a><span class="fu">str</span>(carolinensis.td)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 184730 obs. of  4 variables:
&gt;  $ CHROM    : chr  "CM069367.1" "CM069367.1" "CM069367.1" "CM069367.1" ...
&gt;  $ BIN_START: int  0 10000 20000 30000 40000 50000 60000 70000 80000 90000 ...
&gt;  $ N_SNPS   : int  155 76 147 191 150 166 241 180 122 97 ...
&gt;  $ TajimaD  : num  1.007 1.023 1.119 1.377 0.486 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1"></a>siculus.nd <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">'P.siculus_pi.windowed.pi'</span>, <span class="at">sep =</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span>)</span>
<span id="cb237-2"><a href="#cb237-2"></a><span class="fu">str</span>(siculus.nd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 150255 obs. of  5 variables:
&gt;  $ CHROM     : chr  "OZ076838.1" "OZ076838.1" "OZ076838.1" "OZ076838.1" ...
&gt;  $ BIN_START : int  10001 20001 30001 40001 50001 60001 70001 80001 90001 100001 ...
&gt;  $ BIN_END   : int  20000 30000 40000 50000 60000 70000 80000 90000 100000 110000 ...
&gt;  $ N_VARIANTS: int  204 155 97 44 30 97 61 27 148 91 ...
&gt;  $ PI        : num  0.0083 0.00812 0.00546 0.00194 0.00122 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1"></a>siculus.td <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">'P.siculus_D.Tajima.D'</span>, <span class="at">sep =</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span>)</span>
<span id="cb239-2"><a href="#cb239-2"></a><span class="fu">str</span>(siculus.td)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 155355 obs. of  4 variables:
&gt;  $ CHROM    : chr  "OZ076838.1" "OZ076838.1" "OZ076838.1" "OZ076838.1" ...
&gt;  $ BIN_START: int  10000 20000 30000 40000 50000 60000 70000 80000 90000 100000 ...
&gt;  $ N_SNPS   : int  199 151 89 44 30 95 61 26 146 86 ...
&gt;  $ TajimaD  : num  0.463 0.187 1.247 0.361 1.771 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1"></a>muralis.nd <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">'P.muralis.pop_pi.windowed.pi'</span>, <span class="at">sep =</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span>)</span>
<span id="cb241-2"><a href="#cb241-2"></a><span class="fu">str</span>(muralis.nd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 151340 obs. of  5 variables:
&gt;  $ CHROM     : chr  "NC_041312.1" "NC_041312.1" "NC_041312.1" "NC_041312.1" ...
&gt;  $ BIN_START : int  1 10001 20001 30001 40001 50001 60001 70001 80001 90001 ...
&gt;  $ BIN_END   : int  10000 20000 30000 40000 50000 60000 70000 80000 90000 100000 ...
&gt;  $ N_VARIANTS: int  115 289 139 132 95 265 194 70 152 288 ...
&gt;  $ PI        : num  0.00255 0.00994 0.00406 0.00352 0.00292 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1"></a>muralis.td <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">'P.muralis.pop_D.Tajima.D'</span>, <span class="at">sep =</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span>)</span>
<span id="cb243-2"><a href="#cb243-2"></a><span class="fu">str</span>(muralis.td)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 151623 obs. of  4 variables:
&gt;  $ CHROM    : chr  "NC_041312.1" "NC_041312.1" "NC_041312.1" "NC_041312.1" ...
&gt;  $ BIN_START: int  0 10000 20000 30000 40000 50000 60000 70000 80000 90000 ...
&gt;  $ N_SNPS   : int  112 264 130 128 93 247 180 68 146 275 ...
&gt;  $ TajimaD  : num  1.568 0.139 0.188 1.218 1.248 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1"></a><span class="do">## fixing chromosome labels</span></span>
<span id="cb245-2"><a href="#cb245-2"></a><span class="do">## we need to confirm what chromosome corresponds to</span></span>
<span id="cb245-3"><a href="#cb245-3"></a><span class="do">## labels JBBBDO010000003.1 (it seems to be sex chromosomes)</span></span>
<span id="cb245-4"><a href="#cb245-4"></a></span>
<span id="cb245-5"><a href="#cb245-5"></a></span>
<span id="cb245-6"><a href="#cb245-6"></a><span class="do">## Nucleotide diveristy</span></span>
<span id="cb245-7"><a href="#cb245-7"></a></span>
<span id="cb245-8"><a href="#cb245-8"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073870.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr1'</span></span>
<span id="cb245-9"><a href="#cb245-9"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073871.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr2'</span></span>
<span id="cb245-10"><a href="#cb245-10"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073872.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr3'</span></span>
<span id="cb245-11"><a href="#cb245-11"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073873.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr4'</span></span>
<span id="cb245-12"><a href="#cb245-12"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073874.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr5'</span></span>
<span id="cb245-13"><a href="#cb245-13"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073875.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr6'</span></span>
<span id="cb245-14"><a href="#cb245-14"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073876.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr7'</span></span>
<span id="cb245-15"><a href="#cb245-15"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073877.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr8'</span></span>
<span id="cb245-16"><a href="#cb245-16"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073878.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr9'</span></span>
<span id="cb245-17"><a href="#cb245-17"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073879.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr10'</span></span>
<span id="cb245-18"><a href="#cb245-18"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073880.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr11'</span></span>
<span id="cb245-19"><a href="#cb245-19"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073881.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr12'</span></span>
<span id="cb245-20"><a href="#cb245-20"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073882.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr13'</span></span>
<span id="cb245-21"><a href="#cb245-21"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073883.1'</span>] <span class="ot">&lt;-</span> <span class="st">'X'</span></span>
<span id="cb245-22"><a href="#cb245-22"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073884.1'</span>] <span class="ot">&lt;-</span> <span class="st">'Y'</span></span>
<span id="cb245-23"><a href="#cb245-23"></a></span>
<span id="cb245-24"><a href="#cb245-24"></a></span>
<span id="cb245-25"><a href="#cb245-25"></a><span class="fu">str</span>(sagrei.nd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 183715 obs. of  5 variables:
&gt;  $ CHROM     : chr  "chr1" "chr1" "chr1" "chr1" ...
&gt;  $ BIN_START : int  10001 30001 40001 50001 60001 70001 80001 90001 100001 110001 ...
&gt;  $ BIN_END   : int  20000 40000 50000 60000 70000 80000 90000 100000 110000 120000 ...
&gt;  $ N_VARIANTS: int  17 3 18 17 13 19 22 32 18 18 ...
&gt;  $ PI        : num  0.000717 0.000167 0.00095 0.001067 0.000683 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1"></a>pi.chr.sagrei <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(sagrei.nd<span class="sc">$</span>PI,</span>
<span id="cb247-2"><a href="#cb247-2"></a>                           <span class="fu">list</span>(sagrei.nd<span class="sc">$</span>CHROM), mean)</span>
<span id="cb247-3"><a href="#cb247-3"></a><span class="fu">colnames</span>(pi.chr.sagrei) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CHROM'</span>, <span class="st">'pi'</span>)</span>
<span id="cb247-4"><a href="#cb247-4"></a><span class="fu">head</span>(pi.chr.sagrei)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;   CHROM           pi
&gt; 1  chr1 0.0006937071
&gt; 2 chr10 0.0012968639
&gt; 3 chr11 0.0009825641
&gt; 4 chr12 0.0010971102
&gt; 5 chr13 0.0008825990
&gt; 6  chr2 0.0007605876</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1"></a>chrom <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'chr1'</span>, <span class="st">'chr2'</span>, <span class="st">'chr3'</span>, <span class="st">'chr4'</span>, <span class="st">'chr5'</span>, <span class="st">'chr6'</span>,</span>
<span id="cb249-2"><a href="#cb249-2"></a>  <span class="st">'chr7'</span>, <span class="st">'chr8'</span>, <span class="st">'chr9'</span>, <span class="st">'chr10'</span>, <span class="st">'chr11'</span>, <span class="st">'chr12'</span>,</span>
<span id="cb249-3"><a href="#cb249-3"></a>  <span class="st">'chr13'</span>, <span class="st">'X'</span>, <span class="st">'Y'</span>)</span>
<span id="cb249-4"><a href="#cb249-4"></a></span>
<span id="cb249-5"><a href="#cb249-5"></a>pi.chr.sagrei <span class="ot">&lt;-</span> pi.chr.sagrei[pi.chr.sagrei<span class="sc">$</span>CHROM <span class="sc">%in%</span> chrom, ]</span>
<span id="cb249-6"><a href="#cb249-6"></a>ordered <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb249-7"><a href="#cb249-7"></a><span class="cf">for</span>(i <span class="cf">in</span> chrom){</span>
<span id="cb249-8"><a href="#cb249-8"></a>    obj <span class="ot">&lt;-</span> pi.chr.sagrei[pi.chr.sagrei<span class="sc">$</span>CHROM <span class="sc">==</span> i, ]</span>
<span id="cb249-9"><a href="#cb249-9"></a>    ordered <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ordered, obj)</span>
<span id="cb249-10"><a href="#cb249-10"></a>}</span>
<span id="cb249-11"><a href="#cb249-11"></a>pi.chr.sagrei <span class="ot">&lt;-</span> ordered</span>
<span id="cb249-12"><a href="#cb249-12"></a></span>
<span id="cb249-13"><a href="#cb249-13"></a></span>
<span id="cb249-14"><a href="#cb249-14"></a>pi.chr.sagrei</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;    CHROM           pi
&gt; 1   chr1 0.0006937071
&gt; 6   chr2 0.0007605876
&gt; 7   chr3 0.0007809922
&gt; 8   chr4 0.0006684585
&gt; 9   chr5 0.0007950722
&gt; 10  chr6 0.0009198097
&gt; 11  chr7 0.0012320459
&gt; 12  chr8 0.0011067505
&gt; 13  chr9 0.0012102928
&gt; 2  chr10 0.0012968639
&gt; 3  chr11 0.0009825641
&gt; 4  chr12 0.0010971102
&gt; 5  chr13 0.0008825990
&gt; 24     X 0.0007406440
&gt; 25     Y 0.0005350790</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1"></a><span class="fu">str</span>(pi.chr.sagrei)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 15 obs. of  2 variables:
&gt;  $ CHROM: chr  "chr1" "chr2" "chr3" "chr4" ...
&gt;  $ pi   : num  0.000694 0.000761 0.000781 0.000668 0.000795 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1"></a>value <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.sagrei<span class="sc">$</span>CHROM)</span>
<span id="cb253-2"><a href="#cb253-2"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="fl">5.4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb253-3"><a href="#cb253-3"></a><span class="fu">plot</span>(pi.chr.sagrei<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb253-4"><a href="#cb253-4"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>,</span>
<span id="cb253-5"><a href="#cb253-5"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">'Nucleotide diversity'</span><span class="sc">~</span>(pi)),</span>
<span id="cb253-6"><a href="#cb253-6"></a>     <span class="at">xlab =</span> <span class="st">'Genomic position'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>)</span>
<span id="cb253-7"><a href="#cb253-7"></a><span class="fu">grid</span>()</span>
<span id="cb253-8"><a href="#cb253-8"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb253-9"><a href="#cb253-9"></a><span class="fu">plot</span>(pi.chr.sagrei<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb253-10"><a href="#cb253-10"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb253-11"><a href="#cb253-11"></a>     <span class="at">xlab =</span> <span class="st">' '</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb253-12"><a href="#cb253-12"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.sagrei<span class="sc">$</span>CHROM),</span>
<span id="cb253-13"><a href="#cb253-13"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb253-14"><a href="#cb253-14"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.sagrei<span class="sc">$</span>CHROM), <span class="at">y =</span> <span class="fl">0.00045</span>, </span>
<span id="cb253-15"><a href="#cb253-15"></a>     <span class="at">labels =</span> pi.chr.sagrei<span class="sc">$</span>CHROM, <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">xpd =</span> <span class="cn">NA</span>,</span>
<span id="cb253-16"><a href="#cb253-16"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1"></a><span class="do">## Tajima's D</span></span>
<span id="cb254-2"><a href="#cb254-2"></a></span>
<span id="cb254-3"><a href="#cb254-3"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073870.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr1'</span></span>
<span id="cb254-4"><a href="#cb254-4"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073871.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr2'</span></span>
<span id="cb254-5"><a href="#cb254-5"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073872.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr3'</span></span>
<span id="cb254-6"><a href="#cb254-6"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073873.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr4'</span></span>
<span id="cb254-7"><a href="#cb254-7"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073874.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr5'</span></span>
<span id="cb254-8"><a href="#cb254-8"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073875.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr6'</span></span>
<span id="cb254-9"><a href="#cb254-9"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073876.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr7'</span></span>
<span id="cb254-10"><a href="#cb254-10"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073877.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr8'</span></span>
<span id="cb254-11"><a href="#cb254-11"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073878.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr9'</span></span>
<span id="cb254-12"><a href="#cb254-12"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073879.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr10'</span></span>
<span id="cb254-13"><a href="#cb254-13"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073880.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr11'</span></span>
<span id="cb254-14"><a href="#cb254-14"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073881.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr12'</span></span>
<span id="cb254-15"><a href="#cb254-15"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073882.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr13'</span></span>
<span id="cb254-16"><a href="#cb254-16"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073883.1'</span>] <span class="ot">&lt;-</span> <span class="st">'X'</span></span>
<span id="cb254-17"><a href="#cb254-17"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073884.1'</span>] <span class="ot">&lt;-</span> <span class="st">'Y'</span></span>
<span id="cb254-18"><a href="#cb254-18"></a></span>
<span id="cb254-19"><a href="#cb254-19"></a><span class="fu">str</span>(sagrei.td)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 195018 obs. of  4 variables:
&gt;  $ CHROM    : chr  "chr1" "chr1" "chr1" "chr1" ...
&gt;  $ BIN_START: int  10000 20000 30000 40000 50000 60000 70000 80000 90000 100000 ...
&gt;  $ N_SNPS   : int  17 0 3 18 17 13 19 22 32 16 ...
&gt;  $ TajimaD  : num  0.434 NaN 0.168 2.272 1.534 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1"></a>d.chr.sagrei <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(sagrei.td<span class="sc">$</span>TajimaD,</span>
<span id="cb256-2"><a href="#cb256-2"></a>                          <span class="fu">list</span>(sagrei.td<span class="sc">$</span>CHROM),</span>
<span id="cb256-3"><a href="#cb256-3"></a>                          <span class="cf">function</span>(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb256-4"><a href="#cb256-4"></a><span class="fu">colnames</span>(d.chr.sagrei) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CHROM'</span>, <span class="st">'d'</span>)</span>
<span id="cb256-5"><a href="#cb256-5"></a><span class="fu">head</span>(d.chr.sagrei)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;   CHROM        d
&gt; 1  chr1 1.500319
&gt; 2 chr10 1.534910
&gt; 3 chr11 1.470594
&gt; 4 chr12 1.431255
&gt; 5 chr13 1.358655
&gt; 6  chr2 1.494493</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1"></a>chrom <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'chr1'</span>, <span class="st">'chr2'</span>, <span class="st">'chr3'</span>, <span class="st">'chr4'</span>, <span class="st">'chr5'</span>, <span class="st">'chr6'</span>,</span>
<span id="cb258-2"><a href="#cb258-2"></a>  <span class="st">'chr7'</span>, <span class="st">'chr8'</span>, <span class="st">'chr9'</span>, <span class="st">'chr10'</span>, <span class="st">'chr11'</span>, <span class="st">'chr12'</span>,</span>
<span id="cb258-3"><a href="#cb258-3"></a>  <span class="st">'chr13'</span>, <span class="st">'X'</span>, <span class="st">'Y'</span>)</span>
<span id="cb258-4"><a href="#cb258-4"></a></span>
<span id="cb258-5"><a href="#cb258-5"></a>d.chr.sagrei <span class="ot">&lt;-</span> d.chr.sagrei[d.chr.sagrei<span class="sc">$</span>CHROM <span class="sc">%in%</span> chrom, ]</span>
<span id="cb258-6"><a href="#cb258-6"></a>ordered <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb258-7"><a href="#cb258-7"></a><span class="cf">for</span>(i <span class="cf">in</span> chrom){</span>
<span id="cb258-8"><a href="#cb258-8"></a>    obj <span class="ot">&lt;-</span> d.chr.sagrei[d.chr.sagrei<span class="sc">$</span>CHROM <span class="sc">==</span> i, ]</span>
<span id="cb258-9"><a href="#cb258-9"></a>    ordered <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ordered, obj)</span>
<span id="cb258-10"><a href="#cb258-10"></a>}</span>
<span id="cb258-11"><a href="#cb258-11"></a>d.chr.sagrei <span class="ot">&lt;-</span> ordered</span>
<span id="cb258-12"><a href="#cb258-12"></a></span>
<span id="cb258-13"><a href="#cb258-13"></a></span>
<span id="cb258-14"><a href="#cb258-14"></a>value <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.sagrei<span class="sc">$</span>CHROM)</span>
<span id="cb258-15"><a href="#cb258-15"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="fl">5.4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb258-16"><a href="#cb258-16"></a><span class="fu">plot</span>(d.chr.sagrei<span class="sc">$</span>d <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb258-17"><a href="#cb258-17"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Tajima's D"</span>),</span>
<span id="cb258-18"><a href="#cb258-18"></a>     <span class="at">xlab =</span> <span class="st">'Genomic position'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>)</span>
<span id="cb258-19"><a href="#cb258-19"></a><span class="fu">grid</span>()</span>
<span id="cb258-20"><a href="#cb258-20"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb258-21"><a href="#cb258-21"></a><span class="fu">plot</span>(d.chr.sagrei<span class="sc">$</span>d <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb258-22"><a href="#cb258-22"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb258-23"><a href="#cb258-23"></a>     <span class="at">xlab =</span> <span class="st">' '</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb258-24"><a href="#cb258-24"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.sagrei<span class="sc">$</span>CHROM),</span>
<span id="cb258-25"><a href="#cb258-25"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb258-26"><a href="#cb258-26"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.sagrei<span class="sc">$</span>CHROM), <span class="at">y =</span> <span class="fl">1.33</span>, </span>
<span id="cb258-27"><a href="#cb258-27"></a>     <span class="at">labels =</span> d.chr.sagrei<span class="sc">$</span>CHROM, <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">xpd =</span> <span class="cn">NA</span>,</span>
<span id="cb258-28"><a href="#cb258-28"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1"></a><span class="do">## Nucleotide diveristy</span></span>
<span id="cb259-2"><a href="#cb259-2"></a></span>
<span id="cb259-3"><a href="#cb259-3"></a>carolinensis.nd<span class="sc">$</span>CHROM[carolinensis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069367.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr1'</span></span>
<span id="cb259-4"><a href="#cb259-4"></a>carolinensis.nd<span class="sc">$</span>CHROM[carolinensis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069368.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr2'</span></span>
<span id="cb259-5"><a href="#cb259-5"></a>carolinensis.nd<span class="sc">$</span>CHROM[carolinensis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069369.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr3'</span></span>
<span id="cb259-6"><a href="#cb259-6"></a>carolinensis.nd<span class="sc">$</span>CHROM[carolinensis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069370.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr4'</span></span>
<span id="cb259-7"><a href="#cb259-7"></a>carolinensis.nd<span class="sc">$</span>CHROM[carolinensis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069371.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr5'</span></span>
<span id="cb259-8"><a href="#cb259-8"></a>carolinensis.nd<span class="sc">$</span>CHROM[carolinensis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069372.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr6'</span></span>
<span id="cb259-9"><a href="#cb259-9"></a>carolinensis.nd<span class="sc">$</span>CHROM[carolinensis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069373.1'</span>] <span class="ot">&lt;-</span> <span class="st">'X'</span></span>
<span id="cb259-10"><a href="#cb259-10"></a>carolinensis.nd<span class="sc">$</span>CHROM[carolinensis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069374.1'</span>] <span class="ot">&lt;-</span> <span class="st">'Y'</span></span>
<span id="cb259-11"><a href="#cb259-11"></a></span>
<span id="cb259-12"><a href="#cb259-12"></a><span class="fu">str</span>(carolinensis.nd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 180680 obs. of  5 variables:
&gt;  $ CHROM     : chr  "chr1" "chr1" "chr1" "chr1" ...
&gt;  $ BIN_START : int  1 10001 20001 30001 40001 50001 60001 70001 80001 90001 ...
&gt;  $ BIN_END   : int  10000 20000 30000 40000 50000 60000 70000 80000 90000 100000 ...
&gt;  $ N_VARIANTS: int  168 80 150 193 168 184 260 185 134 98 ...
&gt;  $ PI        : num  0.0067 0.00318 0.00515 0.00704 0.00639 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1"></a>pi.chr.carolinensis <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(carolinensis.nd<span class="sc">$</span>PI,</span>
<span id="cb261-2"><a href="#cb261-2"></a>                                 <span class="fu">list</span>(carolinensis.nd<span class="sc">$</span>CHROM), mean)</span>
<span id="cb261-3"><a href="#cb261-3"></a>pi.chr.carolinensis_sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(carolinensis.nd<span class="sc">$</span>PI,</span>
<span id="cb261-4"><a href="#cb261-4"></a>                           <span class="fu">list</span>(carolinensis.nd<span class="sc">$</span>CHROM), sd)</span>
<span id="cb261-5"><a href="#cb261-5"></a><span class="fu">colnames</span>(pi.chr.carolinensis) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CHROM'</span>, <span class="st">'pi'</span>)</span>
<span id="cb261-6"><a href="#cb261-6"></a><span class="fu">colnames</span>(pi.chr.carolinensis_sd) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CHROM'</span>, <span class="st">'sd'</span>)</span>
<span id="cb261-7"><a href="#cb261-7"></a><span class="fu">head</span>(pi.chr.carolinensis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;   CHROM          pi
&gt; 1  chr1 0.005123106
&gt; 2  chr2 0.005502743
&gt; 3  chr3 0.005475713
&gt; 4  chr4 0.005658807
&gt; 5  chr5 0.006070719
&gt; 6  chr6 0.006330737</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1"></a><span class="fu">head</span>(pi.chr.carolinensis_sd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;   CHROM          sd
&gt; 1  chr1 0.002494150
&gt; 2  chr2 0.002756872
&gt; 3  chr3 0.002648940
&gt; 4  chr4 0.002816381
&gt; 5  chr5 0.002947718
&gt; 6  chr6 0.002898186</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1"></a>chrom <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'chr1'</span>, <span class="st">'chr2'</span>, <span class="st">'chr3'</span>, <span class="st">'chr4'</span>, <span class="st">'chr5'</span>, <span class="st">'chr6'</span>,</span>
<span id="cb265-2"><a href="#cb265-2"></a>           <span class="st">'X'</span>, <span class="st">'Y'</span>)</span>
<span id="cb265-3"><a href="#cb265-3"></a></span>
<span id="cb265-4"><a href="#cb265-4"></a>pi.chr.carolinensis <span class="ot">&lt;-</span> pi.chr.carolinensis[pi.chr.carolinensis<span class="sc">$</span>CHROM <span class="sc">%in%</span> chrom, ]</span>
<span id="cb265-5"><a href="#cb265-5"></a>pi.chr.carolinensis_sd <span class="ot">&lt;-</span> pi.chr.carolinensis_sd[pi.chr.carolinensis_sd<span class="sc">$</span>CHROM <span class="sc">%in%</span></span>
<span id="cb265-6"><a href="#cb265-6"></a>                                                 chrom, ]</span>
<span id="cb265-7"><a href="#cb265-7"></a></span>
<span id="cb265-8"><a href="#cb265-8"></a></span>
<span id="cb265-9"><a href="#cb265-9"></a>pi.chr.carolinensis<span class="sc">$</span>sd <span class="ot">&lt;-</span> pi.chr.carolinensis_sd<span class="sc">$</span>sd</span>
<span id="cb265-10"><a href="#cb265-10"></a><span class="fu">str</span>(pi.chr.carolinensis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 8 obs. of  3 variables:
&gt;  $ CHROM: chr  "chr1" "chr2" "chr3" "chr4" ...
&gt;  $ pi   : num  0.00512 0.0055 0.00548 0.00566 0.00607 ...
&gt;  $ sd   : num  0.00249 0.00276 0.00265 0.00282 0.00295 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1"></a>value <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.carolinensis<span class="sc">$</span>CHROM)</span>
<span id="cb267-2"><a href="#cb267-2"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="fl">5.4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb267-3"><a href="#cb267-3"></a><span class="fu">plot</span>(pi.chr.carolinensis<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb267-4"><a href="#cb267-4"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>,</span>
<span id="cb267-5"><a href="#cb267-5"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">'Nucleotide diversity'</span><span class="sc">~</span>(pi)),</span>
<span id="cb267-6"><a href="#cb267-6"></a>     <span class="at">xlab =</span> <span class="st">'Genomic position'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb267-7"><a href="#cb267-7"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.carolinensis<span class="sc">$</span>sd),</span>
<span id="cb267-8"><a href="#cb267-8"></a>              <span class="fu">max</span>(pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.carolinensis<span class="sc">$</span>sd)))</span>
<span id="cb267-9"><a href="#cb267-9"></a><span class="fu">grid</span>()</span>
<span id="cb267-10"><a href="#cb267-10"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb267-11"><a href="#cb267-11"></a><span class="fu">plot</span>(pi.chr.carolinensis<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb267-12"><a href="#cb267-12"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb267-13"><a href="#cb267-13"></a>     <span class="at">xlab =</span> <span class="st">' '</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb267-14"><a href="#cb267-14"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.carolinensis<span class="sc">$</span>sd),</span>
<span id="cb267-15"><a href="#cb267-15"></a>              <span class="fu">max</span>(pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.carolinensis<span class="sc">$</span>sd)))</span>
<span id="cb267-16"><a href="#cb267-16"></a><span class="fu">segments</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pi.chr.carolinensis),</span>
<span id="cb267-17"><a href="#cb267-17"></a>         pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.carolinensis<span class="sc">$</span>sd,</span>
<span id="cb267-18"><a href="#cb267-18"></a>         <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pi.chr.carolinensis),</span>
<span id="cb267-19"><a href="#cb267-19"></a>         pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.carolinensis<span class="sc">$</span>sd,</span>
<span id="cb267-20"><a href="#cb267-20"></a>         <span class="at">lwd =</span> <span class="fl">2.2</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>)</span>
<span id="cb267-21"><a href="#cb267-21"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.carolinensis<span class="sc">$</span>CHROM),</span>
<span id="cb267-22"><a href="#cb267-22"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb267-23"><a href="#cb267-23"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.carolinensis<span class="sc">$</span>CHROM), <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.0007</span>, </span>
<span id="cb267-24"><a href="#cb267-24"></a>     <span class="at">labels =</span> pi.chr.carolinensis<span class="sc">$</span>CHROM, <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">xpd =</span> <span class="cn">NA</span>,</span>
<span id="cb267-25"><a href="#cb267-25"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-32-3.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1"></a><span class="do">## Tajima's D</span></span>
<span id="cb268-2"><a href="#cb268-2"></a></span>
<span id="cb268-3"><a href="#cb268-3"></a>carolinensis.td<span class="sc">$</span>CHROM[carolinensis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069367.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr1'</span></span>
<span id="cb268-4"><a href="#cb268-4"></a>carolinensis.td<span class="sc">$</span>CHROM[carolinensis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069368.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr2'</span></span>
<span id="cb268-5"><a href="#cb268-5"></a>carolinensis.td<span class="sc">$</span>CHROM[carolinensis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069369.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr3'</span></span>
<span id="cb268-6"><a href="#cb268-6"></a>carolinensis.td<span class="sc">$</span>CHROM[carolinensis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069370.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr4'</span></span>
<span id="cb268-7"><a href="#cb268-7"></a>carolinensis.td<span class="sc">$</span>CHROM[carolinensis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069371.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr5'</span></span>
<span id="cb268-8"><a href="#cb268-8"></a>carolinensis.td<span class="sc">$</span>CHROM[carolinensis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069372.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr6'</span></span>
<span id="cb268-9"><a href="#cb268-9"></a>carolinensis.td<span class="sc">$</span>CHROM[carolinensis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069373.1'</span>] <span class="ot">&lt;-</span> <span class="st">'X'</span></span>
<span id="cb268-10"><a href="#cb268-10"></a>carolinensis.td<span class="sc">$</span>CHROM[carolinensis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069374.1'</span>] <span class="ot">&lt;-</span> <span class="st">'Y'</span></span>
<span id="cb268-11"><a href="#cb268-11"></a></span>
<span id="cb268-12"><a href="#cb268-12"></a><span class="fu">str</span>(carolinensis.td)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 184730 obs. of  4 variables:
&gt;  $ CHROM    : chr  "chr1" "chr1" "chr1" "chr1" ...
&gt;  $ BIN_START: int  0 10000 20000 30000 40000 50000 60000 70000 80000 90000 ...
&gt;  $ N_SNPS   : int  155 76 147 191 150 166 241 180 122 97 ...
&gt;  $ TajimaD  : num  1.007 1.023 1.119 1.377 0.486 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1"></a>d.chr.carolinensis <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(carolinensis.td<span class="sc">$</span>TajimaD,</span>
<span id="cb270-2"><a href="#cb270-2"></a>                                <span class="fu">list</span>(carolinensis.td<span class="sc">$</span>CHROM),</span>
<span id="cb270-3"><a href="#cb270-3"></a>                                <span class="cf">function</span>(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb270-4"><a href="#cb270-4"></a><span class="fu">colnames</span>(d.chr.carolinensis) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CHROM'</span>, <span class="st">'d'</span>)</span>
<span id="cb270-5"><a href="#cb270-5"></a><span class="fu">head</span>(d.chr.carolinensis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;   CHROM         d
&gt; 1  chr1 0.1842384
&gt; 2  chr2 0.1715535
&gt; 3  chr3 0.1912435
&gt; 4  chr4 0.1204333
&gt; 5  chr5 0.1799600
&gt; 6  chr6 0.1269157</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1"></a>chrom <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'chr1'</span>, <span class="st">'chr2'</span>, <span class="st">'chr3'</span>, <span class="st">'chr4'</span>, <span class="st">'chr5'</span>, <span class="st">'chr6'</span>,</span>
<span id="cb272-2"><a href="#cb272-2"></a>           <span class="st">'X'</span>, <span class="st">'Y'</span>)</span>
<span id="cb272-3"><a href="#cb272-3"></a></span>
<span id="cb272-4"><a href="#cb272-4"></a>d.chr.carolinensis <span class="ot">&lt;-</span> d.chr.carolinensis[d.chr.carolinensis<span class="sc">$</span>CHROM <span class="sc">%in%</span> chrom, ]</span>
<span id="cb272-5"><a href="#cb272-5"></a></span>
<span id="cb272-6"><a href="#cb272-6"></a>d.chr.carolinensis</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;     CHROM         d
&gt; 1    chr1 0.1842384
&gt; 2    chr2 0.1715535
&gt; 3    chr3 0.1912435
&gt; 4    chr4 0.1204333
&gt; 5    chr5 0.1799600
&gt; 6    chr6 0.1269157
&gt; 164     X 0.7439540
&gt; 165     Y 0.9187526</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1"></a><span class="fu">str</span>(d.chr.carolinensis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 8 obs. of  2 variables:
&gt;  $ CHROM: chr  "chr1" "chr2" "chr3" "chr4" ...
&gt;  $ d    : num  0.184 0.172 0.191 0.12 0.18 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1"></a>value <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.carolinensis<span class="sc">$</span>CHROM)</span>
<span id="cb276-2"><a href="#cb276-2"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="fl">5.4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb276-3"><a href="#cb276-3"></a><span class="fu">plot</span>(d.chr.carolinensis<span class="sc">$</span>d <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb276-4"><a href="#cb276-4"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Tajima's D"</span>),</span>
<span id="cb276-5"><a href="#cb276-5"></a>     <span class="at">xlab =</span> <span class="st">'Genomic position'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>)</span>
<span id="cb276-6"><a href="#cb276-6"></a><span class="fu">grid</span>()</span>
<span id="cb276-7"><a href="#cb276-7"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb276-8"><a href="#cb276-8"></a><span class="fu">plot</span>(d.chr.carolinensis<span class="sc">$</span>d <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb276-9"><a href="#cb276-9"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb276-10"><a href="#cb276-10"></a>     <span class="at">xlab =</span> <span class="st">' '</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb276-11"><a href="#cb276-11"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.carolinensis<span class="sc">$</span>CHROM),</span>
<span id="cb276-12"><a href="#cb276-12"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb276-13"><a href="#cb276-13"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.carolinensis<span class="sc">$</span>CHROM), <span class="at">y =</span> <span class="fl">0.05</span>, </span>
<span id="cb276-14"><a href="#cb276-14"></a>     <span class="at">labels =</span> d.chr.carolinensis<span class="sc">$</span>CHROM, <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">xpd =</span> <span class="cn">NA</span>,</span>
<span id="cb276-15"><a href="#cb276-15"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-32-4.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1"></a><span class="do">## Nucleotide diveristy</span></span>
<span id="cb277-2"><a href="#cb277-2"></a></span>
<span id="cb277-3"><a href="#cb277-3"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076838.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr1'</span></span>
<span id="cb277-4"><a href="#cb277-4"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076839.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr2'</span></span>
<span id="cb277-5"><a href="#cb277-5"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076840.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr3'</span></span>
<span id="cb277-6"><a href="#cb277-6"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076841.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr4'</span></span>
<span id="cb277-7"><a href="#cb277-7"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076842.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr5'</span></span>
<span id="cb277-8"><a href="#cb277-8"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076843.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr6'</span></span>
<span id="cb277-9"><a href="#cb277-9"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076844.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr7'</span></span>
<span id="cb277-10"><a href="#cb277-10"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076845.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr8'</span></span>
<span id="cb277-11"><a href="#cb277-11"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076846.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr9'</span></span>
<span id="cb277-12"><a href="#cb277-12"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076847.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr10'</span></span>
<span id="cb277-13"><a href="#cb277-13"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076848.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr11'</span></span>
<span id="cb277-14"><a href="#cb277-14"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076849.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr12'</span></span>
<span id="cb277-15"><a href="#cb277-15"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076850.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr13'</span></span>
<span id="cb277-16"><a href="#cb277-16"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076851.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr14'</span></span>
<span id="cb277-17"><a href="#cb277-17"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076853.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr15'</span></span>
<span id="cb277-18"><a href="#cb277-18"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076854.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr16'</span></span>
<span id="cb277-19"><a href="#cb277-19"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076855.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr17'</span></span>
<span id="cb277-20"><a href="#cb277-20"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076857.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr18'</span></span>
<span id="cb277-21"><a href="#cb277-21"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076856.1'</span>] <span class="ot">&lt;-</span> <span class="st">'W'</span></span>
<span id="cb277-22"><a href="#cb277-22"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076852.1'</span>] <span class="ot">&lt;-</span> <span class="st">'Z'</span></span>
<span id="cb277-23"><a href="#cb277-23"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076858.1'</span>] <span class="ot">&lt;-</span> <span class="st">'MT'</span></span>
<span id="cb277-24"><a href="#cb277-24"></a></span>
<span id="cb277-25"><a href="#cb277-25"></a><span class="fu">str</span>(siculus.nd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 150255 obs. of  5 variables:
&gt;  $ CHROM     : chr  "chr1" "chr1" "chr1" "chr1" ...
&gt;  $ BIN_START : int  10001 20001 30001 40001 50001 60001 70001 80001 90001 100001 ...
&gt;  $ BIN_END   : int  20000 30000 40000 50000 60000 70000 80000 90000 100000 110000 ...
&gt;  $ N_VARIANTS: int  204 155 97 44 30 97 61 27 148 91 ...
&gt;  $ PI        : num  0.0083 0.00812 0.00546 0.00194 0.00122 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1"></a>pi.chr.siculus <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(siculus.nd<span class="sc">$</span>PI,</span>
<span id="cb279-2"><a href="#cb279-2"></a>                           <span class="fu">list</span>(siculus.nd<span class="sc">$</span>CHROM), mean)</span>
<span id="cb279-3"><a href="#cb279-3"></a><span class="fu">colnames</span>(pi.chr.siculus) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CHROM'</span>, <span class="st">'pi'</span>)</span>
<span id="cb279-4"><a href="#cb279-4"></a><span class="fu">head</span>(pi.chr.siculus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;               CHROM           pi
&gt; 1 CAXLOV010000001.1 0.0002112068
&gt; 2 CAXLOV010000002.1 0.0003645594
&gt; 3 CAXLOV010000003.1 0.0018667109
&gt; 4 CAXLOV010000004.1 0.0002367875
&gt; 5 CAXLOV010000005.1 0.0003552539
&gt; 6 CAXLOV010000006.1 0.0001114468</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1"></a>chrom <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'chr1'</span>, <span class="st">'chr2'</span>, <span class="st">'chr3'</span>, <span class="st">'chr4'</span>, <span class="st">'chr5'</span>, <span class="st">'chr6'</span>,</span>
<span id="cb281-2"><a href="#cb281-2"></a>  <span class="st">'chr7'</span>, <span class="st">'chr8'</span>, <span class="st">'chr9'</span>, <span class="st">'chr10'</span>, <span class="st">'chr11'</span>, <span class="st">'chr12'</span>,</span>
<span id="cb281-3"><a href="#cb281-3"></a>  <span class="st">'chr13'</span>, <span class="st">'chr14'</span>, <span class="st">'chr15'</span>, <span class="st">'chr16'</span>, <span class="st">'chr17'</span>, <span class="st">'chr18'</span>,</span>
<span id="cb281-4"><a href="#cb281-4"></a>  <span class="st">'W'</span>, <span class="st">'Z'</span>, <span class="st">'MT'</span>)</span>
<span id="cb281-5"><a href="#cb281-5"></a></span>
<span id="cb281-6"><a href="#cb281-6"></a>pi.chr.siculus <span class="ot">&lt;-</span> pi.chr.siculus[pi.chr.siculus<span class="sc">$</span>CHROM <span class="sc">%in%</span> chrom, ]</span>
<span id="cb281-7"><a href="#cb281-7"></a>ordered <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb281-8"><a href="#cb281-8"></a><span class="cf">for</span>(i <span class="cf">in</span> chrom){</span>
<span id="cb281-9"><a href="#cb281-9"></a>    obj <span class="ot">&lt;-</span> pi.chr.siculus[pi.chr.siculus<span class="sc">$</span>CHROM <span class="sc">==</span> i, ]</span>
<span id="cb281-10"><a href="#cb281-10"></a>    ordered <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ordered, obj)</span>
<span id="cb281-11"><a href="#cb281-11"></a>}</span>
<span id="cb281-12"><a href="#cb281-12"></a>pi.chr.siculus <span class="ot">&lt;-</span> ordered</span>
<span id="cb281-13"><a href="#cb281-13"></a></span>
<span id="cb281-14"><a href="#cb281-14"></a></span>
<span id="cb281-15"><a href="#cb281-15"></a>value <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.siculus<span class="sc">$</span>CHROM)</span>
<span id="cb281-16"><a href="#cb281-16"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="fl">5.4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb281-17"><a href="#cb281-17"></a><span class="fu">plot</span>(pi.chr.siculus<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb281-18"><a href="#cb281-18"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>,</span>
<span id="cb281-19"><a href="#cb281-19"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">'Nucleotide diversity'</span><span class="sc">~</span>(pi)),</span>
<span id="cb281-20"><a href="#cb281-20"></a>     <span class="at">xlab =</span> <span class="st">'Genomic position'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>)</span>
<span id="cb281-21"><a href="#cb281-21"></a><span class="fu">grid</span>()</span>
<span id="cb281-22"><a href="#cb281-22"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb281-23"><a href="#cb281-23"></a><span class="fu">plot</span>(pi.chr.siculus<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb281-24"><a href="#cb281-24"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb281-25"><a href="#cb281-25"></a>     <span class="at">xlab =</span> <span class="st">' '</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb281-26"><a href="#cb281-26"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.siculus<span class="sc">$</span>CHROM),</span>
<span id="cb281-27"><a href="#cb281-27"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb281-28"><a href="#cb281-28"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.siculus<span class="sc">$</span>CHROM), <span class="at">y =</span> <span class="fl">0.0028</span>, </span>
<span id="cb281-29"><a href="#cb281-29"></a>     <span class="at">labels =</span> pi.chr.siculus<span class="sc">$</span>CHROM, <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">xpd =</span> <span class="cn">NA</span>,</span>
<span id="cb281-30"><a href="#cb281-30"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-32-5.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1"></a><span class="do">## Tajima's D</span></span>
<span id="cb282-2"><a href="#cb282-2"></a></span>
<span id="cb282-3"><a href="#cb282-3"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076838.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr1'</span></span>
<span id="cb282-4"><a href="#cb282-4"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076839.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr2'</span></span>
<span id="cb282-5"><a href="#cb282-5"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076840.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr3'</span></span>
<span id="cb282-6"><a href="#cb282-6"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076841.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr4'</span></span>
<span id="cb282-7"><a href="#cb282-7"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076842.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr5'</span></span>
<span id="cb282-8"><a href="#cb282-8"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076843.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr6'</span></span>
<span id="cb282-9"><a href="#cb282-9"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076844.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr7'</span></span>
<span id="cb282-10"><a href="#cb282-10"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076845.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr8'</span></span>
<span id="cb282-11"><a href="#cb282-11"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076846.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr9'</span></span>
<span id="cb282-12"><a href="#cb282-12"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076847.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr10'</span></span>
<span id="cb282-13"><a href="#cb282-13"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076848.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr11'</span></span>
<span id="cb282-14"><a href="#cb282-14"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076849.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr12'</span></span>
<span id="cb282-15"><a href="#cb282-15"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076850.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr13'</span></span>
<span id="cb282-16"><a href="#cb282-16"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076851.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr14'</span></span>
<span id="cb282-17"><a href="#cb282-17"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076853.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr15'</span></span>
<span id="cb282-18"><a href="#cb282-18"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076854.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr16'</span></span>
<span id="cb282-19"><a href="#cb282-19"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076855.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr17'</span></span>
<span id="cb282-20"><a href="#cb282-20"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076857.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr18'</span></span>
<span id="cb282-21"><a href="#cb282-21"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076856.1'</span>] <span class="ot">&lt;-</span> <span class="st">'W'</span></span>
<span id="cb282-22"><a href="#cb282-22"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076852.1'</span>] <span class="ot">&lt;-</span> <span class="st">'Z'</span></span>
<span id="cb282-23"><a href="#cb282-23"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076858.1'</span>] <span class="ot">&lt;-</span> <span class="st">'MT'</span></span>
<span id="cb282-24"><a href="#cb282-24"></a></span>
<span id="cb282-25"><a href="#cb282-25"></a><span class="fu">str</span>(siculus.td)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 155355 obs. of  4 variables:
&gt;  $ CHROM    : chr  "chr1" "chr1" "chr1" "chr1" ...
&gt;  $ BIN_START: int  10000 20000 30000 40000 50000 60000 70000 80000 90000 100000 ...
&gt;  $ N_SNPS   : int  199 151 89 44 30 95 61 26 146 86 ...
&gt;  $ TajimaD  : num  0.463 0.187 1.247 0.361 1.771 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1"></a>d.chr.siculus <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(siculus.td<span class="sc">$</span>TajimaD,</span>
<span id="cb284-2"><a href="#cb284-2"></a>                           <span class="fu">list</span>(siculus.td<span class="sc">$</span>CHROM),</span>
<span id="cb284-3"><a href="#cb284-3"></a>                           <span class="cf">function</span>(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb284-4"><a href="#cb284-4"></a><span class="fu">colnames</span>(d.chr.siculus) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CHROM'</span>, <span class="st">'d'</span>)</span>
<span id="cb284-5"><a href="#cb284-5"></a><span class="fu">head</span>(d.chr.siculus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;               CHROM        d
&gt; 1 CAXLOV010000001.1 1.547345
&gt; 2 CAXLOV010000002.1 1.404756
&gt; 3 CAXLOV010000003.1 1.466791
&gt; 4 CAXLOV010000004.1 1.908150
&gt; 5 CAXLOV010000005.1 1.068272
&gt; 6 CAXLOV010000006.1 1.852765</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1"></a>chrom <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'chr1'</span>, <span class="st">'chr2'</span>, <span class="st">'chr3'</span>, <span class="st">'chr4'</span>, <span class="st">'chr5'</span>, <span class="st">'chr6'</span>,</span>
<span id="cb286-2"><a href="#cb286-2"></a>  <span class="st">'chr7'</span>, <span class="st">'chr8'</span>, <span class="st">'chr9'</span>, <span class="st">'chr10'</span>, <span class="st">'chr11'</span>, <span class="st">'chr12'</span>,</span>
<span id="cb286-3"><a href="#cb286-3"></a>  <span class="st">'chr13'</span>, <span class="st">'chr14'</span>, <span class="st">'chr15'</span>, <span class="st">'chr16'</span>, <span class="st">'chr17'</span>, <span class="st">'chr18'</span>,</span>
<span id="cb286-4"><a href="#cb286-4"></a>  <span class="st">'W'</span>, <span class="st">'Z'</span>, <span class="st">'MT'</span>)</span>
<span id="cb286-5"><a href="#cb286-5"></a></span>
<span id="cb286-6"><a href="#cb286-6"></a>d.chr.siculus <span class="ot">&lt;-</span> d.chr.siculus[d.chr.siculus<span class="sc">$</span>CHROM <span class="sc">%in%</span> chrom, ]</span>
<span id="cb286-7"><a href="#cb286-7"></a>ordered <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb286-8"><a href="#cb286-8"></a><span class="cf">for</span>(i <span class="cf">in</span> chrom){</span>
<span id="cb286-9"><a href="#cb286-9"></a>    obj <span class="ot">&lt;-</span> d.chr.siculus[d.chr.siculus<span class="sc">$</span>CHROM <span class="sc">==</span> i, ]</span>
<span id="cb286-10"><a href="#cb286-10"></a>    ordered <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ordered, obj)</span>
<span id="cb286-11"><a href="#cb286-11"></a>}</span>
<span id="cb286-12"><a href="#cb286-12"></a>d.chr.siculus <span class="ot">&lt;-</span> ordered</span>
<span id="cb286-13"><a href="#cb286-13"></a></span>
<span id="cb286-14"><a href="#cb286-14"></a></span>
<span id="cb286-15"><a href="#cb286-15"></a>value <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.siculus<span class="sc">$</span>CHROM)</span>
<span id="cb286-16"><a href="#cb286-16"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="fl">5.4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb286-17"><a href="#cb286-17"></a><span class="fu">plot</span>(d.chr.siculus<span class="sc">$</span>d <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb286-18"><a href="#cb286-18"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Tajima's D"</span>),</span>
<span id="cb286-19"><a href="#cb286-19"></a>     <span class="at">xlab =</span> <span class="st">'Genomic position'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>)</span>
<span id="cb286-20"><a href="#cb286-20"></a><span class="fu">grid</span>()</span>
<span id="cb286-21"><a href="#cb286-21"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb286-22"><a href="#cb286-22"></a><span class="fu">plot</span>(d.chr.siculus<span class="sc">$</span>d <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb286-23"><a href="#cb286-23"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb286-24"><a href="#cb286-24"></a>     <span class="at">xlab =</span> <span class="st">' '</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb286-25"><a href="#cb286-25"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.siculus<span class="sc">$</span>CHROM),</span>
<span id="cb286-26"><a href="#cb286-26"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb286-27"><a href="#cb286-27"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.siculus<span class="sc">$</span>CHROM), <span class="at">y =</span> <span class="fl">0.65</span>, </span>
<span id="cb286-28"><a href="#cb286-28"></a>     <span class="at">labels =</span> d.chr.siculus<span class="sc">$</span>CHROM, <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">xpd =</span> <span class="cn">NA</span>,</span>
<span id="cb286-29"><a href="#cb286-29"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-32-6.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1"></a><span class="do">## Nucleotide diveristy</span></span>
<span id="cb287-2"><a href="#cb287-2"></a></span>
<span id="cb287-3"><a href="#cb287-3"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041312.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr1'</span></span>
<span id="cb287-4"><a href="#cb287-4"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041313.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr2'</span></span>
<span id="cb287-5"><a href="#cb287-5"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041314.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr3'</span></span>
<span id="cb287-6"><a href="#cb287-6"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041315.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr4'</span></span>
<span id="cb287-7"><a href="#cb287-7"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041316.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr5'</span></span>
<span id="cb287-8"><a href="#cb287-8"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041317.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr6'</span></span>
<span id="cb287-9"><a href="#cb287-9"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041318.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr7'</span></span>
<span id="cb287-10"><a href="#cb287-10"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041319.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr8'</span></span>
<span id="cb287-11"><a href="#cb287-11"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041320.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr9'</span></span>
<span id="cb287-12"><a href="#cb287-12"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041321.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr10'</span></span>
<span id="cb287-13"><a href="#cb287-13"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041322.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr11'</span></span>
<span id="cb287-14"><a href="#cb287-14"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041323.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr12'</span></span>
<span id="cb287-15"><a href="#cb287-15"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041324.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr13'</span></span>
<span id="cb287-16"><a href="#cb287-16"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041325.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr14'</span></span>
<span id="cb287-17"><a href="#cb287-17"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041326.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr15'</span></span>
<span id="cb287-18"><a href="#cb287-18"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041327.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr16'</span></span>
<span id="cb287-19"><a href="#cb287-19"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041328.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr17'</span></span>
<span id="cb287-20"><a href="#cb287-20"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041329.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr18'</span></span>
<span id="cb287-21"><a href="#cb287-21"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041330.1'</span>] <span class="ot">&lt;-</span> <span class="st">'Z'</span></span>
<span id="cb287-22"><a href="#cb287-22"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_011607.1'</span>] <span class="ot">&lt;-</span> <span class="st">'MT'</span></span>
<span id="cb287-23"><a href="#cb287-23"></a></span>
<span id="cb287-24"><a href="#cb287-24"></a></span>
<span id="cb287-25"><a href="#cb287-25"></a><span class="fu">str</span>(muralis.nd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 151340 obs. of  5 variables:
&gt;  $ CHROM     : chr  "chr1" "chr1" "chr1" "chr1" ...
&gt;  $ BIN_START : int  1 10001 20001 30001 40001 50001 60001 70001 80001 90001 ...
&gt;  $ BIN_END   : int  10000 20000 30000 40000 50000 60000 70000 80000 90000 100000 ...
&gt;  $ N_VARIANTS: int  115 289 139 132 95 265 194 70 152 288 ...
&gt;  $ PI        : num  0.00255 0.00994 0.00406 0.00352 0.00292 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1"></a>pi.chr.muralis <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(muralis.nd<span class="sc">$</span>PI,</span>
<span id="cb289-2"><a href="#cb289-2"></a>                           <span class="fu">list</span>(muralis.nd<span class="sc">$</span>CHROM), mean)</span>
<span id="cb289-3"><a href="#cb289-3"></a>pi.chr.muralis_sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(muralis.nd<span class="sc">$</span>PI,</span>
<span id="cb289-4"><a href="#cb289-4"></a>                           <span class="fu">list</span>(muralis.nd<span class="sc">$</span>CHROM), sd)</span>
<span id="cb289-5"><a href="#cb289-5"></a></span>
<span id="cb289-6"><a href="#cb289-6"></a><span class="fu">colnames</span>(pi.chr.muralis) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CHROM'</span>, <span class="st">'pi'</span>)</span>
<span id="cb289-7"><a href="#cb289-7"></a><span class="fu">colnames</span>(pi.chr.muralis_sd) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CHROM'</span>, <span class="st">'sd'</span>)</span>
<span id="cb289-8"><a href="#cb289-8"></a><span class="fu">head</span>(pi.chr.muralis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;   CHROM         pi
&gt; 1  chr1 0.01120494
&gt; 2 chr10 0.01174881
&gt; 3 chr11 0.01170326
&gt; 4 chr12 0.01201075
&gt; 5 chr13 0.01347577
&gt; 6 chr14 0.01273662</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1"></a><span class="fu">head</span>(pi.chr.muralis_sd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;   CHROM          sd
&gt; 1  chr1 0.004328006
&gt; 2 chr10 0.004635450
&gt; 3 chr11 0.004571697
&gt; 4 chr12 0.004998158
&gt; 5 chr13 0.005758774
&gt; 6 chr14 0.004844764</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1"></a>chrom <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'chr1'</span>, <span class="st">'chr2'</span>, <span class="st">'chr3'</span>, <span class="st">'chr4'</span>, <span class="st">'chr5'</span>, <span class="st">'chr6'</span>,</span>
<span id="cb293-2"><a href="#cb293-2"></a>  <span class="st">'chr7'</span>, <span class="st">'chr8'</span>, <span class="st">'chr9'</span>, <span class="st">'chr10'</span>, <span class="st">'chr11'</span>, <span class="st">'chr12'</span>,</span>
<span id="cb293-3"><a href="#cb293-3"></a>  <span class="st">'chr13'</span>, <span class="st">'chr14'</span>, <span class="st">'chr15'</span>, <span class="st">'chr16'</span>, <span class="st">'chr17'</span>, <span class="st">'chr18'</span>,</span>
<span id="cb293-4"><a href="#cb293-4"></a>  <span class="st">'Z'</span>, <span class="st">'MT'</span>)</span>
<span id="cb293-5"><a href="#cb293-5"></a></span>
<span id="cb293-6"><a href="#cb293-6"></a>pi.chr.muralis <span class="ot">&lt;-</span> pi.chr.muralis[pi.chr.muralis<span class="sc">$</span>CHROM <span class="sc">%in%</span> chrom, ]</span>
<span id="cb293-7"><a href="#cb293-7"></a>ordered <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb293-8"><a href="#cb293-8"></a><span class="cf">for</span>(i <span class="cf">in</span> chrom){</span>
<span id="cb293-9"><a href="#cb293-9"></a>    obj <span class="ot">&lt;-</span> pi.chr.muralis[pi.chr.muralis<span class="sc">$</span>CHROM <span class="sc">==</span> i, ]</span>
<span id="cb293-10"><a href="#cb293-10"></a>    ordered <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ordered, obj)</span>
<span id="cb293-11"><a href="#cb293-11"></a>}</span>
<span id="cb293-12"><a href="#cb293-12"></a>pi.chr.muralis <span class="ot">&lt;-</span> ordered</span>
<span id="cb293-13"><a href="#cb293-13"></a></span>
<span id="cb293-14"><a href="#cb293-14"></a>pi.chr.muralis_sd <span class="ot">&lt;-</span> pi.chr.muralis_sd[pi.chr.muralis_sd<span class="sc">$</span>CHROM <span class="sc">%in%</span> chrom, ]</span>
<span id="cb293-15"><a href="#cb293-15"></a>ordered <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb293-16"><a href="#cb293-16"></a><span class="cf">for</span>(i <span class="cf">in</span> chrom){</span>
<span id="cb293-17"><a href="#cb293-17"></a>    obj <span class="ot">&lt;-</span> pi.chr.muralis_sd[pi.chr.muralis_sd<span class="sc">$</span>CHROM <span class="sc">==</span> i, ]</span>
<span id="cb293-18"><a href="#cb293-18"></a>    ordered <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ordered, obj)</span>
<span id="cb293-19"><a href="#cb293-19"></a>}</span>
<span id="cb293-20"><a href="#cb293-20"></a>pi.chr.muralis_sd <span class="ot">&lt;-</span> ordered</span>
<span id="cb293-21"><a href="#cb293-21"></a>pi.chr.muralis<span class="sc">$</span>sd <span class="ot">&lt;-</span> pi.chr.muralis_sd<span class="sc">$</span>sd</span>
<span id="cb293-22"><a href="#cb293-22"></a></span>
<span id="cb293-23"><a href="#cb293-23"></a>value <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.muralis<span class="sc">$</span>CHROM)</span>
<span id="cb293-24"><a href="#cb293-24"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="fl">5.4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb293-25"><a href="#cb293-25"></a><span class="fu">plot</span>(pi.chr.muralis<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb293-26"><a href="#cb293-26"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>,</span>
<span id="cb293-27"><a href="#cb293-27"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">'Nucleotide diversity'</span><span class="sc">~</span>(pi)),</span>
<span id="cb293-28"><a href="#cb293-28"></a>     <span class="at">xlab =</span> <span class="st">'Genomic position'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb293-29"><a href="#cb293-29"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(pi.chr.muralis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.muralis<span class="sc">$</span>sd),</span>
<span id="cb293-30"><a href="#cb293-30"></a>              <span class="fu">max</span>(pi.chr.muralis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.muralis<span class="sc">$</span>sd)))</span>
<span id="cb293-31"><a href="#cb293-31"></a><span class="fu">grid</span>()</span>
<span id="cb293-32"><a href="#cb293-32"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb293-33"><a href="#cb293-33"></a><span class="fu">plot</span>(pi.chr.muralis<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb293-34"><a href="#cb293-34"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb293-35"><a href="#cb293-35"></a>     <span class="at">xlab =</span> <span class="st">' '</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb293-36"><a href="#cb293-36"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(pi.chr.muralis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.muralis<span class="sc">$</span>sd),</span>
<span id="cb293-37"><a href="#cb293-37"></a>              <span class="fu">max</span>(pi.chr.muralis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.muralis<span class="sc">$</span>sd)))</span>
<span id="cb293-38"><a href="#cb293-38"></a><span class="fu">segments</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pi.chr.muralis),</span>
<span id="cb293-39"><a href="#cb293-39"></a>         pi.chr.muralis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.muralis<span class="sc">$</span>sd,</span>
<span id="cb293-40"><a href="#cb293-40"></a>         <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pi.chr.muralis),</span>
<span id="cb293-41"><a href="#cb293-41"></a>         pi.chr.muralis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.muralis<span class="sc">$</span>sd,</span>
<span id="cb293-42"><a href="#cb293-42"></a>         <span class="at">lwd =</span> <span class="fl">2.2</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>)</span>
<span id="cb293-43"><a href="#cb293-43"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.muralis<span class="sc">$</span>CHROM),</span>
<span id="cb293-44"><a href="#cb293-44"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb293-45"><a href="#cb293-45"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.muralis<span class="sc">$</span>CHROM), <span class="at">y =</span> <span class="fl">0.0029</span>, </span>
<span id="cb293-46"><a href="#cb293-46"></a>     <span class="at">labels =</span> pi.chr.muralis<span class="sc">$</span>CHROM, <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">xpd =</span> <span class="cn">NA</span>,</span>
<span id="cb293-47"><a href="#cb293-47"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-32-7.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1"></a><span class="do">## Tajima's D</span></span>
<span id="cb294-2"><a href="#cb294-2"></a></span>
<span id="cb294-3"><a href="#cb294-3"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041312.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr1'</span></span>
<span id="cb294-4"><a href="#cb294-4"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041313.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr2'</span></span>
<span id="cb294-5"><a href="#cb294-5"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041314.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr3'</span></span>
<span id="cb294-6"><a href="#cb294-6"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041315.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr4'</span></span>
<span id="cb294-7"><a href="#cb294-7"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041316.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr5'</span></span>
<span id="cb294-8"><a href="#cb294-8"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041317.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr6'</span></span>
<span id="cb294-9"><a href="#cb294-9"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041318.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr7'</span></span>
<span id="cb294-10"><a href="#cb294-10"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041319.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr8'</span></span>
<span id="cb294-11"><a href="#cb294-11"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041320.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr9'</span></span>
<span id="cb294-12"><a href="#cb294-12"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041321.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr10'</span></span>
<span id="cb294-13"><a href="#cb294-13"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041322.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr11'</span></span>
<span id="cb294-14"><a href="#cb294-14"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041323.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr12'</span></span>
<span id="cb294-15"><a href="#cb294-15"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041324.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr13'</span></span>
<span id="cb294-16"><a href="#cb294-16"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041325.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr14'</span></span>
<span id="cb294-17"><a href="#cb294-17"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041326.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr15'</span></span>
<span id="cb294-18"><a href="#cb294-18"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041327.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr16'</span></span>
<span id="cb294-19"><a href="#cb294-19"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041328.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr17'</span></span>
<span id="cb294-20"><a href="#cb294-20"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041329.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr18'</span></span>
<span id="cb294-21"><a href="#cb294-21"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041330.1'</span>] <span class="ot">&lt;-</span> <span class="st">'Z'</span></span>
<span id="cb294-22"><a href="#cb294-22"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_011607.1'</span>] <span class="ot">&lt;-</span> <span class="st">'MT'</span></span>
<span id="cb294-23"><a href="#cb294-23"></a></span>
<span id="cb294-24"><a href="#cb294-24"></a><span class="fu">str</span>(muralis.td)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt; 'data.frame': 151623 obs. of  4 variables:
&gt;  $ CHROM    : chr  "chr1" "chr1" "chr1" "chr1" ...
&gt;  $ BIN_START: int  0 10000 20000 30000 40000 50000 60000 70000 80000 90000 ...
&gt;  $ N_SNPS   : int  112 264 130 128 93 247 180 68 146 275 ...
&gt;  $ TajimaD  : num  1.568 0.139 0.188 1.218 1.248 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1"></a>d.chr.muralis <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(muralis.td<span class="sc">$</span>TajimaD,</span>
<span id="cb296-2"><a href="#cb296-2"></a>                           <span class="fu">list</span>(muralis.td<span class="sc">$</span>CHROM),</span>
<span id="cb296-3"><a href="#cb296-3"></a>                           <span class="cf">function</span>(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb296-4"><a href="#cb296-4"></a><span class="fu">colnames</span>(d.chr.muralis) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CHROM'</span>, <span class="st">'d'</span>)</span>
<span id="cb296-5"><a href="#cb296-5"></a><span class="fu">head</span>(d.chr.muralis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;   CHROM         d
&gt; 1  chr1 0.3015808
&gt; 2 chr10 0.3913805
&gt; 3 chr11 0.3129301
&gt; 4 chr12 0.3506554
&gt; 5 chr13 0.4130814
&gt; 6 chr14 0.4024010</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1"></a>chrom <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'chr1'</span>, <span class="st">'chr2'</span>, <span class="st">'chr3'</span>, <span class="st">'chr4'</span>, <span class="st">'chr5'</span>, <span class="st">'chr6'</span>,</span>
<span id="cb298-2"><a href="#cb298-2"></a>  <span class="st">'chr7'</span>, <span class="st">'chr8'</span>, <span class="st">'chr9'</span>, <span class="st">'chr10'</span>, <span class="st">'chr11'</span>, <span class="st">'chr12'</span>,</span>
<span id="cb298-3"><a href="#cb298-3"></a>  <span class="st">'chr13'</span>, <span class="st">'chr14'</span>, <span class="st">'chr15'</span>, <span class="st">'chr16'</span>, <span class="st">'chr17'</span>, <span class="st">'chr18'</span>,</span>
<span id="cb298-4"><a href="#cb298-4"></a>  <span class="st">'Z'</span>, <span class="st">'MT'</span>)</span>
<span id="cb298-5"><a href="#cb298-5"></a></span>
<span id="cb298-6"><a href="#cb298-6"></a>d.chr.muralis <span class="ot">&lt;-</span> d.chr.muralis[d.chr.muralis<span class="sc">$</span>CHROM <span class="sc">%in%</span> chrom, ]</span>
<span id="cb298-7"><a href="#cb298-7"></a>ordered <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb298-8"><a href="#cb298-8"></a><span class="cf">for</span>(i <span class="cf">in</span> chrom){</span>
<span id="cb298-9"><a href="#cb298-9"></a>    obj <span class="ot">&lt;-</span> d.chr.muralis[d.chr.muralis<span class="sc">$</span>CHROM <span class="sc">==</span> i, ]</span>
<span id="cb298-10"><a href="#cb298-10"></a>    ordered <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ordered, obj)</span>
<span id="cb298-11"><a href="#cb298-11"></a>}</span>
<span id="cb298-12"><a href="#cb298-12"></a>d.chr.muralis <span class="ot">&lt;-</span> ordered</span>
<span id="cb298-13"><a href="#cb298-13"></a></span>
<span id="cb298-14"><a href="#cb298-14"></a></span>
<span id="cb298-15"><a href="#cb298-15"></a>value <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.muralis<span class="sc">$</span>CHROM)</span>
<span id="cb298-16"><a href="#cb298-16"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="fl">5.4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb298-17"><a href="#cb298-17"></a><span class="fu">plot</span>(d.chr.muralis<span class="sc">$</span>d <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb298-18"><a href="#cb298-18"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Tajima's D"</span>),</span>
<span id="cb298-19"><a href="#cb298-19"></a>     <span class="at">xlab =</span> <span class="st">'Genomic position'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>)</span>
<span id="cb298-20"><a href="#cb298-20"></a><span class="fu">grid</span>()</span>
<span id="cb298-21"><a href="#cb298-21"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb298-22"><a href="#cb298-22"></a><span class="fu">plot</span>(d.chr.muralis<span class="sc">$</span>d <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb298-23"><a href="#cb298-23"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb298-24"><a href="#cb298-24"></a>     <span class="at">xlab =</span> <span class="st">' '</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb298-25"><a href="#cb298-25"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.muralis<span class="sc">$</span>CHROM),</span>
<span id="cb298-26"><a href="#cb298-26"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb298-27"><a href="#cb298-27"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.muralis<span class="sc">$</span>CHROM), <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.029</span>, </span>
<span id="cb298-28"><a href="#cb298-28"></a>     <span class="at">labels =</span> d.chr.muralis<span class="sc">$</span>CHROM, <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">xpd =</span> <span class="cn">NA</span>,</span>
<span id="cb298-29"><a href="#cb298-29"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-32-8.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1"></a><span class="do">##png('./imgs/figure6.png', width = 7, height = 7, units = 'in',</span></span>
<span id="cb299-2"><a href="#cb299-2"></a><span class="do">##    res = 360)</span></span>
<span id="cb299-3"><a href="#cb299-3"></a></span>
<span id="cb299-4"><a href="#cb299-4"></a></span>
<span id="cb299-5"><a href="#cb299-5"></a><span class="do">## Creating a multipanel figure</span></span>
<span id="cb299-6"><a href="#cb299-6"></a></span>
<span id="cb299-7"><a href="#cb299-7"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb299-8"><a href="#cb299-8"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb299-9"><a href="#cb299-9"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb299-10"><a href="#cb299-10"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">4</span>,</span>
<span id="cb299-11"><a href="#cb299-11"></a>              <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb299-12"><a href="#cb299-12"></a></span>
<span id="cb299-13"><a href="#cb299-13"></a></span>
<span id="cb299-14"><a href="#cb299-14"></a><span class="do">## Anolis carolinensis (pi)</span></span>
<span id="cb299-15"><a href="#cb299-15"></a></span>
<span id="cb299-16"><a href="#cb299-16"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">3.8</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb299-17"><a href="#cb299-17"></a></span>
<span id="cb299-18"><a href="#cb299-18"></a>value <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.carolinensis<span class="sc">$</span>CHROM)</span>
<span id="cb299-19"><a href="#cb299-19"></a><span class="fu">plot</span>(pi.chr.carolinensis<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb299-20"><a href="#cb299-20"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>,</span>
<span id="cb299-21"><a href="#cb299-21"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">'Nucleotide diversity'</span><span class="sc">~</span>(pi)),</span>
<span id="cb299-22"><a href="#cb299-22"></a>     <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>, <span class="at">cex.lab =</span> <span class="fl">1.5</span>,</span>
<span id="cb299-23"><a href="#cb299-23"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.carolinensis<span class="sc">$</span>sd),</span>
<span id="cb299-24"><a href="#cb299-24"></a>              <span class="fu">max</span>(pi.chr.muralis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.muralis<span class="sc">$</span>sd)))     </span>
<span id="cb299-25"><a href="#cb299-25"></a><span class="fu">grid</span>()</span>
<span id="cb299-26"><a href="#cb299-26"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb299-27"><a href="#cb299-27"></a><span class="fu">plot</span>(pi.chr.carolinensis<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb299-28"><a href="#cb299-28"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb299-29"><a href="#cb299-29"></a>     <span class="at">xlab =</span> <span class="st">' '</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb299-30"><a href="#cb299-30"></a><span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.carolinensis<span class="sc">$</span>sd),</span>
<span id="cb299-31"><a href="#cb299-31"></a>              <span class="fu">max</span>(pi.chr.muralis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.muralis<span class="sc">$</span>sd)))</span>
<span id="cb299-32"><a href="#cb299-32"></a><span class="fu">legend</span>(<span class="st">'topleft'</span>, <span class="at">legend =</span> <span class="st">'n = 5'</span>, <span class="at">bty =</span> <span class="st">'n'</span>)</span>
<span id="cb299-33"><a href="#cb299-33"></a><span class="fu">segments</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pi.chr.carolinensis),</span>
<span id="cb299-34"><a href="#cb299-34"></a>         pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.carolinensis<span class="sc">$</span>sd,</span>
<span id="cb299-35"><a href="#cb299-35"></a>         <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pi.chr.carolinensis),</span>
<span id="cb299-36"><a href="#cb299-36"></a>         pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.carolinensis<span class="sc">$</span>sd,</span>
<span id="cb299-37"><a href="#cb299-37"></a>         <span class="at">lwd =</span> <span class="fl">2.2</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>)</span>
<span id="cb299-38"><a href="#cb299-38"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.carolinensis<span class="sc">$</span>CHROM),</span>
<span id="cb299-39"><a href="#cb299-39"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb299-40"><a href="#cb299-40"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.carolinensis<span class="sc">$</span>CHROM), <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.0027</span>, </span>
<span id="cb299-41"><a href="#cb299-41"></a>     <span class="at">labels =</span> pi.chr.carolinensis<span class="sc">$</span>CHROM, <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">xpd =</span> <span class="cn">NA</span>,</span>
<span id="cb299-42"><a href="#cb299-42"></a>     <span class="at">cex =</span> <span class="dv">1</span>)</span>
<span id="cb299-43"><a href="#cb299-43"></a>caro.img <span class="ot">&lt;-</span> <span class="fu">readPNG</span>(<span class="st">'imgs/anole.png'</span>, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb299-44"><a href="#cb299-44"></a><span class="fu">rasterImage</span>(caro.img, <span class="dv">1</span>, <span class="fl">0.018</span>, <span class="dv">2</span>, <span class="fl">0.020</span>)</span>
<span id="cb299-45"><a href="#cb299-45"></a><span class="fu">mtext</span>(<span class="st">'A'</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">at =</span> <span class="fl">0.027</span>, <span class="at">las =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">4.5</span>)</span>
<span id="cb299-46"><a href="#cb299-46"></a></span>
<span id="cb299-47"><a href="#cb299-47"></a></span>
<span id="cb299-48"><a href="#cb299-48"></a><span class="do">## Podarcis muralis (pi)</span></span>
<span id="cb299-49"><a href="#cb299-49"></a></span>
<span id="cb299-50"><a href="#cb299-50"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb299-51"><a href="#cb299-51"></a></span>
<span id="cb299-52"><a href="#cb299-52"></a>value <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.muralis<span class="sc">$</span>CHROM)</span>
<span id="cb299-53"><a href="#cb299-53"></a><span class="fu">plot</span>(pi.chr.muralis<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb299-54"><a href="#cb299-54"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>,</span>
<span id="cb299-55"><a href="#cb299-55"></a>     <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb299-56"><a href="#cb299-56"></a>     <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb299-57"><a href="#cb299-57"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.carolinensis<span class="sc">$</span>sd),</span>
<span id="cb299-58"><a href="#cb299-58"></a>              <span class="fu">max</span>(pi.chr.muralis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.muralis<span class="sc">$</span>sd)))</span>
<span id="cb299-59"><a href="#cb299-59"></a><span class="fu">grid</span>()</span>
<span id="cb299-60"><a href="#cb299-60"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb299-61"><a href="#cb299-61"></a><span class="fu">plot</span>(pi.chr.muralis<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb299-62"><a href="#cb299-62"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb299-63"><a href="#cb299-63"></a>     <span class="at">xlab =</span> <span class="st">' '</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb299-64"><a href="#cb299-64"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.carolinensis<span class="sc">$</span>sd),</span>
<span id="cb299-65"><a href="#cb299-65"></a>              <span class="fu">max</span>(pi.chr.muralis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.muralis<span class="sc">$</span>sd)))     </span>
<span id="cb299-66"><a href="#cb299-66"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.muralis<span class="sc">$</span>CHROM),</span>
<span id="cb299-67"><a href="#cb299-67"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb299-68"><a href="#cb299-68"></a><span class="fu">legend</span>(<span class="st">'topleft'</span>, <span class="at">legend =</span> <span class="st">'n = 5'</span>, <span class="at">bty =</span> <span class="st">'n'</span>)</span>
<span id="cb299-69"><a href="#cb299-69"></a><span class="fu">segments</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pi.chr.muralis),</span>
<span id="cb299-70"><a href="#cb299-70"></a>         pi.chr.muralis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.muralis<span class="sc">$</span>sd,</span>
<span id="cb299-71"><a href="#cb299-71"></a>         <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pi.chr.muralis),</span>
<span id="cb299-72"><a href="#cb299-72"></a>         pi.chr.muralis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.muralis<span class="sc">$</span>sd,</span>
<span id="cb299-73"><a href="#cb299-73"></a>         <span class="at">lwd =</span> <span class="fl">2.2</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>)</span>
<span id="cb299-74"><a href="#cb299-74"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.muralis<span class="sc">$</span>CHROM), <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.0027</span>, </span>
<span id="cb299-75"><a href="#cb299-75"></a>     <span class="at">labels =</span> pi.chr.muralis<span class="sc">$</span>CHROM, <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">xpd =</span> <span class="cn">NA</span>,</span>
<span id="cb299-76"><a href="#cb299-76"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb299-77"><a href="#cb299-77"></a>muralis.img <span class="ot">&lt;-</span> <span class="fu">readPNG</span>(<span class="st">'imgs/p.muralis.png'</span>, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb299-78"><a href="#cb299-78"></a><span class="fu">rasterImage</span>(muralis.img, <span class="dv">1</span>, <span class="fl">0.018</span>, <span class="dv">5</span>, <span class="fl">0.021</span>)</span>
<span id="cb299-79"><a href="#cb299-79"></a><span class="fu">mtext</span>(<span class="st">'B'</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">at =</span> <span class="fl">0.027</span>, <span class="at">las =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.5</span>)</span>
<span id="cb299-80"><a href="#cb299-80"></a></span>
<span id="cb299-81"><a href="#cb299-81"></a><span class="fu">par</span>(<span class="at">xpd =</span> <span class="cn">TRUE</span>)</span>
<span id="cb299-82"><a href="#cb299-82"></a><span class="fu">mtext</span>(<span class="st">'Genomic position'</span>, <span class="at">at =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1"></a><span class="do">##dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<!-- -->


</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb301" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb301-1"><a href="#cb301-1"></a><span class="co">---</span></span>
<span id="cb301-2"><a href="#cb301-2"></a><span class="an">title:</span><span class="co"> 'Data analysis for: Relative High Fitness and Genome-wide Diversity May Facilitate Active Foragers Diversification'</span></span>
<span id="cb301-3"><a href="#cb301-3"></a><span class="an">author:</span><span class="co"> '[Dylan Padilla](https://dylanpadilla.netlify.app/), Martha Munoz, David Skelly &lt;br&gt; Yale Institute for Biospheric Studies &amp; Yale School of the Environment, New Haven, CT 06511'</span></span>
<span id="cb301-4"><a href="#cb301-4"></a><span class="an">format:</span></span>
<span id="cb301-5"><a href="#cb301-5"></a><span class="co">  html:</span></span>
<span id="cb301-6"><a href="#cb301-6"></a><span class="co">    code-line-numbers: true</span></span>
<span id="cb301-7"><a href="#cb301-7"></a><span class="co">    code-fold: true</span></span>
<span id="cb301-8"><a href="#cb301-8"></a><span class="co">    code-tools: true</span></span>
<span id="cb301-9"><a href="#cb301-9"></a><span class="co">---</span></span>
<span id="cb301-10"><a href="#cb301-10"></a></span>
<span id="cb301-11"><a href="#cb301-11"></a></span>
<span id="cb301-12"><a href="#cb301-12"></a><span class="al">![](imgs/yale-logo.png)</span></span>
<span id="cb301-13"><a href="#cb301-13"></a></span>
<span id="cb301-14"><a href="#cb301-14"></a><span class="in">```{r, include = FALSE}</span></span>
<span id="cb301-15"><a href="#cb301-15"></a></span>
<span id="cb301-16"><a href="#cb301-16"></a><span class="in">knitr::opts_chunk$set(comment = "&gt;", fig.width = 7, fig.height = 7, dpi = 300, warning = FALSE, message = FALSE)</span></span>
<span id="cb301-17"><a href="#cb301-17"></a></span>
<span id="cb301-18"><a href="#cb301-18"></a><span class="in">```</span></span>
<span id="cb301-19"><a href="#cb301-19"></a></span>
<span id="cb301-20"><a href="#cb301-20"></a>&lt;br&gt;</span>
<span id="cb301-21"><a href="#cb301-21"></a></span>
<span id="cb301-24"><a href="#cb301-24"></a><span class="in">```{r}</span></span>
<span id="cb301-25"><a href="#cb301-25"></a><span class="do">##  Libraries</span></span>
<span id="cb301-26"><a href="#cb301-26"></a></span>
<span id="cb301-27"><a href="#cb301-27"></a><span class="fu">library</span>(AICcmodavg)</span>
<span id="cb301-28"><a href="#cb301-28"></a><span class="fu">library</span>(ape)</span>
<span id="cb301-29"><a href="#cb301-29"></a><span class="fu">library</span>(BAMMtools)</span>
<span id="cb301-30"><a href="#cb301-30"></a><span class="fu">library</span>(bayou)</span>
<span id="cb301-31"><a href="#cb301-31"></a><span class="fu">library</span>(caper)</span>
<span id="cb301-32"><a href="#cb301-32"></a><span class="fu">library</span>(car)</span>
<span id="cb301-33"><a href="#cb301-33"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb301-34"><a href="#cb301-34"></a><span class="fu">library</span>(diversitree)</span>
<span id="cb301-35"><a href="#cb301-35"></a><span class="fu">library</span>(geiger)</span>
<span id="cb301-36"><a href="#cb301-36"></a><span class="fu">library</span>(ggplotify)</span>
<span id="cb301-37"><a href="#cb301-37"></a><span class="fu">library</span>(grid)</span>
<span id="cb301-38"><a href="#cb301-38"></a><span class="fu">library</span>(hisse)</span>
<span id="cb301-39"><a href="#cb301-39"></a><span class="fu">library</span>(lattice)</span>
<span id="cb301-40"><a href="#cb301-40"></a><span class="fu">library</span>(latticeExtra)</span>
<span id="cb301-41"><a href="#cb301-41"></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb301-42"><a href="#cb301-42"></a><span class="fu">library</span>(nlme)</span>
<span id="cb301-43"><a href="#cb301-43"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb301-44"><a href="#cb301-44"></a><span class="fu">library</span>(plotrix)</span>
<span id="cb301-45"><a href="#cb301-45"></a><span class="fu">library</span>(png)</span>
<span id="cb301-46"><a href="#cb301-46"></a><span class="fu">library</span>(phytools)</span>
<span id="cb301-47"><a href="#cb301-47"></a><span class="fu">library</span>(raster)</span>
<span id="cb301-48"><a href="#cb301-48"></a><span class="fu">library</span>(scales)</span>
<span id="cb301-49"><a href="#cb301-49"></a><span class="fu">library</span>(TreeSim)</span>
<span id="cb301-50"><a href="#cb301-50"></a><span class="fu">library</span>(vioplot)</span>
<span id="cb301-51"><a href="#cb301-51"></a><span class="fu">library</span>(viridis)</span>
<span id="cb301-52"><a href="#cb301-52"></a></span>
<span id="cb301-53"><a href="#cb301-53"></a></span>
<span id="cb301-54"><a href="#cb301-54"></a><span class="do">## Session info and R version</span></span>
<span id="cb301-55"><a href="#cb301-55"></a></span>
<span id="cb301-56"><a href="#cb301-56"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb301-57"><a href="#cb301-57"></a>R.version</span>
<span id="cb301-58"><a href="#cb301-58"></a></span>
<span id="cb301-59"><a href="#cb301-59"></a><span class="do">## setting seed for reproducibility</span></span>
<span id="cb301-60"><a href="#cb301-60"></a></span>
<span id="cb301-61"><a href="#cb301-61"></a><span class="do">##set.seed(3487593)</span></span>
<span id="cb301-62"><a href="#cb301-62"></a></span>
<span id="cb301-63"><a href="#cb301-63"></a><span class="do">##  Loading the data</span></span>
<span id="cb301-64"><a href="#cb301-64"></a></span>
<span id="cb301-65"><a href="#cb301-65"></a>raw.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data_Meiri-2024.csv'</span>, <span class="at">as.is =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-66"><a href="#cb301-66"></a><span class="fu">str</span>(raw.data)</span>
<span id="cb301-67"><a href="#cb301-67"></a></span>
<span id="cb301-68"><a href="#cb301-68"></a></span>
<span id="cb301-69"><a href="#cb301-69"></a>range.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'area-of-lizard-ranges.csv'</span>)</span>
<span id="cb301-70"><a href="#cb301-70"></a><span class="fu">str</span>(range.data)</span>
<span id="cb301-71"><a href="#cb301-71"></a>area <span class="ot">&lt;-</span> range.data[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">7</span>)]</span>
<span id="cb301-72"><a href="#cb301-72"></a></span>
<span id="cb301-73"><a href="#cb301-73"></a>lizard.tree <span class="ot">&lt;-</span> <span class="fu">read.tree</span>(<span class="st">'zheng-wiens2016-tree.tre'</span>)</span>
<span id="cb301-74"><a href="#cb301-74"></a></span>
<span id="cb301-75"><a href="#cb301-75"></a><span class="do">## Checking out the variables</span></span>
<span id="cb301-76"><a href="#cb301-76"></a></span>
<span id="cb301-77"><a href="#cb301-77"></a><span class="fu">unique</span>(raw.data<span class="sc">$</span>Foraging.mode)</span>
<span id="cb301-78"><a href="#cb301-78"></a></span>
<span id="cb301-79"><a href="#cb301-79"></a>raw.data<span class="sc">$</span>Foraging.mode[raw.data<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'ACT'</span>] <span class="ot">&lt;-</span> <span class="st">'active'</span></span>
<span id="cb301-80"><a href="#cb301-80"></a>raw.data<span class="sc">$</span>Foraging.mode[raw.data<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'AMB'</span>] <span class="ot">&lt;-</span> <span class="st">'sit-and-wait'</span></span>
<span id="cb301-81"><a href="#cb301-81"></a>raw.data<span class="sc">$</span>Foraging.mode[raw.data<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'Mixed'</span>] <span class="ot">&lt;-</span> <span class="st">'plastic'</span></span>
<span id="cb301-82"><a href="#cb301-82"></a></span>
<span id="cb301-83"><a href="#cb301-83"></a></span>
<span id="cb301-84"><a href="#cb301-84"></a><span class="do">## Filtering the data</span></span>
<span id="cb301-85"><a href="#cb301-85"></a></span>
<span id="cb301-86"><a href="#cb301-86"></a>filt.data <span class="ot">&lt;-</span> raw.data[<span class="sc">!</span><span class="fu">is.na</span>(raw.data<span class="sc">$</span>Foraging.mode), ]</span>
<span id="cb301-87"><a href="#cb301-87"></a><span class="fu">str</span>(filt.data)</span>
<span id="cb301-88"><a href="#cb301-88"></a><span class="fu">dim</span>(filt.data)</span>
<span id="cb301-89"><a href="#cb301-89"></a><span class="fu">unique</span>(filt.data<span class="sc">$</span>Foraging.mode)</span>
<span id="cb301-90"><a href="#cb301-90"></a></span>
<span id="cb301-91"><a href="#cb301-91"></a><span class="do">## How many species do we have within each</span></span>
<span id="cb301-92"><a href="#cb301-92"></a><span class="do">## foraging behavior category?</span></span>
<span id="cb301-93"><a href="#cb301-93"></a></span>
<span id="cb301-94"><a href="#cb301-94"></a><span class="fu">tapply</span>(<span class="at">X =</span> filt.data<span class="sc">$</span>Species,</span>
<span id="cb301-95"><a href="#cb301-95"></a>       <span class="at">INDEX =</span> <span class="fu">list</span>(filt.data<span class="sc">$</span>Foraging.mode),       length)</span>
<span id="cb301-96"><a href="#cb301-96"></a></span>
<span id="cb301-97"><a href="#cb301-97"></a></span>
<span id="cb301-98"><a href="#cb301-98"></a><span class="do">## How many species with data of body mass do we have</span></span>
<span id="cb301-99"><a href="#cb301-99"></a><span class="do">## within each foraging behavior category?</span></span>
<span id="cb301-100"><a href="#cb301-100"></a></span>
<span id="cb301-101"><a href="#cb301-101"></a>((bd.mass <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="at">X =</span> filt.data<span class="sc">$</span>Maximum.body.mass..g.,</span>
<span id="cb301-102"><a href="#cb301-102"></a>                    <span class="at">INDEX =</span> <span class="fu">list</span>(filt.data<span class="sc">$</span>Foraging.mode),</span>
<span id="cb301-103"><a href="#cb301-103"></a>                    <span class="at">FUN =</span> <span class="cf">function</span>(X) <span class="fu">length</span>(<span class="fu">na.omit</span>(X)))))</span>
<span id="cb301-104"><a href="#cb301-104"></a></span>
<span id="cb301-105"><a href="#cb301-105"></a></span>
<span id="cb301-106"><a href="#cb301-106"></a><span class="do">## How many species with data of Mean.Tb do we have</span></span>
<span id="cb301-107"><a href="#cb301-107"></a><span class="do">## within each foraging behavior category?</span></span>
<span id="cb301-108"><a href="#cb301-108"></a></span>
<span id="cb301-109"><a href="#cb301-109"></a>((mean.tb <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="at">X =</span> filt.data<span class="sc">$</span>Mean.Tb,</span>
<span id="cb301-110"><a href="#cb301-110"></a>                    <span class="at">INDEX =</span> <span class="fu">list</span>(filt.data<span class="sc">$</span>Foraging.mode),</span>
<span id="cb301-111"><a href="#cb301-111"></a>                    <span class="at">FUN =</span> <span class="cf">function</span>(X) <span class="fu">length</span>(<span class="fu">na.omit</span>(X)))))</span>
<span id="cb301-112"><a href="#cb301-112"></a></span>
<span id="cb301-113"><a href="#cb301-113"></a></span>
<span id="cb301-114"><a href="#cb301-114"></a><span class="do">## Merging data of lizard ranges</span></span>
<span id="cb301-115"><a href="#cb301-115"></a></span>
<span id="cb301-116"><a href="#cb301-116"></a><span class="fu">names</span>(area)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">'Species'</span></span>
<span id="cb301-117"><a href="#cb301-117"></a>merg.data <span class="ot">&lt;-</span> <span class="fu">merge</span>(filt.data, area, <span class="at">by =</span> <span class="st">'Species'</span>)</span>
<span id="cb301-118"><a href="#cb301-118"></a><span class="fu">str</span>(merg.data)</span>
<span id="cb301-119"><a href="#cb301-119"></a></span>
<span id="cb301-120"><a href="#cb301-120"></a></span>
<span id="cb301-121"><a href="#cb301-121"></a><span class="do">## How many species with distribution range</span></span>
<span id="cb301-122"><a href="#cb301-122"></a><span class="do">##data do we have within each foraging behavior category?</span></span>
<span id="cb301-123"><a href="#cb301-123"></a></span>
<span id="cb301-124"><a href="#cb301-124"></a>((range.area <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="at">X =</span> merg.data<span class="sc">$</span>area,</span>
<span id="cb301-125"><a href="#cb301-125"></a>                       <span class="at">INDEX =</span> <span class="fu">list</span>(merg.data<span class="sc">$</span>Foraging.mode),</span>
<span id="cb301-126"><a href="#cb301-126"></a>                       <span class="at">FUN =</span> <span class="cf">function</span>(X) <span class="fu">length</span>(<span class="fu">na.omit</span>(X)))))</span>
<span id="cb301-127"><a href="#cb301-127"></a></span>
<span id="cb301-128"><a href="#cb301-128"></a></span>
<span id="cb301-129"><a href="#cb301-129"></a><span class="do">## Visualizing the data</span></span>
<span id="cb301-130"><a href="#cb301-130"></a></span>
<span id="cb301-131"><a href="#cb301-131"></a>vis.data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(bd.mass, mean.tb, range.area)</span>
<span id="cb301-132"><a href="#cb301-132"></a><span class="fu">colnames</span>(vis.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Active (n = 1136)'</span>,</span>
<span id="cb301-133"><a href="#cb301-133"></a>                        <span class="st">'Plastic (n = 104)'</span>,</span>
<span id="cb301-134"><a href="#cb301-134"></a>                        <span class="st">'Sit-and-wait (n = 566)'</span>)</span>
<span id="cb301-135"><a href="#cb301-135"></a><span class="fu">rownames</span>(vis.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'body mass'</span>, <span class="st">'mean Tb'</span>, <span class="st">'range area'</span>)</span>
<span id="cb301-136"><a href="#cb301-136"></a></span>
<span id="cb301-137"><a href="#cb301-137"></a></span>
<span id="cb301-138"><a href="#cb301-138"></a><span class="fu">barplot</span>(vis.data, <span class="at">beside =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1500</span>),</span>
<span id="cb301-139"><a href="#cb301-139"></a>        <span class="at">las =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="fu">rep</span>(<span class="st">'white'</span>, <span class="dv">3</span>), <span class="at">border =</span> <span class="st">'white'</span>,</span>
<span id="cb301-140"><a href="#cb301-140"></a>        <span class="at">ylab =</span> <span class="st">'Absolut number'</span>, <span class="at">xlab =</span> <span class="st">'Foraging behavior'</span>)</span>
<span id="cb301-141"><a href="#cb301-141"></a></span>
<span id="cb301-142"><a href="#cb301-142"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-143"><a href="#cb301-143"></a></span>
<span id="cb301-144"><a href="#cb301-144"></a><span class="fu">grid</span>()</span>
<span id="cb301-145"><a href="#cb301-145"></a><span class="fu">barplot</span>(vis.data, <span class="at">beside =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1500</span>),</span>
<span id="cb301-146"><a href="#cb301-146"></a>        <span class="at">las =</span> <span class="dv">1</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-147"><a href="#cb301-147"></a><span class="fu">box</span>()</span>
<span id="cb301-148"><a href="#cb301-148"></a></span>
<span id="cb301-149"><a href="#cb301-149"></a><span class="fu">legend</span>(<span class="st">'topleft'</span>, <span class="at">legend =</span> <span class="fu">rownames</span>(vis.data),</span>
<span id="cb301-150"><a href="#cb301-150"></a>       <span class="at">fill =</span> <span class="fu">gray.colors</span>(<span class="dv">3</span>), <span class="at">bty =</span> <span class="st">'n'</span>)</span>
<span id="cb301-151"><a href="#cb301-151"></a></span>
<span id="cb301-152"><a href="#cb301-152"></a></span>
<span id="cb301-153"><a href="#cb301-153"></a></span>
<span id="cb301-154"><a href="#cb301-154"></a><span class="do">## Lineage through time plot</span></span>
<span id="cb301-155"><a href="#cb301-155"></a></span>
<span id="cb301-156"><a href="#cb301-156"></a>filt.data<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">' '</span>, <span class="st">'_'</span>, <span class="fu">as.character</span>(filt.data<span class="sc">$</span>Species))</span>
<span id="cb301-157"><a href="#cb301-157"></a>filt.data<span class="sc">$</span>Species[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb301-158"><a href="#cb301-158"></a><span class="fu">rownames</span>(filt.data) <span class="ot">&lt;-</span> filt.data<span class="sc">$</span>Species</span>
<span id="cb301-159"><a href="#cb301-159"></a></span>
<span id="cb301-160"><a href="#cb301-160"></a>check <span class="ot">&lt;-</span> <span class="fu">name.check</span>(lizard.tree, filt.data)</span>
<span id="cb301-161"><a href="#cb301-161"></a>rm_phy <span class="ot">&lt;-</span> check<span class="sc">$</span>tree_not_data</span>
<span id="cb301-162"><a href="#cb301-162"></a>rm_dat <span class="ot">&lt;-</span> check<span class="sc">$</span>data_not_tree</span>
<span id="cb301-163"><a href="#cb301-163"></a>pruned.tree <span class="ot">&lt;-</span> <span class="fu">drop.tip</span>(lizard.tree, rm_phy)</span>
<span id="cb301-164"><a href="#cb301-164"></a></span>
<span id="cb301-165"><a href="#cb301-165"></a>pruned.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(filt.data,</span>
<span id="cb301-166"><a href="#cb301-166"></a>                      <span class="at">subset =</span> <span class="fu">rownames</span>(filt.data) <span class="sc">%in%</span> pruned.tree<span class="sc">$</span>tip,</span>
<span id="cb301-167"><a href="#cb301-167"></a>                      <span class="at">select =</span> <span class="fu">names</span>(filt.data))</span>
<span id="cb301-168"><a href="#cb301-168"></a><span class="fu">name.check</span>(pruned.tree, pruned.data)</span>
<span id="cb301-169"><a href="#cb301-169"></a></span>
<span id="cb301-170"><a href="#cb301-170"></a>pruned.data<span class="sc">$</span>Foraging.mode <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(pruned.data<span class="sc">$</span>Foraging.mode)</span>
<span id="cb301-171"><a href="#cb301-171"></a></span>
<span id="cb301-172"><a href="#cb301-172"></a>map.spp <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(pruned.data)[ , <span class="dv">12</span>]</span>
<span id="cb301-173"><a href="#cb301-173"></a><span class="fu">head</span>(map.spp)</span>
<span id="cb301-174"><a href="#cb301-174"></a></span>
<span id="cb301-175"><a href="#cb301-175"></a><span class="in">```</span></span>
<span id="cb301-176"><a href="#cb301-176"></a></span>
<span id="cb301-177"><a href="#cb301-177"></a></span>
<span id="cb301-178"><a href="#cb301-178"></a><span class="in">```{r, eval = FALSE}</span></span>
<span id="cb301-179"><a href="#cb301-179"></a></span>
<span id="cb301-180"><a href="#cb301-180"></a><span class="in">## now let's do our stochastic mapping</span></span>
<span id="cb301-181"><a href="#cb301-181"></a></span>
<span id="cb301-182"><a href="#cb301-182"></a><span class="in">lizard.maps.ard &lt;- make.simmap(pruned.tree, map.spp, model = "ARD",</span></span>
<span id="cb301-183"><a href="#cb301-183"></a><span class="in">                               nsim = 5, pi = 'estimated', Q = 'mcmc')</span></span>
<span id="cb301-184"><a href="#cb301-184"></a><span class="in">lizard.maps.sym &lt;- make.simmap(pruned.tree, pi = 'estimated',</span></span>
<span id="cb301-185"><a href="#cb301-185"></a><span class="in">                               map.spp, Q = 'mcmc', model = "SYM",</span></span>
<span id="cb301-186"><a href="#cb301-186"></a><span class="in">                               nsim = 5)</span></span>
<span id="cb301-187"><a href="#cb301-187"></a><span class="in">lizard.maps.er &lt;- make.simmap(pruned.tree, map.spp, pi = 'estimated',</span></span>
<span id="cb301-188"><a href="#cb301-188"></a><span class="in">                              Q = 'mcmc', model = "ER",</span></span>
<span id="cb301-189"><a href="#cb301-189"></a><span class="in">                              nsim = 5)</span></span>
<span id="cb301-190"><a href="#cb301-190"></a></span>
<span id="cb301-191"><a href="#cb301-191"></a><span class="in">## model selection based on AIC</span></span>
<span id="cb301-192"><a href="#cb301-192"></a></span>
<span id="cb301-193"><a href="#cb301-193"></a><span class="in">data.frame(Model = c("modER", "modARD", "modSYM"),</span></span>
<span id="cb301-194"><a href="#cb301-194"></a><span class="in">           AIC = c(AIC(lizard.maps.er), AIC(lizard.maps.ard),</span></span>
<span id="cb301-195"><a href="#cb301-195"></a><span class="in">                   AIC(lizard.maps.sym)), stringsAsFactors = FALSE)</span></span>
<span id="cb301-196"><a href="#cb301-196"></a></span>
<span id="cb301-197"><a href="#cb301-197"></a><span class="in">## increasing the simulations</span></span>
<span id="cb301-198"><a href="#cb301-198"></a></span>
<span id="cb301-199"><a href="#cb301-199"></a><span class="in">lizard.maps.sym &lt;- make.simmap(pruned.tree,</span></span>
<span id="cb301-200"><a href="#cb301-200"></a><span class="in">                               map.spp, model = "SYM", nsim = 100000)</span></span>
<span id="cb301-201"><a href="#cb301-201"></a><span class="in">save(lizard.maps.sym, file = "stochastic.map.sym.RData")</span></span>
<span id="cb301-202"><a href="#cb301-202"></a></span>
<span id="cb301-203"><a href="#cb301-203"></a></span>
<span id="cb301-204"><a href="#cb301-204"></a><span class="in">```</span></span>
<span id="cb301-205"><a href="#cb301-205"></a></span>
<span id="cb301-206"><a href="#cb301-206"></a><span class="in">```{r, include = FALSE}</span></span>
<span id="cb301-207"><a href="#cb301-207"></a></span>
<span id="cb301-208"><a href="#cb301-208"></a><span class="in">load('stochastic.map.sym.RData')</span></span>
<span id="cb301-209"><a href="#cb301-209"></a></span>
<span id="cb301-210"><a href="#cb301-210"></a><span class="in">```</span></span>
<span id="cb301-211"><a href="#cb301-211"></a></span>
<span id="cb301-212"><a href="#cb301-212"></a></span>
<span id="cb301-215"><a href="#cb301-215"></a><span class="in">```{r}</span></span>
<span id="cb301-216"><a href="#cb301-216"></a><span class="do">## convert to tree with unbranching nodes</span></span>
<span id="cb301-217"><a href="#cb301-217"></a></span>
<span id="cb301-218"><a href="#cb301-218"></a>idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lizard.maps.sym), <span class="dv">1</span>)</span>
<span id="cb301-219"><a href="#cb301-219"></a>tt <span class="ot">&lt;-</span> <span class="fu">map.to.singleton</span>(lizard.maps.sym[[idx]])</span>
<span id="cb301-220"><a href="#cb301-220"></a></span>
<span id="cb301-221"><a href="#cb301-221"></a><span class="do">## compute all node heights</span></span>
<span id="cb301-222"><a href="#cb301-222"></a></span>
<span id="cb301-223"><a href="#cb301-223"></a>H <span class="ot">&lt;-</span> <span class="fu">nodeHeights</span>(tt)</span>
<span id="cb301-224"><a href="#cb301-224"></a></span>
<span id="cb301-225"><a href="#cb301-225"></a><span class="do">## pull out heights all all events</span></span>
<span id="cb301-226"><a href="#cb301-226"></a></span>
<span id="cb301-227"><a href="#cb301-227"></a>h <span class="ot">&lt;-</span> <span class="fu">max</span>(H)<span class="sc">-</span><span class="fu">branching.times</span>(tt)</span>
<span id="cb301-228"><a href="#cb301-228"></a></span>
<span id="cb301-229"><a href="#cb301-229"></a><span class="do">## get the states at each event</span></span>
<span id="cb301-230"><a href="#cb301-230"></a></span>
<span id="cb301-231"><a href="#cb301-231"></a>ss <span class="ot">&lt;-</span><span class="fu">setNames</span>(<span class="fu">as.factor</span>(<span class="fu">names</span>(tt<span class="sc">$</span>edge.length)), tt<span class="sc">$</span>edge[ , <span class="dv">2</span>])</span>
<span id="cb301-232"><a href="#cb301-232"></a></span>
<span id="cb301-233"><a href="#cb301-233"></a><span class="do">## create a matrix to count lineages</span></span>
<span id="cb301-234"><a href="#cb301-234"></a></span>
<span id="cb301-235"><a href="#cb301-235"></a>lineages <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="fu">length</span>(h), <span class="fu">length</span>(<span class="fu">levels</span>(<span class="fu">as.factor</span>(map.spp))),</span>
<span id="cb301-236"><a href="#cb301-236"></a>                   <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">names</span>(h), <span class="fu">levels</span>(<span class="fu">as.factor</span>(map.spp))))</span>
<span id="cb301-237"><a href="#cb301-237"></a></span>
<span id="cb301-238"><a href="#cb301-238"></a><span class="do">## count them</span></span>
<span id="cb301-239"><a href="#cb301-239"></a></span>
<span id="cb301-240"><a href="#cb301-240"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(h)){</span>
<span id="cb301-241"><a href="#cb301-241"></a>    ii <span class="ot">&lt;-</span> <span class="fu">intersect</span>(<span class="fu">which</span>(h[i]<span class="sc">&gt;</span>H[ , <span class="dv">1</span>]), <span class="fu">which</span>(h[i]<span class="sc">&lt;=</span>H[ , <span class="dv">2</span>]))</span>
<span id="cb301-242"><a href="#cb301-242"></a>    lineages[i,] <span class="ot">&lt;-</span> <span class="fu">summary</span>(ss[ii])</span>
<span id="cb301-243"><a href="#cb301-243"></a>}</span>
<span id="cb301-244"><a href="#cb301-244"></a></span>
<span id="cb301-245"><a href="#cb301-245"></a><span class="do">## sort by event</span></span>
<span id="cb301-246"><a href="#cb301-246"></a></span>
<span id="cb301-247"><a href="#cb301-247"></a>ii <span class="ot">&lt;-</span> <span class="fu">order</span>(h)</span>
<span id="cb301-248"><a href="#cb301-248"></a>times <span class="ot">&lt;-</span> h[ii]</span>
<span id="cb301-249"><a href="#cb301-249"></a>lineages <span class="ot">&lt;-</span> lineages[ii, ]</span>
<span id="cb301-250"><a href="#cb301-250"></a></span>
<span id="cb301-251"><a href="#cb301-251"></a></span>
<span id="cb301-252"><a href="#cb301-252"></a><span class="do">##png('./imgs/figureS2.png', width = 7, height = 7, units = 'in',</span></span>
<span id="cb301-253"><a href="#cb301-253"></a><span class="do">##    res = 360)</span></span>
<span id="cb301-254"><a href="#cb301-254"></a><span class="do">##pdf('./imgs/figuer1.pdf')</span></span>
<span id="cb301-255"><a href="#cb301-255"></a></span>
<span id="cb301-256"><a href="#cb301-256"></a></span>
<span id="cb301-257"><a href="#cb301-257"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb301-258"><a href="#cb301-258"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-259"><a href="#cb301-259"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-260"><a href="#cb301-260"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb301-261"><a href="#cb301-261"></a></span>
<span id="cb301-262"><a href="#cb301-262"></a></span>
<span id="cb301-263"><a href="#cb301-263"></a><span class="do">## create plot area</span></span>
<span id="cb301-264"><a href="#cb301-264"></a></span>
<span id="cb301-265"><a href="#cb301-265"></a><span class="fu">plot</span>(<span class="cn">NA</span>, <span class="at">xlim =</span> <span class="fu">range</span>(times), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(lineages)),</span>
<span id="cb301-266"><a href="#cb301-266"></a>     <span class="at">ylab =</span> <span class="st">"Lineages"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb301-267"><a href="#cb301-267"></a>     <span class="at">xlab =</span> <span class="st">"Time (mya)"</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-268"><a href="#cb301-268"></a></span>
<span id="cb301-269"><a href="#cb301-269"></a><span class="do">## add lineages through time for each type</span></span>
<span id="cb301-270"><a href="#cb301-270"></a></span>
<span id="cb301-271"><a href="#cb301-271"></a><span class="fu">lines</span>(times, lineages[ , <span class="dv">1</span>], <span class="at">type =</span> <span class="st">"s"</span>,</span>
<span id="cb301-272"><a href="#cb301-272"></a>      <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>)</span>
<span id="cb301-273"><a href="#cb301-273"></a><span class="fu">lines</span>(times, lineages[ , <span class="dv">2</span>], <span class="at">type =</span> <span class="st">"s"</span>,</span>
<span id="cb301-274"><a href="#cb301-274"></a>      <span class="at">col =</span> <span class="st">'green4'</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb301-275"><a href="#cb301-275"></a><span class="fu">lines</span>(times, lineages[ , <span class="dv">3</span>], <span class="at">type =</span> <span class="st">"s"</span>,</span>
<span id="cb301-276"><a href="#cb301-276"></a>      <span class="at">col =</span> <span class="st">'#DCE319FF'</span>, <span class="at">lwd =</span> <span class="dv">4</span>)</span>
<span id="cb301-277"><a href="#cb301-277"></a></span>
<span id="cb301-278"><a href="#cb301-278"></a><span class="do">## superimpose tree</span></span>
<span id="cb301-279"><a href="#cb301-279"></a></span>
<span id="cb301-280"><a href="#cb301-280"></a>cols <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">make.transparent</span>(<span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>), <span class="fl">0.5</span>),</span>
<span id="cb301-281"><a href="#cb301-281"></a>                 <span class="fu">levels</span>(<span class="fu">as.factor</span>(map.spp)))</span>
<span id="cb301-282"><a href="#cb301-282"></a></span>
<span id="cb301-283"><a href="#cb301-283"></a><span class="fu">plot</span>(lizard.maps.sym[[idx]], cols, <span class="at">ftype =</span> <span class="st">"off"</span>, <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb301-284"><a href="#cb301-284"></a>     <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>))</span>
<span id="cb301-285"><a href="#cb301-285"></a>obj<span class="ot">&lt;-</span> <span class="fu">markChanges</span>(lizard.maps.sym[[idx]], <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-286"><a href="#cb301-286"></a></span>
<span id="cb301-287"><a href="#cb301-287"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(obj)) <span class="fu">lines</span>(<span class="fu">rep</span>(obj[i,<span class="st">"x"</span>] , <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">0</span>, obj[i,<span class="st">"y"</span>]),</span>
<span id="cb301-288"><a href="#cb301-288"></a>                            <span class="at">lty =</span> <span class="st">"dotted"</span>, <span class="at">col =</span> <span class="fu">make.transparent</span>(<span class="st">"grey"</span>, <span class="fl">0.8</span>))</span>
<span id="cb301-289"><a href="#cb301-289"></a></span>
<span id="cb301-290"><a href="#cb301-290"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="fu">levels</span>(<span class="fu">as.factor</span>(map.spp)), <span class="at">pch =</span> <span class="dv">22</span>,</span>
<span id="cb301-291"><a href="#cb301-291"></a>       <span class="at">pt.bg =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>),</span>
<span id="cb301-292"><a href="#cb301-292"></a>       <span class="at">pt.cex =</span> <span class="fl">1.2</span> , <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb301-293"><a href="#cb301-293"></a></span>
<span id="cb301-294"><a href="#cb301-294"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">nodeHeights</span>(lizard.maps.sym[[idx]])),</span>
<span id="cb301-295"><a href="#cb301-295"></a>                       <span class="at">length.out =</span> <span class="dv">4</span>), <span class="dv">0</span>),</span>
<span id="cb301-296"><a href="#cb301-296"></a>     <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">max</span>(<span class="fu">nodeHeights</span>(lizard.maps.sym[[idx]])), <span class="dv">0</span>,</span>
<span id="cb301-297"><a href="#cb301-297"></a>                       <span class="at">length.out =</span> <span class="dv">4</span>), <span class="dv">0</span>), <span class="at">cex.axis =</span> <span class="fl">0.8</span>)</span>
<span id="cb301-298"><a href="#cb301-298"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">cex.axis =</span> <span class="fl">0.8</span>)</span>
<span id="cb301-299"><a href="#cb301-299"></a><span class="fu">mtext</span>(<span class="st">'A'</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">at =</span> <span class="dv">1200</span>, <span class="at">las =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="dv">3</span>)</span>
<span id="cb301-300"><a href="#cb301-300"></a></span>
<span id="cb301-301"><a href="#cb301-301"></a></span>
<span id="cb301-302"><a href="#cb301-302"></a><span class="do">## create plot area</span></span>
<span id="cb301-303"><a href="#cb301-303"></a></span>
<span id="cb301-304"><a href="#cb301-304"></a><span class="fu">plot</span>(<span class="cn">NA</span>, <span class="at">xlim =</span> <span class="fu">range</span>(times), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(lineages)),</span>
<span id="cb301-305"><a href="#cb301-305"></a>     <span class="at">ylab =</span> <span class="st">"Lineages"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb301-306"><a href="#cb301-306"></a>     <span class="at">xlab =</span> <span class="st">"Time (mya)"</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-307"><a href="#cb301-307"></a><span class="fu">grid</span>()</span>
<span id="cb301-308"><a href="#cb301-308"></a></span>
<span id="cb301-309"><a href="#cb301-309"></a><span class="do">## add lineages through time for each type</span></span>
<span id="cb301-310"><a href="#cb301-310"></a></span>
<span id="cb301-311"><a href="#cb301-311"></a><span class="fu">lines</span>(times, lineages[ , <span class="dv">1</span>], <span class="at">type =</span> <span class="st">"s"</span>,</span>
<span id="cb301-312"><a href="#cb301-312"></a>      <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>)</span>
<span id="cb301-313"><a href="#cb301-313"></a><span class="fu">lines</span>(times, lineages[ , <span class="dv">2</span>], <span class="at">type =</span> <span class="st">"s"</span>,</span>
<span id="cb301-314"><a href="#cb301-314"></a>      <span class="at">col =</span> <span class="st">'green4'</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb301-315"><a href="#cb301-315"></a><span class="fu">lines</span>(times, lineages[ , <span class="dv">3</span>], <span class="at">type =</span> <span class="st">"s"</span>,</span>
<span id="cb301-316"><a href="#cb301-316"></a>      <span class="at">col =</span> <span class="st">'#DCE319FF'</span>, <span class="at">lwd =</span> <span class="dv">4</span>)</span>
<span id="cb301-317"><a href="#cb301-317"></a></span>
<span id="cb301-318"><a href="#cb301-318"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="fu">levels</span>(<span class="fu">as.factor</span>(map.spp)),</span>
<span id="cb301-319"><a href="#cb301-319"></a>       <span class="at">pch =</span> <span class="dv">22</span>, <span class="at">pt.bg =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>),</span>
<span id="cb301-320"><a href="#cb301-320"></a>       <span class="at">pt.cex =</span> <span class="fl">1.2</span> , <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb301-321"><a href="#cb301-321"></a></span>
<span id="cb301-322"><a href="#cb301-322"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">nodeHeights</span>(lizard.maps.sym[[idx]])),</span>
<span id="cb301-323"><a href="#cb301-323"></a>                       <span class="at">length.out =</span> <span class="dv">4</span>), <span class="dv">0</span>),</span>
<span id="cb301-324"><a href="#cb301-324"></a>     <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">max</span>(<span class="fu">nodeHeights</span>(lizard.maps.sym[[idx]])), <span class="dv">0</span>,</span>
<span id="cb301-325"><a href="#cb301-325"></a>                       <span class="at">length.out =</span> <span class="dv">4</span>), <span class="dv">0</span>), <span class="at">cex.axis =</span> <span class="fl">0.8</span>)</span>
<span id="cb301-326"><a href="#cb301-326"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">cex.axis =</span> <span class="fl">0.8</span>)</span>
<span id="cb301-327"><a href="#cb301-327"></a><span class="fu">mtext</span>(<span class="st">'B'</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">at =</span> <span class="dv">590</span>, <span class="at">las =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="dv">3</span>)</span>
<span id="cb301-328"><a href="#cb301-328"></a><span class="fu">box</span>()</span>
<span id="cb301-329"><a href="#cb301-329"></a></span>
<span id="cb301-330"><a href="#cb301-330"></a><span class="do">##dev.off()</span></span>
<span id="cb301-331"><a href="#cb301-331"></a></span>
<span id="cb301-332"><a href="#cb301-332"></a></span>
<span id="cb301-333"><a href="#cb301-333"></a><span class="do">## plotting arc phylogeny for visualization</span></span>
<span id="cb301-334"><a href="#cb301-334"></a></span>
<span id="cb301-335"><a href="#cb301-335"></a><span class="do">##png('./imgs/figure2.png', width = 7, height = 7, units = 'in',</span></span>
<span id="cb301-336"><a href="#cb301-336"></a><span class="do">##    res = 360)</span></span>
<span id="cb301-337"><a href="#cb301-337"></a><span class="do">##pdf('./imgs/figuer1.pdf')</span></span>
<span id="cb301-338"><a href="#cb301-338"></a></span>
<span id="cb301-339"><a href="#cb301-339"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb301-340"><a href="#cb301-340"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb301-341"><a href="#cb301-341"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb301-342"><a href="#cb301-342"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb301-343"><a href="#cb301-343"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb301-344"><a href="#cb301-344"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb301-345"><a href="#cb301-345"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb301-346"><a href="#cb301-346"></a>                <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>,</span>
<span id="cb301-347"><a href="#cb301-347"></a>                <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>,</span>
<span id="cb301-348"><a href="#cb301-348"></a>                <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">7</span>,</span>
<span id="cb301-349"><a href="#cb301-349"></a>                <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">7</span>), <span class="at">nrow =</span> <span class="dv">11</span>, <span class="at">ncol =</span> <span class="dv">6</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb301-350"><a href="#cb301-350"></a></span>
<span id="cb301-351"><a href="#cb301-351"></a>cols <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>),</span>
<span id="cb301-352"><a href="#cb301-352"></a>                 <span class="fu">levels</span>(<span class="fu">as.factor</span>(map.spp)))</span>
<span id="cb301-353"><a href="#cb301-353"></a></span>
<span id="cb301-354"><a href="#cb301-354"></a>arc_height <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb301-355"><a href="#cb301-355"></a>h <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">nodeHeights</span>(pruned.tree))</span>
<span id="cb301-356"><a href="#cb301-356"></a><span class="fu">plotSimmap</span>(lizard.maps.sym[[<span class="dv">1</span>]], <span class="at">colors =</span> cols,</span>
<span id="cb301-357"><a href="#cb301-357"></a>           <span class="at">type =</span> <span class="st">"arc"</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">ftype =</span> <span class="st">"off"</span>,</span>
<span id="cb301-358"><a href="#cb301-358"></a>           <span class="at">arc_height =</span> <span class="fl">0.5</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span><span class="sc">*</span>h, <span class="fl">1.1</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>arc_height)<span class="sc">*</span>h),</span>
<span id="cb301-359"><a href="#cb301-359"></a>           <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="fl">3.2</span>))</span>
<span id="cb301-360"><a href="#cb301-360"></a></span>
<span id="cb301-361"><a href="#cb301-361"></a>labs <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, h, <span class="at">by =</span> <span class="dv">35</span>)</span>
<span id="cb301-362"><a href="#cb301-362"></a><span class="fu">draw.arc</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">radius =</span> h<span class="sc">-</span>labs[<span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(labs)]<span class="sc">+</span><span class="fl">0.5</span><span class="sc">*</span>h,</span>
<span id="cb301-363"><a href="#cb301-363"></a>         <span class="at">angle1 =</span> , <span class="at">angle2 =</span> pi, <span class="at">col =</span> <span class="fu">make.transparent</span>(<span class="st">"blue"</span>,<span class="fl">0.2</span>),</span>
<span id="cb301-364"><a href="#cb301-364"></a>         <span class="at">lty =</span> <span class="st">"dotted"</span>)</span>
<span id="cb301-365"><a href="#cb301-365"></a></span>
<span id="cb301-366"><a href="#cb301-366"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">pos =</span> <span class="sc">-</span><span class="fl">3.5</span>, <span class="at">at =</span> h<span class="sc">-</span><span class="fu">seq</span>(<span class="dv">0</span>, h, <span class="at">by =</span> <span class="dv">35</span>)<span class="sc">+</span><span class="fl">0.5</span><span class="sc">*</span>h,</span>
<span id="cb301-367"><a href="#cb301-367"></a>     <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">0</span>, h, <span class="at">by =</span> <span class="dv">35</span>), <span class="at">cex.axis =</span> <span class="fl">0.5</span>, <span class="at">padj =</span> <span class="sc">-</span><span class="fl">2.5</span>)</span>
<span id="cb301-368"><a href="#cb301-368"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">pos =</span> <span class="sc">-</span><span class="fl">3.5</span>, <span class="at">at =</span> <span class="sc">-</span>h<span class="sc">+</span><span class="fu">seq</span>(<span class="dv">0</span>, h, <span class="at">by =</span> <span class="dv">35</span>)<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span>h,</span>
<span id="cb301-369"><a href="#cb301-369"></a>     <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">0</span>, h, <span class="at">by =</span> <span class="dv">35</span>), <span class="at">cex.axis =</span> <span class="fl">0.5</span>, <span class="at">padj =</span> <span class="sc">-</span><span class="fl">2.5</span>)</span>
<span id="cb301-370"><a href="#cb301-370"></a></span>
<span id="cb301-371"><a href="#cb301-371"></a><span class="fu">legend</span>(<span class="st">'topleft'</span>, <span class="fu">levels</span>(<span class="fu">as.factor</span>(map.spp)), <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb301-372"><a href="#cb301-372"></a>       <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>))</span>
<span id="cb301-373"><a href="#cb301-373"></a></span>
<span id="cb301-374"><a href="#cb301-374"></a></span>
<span id="cb301-375"><a href="#cb301-375"></a><span class="do">## overlaying raster images</span></span>
<span id="cb301-376"><a href="#cb301-376"></a></span>
<span id="cb301-377"><a href="#cb301-377"></a>gek.img <span class="ot">&lt;-</span><span class="fu">readPNG</span>(<span class="st">'imgs/gecko.png'</span>, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-378"><a href="#cb301-378"></a><span class="fu">rasterImage</span>(gek.img, <span class="dv">445</span>, <span class="dv">110</span>, <span class="dv">475</span>, <span class="dv">85</span>)</span>
<span id="cb301-379"><a href="#cb301-379"></a>sci.img <span class="ot">&lt;-</span><span class="fu">readPNG</span>(<span class="st">'imgs/skink.png'</span>, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-380"><a href="#cb301-380"></a><span class="fu">rasterImage</span>(sci.img, <span class="dv">325</span>, <span class="dv">360</span>, <span class="dv">365</span>, <span class="dv">290</span>)</span>
<span id="cb301-381"><a href="#cb301-381"></a>tegu.img <span class="ot">&lt;-</span><span class="fu">readPNG</span>(<span class="st">'imgs/tegu.png'</span>, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-382"><a href="#cb301-382"></a><span class="fu">rasterImage</span>(tegu.img, <span class="dv">205</span>, <span class="dv">375</span>, <span class="dv">275</span>, <span class="dv">450</span>)</span>
<span id="cb301-383"><a href="#cb301-383"></a>var.img <span class="ot">&lt;-</span><span class="fu">readPNG</span>(<span class="st">'imgs/komodo.png'</span>, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-384"><a href="#cb301-384"></a><span class="fu">rasterImage</span>(var.img, <span class="dv">10</span>, <span class="dv">450</span>, <span class="dv">130</span>, <span class="dv">495</span>)</span>
<span id="cb301-385"><a href="#cb301-385"></a>igu.img <span class="ot">&lt;-</span> <span class="fu">readPNG</span>(<span class="st">'imgs/clamy.png'</span>, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-386"><a href="#cb301-386"></a><span class="fu">rasterImage</span>(igu.img, <span class="sc">-</span><span class="dv">170</span>, <span class="dv">470</span>, <span class="sc">-</span><span class="dv">120</span>, <span class="dv">435</span>)</span>
<span id="cb301-387"><a href="#cb301-387"></a>anole.img <span class="ot">&lt;-</span> <span class="fu">readPNG</span>(<span class="st">'imgs/anole.png'</span>, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-388"><a href="#cb301-388"></a><span class="fu">rasterImage</span>(anole.img, <span class="sc">-</span><span class="dv">350</span>, <span class="dv">360</span>, <span class="sc">-</span><span class="dv">310</span>, <span class="dv">320</span>)</span>
<span id="cb301-389"><a href="#cb301-389"></a>boa.img <span class="ot">&lt;-</span> <span class="fu">readPNG</span>(<span class="st">'imgs/boa.png'</span>, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-390"><a href="#cb301-390"></a><span class="fu">rasterImage</span>(boa.img, <span class="sc">-</span><span class="dv">430</span>, <span class="dv">220</span>, <span class="sc">-</span><span class="dv">350</span>, <span class="dv">320</span>)</span>
<span id="cb301-391"><a href="#cb301-391"></a>col.img <span class="ot">&lt;-</span> <span class="fu">readPNG</span>(<span class="st">'imgs/colubrid.png'</span>, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-392"><a href="#cb301-392"></a><span class="fu">rasterImage</span>(col.img, <span class="sc">-</span><span class="dv">490</span>, <span class="dv">90</span>, <span class="sc">-</span><span class="dv">430</span>, <span class="dv">180</span>)</span>
<span id="cb301-393"><a href="#cb301-393"></a></span>
<span id="cb301-394"><a href="#cb301-394"></a></span>
<span id="cb301-395"><a href="#cb301-395"></a><span class="fu">mtext</span>(<span class="st">'A'</span>, <span class="at">at =</span> <span class="sc">-</span><span class="dv">550</span>, <span class="at">side =</span> <span class="dv">3</span>, <span class="at">line =</span> <span class="fl">0.5</span>)</span>
<span id="cb301-396"><a href="#cb301-396"></a></span>
<span id="cb301-397"><a href="#cb301-397"></a><span class="do">## plotting state transitions</span></span>
<span id="cb301-398"><a href="#cb301-398"></a></span>
<span id="cb301-399"><a href="#cb301-399"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">3</span>), <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">2.8</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb301-400"><a href="#cb301-400"></a>    <span class="at">las =</span> <span class="dv">1</span>, <span class="at">col.lab =</span> <span class="st">'white'</span>)</span>
<span id="cb301-401"><a href="#cb301-401"></a></span>
<span id="cb301-402"><a href="#cb301-402"></a>for.density <span class="ot">&lt;-</span> <span class="fu">density</span>(lizard.maps.sym)</span>
<span id="cb301-403"><a href="#cb301-403"></a><span class="fu">plot</span>(for.density, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>),</span>
<span id="cb301-404"><a href="#cb301-404"></a>     <span class="at">transition =</span> for.density<span class="sc">$</span>trans[<span class="dv">1</span>],</span>
<span id="cb301-405"><a href="#cb301-405"></a>     <span class="at">colors =</span> <span class="st">'#39568CFF'</span>, <span class="at">xlab =</span> <span class="st">'Number of transitions'</span>,</span>
<span id="cb301-406"><a href="#cb301-406"></a>     <span class="at">ylab =</span> <span class="st">'Relative frequency'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-407"><a href="#cb301-407"></a><span class="fu">plot</span>(for.density, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb301-408"><a href="#cb301-408"></a>     <span class="at">transition =</span> for.density<span class="sc">$</span>trans[<span class="dv">2</span>],</span>
<span id="cb301-409"><a href="#cb301-409"></a>     <span class="at">colors =</span> <span class="st">'#39568CFF'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb301-410"><a href="#cb301-410"></a><span class="fu">plot</span>(for.density, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb301-411"><a href="#cb301-411"></a>     <span class="at">transition =</span> for.density<span class="sc">$</span>trans[<span class="dv">4</span>],</span>
<span id="cb301-412"><a href="#cb301-412"></a>     <span class="at">colors =</span> <span class="st">'green4'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>) </span>
<span id="cb301-413"><a href="#cb301-413"></a><span class="fu">plot</span>(for.density, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb301-414"><a href="#cb301-414"></a>     <span class="at">transition =</span> for.density<span class="sc">$</span>trans[<span class="dv">6</span>],</span>
<span id="cb301-415"><a href="#cb301-415"></a>     <span class="at">colors =</span> <span class="st">'#DCE319FF'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>) </span>
<span id="cb301-416"><a href="#cb301-416"></a><span class="fu">plot</span>(for.density, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb301-417"><a href="#cb301-417"></a>     <span class="at">transition =</span> for.density<span class="sc">$</span>trans[<span class="dv">5</span>],</span>
<span id="cb301-418"><a href="#cb301-418"></a>     <span class="at">colors =</span> <span class="st">'#DCE319FF'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>) </span>
<span id="cb301-419"><a href="#cb301-419"></a><span class="fu">plot</span>(for.density, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb301-420"><a href="#cb301-420"></a>     <span class="at">transition =</span> for.density<span class="sc">$</span>trans[<span class="dv">3</span>],</span>
<span id="cb301-421"><a href="#cb301-421"></a>     <span class="at">colors =</span> <span class="st">'green4'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>) </span>
<span id="cb301-422"><a href="#cb301-422"></a></span>
<span id="cb301-423"><a href="#cb301-423"></a></span>
<span id="cb301-424"><a href="#cb301-424"></a><span class="do">## Modifying axes labels</span></span>
<span id="cb301-425"><a href="#cb301-425"></a></span>
<span id="cb301-426"><a href="#cb301-426"></a><span class="do">## plotting state transitions</span></span>
<span id="cb301-427"><a href="#cb301-427"></a></span>
<span id="cb301-428"><a href="#cb301-428"></a><span class="fu">mtext</span>(<span class="st">'Relative frequency'</span>, <span class="at">at =</span> <span class="sc">-</span><span class="dv">380</span>, <span class="at">line =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb301-429"><a href="#cb301-429"></a><span class="fu">mtext</span>(<span class="st">'B'</span>, <span class="at">at =</span> <span class="sc">-</span><span class="dv">380</span>, <span class="at">line =</span> <span class="dv">17</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb301-430"><a href="#cb301-430"></a><span class="fu">mtext</span>(<span class="st">'Number of transitions'</span>, <span class="at">at =</span> <span class="sc">-</span><span class="dv">130</span>, <span class="at">line =</span> <span class="sc">-</span><span class="fl">11.5</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb301-431"><a href="#cb301-431"></a></span>
<span id="cb301-432"><a href="#cb301-432"></a><span class="do">##dev.off()</span></span>
<span id="cb301-433"><a href="#cb301-433"></a></span>
<span id="cb301-434"><a href="#cb301-434"></a></span>
<span id="cb301-435"><a href="#cb301-435"></a><span class="in">```</span></span>
<span id="cb301-436"><a href="#cb301-436"></a></span>
<span id="cb301-437"><a href="#cb301-437"></a><span class="in">```{r, eval = FALSE}</span></span>
<span id="cb301-438"><a href="#cb301-438"></a></span>
<span id="cb301-439"><a href="#cb301-439"></a><span class="in">## setting up data for MuSEE model</span></span>
<span id="cb301-440"><a href="#cb301-440"></a></span>
<span id="cb301-441"><a href="#cb301-441"></a><span class="in">## acording to Reptile database, there are</span></span>
<span id="cb301-442"><a href="#cb301-442"></a><span class="in">## currently 11989 species of squamates</span></span>
<span id="cb301-443"><a href="#cb301-443"></a></span>
<span id="cb301-444"><a href="#cb301-444"></a><span class="in">((sampling.f &lt;- as.numeric(tapply(X = pruned.data$Species,</span></span>
<span id="cb301-445"><a href="#cb301-445"></a><span class="in">                                  INDEX = list(pruned.data$Foraging.mode),</span></span>
<span id="cb301-446"><a href="#cb301-446"></a><span class="in">                                  length)/11989)))</span></span>
<span id="cb301-447"><a href="#cb301-447"></a></span>
<span id="cb301-448"><a href="#cb301-448"></a><span class="in">pruned.data$Foraging.mode &lt;- as.character(pruned.data$Foraging.mode)</span></span>
<span id="cb301-449"><a href="#cb301-449"></a><span class="in">pruned.data$Foraging.mode[pruned.data$Foraging.mode == 'active'] &lt;- 3</span></span>
<span id="cb301-450"><a href="#cb301-450"></a><span class="in">pruned.data$Foraging.mode[pruned.data$Foraging.mode == 'plastic'] &lt;- 2</span></span>
<span id="cb301-451"><a href="#cb301-451"></a><span class="in">pruned.data$Foraging.mode[pruned.data$Foraging.mode == 'sit-and-wait'] &lt;- 1</span></span>
<span id="cb301-452"><a href="#cb301-452"></a></span>
<span id="cb301-453"><a href="#cb301-453"></a><span class="in">pruned.data$Foraging.mode &lt;- as.integer(pruned.data$Foraging.mode)</span></span>
<span id="cb301-454"><a href="#cb301-454"></a><span class="in">pruned.data &lt;- pruned.data[pruned.tree$tip.label, ]</span></span>
<span id="cb301-455"><a href="#cb301-455"></a><span class="in">data.frame(tree = pruned.tree$tip.label[1:10],</span></span>
<span id="cb301-456"><a href="#cb301-456"></a><span class="in">           data = rownames(pruned.data)[1:10])</span></span>
<span id="cb301-457"><a href="#cb301-457"></a><span class="in">forg &lt;- setNames(pruned.data$Foraging.mode, rownames(pruned.data))</span></span>
<span id="cb301-458"><a href="#cb301-458"></a></span>
<span id="cb301-459"><a href="#cb301-459"></a><span class="in">```</span></span>
<span id="cb301-460"><a href="#cb301-460"></a></span>
<span id="cb301-461"><a href="#cb301-461"></a><span class="in">```{r, eval = FALSE}</span></span>
<span id="cb301-462"><a href="#cb301-462"></a></span>
<span id="cb301-463"><a href="#cb301-463"></a></span>
<span id="cb301-464"><a href="#cb301-464"></a><span class="in">## writing down our MuSSE likelihood function</span></span>
<span id="cb301-465"><a href="#cb301-465"></a></span>
<span id="cb301-466"><a href="#cb301-466"></a><span class="in">pruned.tree &lt;- force.ultrametric(pruned.tree)</span></span>
<span id="cb301-467"><a href="#cb301-467"></a><span class="in">is.ultrametric(pruned.tree)</span></span>
<span id="cb301-468"><a href="#cb301-468"></a></span>
<span id="cb301-469"><a href="#cb301-469"></a><span class="in">((lik.musse &lt;- make.musse(pruned.tree,</span></span>
<span id="cb301-470"><a href="#cb301-470"></a><span class="in">                          forg, 3, sampling.f = sampling.f)))</span></span>
<span id="cb301-471"><a href="#cb301-471"></a></span>
<span id="cb301-472"><a href="#cb301-472"></a></span>
<span id="cb301-473"><a href="#cb301-473"></a><span class="in">p &lt;- starting.point.musse(pruned.tree, k = 3)</span></span>
<span id="cb301-474"><a href="#cb301-474"></a><span class="in">p</span></span>
<span id="cb301-475"><a href="#cb301-475"></a></span>
<span id="cb301-476"><a href="#cb301-476"></a><span class="in">obj &lt;- birthdeath(pruned.tree)</span></span>
<span id="cb301-477"><a href="#cb301-477"></a><span class="in">bd(obj)</span></span>
<span id="cb301-478"><a href="#cb301-478"></a></span>
<span id="cb301-479"><a href="#cb301-479"></a><span class="in">lik.null&lt;-constrain(lik.musse,lambda2 ~ lambda1, lambda3 ~ lambda1, </span></span>
<span id="cb301-480"><a href="#cb301-480"></a><span class="in">    mu2 ~ mu1, mu3 ~ mu1, q13 ~ 0, q21 ~ q12, q23 ~ q12, q31 ~ 0, </span></span>
<span id="cb301-481"><a href="#cb301-481"></a><span class="in">    q32 ~ q12)</span></span>
<span id="cb301-482"><a href="#cb301-482"></a><span class="in">lik.null</span></span>
<span id="cb301-483"><a href="#cb301-483"></a></span>
<span id="cb301-484"><a href="#cb301-484"></a><span class="in">## fitting a model - the null model in a sense - in which</span></span>
<span id="cb301-485"><a href="#cb301-485"></a><span class="in">## all birth &amp; death rates are equal between states,</span></span>
<span id="cb301-486"><a href="#cb301-486"></a><span class="in">## the character evolution is ordered (that is 1&lt;-&gt;2&lt;-&gt;3),</span></span>
<span id="cb301-487"><a href="#cb301-487"></a><span class="in">## and there is a single character transition rate</span></span>
<span id="cb301-488"><a href="#cb301-488"></a></span>
<span id="cb301-489"><a href="#cb301-489"></a><span class="in">p[argnames(lik.null)]</span></span>
<span id="cb301-490"><a href="#cb301-490"></a></span>
<span id="cb301-491"><a href="#cb301-491"></a><span class="in">## fit the model</span></span>
<span id="cb301-492"><a href="#cb301-492"></a><span class="in">fit.null &lt;- find.mle(lik.null, x.init = p[argnames(lik.null)])</span></span>
<span id="cb301-493"><a href="#cb301-493"></a><span class="in">fit.null</span></span>
<span id="cb301-494"><a href="#cb301-494"></a></span>
<span id="cb301-495"><a href="#cb301-495"></a><span class="in">## most complex model in which all rates of speciation</span></span>
<span id="cb301-496"><a href="#cb301-496"></a><span class="in">## &amp; extinction depend on the character state for our</span></span>
<span id="cb301-497"><a href="#cb301-497"></a><span class="in">## multi-state character</span></span>
<span id="cb301-498"><a href="#cb301-498"></a></span>
<span id="cb301-499"><a href="#cb301-499"></a><span class="in">fit.full &lt;- find.mle(lik.musse, x.init = p[argnames(lik.musse)])</span></span>
<span id="cb301-500"><a href="#cb301-500"></a><span class="in">fit.full</span></span>
<span id="cb301-501"><a href="#cb301-501"></a></span>
<span id="cb301-502"><a href="#cb301-502"></a><span class="in">## model in which only the speciation rate () varies between states</span></span>
<span id="cb301-503"><a href="#cb301-503"></a></span>
<span id="cb301-504"><a href="#cb301-504"></a><span class="in">## create likelihood function</span></span>
<span id="cb301-505"><a href="#cb301-505"></a></span>
<span id="cb301-506"><a href="#cb301-506"></a><span class="in">lik.lambda &lt;- constrain(lik.musse, mu2 ~ mu1, mu3 ~ mu1,</span></span>
<span id="cb301-507"><a href="#cb301-507"></a><span class="in">                        q21 ~ q12, q23 ~ q12, q32 ~ q12)</span></span>
<span id="cb301-508"><a href="#cb301-508"></a></span>
<span id="cb301-509"><a href="#cb301-509"></a><span class="in">## fit it</span></span>
<span id="cb301-510"><a href="#cb301-510"></a></span>
<span id="cb301-511"><a href="#cb301-511"></a><span class="in">fit.lambda &lt;- find.mle(lik.lambda, p[argnames(lik.lambda)])</span></span>
<span id="cb301-512"><a href="#cb301-512"></a><span class="in">fit.lambda</span></span>
<span id="cb301-513"><a href="#cb301-513"></a></span>
<span id="cb301-514"><a href="#cb301-514"></a><span class="in">## model in which extinction rate () varies</span></span>
<span id="cb301-515"><a href="#cb301-515"></a></span>
<span id="cb301-516"><a href="#cb301-516"></a><span class="in">lik.mu &lt;- constrain(lik.musse, lambda2 ~ lambda1, lambda3 ~ lambda1, </span></span>
<span id="cb301-517"><a href="#cb301-517"></a><span class="in">    q13 ~ 0, q21 ~ q12, q23 ~ q12, q31 ~ 0, q32 ~ q12)</span></span>
<span id="cb301-518"><a href="#cb301-518"></a><span class="in">fit.mu &lt;- find.mle(lik.mu, p[argnames(lik.mu)])</span></span>
<span id="cb301-519"><a href="#cb301-519"></a><span class="in">fit.mu</span></span>
<span id="cb301-520"><a href="#cb301-520"></a></span>
<span id="cb301-521"><a href="#cb301-521"></a><span class="in">## a model in which  &amp;  vary, but in which</span></span>
<span id="cb301-522"><a href="#cb301-522"></a><span class="in">## character transitions are ordered</span></span>
<span id="cb301-523"><a href="#cb301-523"></a></span>
<span id="cb301-524"><a href="#cb301-524"></a><span class="in">lik.lambda.mu &lt;- constrain(lik.musse, q13 ~ 0, q21 ~ q12, q23 ~ q12, </span></span>
<span id="cb301-525"><a href="#cb301-525"></a><span class="in">    q31 ~ 0, q32 ~ q12)</span></span>
<span id="cb301-526"><a href="#cb301-526"></a><span class="in">fit.lambda.mu &lt;- find.mle(lik.lambda.mu, p[argnames(lik.lambda.mu)])</span></span>
<span id="cb301-527"><a href="#cb301-527"></a><span class="in">fit.lambda.mu</span></span>
<span id="cb301-528"><a href="#cb301-528"></a></span>
<span id="cb301-529"><a href="#cb301-529"></a><span class="in">## a model in which  &amp;  are constant,</span></span>
<span id="cb301-530"><a href="#cb301-530"></a><span class="in">## but in which the transition process is</span></span>
<span id="cb301-531"><a href="#cb301-531"></a><span class="in">## full flexible (i.e., unordered)</span></span>
<span id="cb301-532"><a href="#cb301-532"></a></span>
<span id="cb301-533"><a href="#cb301-533"></a><span class="in">lik.unordered &lt;- constrain(lik.musse, lambda2 ~ lambda1,</span></span>
<span id="cb301-534"><a href="#cb301-534"></a><span class="in">                           lambda3 ~ lambda1, mu2 ~ mu1, mu3 ~ mu1)</span></span>
<span id="cb301-535"><a href="#cb301-535"></a><span class="in">fit.unordered &lt;- find.mle(lik.unordered, p[argnames(lik.unordered)])</span></span>
<span id="cb301-536"><a href="#cb301-536"></a><span class="in">fit.unordered</span></span>
<span id="cb301-537"><a href="#cb301-537"></a></span>
<span id="cb301-538"><a href="#cb301-538"></a><span class="in">## comparing our fitted models</span></span>
<span id="cb301-539"><a href="#cb301-539"></a></span>
<span id="cb301-540"><a href="#cb301-540"></a><span class="in">AnovaResults &lt;- anova(fit.null, </span></span>
<span id="cb301-541"><a href="#cb301-541"></a><span class="in">    all.different = fit.full, </span></span>
<span id="cb301-542"><a href="#cb301-542"></a><span class="in">    free.lambda = fit.lambda, </span></span>
<span id="cb301-543"><a href="#cb301-543"></a><span class="in">    free.mu = fit.mu, </span></span>
<span id="cb301-544"><a href="#cb301-544"></a><span class="in">    free.lambda.mu = fit.lambda.mu, </span></span>
<span id="cb301-545"><a href="#cb301-545"></a><span class="in">    free.q = fit.unordered)</span></span>
<span id="cb301-546"><a href="#cb301-546"></a><span class="in">save(AnovaResults, file = 'anova-models.RData')</span></span>
<span id="cb301-547"><a href="#cb301-547"></a><span class="in">aicw(setNames(AnovaResults$AIC,rownames(AnovaResults)))</span></span>
<span id="cb301-548"><a href="#cb301-548"></a></span>
<span id="cb301-549"><a href="#cb301-549"></a><span class="in">coef(fit.full)</span></span>
<span id="cb301-550"><a href="#cb301-550"></a></span>
<span id="cb301-551"><a href="#cb301-551"></a></span>
<span id="cb301-552"><a href="#cb301-552"></a><span class="in">## Bayesian mcmc to get posterior probability distributions</span></span>
<span id="cb301-553"><a href="#cb301-553"></a></span>
<span id="cb301-554"><a href="#cb301-554"></a><span class="in">prior &lt;- make.prior.exponential(1/2)</span></span>
<span id="cb301-555"><a href="#cb301-555"></a></span>
<span id="cb301-556"><a href="#cb301-556"></a><span class="in">## because of the type of MCMC used by diversitree,</span></span>
<span id="cb301-557"><a href="#cb301-557"></a><span class="in">## is to set a control parameter w. This parameter</span></span>
<span id="cb301-558"><a href="#cb301-558"></a><span class="in">## affects how many function evaluations are required</span></span>
<span id="cb301-559"><a href="#cb301-559"></a><span class="in">## between updates to the MCMC chain; however we need</span></span>
<span id="cb301-560"><a href="#cb301-560"></a><span class="in">## to do some preliminary sampling from the posterior</span></span>
<span id="cb301-561"><a href="#cb301-561"></a><span class="in">## distribution to set it</span></span>
<span id="cb301-562"><a href="#cb301-562"></a></span>
<span id="cb301-563"><a href="#cb301-563"></a><span class="in">prelim &lt;- mcmc(lik.musse, fit.full$par, nsteps = 100,</span></span>
<span id="cb301-564"><a href="#cb301-564"></a><span class="in">               prior = prior, w = 1, print.every = 0)</span></span>
<span id="cb301-565"><a href="#cb301-565"></a><span class="in">head(prelim)</span></span>
<span id="cb301-566"><a href="#cb301-566"></a></span>
<span id="cb301-567"><a href="#cb301-567"></a><span class="in">## Fitzjohn recommends setting w</span></span>
<span id="cb301-568"><a href="#cb301-568"></a></span>
<span id="cb301-569"><a href="#cb301-569"></a><span class="in">w &lt;- diff(sapply(prelim[2:(ncol(prelim)-1)],</span></span>
<span id="cb301-570"><a href="#cb301-570"></a><span class="in">                 quantile, c(0.05, 0.95)))</span></span>
<span id="cb301-571"><a href="#cb301-571"></a><span class="in">w</span></span>
<span id="cb301-572"><a href="#cb301-572"></a></span>
<span id="cb301-573"><a href="#cb301-573"></a><span class="in">## running the mcmc</span></span>
<span id="cb301-574"><a href="#cb301-574"></a></span>
<span id="cb301-575"><a href="#cb301-575"></a><span class="in">mcmc.fit.full &lt;- mcmc(lik.musse, p[colnames(w)],</span></span>
<span id="cb301-576"><a href="#cb301-576"></a><span class="in">                      nsteps = 1e5, prior = prior,</span></span>
<span id="cb301-577"><a href="#cb301-577"></a><span class="in">                      w = w, print.every = 1000)</span></span>
<span id="cb301-578"><a href="#cb301-578"></a><span class="in">save(mcmc.fit.full, file = "mcmc.fit.full.RData")</span></span>
<span id="cb301-579"><a href="#cb301-579"></a></span>
<span id="cb301-580"><a href="#cb301-580"></a><span class="in">```</span></span>
<span id="cb301-581"><a href="#cb301-581"></a></span>
<span id="cb301-582"><a href="#cb301-582"></a><span class="in">```{r, include = FALSE}</span></span>
<span id="cb301-583"><a href="#cb301-583"></a></span>
<span id="cb301-584"><a href="#cb301-584"></a><span class="in">load('mcmc.fit.full-10e5(2).RData')</span></span>
<span id="cb301-585"><a href="#cb301-585"></a></span>
<span id="cb301-586"><a href="#cb301-586"></a></span>
<span id="cb301-587"><a href="#cb301-587"></a><span class="in">##files &lt;- list.files('results/', full.names = TRUE)</span></span>
<span id="cb301-588"><a href="#cb301-588"></a></span>
<span id="cb301-589"><a href="#cb301-589"></a><span class="in">##mcmc.full &lt;- data.frame()</span></span>
<span id="cb301-590"><a href="#cb301-590"></a><span class="in">##for(i in files){</span></span>
<span id="cb301-591"><a href="#cb301-591"></a><span class="in">##    load(i)</span></span>
<span id="cb301-592"><a href="#cb301-592"></a><span class="in">##    subset &lt;- mcmc.fit.full</span></span>
<span id="cb301-593"><a href="#cb301-593"></a><span class="in">##    mcmc.full &lt;- rbind(mcmc.full, subset)</span></span>
<span id="cb301-594"><a href="#cb301-594"></a><span class="in">##}</span></span>
<span id="cb301-595"><a href="#cb301-595"></a></span>
<span id="cb301-596"><a href="#cb301-596"></a><span class="in">##dim(mcmc.full)</span></span>
<span id="cb301-597"><a href="#cb301-597"></a></span>
<span id="cb301-598"><a href="#cb301-598"></a></span>
<span id="cb301-599"><a href="#cb301-599"></a><span class="in">```</span></span>
<span id="cb301-600"><a href="#cb301-600"></a></span>
<span id="cb301-603"><a href="#cb301-603"></a><span class="in">```{r}</span></span>
<span id="cb301-604"><a href="#cb301-604"></a><span class="do">## likelihood profile showing how the</span></span>
<span id="cb301-605"><a href="#cb301-605"></a><span class="do">## likelihood changed through the MCMC run</span></span>
<span id="cb301-606"><a href="#cb301-606"></a></span>
<span id="cb301-607"><a href="#cb301-607"></a><span class="fu">plot</span>(mcmc.fit.full<span class="sc">$</span>i, mcmc.fit.full<span class="sc">$</span>p, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb301-608"><a href="#cb301-608"></a>     <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-609"><a href="#cb301-609"></a><span class="fu">grid</span>()</span>
<span id="cb301-610"><a href="#cb301-610"></a></span>
<span id="cb301-611"><a href="#cb301-611"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-612"><a href="#cb301-612"></a><span class="fu">plot</span>(mcmc.fit.full<span class="sc">$</span>i, mcmc.fit.full<span class="sc">$</span>p, <span class="at">type =</span> <span class="st">'l'</span>, <span class="at">xlab =</span> <span class="st">'Generation'</span>,</span>
<span id="cb301-613"><a href="#cb301-613"></a>    <span class="at">ylab =</span> <span class="st">'log(L)'</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb301-614"><a href="#cb301-614"></a></span>
<span id="cb301-615"><a href="#cb301-615"></a></span>
<span id="cb301-616"><a href="#cb301-616"></a><span class="do">##png('./imgs/figure2.png', width = 7, height = 7, units = 'in',</span></span>
<span id="cb301-617"><a href="#cb301-617"></a><span class="do">##    res = 360)</span></span>
<span id="cb301-618"><a href="#cb301-618"></a><span class="do">##pdf('./imgs/figuer2.pdf')</span></span>
<span id="cb301-619"><a href="#cb301-619"></a></span>
<span id="cb301-620"><a href="#cb301-620"></a></span>
<span id="cb301-621"><a href="#cb301-621"></a></span>
<span id="cb301-622"><a href="#cb301-622"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb301-623"><a href="#cb301-623"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>,</span>
<span id="cb301-624"><a href="#cb301-624"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>,</span>
<span id="cb301-625"><a href="#cb301-625"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">ncol =</span> <span class="dv">6</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb301-626"><a href="#cb301-626"></a></span>
<span id="cb301-627"><a href="#cb301-627"></a><span class="do">## computing the mean of our posterior sample,</span></span>
<span id="cb301-628"><a href="#cb301-628"></a><span class="do">## and we can also compute things like the density</span></span>
<span id="cb301-629"><a href="#cb301-629"></a><span class="do">## or the 95% HPD interval, just as we would with</span></span>
<span id="cb301-630"><a href="#cb301-630"></a><span class="do">## any standard Bayesian MCMC</span></span>
<span id="cb301-631"><a href="#cb301-631"></a></span>
<span id="cb301-632"><a href="#cb301-632"></a><span class="fu">colMeans</span>(mcmc.fit.full)[<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(mcmc.fit.full)]</span>
<span id="cb301-633"><a href="#cb301-633"></a></span>
<span id="cb301-634"><a href="#cb301-634"></a><span class="do">## speciation rates</span></span>
<span id="cb301-635"><a href="#cb301-635"></a></span>
<span id="cb301-636"><a href="#cb301-636"></a>colors <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>), <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb301-637"><a href="#cb301-637"></a></span>
<span id="cb301-638"><a href="#cb301-638"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb301-639"><a href="#cb301-639"></a><span class="fu">plot</span>(<span class="cn">NA</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb301-640"><a href="#cb301-640"></a>     <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">xlab =</span> <span class="st">''</span>)</span>
<span id="cb301-641"><a href="#cb301-641"></a><span class="fu">grid</span>()</span>
<span id="cb301-642"><a href="#cb301-642"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-643"><a href="#cb301-643"></a><span class="fu">profiles.plot</span>(mcmc.fit.full[ , <span class="fu">grep</span>(<span class="st">'lambda'</span>, <span class="fu">colnames</span>(mcmc.fit.full))],</span>
<span id="cb301-644"><a href="#cb301-644"></a>              <span class="at">col.line =</span> colors, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">legend.pos =</span> <span class="cn">NULL</span>,</span>
<span id="cb301-645"><a href="#cb301-645"></a>              <span class="at">lines.on.top =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-646"><a href="#cb301-646"></a><span class="fu">legend</span>(<span class="st">'topright'</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">expression</span>(lambda[<span class="dv">1</span>]),</span>
<span id="cb301-647"><a href="#cb301-647"></a>                              <span class="fu">expression</span>(lambda[<span class="dv">2</span>]), <span class="fu">expression</span>(lambda[<span class="dv">3</span>])),</span>
<span id="cb301-648"><a href="#cb301-648"></a>       <span class="at">fil =</span> colors, <span class="at">bty =</span> <span class="st">'n'</span>)</span>
<span id="cb301-649"><a href="#cb301-649"></a></span>
<span id="cb301-650"><a href="#cb301-650"></a><span class="do">## extinction rates</span></span>
<span id="cb301-651"><a href="#cb301-651"></a></span>
<span id="cb301-652"><a href="#cb301-652"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb301-653"><a href="#cb301-653"></a><span class="fu">plot</span>(<span class="cn">NA</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb301-654"><a href="#cb301-654"></a>     <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">xlab =</span> <span class="st">''</span>)</span>
<span id="cb301-655"><a href="#cb301-655"></a><span class="fu">grid</span>()</span>
<span id="cb301-656"><a href="#cb301-656"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-657"><a href="#cb301-657"></a><span class="fu">profiles.plot</span>(mcmc.fit.full[ , <span class="fu">grep</span>(<span class="st">'mu'</span>, <span class="fu">colnames</span>(mcmc.fit.full))], </span>
<span id="cb301-658"><a href="#cb301-658"></a>              <span class="at">col.line =</span> colors, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">legend.pos =</span> <span class="cn">NULL</span>,</span>
<span id="cb301-659"><a href="#cb301-659"></a>              <span class="at">lines.on.top =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-660"><a href="#cb301-660"></a><span class="fu">legend</span>(<span class="st">'topright'</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">expression</span>(mu[<span class="dv">1</span>]),</span>
<span id="cb301-661"><a href="#cb301-661"></a>                              <span class="fu">expression</span>(mu[<span class="dv">2</span>]), <span class="fu">expression</span>(mu[<span class="dv">3</span>])),</span>
<span id="cb301-662"><a href="#cb301-662"></a>       <span class="at">fill =</span> colors, <span class="at">bty =</span> <span class="st">'n'</span>)</span>
<span id="cb301-663"><a href="#cb301-663"></a></span>
<span id="cb301-664"><a href="#cb301-664"></a><span class="do">## net diversification rates</span></span>
<span id="cb301-665"><a href="#cb301-665"></a></span>
<span id="cb301-666"><a href="#cb301-666"></a>net.div <span class="ot">&lt;-</span> mcmc.fit.full[ , <span class="fu">grep</span>(<span class="st">'lambda'</span>, <span class="fu">colnames</span>(mcmc.fit.full))]<span class="sc">-</span></span>
<span id="cb301-667"><a href="#cb301-667"></a>    mcmc.fit.full[ , <span class="fu">grep</span>(<span class="st">'mu'</span>, <span class="fu">colnames</span>(mcmc.fit.full))]</span>
<span id="cb301-668"><a href="#cb301-668"></a></span>
<span id="cb301-669"><a href="#cb301-669"></a><span class="do">##par(mar = c(5, 7, 2.5, 3.1), mgp = c(2.5, 1, 0), col.lab = 'black')</span></span>
<span id="cb301-670"><a href="#cb301-670"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="fl">0.5</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">col.lab =</span> <span class="st">'black'</span>)</span>
<span id="cb301-671"><a href="#cb301-671"></a><span class="fu">plot</span>(<span class="cn">NA</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">70</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.30</span>),</span>
<span id="cb301-672"><a href="#cb301-672"></a>     <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">xlab =</span> <span class="st">''</span>)</span>
<span id="cb301-673"><a href="#cb301-673"></a><span class="fu">grid</span>()</span>
<span id="cb301-674"><a href="#cb301-674"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-675"><a href="#cb301-675"></a><span class="fu">profiles.plot</span>(net.div,</span>
<span id="cb301-676"><a href="#cb301-676"></a>              <span class="at">xlab =</span> <span class="st">'Net diversification'</span>, <span class="at">ylab =</span> <span class="st">'Probability density'</span>,</span>
<span id="cb301-677"><a href="#cb301-677"></a>              <span class="at">las =</span> <span class="dv">1</span>, <span class="at">legend.pos =</span> <span class="cn">NULL</span>,</span>
<span id="cb301-678"><a href="#cb301-678"></a>              <span class="at">col.line =</span> <span class="fu">setNames</span>(colors, <span class="fu">colnames</span>(net.div)),</span>
<span id="cb301-679"><a href="#cb301-679"></a>              <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb301-680"><a href="#cb301-680"></a><span class="fu">legend</span>(<span class="st">'topright'</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">expression</span>(lambda<span class="sc">-</span>mu[<span class="dv">1</span>]),</span>
<span id="cb301-681"><a href="#cb301-681"></a>                              <span class="fu">expression</span>(lambda<span class="sc">-</span>mu[<span class="dv">2</span>]),</span>
<span id="cb301-682"><a href="#cb301-682"></a>                              <span class="fu">expression</span>(lambda<span class="sc">-</span>mu[<span class="dv">3</span>])),</span>
<span id="cb301-683"><a href="#cb301-683"></a>       <span class="at">fill =</span> colors, <span class="at">bty =</span> <span class="st">'n'</span>)</span>
<span id="cb301-684"><a href="#cb301-684"></a></span>
<span id="cb301-685"><a href="#cb301-685"></a><span class="do">##mtext('C', at = -0.2, side = 3, line = 1.1)</span></span>
<span id="cb301-686"><a href="#cb301-686"></a></span>
<span id="cb301-687"><a href="#cb301-687"></a><span class="do">##dev.off()</span></span>
<span id="cb301-688"><a href="#cb301-688"></a></span>
<span id="cb301-689"><a href="#cb301-689"></a><span class="do">## setting up the data for GLS models. We are using</span></span>
<span id="cb301-690"><a href="#cb301-690"></a><span class="do">## the merg.data table because it contains data on species ranges</span></span>
<span id="cb301-691"><a href="#cb301-691"></a></span>
<span id="cb301-692"><a href="#cb301-692"></a>merg.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(merg.data)</span>
<span id="cb301-693"><a href="#cb301-693"></a>merg.data<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">' '</span>, <span class="st">'_'</span>, <span class="fu">as.character</span>(merg.data<span class="sc">$</span>Species))</span>
<span id="cb301-694"><a href="#cb301-694"></a><span class="fu">rownames</span>(merg.data) <span class="ot">&lt;-</span> merg.data<span class="sc">$</span>Species</span>
<span id="cb301-695"><a href="#cb301-695"></a>check <span class="ot">&lt;-</span> <span class="fu">name.check</span>(lizard.tree, merg.data)</span>
<span id="cb301-696"><a href="#cb301-696"></a>rm_phy <span class="ot">&lt;-</span> check<span class="sc">$</span>tree_not_data</span>
<span id="cb301-697"><a href="#cb301-697"></a>rm_dat <span class="ot">&lt;-</span> check<span class="sc">$</span>data_not_tree</span>
<span id="cb301-698"><a href="#cb301-698"></a>pruned.tree.mrg <span class="ot">&lt;-</span> <span class="fu">drop.tip</span>(lizard.tree, rm_phy)</span>
<span id="cb301-699"><a href="#cb301-699"></a></span>
<span id="cb301-700"><a href="#cb301-700"></a>pruned.data.mrg <span class="ot">&lt;-</span> <span class="fu">subset</span>(merg.data,</span>
<span id="cb301-701"><a href="#cb301-701"></a>                          <span class="at">subset =</span> <span class="fu">rownames</span>(merg.data) <span class="sc">%in%</span> pruned.tree.mrg<span class="sc">$</span>tip,</span>
<span id="cb301-702"><a href="#cb301-702"></a>                          <span class="at">select =</span> <span class="fu">names</span>(merg.data))</span>
<span id="cb301-703"><a href="#cb301-703"></a><span class="fu">name.check</span>(pruned.tree.mrg, pruned.data.mrg)</span>
<span id="cb301-704"><a href="#cb301-704"></a></span>
<span id="cb301-705"><a href="#cb301-705"></a>pruned.data.mrg<span class="sc">$</span>rep.output <span class="ot">&lt;-</span> (pruned.data.mrg<span class="sc">$</span>Mean.number.of.offspring.per.litter.or.number.of.eggs.per.clutch)<span class="sc">*</span>(pruned.data.mrg<span class="sc">$</span>Number.of.litters.or.clutches.produced.per.year)</span>
<span id="cb301-706"><a href="#cb301-706"></a><span class="fu">str</span>(pruned.data.mrg)</span>
<span id="cb301-707"><a href="#cb301-707"></a></span>
<span id="cb301-708"><a href="#cb301-708"></a></span>
<span id="cb301-709"><a href="#cb301-709"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb301-710"><a href="#cb301-710"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-711"><a href="#cb301-711"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-712"><a href="#cb301-712"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb301-713"><a href="#cb301-713"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb301-714"><a href="#cb301-714"></a></span>
<span id="cb301-715"><a href="#cb301-715"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(pruned.data.mrg<span class="sc">$</span>Maximum.body.mass..g.),</span>
<span id="cb301-716"><a href="#cb301-716"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">border =</span> <span class="st">'white'</span>, <span class="at">col =</span> <span class="st">'white'</span>,</span>
<span id="cb301-717"><a href="#cb301-717"></a>     <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb301-718"><a href="#cb301-718"></a><span class="fu">grid</span>()</span>
<span id="cb301-719"><a href="#cb301-719"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-720"><a href="#cb301-720"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(pruned.data.mrg<span class="sc">$</span>Maximum.body.mass..g.),</span>
<span id="cb301-721"><a href="#cb301-721"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">'Body mass'</span><span class="sc">~</span>(g)))</span>
<span id="cb301-722"><a href="#cb301-722"></a><span class="fu">box</span>()</span>
<span id="cb301-723"><a href="#cb301-723"></a></span>
<span id="cb301-724"><a href="#cb301-724"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(<span class="fu">log10</span>(pruned.data.mrg<span class="sc">$</span>Maximum.body.mass..g.)<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb301-725"><a href="#cb301-725"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">border =</span> <span class="st">'white'</span>, <span class="at">col =</span> <span class="st">'white'</span>,</span>
<span id="cb301-726"><a href="#cb301-726"></a>     <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb301-727"><a href="#cb301-727"></a><span class="fu">grid</span>()</span>
<span id="cb301-728"><a href="#cb301-728"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-729"><a href="#cb301-729"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(<span class="fu">log10</span>(pruned.data.mrg<span class="sc">$</span>Maximum.body.mass..g.)<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb301-730"><a href="#cb301-730"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">'Body mass'</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">+</span><span class="dv">1</span><span class="sc">~</span>(g)))</span>
<span id="cb301-731"><a href="#cb301-731"></a><span class="fu">box</span>()</span>
<span id="cb301-732"><a href="#cb301-732"></a></span>
<span id="cb301-733"><a href="#cb301-733"></a><span class="do">## transforming the data</span></span>
<span id="cb301-734"><a href="#cb301-734"></a></span>
<span id="cb301-735"><a href="#cb301-735"></a>pruned.data.mrg<span class="sc">$</span>Maximum.body.mass..g. <span class="ot">&lt;-</span> <span class="fu">log10</span>(pruned.data.mrg<span class="sc">$</span>Maximum.body.mass..g.)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb301-736"><a href="#cb301-736"></a></span>
<span id="cb301-737"><a href="#cb301-737"></a></span>
<span id="cb301-738"><a href="#cb301-738"></a></span>
<span id="cb301-739"><a href="#cb301-739"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb301-740"><a href="#cb301-740"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-741"><a href="#cb301-741"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-742"><a href="#cb301-742"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb301-743"><a href="#cb301-743"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb301-744"><a href="#cb301-744"></a></span>
<span id="cb301-745"><a href="#cb301-745"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(pruned.data.mrg<span class="sc">$</span>Mean.Tb), <span class="at">main =</span> <span class="st">''</span>,</span>
<span id="cb301-746"><a href="#cb301-746"></a>     <span class="at">las =</span> <span class="dv">1</span>, <span class="at">border =</span> <span class="st">'white'</span>, <span class="at">col =</span> <span class="st">'white'</span>,</span>
<span id="cb301-747"><a href="#cb301-747"></a>     <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb301-748"><a href="#cb301-748"></a><span class="fu">grid</span>()</span>
<span id="cb301-749"><a href="#cb301-749"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-750"><a href="#cb301-750"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(pruned.data.mrg<span class="sc">$</span>Mean.Tb), <span class="at">main =</span> <span class="st">''</span>,</span>
<span id="cb301-751"><a href="#cb301-751"></a>     <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">'Mean body temperature'</span><span class="sc">~</span>(<span class="st">'\u00B0C'</span>)))</span>
<span id="cb301-752"><a href="#cb301-752"></a><span class="fu">box</span>()</span>
<span id="cb301-753"><a href="#cb301-753"></a></span>
<span id="cb301-754"><a href="#cb301-754"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(<span class="fu">log10</span>(pruned.data.mrg<span class="sc">$</span>Mean.Tb)), <span class="at">main =</span> <span class="st">''</span>,</span>
<span id="cb301-755"><a href="#cb301-755"></a>     <span class="at">las =</span> <span class="dv">1</span>, <span class="at">border =</span> <span class="st">'white'</span>, <span class="at">col =</span> <span class="st">'white'</span>,</span>
<span id="cb301-756"><a href="#cb301-756"></a>     <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb301-757"><a href="#cb301-757"></a><span class="fu">grid</span>()</span>
<span id="cb301-758"><a href="#cb301-758"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-759"><a href="#cb301-759"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(<span class="fu">log10</span>(pruned.data.mrg<span class="sc">$</span>Mean.Tb)),</span>
<span id="cb301-760"><a href="#cb301-760"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb301-761"><a href="#cb301-761"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">'Mean body temperature'</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(<span class="st">'\u00B0C'</span>)))</span>
<span id="cb301-762"><a href="#cb301-762"></a><span class="fu">box</span>()</span>
<span id="cb301-763"><a href="#cb301-763"></a></span>
<span id="cb301-764"><a href="#cb301-764"></a></span>
<span id="cb301-765"><a href="#cb301-765"></a></span>
<span id="cb301-766"><a href="#cb301-766"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb301-767"><a href="#cb301-767"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-768"><a href="#cb301-768"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-769"><a href="#cb301-769"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb301-770"><a href="#cb301-770"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb301-771"><a href="#cb301-771"></a></span>
<span id="cb301-772"><a href="#cb301-772"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(pruned.data.mrg<span class="sc">$</span>area),</span>
<span id="cb301-773"><a href="#cb301-773"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">border =</span> <span class="st">'white'</span>,</span>
<span id="cb301-774"><a href="#cb301-774"></a>     <span class="at">col =</span> <span class="st">'white'</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb301-775"><a href="#cb301-775"></a><span class="fu">grid</span>()</span>
<span id="cb301-776"><a href="#cb301-776"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-777"><a href="#cb301-777"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(pruned.data.mrg<span class="sc">$</span>area), <span class="at">main =</span> <span class="st">''</span>,</span>
<span id="cb301-778"><a href="#cb301-778"></a>     <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">'Area of geographic range'</span><span class="sc">~</span>(km<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb301-779"><a href="#cb301-779"></a><span class="fu">box</span>()</span>
<span id="cb301-780"><a href="#cb301-780"></a></span>
<span id="cb301-781"><a href="#cb301-781"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(<span class="fu">log10</span>(pruned.data.mrg<span class="sc">$</span>area)),</span>
<span id="cb301-782"><a href="#cb301-782"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">border =</span> <span class="st">'white'</span>,</span>
<span id="cb301-783"><a href="#cb301-783"></a>     <span class="at">col =</span> <span class="st">'white'</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb301-784"><a href="#cb301-784"></a><span class="fu">grid</span>()</span>
<span id="cb301-785"><a href="#cb301-785"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-786"><a href="#cb301-786"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(<span class="fu">log10</span>(pruned.data.mrg<span class="sc">$</span>area)),</span>
<span id="cb301-787"><a href="#cb301-787"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb301-788"><a href="#cb301-788"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">'Area of geographic range'</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(km<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb301-789"><a href="#cb301-789"></a><span class="fu">box</span>()</span>
<span id="cb301-790"><a href="#cb301-790"></a></span>
<span id="cb301-791"><a href="#cb301-791"></a><span class="do">## transforming data</span></span>
<span id="cb301-792"><a href="#cb301-792"></a></span>
<span id="cb301-793"><a href="#cb301-793"></a>pruned.data.mrg<span class="sc">$</span>area <span class="ot">&lt;-</span> <span class="fu">log10</span>(pruned.data.mrg<span class="sc">$</span>area)</span>
<span id="cb301-794"><a href="#cb301-794"></a></span>
<span id="cb301-795"><a href="#cb301-795"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb301-796"><a href="#cb301-796"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-797"><a href="#cb301-797"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-798"><a href="#cb301-798"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb301-799"><a href="#cb301-799"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb301-800"><a href="#cb301-800"></a></span>
<span id="cb301-801"><a href="#cb301-801"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(pruned.data.mrg<span class="sc">$</span>rep.output),</span>
<span id="cb301-802"><a href="#cb301-802"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">border =</span> <span class="st">'white'</span>,</span>
<span id="cb301-803"><a href="#cb301-803"></a>     <span class="at">col =</span> <span class="st">'white'</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb301-804"><a href="#cb301-804"></a><span class="fu">grid</span>()</span>
<span id="cb301-805"><a href="#cb301-805"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-806"><a href="#cb301-806"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(pruned.data.mrg<span class="sc">$</span>rep.output),</span>
<span id="cb301-807"><a href="#cb301-807"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb301-808"><a href="#cb301-808"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">'Reproductive output'</span>))</span>
<span id="cb301-809"><a href="#cb301-809"></a><span class="fu">box</span>()</span>
<span id="cb301-810"><a href="#cb301-810"></a></span>
<span id="cb301-811"><a href="#cb301-811"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(<span class="fu">log10</span>(pruned.data.mrg<span class="sc">$</span>rep.output)),</span>
<span id="cb301-812"><a href="#cb301-812"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">border =</span> <span class="st">'white'</span>, <span class="at">col =</span> <span class="st">'white'</span>,</span>
<span id="cb301-813"><a href="#cb301-813"></a>     <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb301-814"><a href="#cb301-814"></a><span class="fu">grid</span>()</span>
<span id="cb301-815"><a href="#cb301-815"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-816"><a href="#cb301-816"></a><span class="fu">hist</span>(<span class="fu">na.omit</span>(<span class="fu">log10</span>(pruned.data.mrg<span class="sc">$</span>rep.output)),</span>
<span id="cb301-817"><a href="#cb301-817"></a>     <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">'Reproductive output'</span>))</span>
<span id="cb301-818"><a href="#cb301-818"></a><span class="fu">box</span>()</span>
<span id="cb301-819"><a href="#cb301-819"></a></span>
<span id="cb301-820"><a href="#cb301-820"></a><span class="do">## transforming data</span></span>
<span id="cb301-821"><a href="#cb301-821"></a></span>
<span id="cb301-822"><a href="#cb301-822"></a>pruned.data.mrg<span class="sc">$</span>rep.output <span class="ot">&lt;-</span> <span class="fu">log10</span>(pruned.data.mrg<span class="sc">$</span>rep.output)</span>
<span id="cb301-823"><a href="#cb301-823"></a></span>
<span id="cb301-824"><a href="#cb301-824"></a><span class="fu">names</span>(pruned.data.mrg)[<span class="fu">c</span>(<span class="dv">14</span>, <span class="dv">26</span>, <span class="dv">29</span>, <span class="dv">30</span>)] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="st">'Maximum body mass'</span>),</span>
<span id="cb301-825"><a href="#cb301-825"></a>                                               <span class="fu">expression</span>(<span class="st">'Mean body temperature'</span>),</span>
<span id="cb301-826"><a href="#cb301-826"></a>                                               <span class="fu">expression</span>(<span class="st">'Area of geographic range'</span>),</span>
<span id="cb301-827"><a href="#cb301-827"></a>                                               <span class="st">'Reproductive output'</span>)</span>
<span id="cb301-828"><a href="#cb301-828"></a></span>
<span id="cb301-829"><a href="#cb301-829"></a></span>
<span id="cb301-830"><a href="#cb301-830"></a><span class="do">## looking at broad patterns in the data first</span></span>
<span id="cb301-831"><a href="#cb301-831"></a></span>
<span id="cb301-832"><a href="#cb301-832"></a><span class="fu">plot</span>(pruned.data.mrg[<span class="fu">c</span>(<span class="dv">14</span>, <span class="dv">26</span>, <span class="dv">29</span>, <span class="dv">30</span>)], <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb301-833"><a href="#cb301-833"></a></span>
<span id="cb301-834"><a href="#cb301-834"></a><span class="do">## fitting phylogenetic generalized least square models</span></span>
<span id="cb301-835"><a href="#cb301-835"></a></span>
<span id="cb301-836"><a href="#cb301-836"></a></span>
<span id="cb301-837"><a href="#cb301-837"></a><span class="fu">tapply</span>(<span class="at">X =</span> pruned.data.mrg<span class="sc">$</span><span class="st">'Maximum body mass'</span>,</span>
<span id="cb301-838"><a href="#cb301-838"></a>       <span class="at">INDEX =</span> <span class="fu">list</span>(pruned.data.mrg<span class="sc">$</span>Foraging.mode),</span>
<span id="cb301-839"><a href="#cb301-839"></a>       <span class="at">FUN =</span> <span class="cf">function</span>(X) <span class="fu">length</span>(<span class="fu">na.omit</span>(X)))</span>
<span id="cb301-840"><a href="#cb301-840"></a></span>
<span id="cb301-841"><a href="#cb301-841"></a><span class="fu">tapply</span>(<span class="at">X =</span> pruned.data.mrg<span class="sc">$</span><span class="st">'Mean body temperature'</span>,</span>
<span id="cb301-842"><a href="#cb301-842"></a>       <span class="at">INDEX =</span> <span class="fu">list</span>(pruned.data.mrg<span class="sc">$</span>Foraging.mode),</span>
<span id="cb301-843"><a href="#cb301-843"></a>       <span class="at">FUN =</span> <span class="cf">function</span>(X) <span class="fu">length</span>(<span class="fu">na.omit</span>(X)))</span>
<span id="cb301-844"><a href="#cb301-844"></a></span>
<span id="cb301-845"><a href="#cb301-845"></a><span class="fu">tapply</span>(<span class="at">X =</span> pruned.data.mrg<span class="sc">$</span><span class="st">'Area of geographic range'</span>,</span>
<span id="cb301-846"><a href="#cb301-846"></a>       <span class="at">INDEX =</span> <span class="fu">list</span>(pruned.data.mrg<span class="sc">$</span>Foraging.mode),</span>
<span id="cb301-847"><a href="#cb301-847"></a>       <span class="at">FUN =</span> <span class="cf">function</span>(X) <span class="fu">length</span>(<span class="fu">na.omit</span>(X)))</span>
<span id="cb301-848"><a href="#cb301-848"></a></span>
<span id="cb301-849"><a href="#cb301-849"></a><span class="fu">tapply</span>(<span class="at">X =</span> pruned.data.mrg<span class="sc">$</span><span class="st">'Reproductive output'</span>,</span>
<span id="cb301-850"><a href="#cb301-850"></a>       <span class="at">INDEX =</span> <span class="fu">list</span>(pruned.data.mrg<span class="sc">$</span>Foraging.mode),</span>
<span id="cb301-851"><a href="#cb301-851"></a>       <span class="at">FUN =</span> <span class="cf">function</span>(X) <span class="fu">length</span>(<span class="fu">na.omit</span>(X)))</span>
<span id="cb301-852"><a href="#cb301-852"></a></span>
<span id="cb301-853"><a href="#cb301-853"></a></span>
<span id="cb301-854"><a href="#cb301-854"></a><span class="do">## filtering data by body mass and geographic range</span></span>
<span id="cb301-855"><a href="#cb301-855"></a></span>
<span id="cb301-856"><a href="#cb301-856"></a>mass.data <span class="ot">&lt;-</span> pruned.data.mrg[<span class="sc">!</span><span class="fu">is.na</span>(pruned.data.mrg<span class="sc">$</span><span class="st">'Maximum body mass'</span>), ]</span>
<span id="cb301-857"><a href="#cb301-857"></a>range.data <span class="ot">&lt;-</span> pruned.data.mrg[<span class="sc">!</span><span class="fu">is.na</span>(pruned.data.mrg<span class="sc">$</span><span class="st">'Area of geographic range'</span>), ]</span>
<span id="cb301-858"><a href="#cb301-858"></a></span>
<span id="cb301-859"><a href="#cb301-859"></a>mass.range <span class="ot">&lt;-</span> mass.data[mass.data<span class="sc">$</span>Species <span class="sc">%in%</span> range.data<span class="sc">$</span>Species, ]</span>
<span id="cb301-860"><a href="#cb301-860"></a><span class="fu">rownames</span>(mass.range) <span class="ot">&lt;-</span> mass.range<span class="sc">$</span>Species</span>
<span id="cb301-861"><a href="#cb301-861"></a></span>
<span id="cb301-862"><a href="#cb301-862"></a></span>
<span id="cb301-863"><a href="#cb301-863"></a>check <span class="ot">&lt;-</span> <span class="fu">name.check</span>(lizard.tree, mass.range)</span>
<span id="cb301-864"><a href="#cb301-864"></a>rm_phy <span class="ot">&lt;-</span> check<span class="sc">$</span>tree_not_data</span>
<span id="cb301-865"><a href="#cb301-865"></a>rm_dat <span class="ot">&lt;-</span> check<span class="sc">$</span>data_not_tree</span>
<span id="cb301-866"><a href="#cb301-866"></a>tree.mass.range <span class="ot">&lt;-</span> <span class="fu">drop.tip</span>(lizard.tree, rm_phy)</span>
<span id="cb301-867"><a href="#cb301-867"></a></span>
<span id="cb301-868"><a href="#cb301-868"></a>pruned.mass.range <span class="ot">&lt;-</span> <span class="fu">subset</span>(mass.range,</span>
<span id="cb301-869"><a href="#cb301-869"></a>                            <span class="at">subset =</span> <span class="fu">rownames</span>(mass.range) <span class="sc">%in%</span> tree.mass.range<span class="sc">$</span>tip,</span>
<span id="cb301-870"><a href="#cb301-870"></a>                            <span class="at">select =</span> <span class="fu">names</span>(mass.range))</span>
<span id="cb301-871"><a href="#cb301-871"></a><span class="fu">name.check</span>(tree.mass.range, pruned.mass.range)</span>
<span id="cb301-872"><a href="#cb301-872"></a><span class="fu">head</span>(pruned.mass.range[<span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">29</span>)])</span>
<span id="cb301-873"><a href="#cb301-873"></a></span>
<span id="cb301-874"><a href="#cb301-874"></a><span class="in">```</span></span>
<span id="cb301-875"><a href="#cb301-875"></a></span>
<span id="cb301-878"><a href="#cb301-878"></a><span class="in">```{r}</span></span>
<span id="cb301-879"><a href="#cb301-879"></a><span class="do">## looking at body size landscape before running PGLS</span></span>
<span id="cb301-880"><a href="#cb301-880"></a></span>
<span id="cb301-881"><a href="#cb301-881"></a>tree <span class="ot">&lt;-</span> <span class="fu">reorder</span>(tree.mass.range, <span class="st">"postorder"</span>)</span>
<span id="cb301-882"><a href="#cb301-882"></a>tree</span>
<span id="cb301-883"><a href="#cb301-883"></a></span>
<span id="cb301-884"><a href="#cb301-884"></a><span class="do">## error assumed</span></span>
<span id="cb301-885"><a href="#cb301-885"></a></span>
<span id="cb301-886"><a href="#cb301-886"></a>MEvar <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb301-887"><a href="#cb301-887"></a></span>
<span id="cb301-888"><a href="#cb301-888"></a><span class="do">## data of body mass</span></span>
<span id="cb301-889"><a href="#cb301-889"></a></span>
<span id="cb301-890"><a href="#cb301-890"></a>dat <span class="ot">&lt;-</span> <span class="fu">setNames</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span>,</span>
<span id="cb301-891"><a href="#cb301-891"></a>                <span class="fu">rownames</span>(pruned.mass.range))</span>
<span id="cb301-892"><a href="#cb301-892"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(dat), <span class="dv">0</span>, <span class="fu">sqrt</span>(MEvar))</span>
<span id="cb301-893"><a href="#cb301-893"></a></span>
<span id="cb301-894"><a href="#cb301-894"></a><span class="in">```</span></span>
<span id="cb301-895"><a href="#cb301-895"></a></span>
<span id="cb301-896"><a href="#cb301-896"></a><span class="in">```{r, eval = FALSE}</span></span>
<span id="cb301-897"><a href="#cb301-897"></a></span>
<span id="cb301-898"><a href="#cb301-898"></a><span class="in">## Defining prior. Prior for the maximum number</span></span>
<span id="cb301-899"><a href="#cb301-899"></a><span class="in">## of shifts was set as half of the number of branch lengths</span></span>
<span id="cb301-900"><a href="#cb301-900"></a></span>
<span id="cb301-901"><a href="#cb301-901"></a><span class="in">priorOU &lt;- make.prior(tree,</span></span>
<span id="cb301-902"><a href="#cb301-902"></a><span class="in">                      dists = list(dalpha ="dhalfcauchy",</span></span>
<span id="cb301-903"><a href="#cb301-903"></a><span class="in">                                   dsig2 = "dhalfcauchy",</span></span>
<span id="cb301-904"><a href="#cb301-904"></a><span class="in">                                   dk = "cdpois", dtheta = "dnorm"),</span></span>
<span id="cb301-905"><a href="#cb301-905"></a><span class="in">                      param = list(dalpha = list(scale = 0.1),</span></span>
<span id="cb301-906"><a href="#cb301-906"></a><span class="in">                                   dsig2 = list(scale = 0.1),</span></span>
<span id="cb301-907"><a href="#cb301-907"></a><span class="in">                                   dk = list(lambda = 10,</span></span>
<span id="cb301-908"><a href="#cb301-908"></a><span class="in">                                             kmax = length(tree$edge.length)/2),</span></span>
<span id="cb301-909"><a href="#cb301-909"></a><span class="in">                                   dsb = list(bmax = 1, prob = 1),</span></span>
<span id="cb301-910"><a href="#cb301-910"></a><span class="in">                                   dtheta = list(mean = mean(dat),</span></span>
<span id="cb301-911"><a href="#cb301-911"></a><span class="in">                                                 sd = 1.5*sd(dat))))</span></span>
<span id="cb301-912"><a href="#cb301-912"></a></span>
<span id="cb301-913"><a href="#cb301-913"></a><span class="in">## to run our MCMC, we have to initiate</span></span>
<span id="cb301-914"><a href="#cb301-914"></a><span class="in">## the MCMC chain with some starting values</span></span>
<span id="cb301-915"><a href="#cb301-915"></a></span>
<span id="cb301-916"><a href="#cb301-916"></a><span class="in">startpars &lt;- priorSim(priorOU, tree, plot = TRUE)$pars[[1]]</span></span>
<span id="cb301-917"><a href="#cb301-917"></a><span class="in">priorOU(startpars)</span></span>
<span id="cb301-918"><a href="#cb301-918"></a></span>
<span id="cb301-919"><a href="#cb301-919"></a></span>
<span id="cb301-920"><a href="#cb301-920"></a><span class="in">## let's take what we have and put it into</span></span>
<span id="cb301-921"><a href="#cb301-921"></a><span class="in">## the function bayou.makeMCMC</span></span>
<span id="cb301-922"><a href="#cb301-922"></a></span>
<span id="cb301-923"><a href="#cb301-923"></a><span class="in">mcmcOU &lt;- bayou.makeMCMC(tree, dat, SE = MEvar, prior = priorOU,</span></span>
<span id="cb301-924"><a href="#cb301-924"></a><span class="in">    new.dir = TRUE, outname = "modelOU_r001", plot.freq = NULL)</span></span>
<span id="cb301-925"><a href="#cb301-925"></a></span>
<span id="cb301-926"><a href="#cb301-926"></a><span class="in">## run the MCMC</span></span>
<span id="cb301-927"><a href="#cb301-927"></a></span>
<span id="cb301-928"><a href="#cb301-928"></a><span class="in">mcmcOU$run(100000)</span></span>
<span id="cb301-929"><a href="#cb301-929"></a></span>
<span id="cb301-930"><a href="#cb301-930"></a><span class="in">## the full MCMC results are written to a set of files.</span></span>
<span id="cb301-931"><a href="#cb301-931"></a><span class="in">## We can load them back in to R as follows</span></span>
<span id="cb301-932"><a href="#cb301-932"></a></span>
<span id="cb301-933"><a href="#cb301-933"></a><span class="in">chainOU &lt;- mcmcOU$load()</span></span>
<span id="cb301-934"><a href="#cb301-934"></a><span class="in">save(chainOU, file = 'mcmc_modelOU.RData')</span></span>
<span id="cb301-935"><a href="#cb301-935"></a></span>
<span id="cb301-936"><a href="#cb301-936"></a><span class="in">## let's take a look at the results. We can set a "burnin"</span></span>
<span id="cb301-937"><a href="#cb301-937"></a><span class="in">## parameter that tells the package coda to discard the</span></span>
<span id="cb301-938"><a href="#cb301-938"></a><span class="in">## first bit of the chain</span></span>
<span id="cb301-939"><a href="#cb301-939"></a></span>
<span id="cb301-940"><a href="#cb301-940"></a><span class="in">chainOU &lt;- set.burnin(chainOU, 0.3)</span></span>
<span id="cb301-941"><a href="#cb301-941"></a><span class="in">##summary(chainOU)</span></span>
<span id="cb301-942"><a href="#cb301-942"></a><span class="in">##plot(chainOU, auto.layout = FALSE)</span></span>
<span id="cb301-943"><a href="#cb301-943"></a></span>
<span id="cb301-944"><a href="#cb301-944"></a><span class="in">## let's visualize what we have so far. First, we will</span></span>
<span id="cb301-945"><a href="#cb301-945"></a><span class="in">## plot the truth, then 3 alternative ways of visualizing</span></span>
<span id="cb301-946"><a href="#cb301-946"></a><span class="in">## our chain</span></span>
<span id="cb301-947"><a href="#cb301-947"></a></span>
<span id="cb301-948"><a href="#cb301-948"></a><span class="in">```</span></span>
<span id="cb301-949"><a href="#cb301-949"></a></span>
<span id="cb301-950"><a href="#cb301-950"></a><span class="in">```{r, include = FALSE}</span></span>
<span id="cb301-951"><a href="#cb301-951"></a></span>
<span id="cb301-952"><a href="#cb301-952"></a><span class="in">load('mcmc_modelOU-10e4.RData')</span></span>
<span id="cb301-953"><a href="#cb301-953"></a></span>
<span id="cb301-954"><a href="#cb301-954"></a><span class="in">```</span></span>
<span id="cb301-955"><a href="#cb301-955"></a></span>
<span id="cb301-958"><a href="#cb301-958"></a><span class="in">```{r}</span></span>
<span id="cb301-959"><a href="#cb301-959"></a><span class="do">## foraging tree</span></span>
<span id="cb301-960"><a href="#cb301-960"></a></span>
<span id="cb301-961"><a href="#cb301-961"></a>a <span class="ot">&lt;-</span> pruned.mass.range<span class="sc">$</span>Species[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"active"</span>]</span>
<span id="cb301-962"><a href="#cb301-962"></a>p <span class="ot">&lt;-</span> pruned.mass.range<span class="sc">$</span>Species[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"plastic"</span>]</span>
<span id="cb301-963"><a href="#cb301-963"></a>sw <span class="ot">&lt;-</span> pruned.mass.range<span class="sc">$</span>Species[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"sit-and-wait"</span>]</span>
<span id="cb301-964"><a href="#cb301-964"></a></span>
<span id="cb301-965"><a href="#cb301-965"></a></span>
<span id="cb301-966"><a href="#cb301-966"></a><span class="do">## paint the edges</span></span>
<span id="cb301-967"><a href="#cb301-967"></a></span>
<span id="cb301-968"><a href="#cb301-968"></a>bt <span class="ot">&lt;-</span> <span class="fu">paintBranches</span>(tree.mass.range, <span class="at">edge =</span></span>
<span id="cb301-969"><a href="#cb301-969"></a>                                         <span class="fu">sapply</span>(sw, match,</span>
<span id="cb301-970"><a href="#cb301-970"></a>                                                tree.mass.range<span class="sc">$</span>tip.label),</span>
<span id="cb301-971"><a href="#cb301-971"></a>                    <span class="at">state =</span> <span class="st">"sit-and-wait"</span>, <span class="at">anc.state =</span> <span class="st">"active"</span>)</span>
<span id="cb301-972"><a href="#cb301-972"></a></span>
<span id="cb301-973"><a href="#cb301-973"></a>bt <span class="ot">&lt;-</span> <span class="fu">paintBranches</span>(bt, <span class="at">edge =</span> <span class="fu">sapply</span>(p, match, bt<span class="sc">$</span>tip.label),</span>
<span id="cb301-974"><a href="#cb301-974"></a>    <span class="at">state =</span> <span class="st">"plastic"</span>, <span class="at">anc.state =</span> <span class="st">"active"</span>)</span>
<span id="cb301-975"><a href="#cb301-975"></a>bt</span>
<span id="cb301-976"><a href="#cb301-976"></a></span>
<span id="cb301-977"><a href="#cb301-977"></a>cols.bt <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>),</span>
<span id="cb301-978"><a href="#cb301-978"></a>                    <span class="fu">c</span>(<span class="st">'active'</span>, <span class="st">'plastic'</span>, <span class="st">'sit-and-wait'</span>))</span>
<span id="cb301-979"><a href="#cb301-979"></a></span>
<span id="cb301-980"><a href="#cb301-980"></a></span>
<span id="cb301-981"><a href="#cb301-981"></a></span>
<span id="cb301-982"><a href="#cb301-982"></a><span class="fu">phenogram</span>(bt, dat, <span class="at">ftype =</span> <span class="st">'off'</span>,</span>
<span id="cb301-983"><a href="#cb301-983"></a>          <span class="at">fsize =</span> <span class="fl">0.3</span>,</span>
<span id="cb301-984"><a href="#cb301-984"></a>          <span class="at">col =</span> cols.bt,</span>
<span id="cb301-985"><a href="#cb301-985"></a>          <span class="at">xlab =</span> <span class="st">"Time (mya)"</span>,</span>
<span id="cb301-986"><a href="#cb301-986"></a>          <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Maximum body mass"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(g)),</span>
<span id="cb301-987"><a href="#cb301-987"></a>          <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-988"><a href="#cb301-988"></a><span class="fu">segments</span>(<span class="at">x0 =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">y0 =</span> <span class="fl">3.8</span>, <span class="at">x1 =</span> <span class="dv">279</span>,</span>
<span id="cb301-989"><a href="#cb301-989"></a>         <span class="at">y1 =</span> <span class="fl">3.8</span>, <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb301-990"><a href="#cb301-990"></a>         <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">'black'</span>, <span class="fl">0.5</span>))</span>
<span id="cb301-991"><a href="#cb301-991"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span>),</span>
<span id="cb301-992"><a href="#cb301-992"></a>            <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb301-993"><a href="#cb301-993"></a>     <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb301-994"><a href="#cb301-994"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(<span class="st">'Maximum body mass'</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(g)), <span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.5</span>)</span>
<span id="cb301-995"><a href="#cb301-995"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">nodeHeights</span>(bt)),</span>
<span id="cb301-996"><a href="#cb301-996"></a>                       <span class="at">length.out =</span> <span class="dv">4</span>), <span class="dv">0</span>),</span>
<span id="cb301-997"><a href="#cb301-997"></a>     <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">max</span>(<span class="fu">nodeHeights</span>(bt)), <span class="dv">0</span>,</span>
<span id="cb301-998"><a href="#cb301-998"></a>                       <span class="at">length.out =</span> <span class="dv">4</span>), <span class="dv">0</span>), <span class="at">cex.axis =</span> <span class="fl">0.8</span>)</span>
<span id="cb301-999"><a href="#cb301-999"></a><span class="fu">mtext</span>(<span class="st">'Time (mya)'</span>, <span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="dv">3</span>)</span>
<span id="cb301-1000"><a href="#cb301-1000"></a><span class="fu">box</span>()</span>
<span id="cb301-1001"><a href="#cb301-1001"></a></span>
<span id="cb301-1002"><a href="#cb301-1002"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">legend =</span> <span class="fu">names</span>(cols.bt), <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb301-1003"><a href="#cb301-1003"></a>       <span class="at">pt.bg =</span> cols.bt, <span class="at">pt.cex =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb301-1004"><a href="#cb301-1004"></a>       <span class="at">col =</span> <span class="st">"transparent"</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb301-1005"><a href="#cb301-1005"></a></span>
<span id="cb301-1006"><a href="#cb301-1006"></a></span>
<span id="cb301-1007"><a href="#cb301-1007"></a></span>
<span id="cb301-1008"><a href="#cb301-1008"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-1009"><a href="#cb301-1009"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-1010"><a href="#cb301-1010"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-1011"><a href="#cb301-1011"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb301-1012"><a href="#cb301-1012"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb301-1013"><a href="#cb301-1013"></a></span>
<span id="cb301-1014"><a href="#cb301-1014"></a><span class="fu">par</span>(<span class="at">las =</span> <span class="dv">1</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="dv">1</span>))</span>
<span id="cb301-1015"><a href="#cb301-1015"></a></span>
<span id="cb301-1016"><a href="#cb301-1016"></a><span class="fu">plotSimmap.mcmc</span>(chainOU, <span class="at">burnin =</span> <span class="fl">0.3</span>, <span class="at">pp.cutoff =</span> <span class="fl">0.3</span>,</span>
<span id="cb301-1017"><a href="#cb301-1017"></a>                <span class="at">edge.type =</span> <span class="st">'regime'</span>, <span class="at">pal =</span> viridis,</span>
<span id="cb301-1018"><a href="#cb301-1018"></a>                <span class="at">cex =</span> <span class="fl">0.2</span>, <span class="at">show.tip.label =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-1019"><a href="#cb301-1019"></a><span class="do">##nodelabels(cex = 0.3, bg = 'white')</span></span>
<span id="cb301-1020"><a href="#cb301-1020"></a></span>
<span id="cb301-1021"><a href="#cb301-1021"></a><span class="fu">legend</span>(<span class="st">'topleft'</span>, <span class="at">legend =</span> <span class="st">'regime'</span>, <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb301-1022"><a href="#cb301-1022"></a>       <span class="at">pt.bg =</span> <span class="fu">make.transparent</span>(<span class="st">'red'</span>, <span class="fl">0.2</span>),</span>
<span id="cb301-1023"><a href="#cb301-1023"></a>       <span class="at">col =</span> <span class="st">'black'</span>, <span class="at">bty =</span> <span class="st">'n'</span>, <span class="at">pt.cex =</span> <span class="dv">2</span>)</span>
<span id="cb301-1024"><a href="#cb301-1024"></a></span>
<span id="cb301-1025"><a href="#cb301-1025"></a><span class="fu">plot</span>(bt, cols.bt, <span class="at">ftype =</span> <span class="st">"off"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">offset =</span> <span class="fl">0.4</span>,</span>
<span id="cb301-1026"><a href="#cb301-1026"></a>     <span class="at">direction =</span> <span class="st">"leftwards"</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="dv">1</span>))</span>
<span id="cb301-1027"><a href="#cb301-1027"></a></span>
<span id="cb301-1028"><a href="#cb301-1028"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">names</span>(cols.bt), <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb301-1029"><a href="#cb301-1029"></a>       <span class="at">pt.bg =</span> cols.bt, <span class="at">pt.cex =</span> <span class="fl">1.5</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb301-1030"><a href="#cb301-1030"></a>       <span class="at">col =</span> <span class="st">"transparent"</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb301-1031"><a href="#cb301-1031"></a></span>
<span id="cb301-1032"><a href="#cb301-1032"></a></span>
<span id="cb301-1033"><a href="#cb301-1033"></a><span class="in">```</span></span>
<span id="cb301-1034"><a href="#cb301-1034"></a></span>
<span id="cb301-1037"><a href="#cb301-1037"></a><span class="in">```{r}</span></span>
<span id="cb301-1038"><a href="#cb301-1038"></a><span class="do">## basic boxplot to look at body size among</span></span>
<span id="cb301-1039"><a href="#cb301-1039"></a><span class="do">## foraging behavior categories</span></span>
<span id="cb301-1040"><a href="#cb301-1040"></a></span>
<span id="cb301-1041"><a href="#cb301-1041"></a><span class="fu">par</span>(<span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb301-1042"><a href="#cb301-1042"></a></span>
<span id="cb301-1043"><a href="#cb301-1043"></a><span class="fu">vioplot</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span> <span class="sc">~</span></span>
<span id="cb301-1044"><a href="#cb301-1044"></a>            pruned.mass.range<span class="sc">$</span>Foraging.mode, <span class="at">border =</span> <span class="cn">NA</span>,</span>
<span id="cb301-1045"><a href="#cb301-1045"></a>        <span class="at">method =</span> <span class="st">"jitter"</span>, <span class="at">side =</span> <span class="st">"right"</span>, <span class="at">col =</span> <span class="st">"white"</span>,</span>
<span id="cb301-1046"><a href="#cb301-1046"></a>        <span class="at">las =</span> <span class="dv">1</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>, <span class="at">yaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb301-1047"><a href="#cb301-1047"></a>        <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">xlab =</span> <span class="st">''</span>)</span>
<span id="cb301-1048"><a href="#cb301-1048"></a></span>
<span id="cb301-1049"><a href="#cb301-1049"></a><span class="fu">grid</span>(<span class="at">nx =</span> <span class="cn">NULL</span>, <span class="at">ny =</span> <span class="cn">NULL</span>, <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">"lightgray"</span>, <span class="fl">0.7</span>),</span>
<span id="cb301-1050"><a href="#cb301-1050"></a>     <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb301-1051"><a href="#cb301-1051"></a></span>
<span id="cb301-1052"><a href="#cb301-1052"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-1053"><a href="#cb301-1053"></a></span>
<span id="cb301-1054"><a href="#cb301-1054"></a><span class="fu">vioplot</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span> <span class="sc">~</span></span>
<span id="cb301-1055"><a href="#cb301-1055"></a>            pruned.mass.range<span class="sc">$</span>Foraging.mode, <span class="at">border =</span> <span class="cn">NA</span>,</span>
<span id="cb301-1056"><a href="#cb301-1056"></a>        <span class="at">method =</span> <span class="st">"jitter"</span>, <span class="at">side =</span> <span class="st">"right"</span>,</span>
<span id="cb301-1057"><a href="#cb301-1057"></a>        <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Maximum body mass"</span>)<span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(g)),</span>
<span id="cb301-1058"><a href="#cb301-1058"></a>        <span class="at">xlab =</span> <span class="st">"Foraging behavior"</span>, <span class="at">col =</span> <span class="fu">alpha</span>(cols.bt, <span class="fl">0.5</span>), <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb301-1059"><a href="#cb301-1059"></a></span>
<span id="cb301-1060"><a href="#cb301-1060"></a><span class="fu">segments</span>(<span class="at">x0 =</span> <span class="dv">1</span>,</span>
<span id="cb301-1061"><a href="#cb301-1061"></a>         <span class="at">y0 =</span> <span class="fu">mean</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span>[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"active"</span>]),</span>
<span id="cb301-1062"><a href="#cb301-1062"></a>         <span class="at">x1 =</span> <span class="fl">1.38</span>,</span>
<span id="cb301-1063"><a href="#cb301-1063"></a>         <span class="at">y1 =</span> <span class="fu">mean</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span>[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"active"</span>]),</span>
<span id="cb301-1064"><a href="#cb301-1064"></a>         <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"black"</span>)</span>
<span id="cb301-1065"><a href="#cb301-1065"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">1.45</span>,</span>
<span id="cb301-1066"><a href="#cb301-1066"></a>     <span class="at">y =</span> <span class="fu">mean</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span>[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"active"</span>]),</span>
<span id="cb301-1067"><a href="#cb301-1067"></a>     <span class="fu">expression</span>(mu))</span>
<span id="cb301-1068"><a href="#cb301-1068"></a></span>
<span id="cb301-1069"><a href="#cb301-1069"></a><span class="fu">segments</span>(<span class="at">x0 =</span> <span class="dv">2</span>,</span>
<span id="cb301-1070"><a href="#cb301-1070"></a>         <span class="at">y0 =</span> <span class="fu">mean</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span>[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"plastic"</span>]),</span>
<span id="cb301-1071"><a href="#cb301-1071"></a>         <span class="at">x1 =</span> <span class="fl">2.39</span>,</span>
<span id="cb301-1072"><a href="#cb301-1072"></a>         <span class="at">y1 =</span> <span class="fu">mean</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span>[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"plastic"</span>]),</span>
<span id="cb301-1073"><a href="#cb301-1073"></a>         <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"black"</span>)</span>
<span id="cb301-1074"><a href="#cb301-1074"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">2.45</span>,</span>
<span id="cb301-1075"><a href="#cb301-1075"></a>     <span class="at">y =</span> <span class="fu">mean</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span>[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"plastic"</span>]),</span>
<span id="cb301-1076"><a href="#cb301-1076"></a>     <span class="fu">expression</span>(mu))</span>
<span id="cb301-1077"><a href="#cb301-1077"></a></span>
<span id="cb301-1078"><a href="#cb301-1078"></a><span class="fu">segments</span>(<span class="at">x0 =</span> <span class="dv">3</span>,</span>
<span id="cb301-1079"><a href="#cb301-1079"></a>         <span class="at">y0 =</span> <span class="fu">mean</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span>[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"sit-and-wait"</span>]),</span>
<span id="cb301-1080"><a href="#cb301-1080"></a>         <span class="at">x1 =</span> <span class="fl">3.4</span>,</span>
<span id="cb301-1081"><a href="#cb301-1081"></a>         <span class="at">y1 =</span> <span class="fu">mean</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span>[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"sit-and-wait"</span>]),</span>
<span id="cb301-1082"><a href="#cb301-1082"></a>         <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"black"</span>)</span>
<span id="cb301-1083"><a href="#cb301-1083"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">3.45</span>,</span>
<span id="cb301-1084"><a href="#cb301-1084"></a>     <span class="at">y =</span> <span class="fu">mean</span>(pruned.mass.range<span class="sc">$</span><span class="st">'Maximum body mass'</span>[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"sit-and-wait"</span>]),</span>
<span id="cb301-1085"><a href="#cb301-1085"></a>     <span class="fu">expression</span>(mu))</span>
<span id="cb301-1086"><a href="#cb301-1086"></a></span>
<span id="cb301-1087"><a href="#cb301-1087"></a></span>
<span id="cb301-1088"><a href="#cb301-1088"></a><span class="fu">names</span>(pruned.mass.range)[<span class="dv">14</span>] <span class="ot">&lt;-</span> <span class="st">'body.mass'</span></span>
<span id="cb301-1089"><a href="#cb301-1089"></a>pruned.mass.range<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(pruned.mass.range<span class="sc">$</span>Species)</span>
<span id="cb301-1090"><a href="#cb301-1090"></a>pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(pruned.mass.range<span class="sc">$</span>Foraging.mode)</span>
<span id="cb301-1091"><a href="#cb301-1091"></a></span>
<span id="cb301-1092"><a href="#cb301-1092"></a>bd.size.model <span class="ot">&lt;-</span> <span class="fu">gls</span>(body.mass <span class="sc">~</span> Foraging.mode,</span>
<span id="cb301-1093"><a href="#cb301-1093"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1094"><a href="#cb301-1094"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.mass.range,</span>
<span id="cb301-1095"><a href="#cb301-1095"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1096"><a href="#cb301-1096"></a>                     <span class="at">data =</span> pruned.mass.range, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1097"><a href="#cb301-1097"></a><span class="fu">summary</span>(bd.size.model)</span>
<span id="cb301-1098"><a href="#cb301-1098"></a></span>
<span id="cb301-1099"><a href="#cb301-1099"></a><span class="in">```</span></span>
<span id="cb301-1100"><a href="#cb301-1100"></a></span>
<span id="cb301-1101"><a href="#cb301-1101"></a></span>
<span id="cb301-1104"><a href="#cb301-1104"></a><span class="in">```{r}</span></span>
<span id="cb301-1105"><a href="#cb301-1105"></a><span class="do">## Checking homogeneity of variance</span></span>
<span id="cb301-1106"><a href="#cb301-1106"></a></span>
<span id="cb301-1107"><a href="#cb301-1107"></a></span>
<span id="cb301-1108"><a href="#cb301-1108"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb301-1109"><a href="#cb301-1109"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-1110"><a href="#cb301-1110"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-1111"><a href="#cb301-1111"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb301-1112"><a href="#cb301-1112"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb301-1113"><a href="#cb301-1113"></a></span>
<span id="cb301-1114"><a href="#cb301-1114"></a><span class="fu">par</span>(<span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb301-1115"><a href="#cb301-1115"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(bd.size.model), <span class="fu">resid</span>(bd.size.model),</span>
<span id="cb301-1116"><a href="#cb301-1116"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb301-1117"><a href="#cb301-1117"></a>     <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">xlab =</span> <span class="st">''</span>)</span>
<span id="cb301-1118"><a href="#cb301-1118"></a></span>
<span id="cb301-1119"><a href="#cb301-1119"></a><span class="fu">grid</span>()</span>
<span id="cb301-1120"><a href="#cb301-1120"></a></span>
<span id="cb301-1121"><a href="#cb301-1121"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-1122"><a href="#cb301-1122"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(bd.size.model), <span class="fu">resid</span>(bd.size.model),</span>
<span id="cb301-1123"><a href="#cb301-1123"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">"Fitted"</span>,</span>
<span id="cb301-1124"><a href="#cb301-1124"></a>     <span class="at">ylab =</span> <span class="st">"Residual"</span>, <span class="at">main =</span> <span class="st">"Fitted versus Residuals"</span>,</span>
<span id="cb301-1125"><a href="#cb301-1125"></a>     <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb301-1126"><a href="#cb301-1126"></a></span>
<span id="cb301-1127"><a href="#cb301-1127"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"darkorange"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb301-1128"><a href="#cb301-1128"></a></span>
<span id="cb301-1129"><a href="#cb301-1129"></a></span>
<span id="cb301-1130"><a href="#cb301-1130"></a><span class="do">## Checking normality</span></span>
<span id="cb301-1131"><a href="#cb301-1131"></a></span>
<span id="cb301-1132"><a href="#cb301-1132"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(bd.size.model), <span class="at">col =</span> <span class="st">"darkgrey"</span>,</span>
<span id="cb301-1133"><a href="#cb301-1133"></a>       <span class="at">type =</span> <span class="st">'n'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="st">''</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb301-1134"><a href="#cb301-1134"></a>       <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb301-1135"><a href="#cb301-1135"></a></span>
<span id="cb301-1136"><a href="#cb301-1136"></a><span class="fu">grid</span>()</span>
<span id="cb301-1137"><a href="#cb301-1137"></a></span>
<span id="cb301-1138"><a href="#cb301-1138"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-1139"><a href="#cb301-1139"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(bd.size.model), <span class="at">col =</span> <span class="st">"darkgrey"</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb301-1140"><a href="#cb301-1140"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(bd.size.model), <span class="at">col =</span> <span class="st">"dodgerblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb301-1141"><a href="#cb301-1141"></a></span>
<span id="cb301-1142"><a href="#cb301-1142"></a><span class="in">```</span></span>
<span id="cb301-1143"><a href="#cb301-1143"></a></span>
<span id="cb301-1144"><a href="#cb301-1144"></a></span>
<span id="cb301-1147"><a href="#cb301-1147"></a><span class="in">```{r}</span></span>
<span id="cb301-1148"><a href="#cb301-1148"></a><span class="fu">names</span>(pruned.mass.range)[<span class="dv">29</span>] <span class="ot">&lt;-</span> <span class="st">'range'</span></span>
<span id="cb301-1149"><a href="#cb301-1149"></a>range.model <span class="ot">&lt;-</span> <span class="fu">gls</span>(range <span class="sc">~</span> Foraging.mode<span class="sc">*</span>body.mass,</span>
<span id="cb301-1150"><a href="#cb301-1150"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1151"><a href="#cb301-1151"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.mass.range,</span>
<span id="cb301-1152"><a href="#cb301-1152"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1153"><a href="#cb301-1153"></a>                     <span class="at">data =</span> pruned.mass.range, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1154"><a href="#cb301-1154"></a></span>
<span id="cb301-1155"><a href="#cb301-1155"></a>range.model2 <span class="ot">&lt;-</span> <span class="fu">gls</span>(range <span class="sc">~</span> Foraging.mode <span class="sc">+</span> body.mass,</span>
<span id="cb301-1156"><a href="#cb301-1156"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1157"><a href="#cb301-1157"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.mass.range,</span>
<span id="cb301-1158"><a href="#cb301-1158"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1159"><a href="#cb301-1159"></a>                     <span class="at">data =</span> pruned.mass.range, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1160"><a href="#cb301-1160"></a></span>
<span id="cb301-1161"><a href="#cb301-1161"></a>range.model3 <span class="ot">&lt;-</span> <span class="fu">gls</span>(range <span class="sc">~</span> Foraging.mode,</span>
<span id="cb301-1162"><a href="#cb301-1162"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1163"><a href="#cb301-1163"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.mass.range,</span>
<span id="cb301-1164"><a href="#cb301-1164"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1165"><a href="#cb301-1165"></a>                     <span class="at">data =</span> pruned.mass.range, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1166"><a href="#cb301-1166"></a></span>
<span id="cb301-1167"><a href="#cb301-1167"></a>range.model4 <span class="ot">&lt;-</span> <span class="fu">gls</span>(range <span class="sc">~</span> body.mass,</span>
<span id="cb301-1168"><a href="#cb301-1168"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1169"><a href="#cb301-1169"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.mass.range,</span>
<span id="cb301-1170"><a href="#cb301-1170"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1171"><a href="#cb301-1171"></a>                    <span class="at">data =</span> pruned.mass.range, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1172"><a href="#cb301-1172"></a></span>
<span id="cb301-1173"><a href="#cb301-1173"></a></span>
<span id="cb301-1174"><a href="#cb301-1174"></a>range.models <span class="ot">&lt;-</span> <span class="fu">anova</span>(range.model, range.model2, range.model3, range.model4)</span>
<span id="cb301-1175"><a href="#cb301-1175"></a></span>
<span id="cb301-1176"><a href="#cb301-1176"></a><span class="fu">round</span>(<span class="fu">aicw</span>(<span class="fu">setNames</span>(range.models<span class="sc">$</span>AIC,</span>
<span id="cb301-1177"><a href="#cb301-1177"></a>              <span class="fu">rownames</span>(range.models))), <span class="dv">3</span>)</span>
<span id="cb301-1178"><a href="#cb301-1178"></a><span class="fu">summary</span>(range.model2)</span>
<span id="cb301-1179"><a href="#cb301-1179"></a></span>
<span id="cb301-1180"><a href="#cb301-1180"></a><span class="in">```</span></span>
<span id="cb301-1181"><a href="#cb301-1181"></a></span>
<span id="cb301-1184"><a href="#cb301-1184"></a><span class="in">```{r}</span></span>
<span id="cb301-1185"><a href="#cb301-1185"></a><span class="do">## plotting results of the model</span></span>
<span id="cb301-1186"><a href="#cb301-1186"></a></span>
<span id="cb301-1187"><a href="#cb301-1187"></a><span class="do">##png('./imgs/figureS1.png', width = 7, height = 7, units = 'in',</span></span>
<span id="cb301-1188"><a href="#cb301-1188"></a><span class="do">##    res = 360)</span></span>
<span id="cb301-1189"><a href="#cb301-1189"></a><span class="do">##pdf('./imgs/figuerS1.pdf')</span></span>
<span id="cb301-1190"><a href="#cb301-1190"></a></span>
<span id="cb301-1191"><a href="#cb301-1191"></a></span>
<span id="cb301-1192"><a href="#cb301-1192"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>)</span>
<span id="cb301-1193"><a href="#cb301-1193"></a></span>
<span id="cb301-1194"><a href="#cb301-1194"></a><span class="fu">dim</span>(pruned.mass.range)</span>
<span id="cb301-1195"><a href="#cb301-1195"></a>pred.mod <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">body.mass =</span> <span class="fu">seq</span>(<span class="fu">min</span>(pruned.mass.range<span class="sc">$</span>body.mass),</span>
<span id="cb301-1196"><a href="#cb301-1196"></a>                                       <span class="fu">max</span>(pruned.mass.range<span class="sc">$</span>body.mass),</span>
<span id="cb301-1197"><a href="#cb301-1197"></a>                                       <span class="at">len =</span> <span class="dv">762</span>),</span>
<span id="cb301-1198"><a href="#cb301-1198"></a>                       <span class="at">Foraging.mode =</span> pruned.mass.range<span class="sc">$</span>Foraging.mode,</span>
<span id="cb301-1199"><a href="#cb301-1199"></a>                       <span class="at">row.names =</span> <span class="fu">rownames</span>(pruned.mass.range))</span>
<span id="cb301-1200"><a href="#cb301-1200"></a>pred.mod<span class="sc">$</span>range <span class="ot">&lt;-</span> <span class="fu">predict</span>(range.model2, pred.mod,</span>
<span id="cb301-1201"><a href="#cb301-1201"></a>                          <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>fit</span>
<span id="cb301-1202"><a href="#cb301-1202"></a>pred.mod<span class="sc">$</span>se <span class="ot">&lt;-</span> <span class="fu">predict</span>(range.model2, pred.mod,</span>
<span id="cb301-1203"><a href="#cb301-1203"></a>                       <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>se.fit</span>
<span id="cb301-1204"><a href="#cb301-1204"></a><span class="fu">head</span>(pred.mod)</span>
<span id="cb301-1205"><a href="#cb301-1205"></a></span>
<span id="cb301-1206"><a href="#cb301-1206"></a>active <span class="ot">&lt;-</span> pred.mod[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'active'</span>, ]</span>
<span id="cb301-1207"><a href="#cb301-1207"></a>plastic <span class="ot">&lt;-</span> pred.mod[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'plastic'</span>, ]</span>
<span id="cb301-1208"><a href="#cb301-1208"></a>sit.and.wait <span class="ot">&lt;-</span> pred.mod[pruned.mass.range<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'sit-and-wait'</span>, ]</span>
<span id="cb301-1209"><a href="#cb301-1209"></a></span>
<span id="cb301-1210"><a href="#cb301-1210"></a><span class="fu">par</span>(<span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb301-1211"><a href="#cb301-1211"></a></span>
<span id="cb301-1212"><a href="#cb301-1212"></a><span class="fu">plot</span>(range <span class="sc">~</span> body.mass, <span class="at">data =</span> pruned.mass.range,</span>
<span id="cb301-1213"><a href="#cb301-1213"></a>     <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">bg =</span> cols[<span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(pruned.mass.range<span class="sc">$</span>Foraging.mode))],</span>
<span id="cb301-1214"><a href="#cb301-1214"></a>     <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>, <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb301-1215"><a href="#cb301-1215"></a>     <span class="at">type =</span> <span class="st">'n'</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-1216"><a href="#cb301-1216"></a></span>
<span id="cb301-1217"><a href="#cb301-1217"></a><span class="fu">grid</span>(<span class="at">nx =</span> <span class="cn">NULL</span>, <span class="at">ny =</span> <span class="cn">NULL</span>, <span class="at">col =</span> <span class="st">"lightgray"</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb301-1218"><a href="#cb301-1218"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-1219"><a href="#cb301-1219"></a></span>
<span id="cb301-1220"><a href="#cb301-1220"></a><span class="fu">plot</span>(range <span class="sc">~</span> body.mass, <span class="at">data =</span> pruned.mass.range,</span>
<span id="cb301-1221"><a href="#cb301-1221"></a>     <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">bg =</span> cols[<span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(pruned.mass.range<span class="sc">$</span>Foraging.mode))],</span>
<span id="cb301-1222"><a href="#cb301-1222"></a>     <span class="at">col =</span> <span class="st">'black'</span>, <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb301-1223"><a href="#cb301-1223"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">"Maximum body mass"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(g)),</span>
<span id="cb301-1224"><a href="#cb301-1224"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Area of geographic range"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(km<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb301-1225"><a href="#cb301-1225"></a>     <span class="at">type =</span> <span class="st">'p'</span>)</span>
<span id="cb301-1226"><a href="#cb301-1226"></a></span>
<span id="cb301-1227"><a href="#cb301-1227"></a><span class="fu">lines</span>(active<span class="sc">$</span>range <span class="sc">~</span> active<span class="sc">$</span>body.mass,</span>
<span id="cb301-1228"><a href="#cb301-1228"></a>      <span class="at">data =</span> active, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>)</span>
<span id="cb301-1229"><a href="#cb301-1229"></a></span>
<span id="cb301-1230"><a href="#cb301-1230"></a><span class="fu">lines</span>(plastic<span class="sc">$</span>range <span class="sc">~</span> plastic<span class="sc">$</span>body.mass,</span>
<span id="cb301-1231"><a href="#cb301-1231"></a>      <span class="at">data =</span> plastic, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'green4'</span>)</span>
<span id="cb301-1232"><a href="#cb301-1232"></a></span>
<span id="cb301-1233"><a href="#cb301-1233"></a><span class="fu">lines</span>(sit.and.wait<span class="sc">$</span>range <span class="sc">~</span> sit.and.wait<span class="sc">$</span>body.mass,</span>
<span id="cb301-1234"><a href="#cb301-1234"></a>      <span class="at">data =</span> sit.and.wait, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>)</span>
<span id="cb301-1235"><a href="#cb301-1235"></a></span>
<span id="cb301-1236"><a href="#cb301-1236"></a><span class="fu">legend</span>(<span class="st">'bottomright'</span>,</span>
<span id="cb301-1237"><a href="#cb301-1237"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">'active'</span>, <span class="st">'plastic'</span>, <span class="st">'sit-and-wait'</span>),</span>
<span id="cb301-1238"><a href="#cb301-1238"></a>       <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">pt.bg =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>),</span>
<span id="cb301-1239"><a href="#cb301-1239"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>), <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb301-1240"><a href="#cb301-1240"></a>       <span class="at">bty =</span> <span class="st">'n'</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb301-1241"><a href="#cb301-1241"></a></span>
<span id="cb301-1242"><a href="#cb301-1242"></a></span>
<span id="cb301-1243"><a href="#cb301-1243"></a><span class="do">##dev.off()</span></span>
<span id="cb301-1244"><a href="#cb301-1244"></a></span>
<span id="cb301-1245"><a href="#cb301-1245"></a></span>
<span id="cb301-1246"><a href="#cb301-1246"></a><span class="in">```</span></span>
<span id="cb301-1247"><a href="#cb301-1247"></a></span>
<span id="cb301-1248"><a href="#cb301-1248"></a></span>
<span id="cb301-1251"><a href="#cb301-1251"></a><span class="in">```{r}</span></span>
<span id="cb301-1252"><a href="#cb301-1252"></a><span class="do">## Checking homogeneity of variance</span></span>
<span id="cb301-1253"><a href="#cb301-1253"></a></span>
<span id="cb301-1254"><a href="#cb301-1254"></a></span>
<span id="cb301-1255"><a href="#cb301-1255"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb301-1256"><a href="#cb301-1256"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-1257"><a href="#cb301-1257"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-1258"><a href="#cb301-1258"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb301-1259"><a href="#cb301-1259"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb301-1260"><a href="#cb301-1260"></a></span>
<span id="cb301-1261"><a href="#cb301-1261"></a><span class="fu">par</span>(<span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb301-1262"><a href="#cb301-1262"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(range.model2), <span class="fu">resid</span>(range.model2),</span>
<span id="cb301-1263"><a href="#cb301-1263"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb301-1264"><a href="#cb301-1264"></a>     <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">xlab =</span> <span class="st">''</span>)</span>
<span id="cb301-1265"><a href="#cb301-1265"></a></span>
<span id="cb301-1266"><a href="#cb301-1266"></a><span class="fu">grid</span>()</span>
<span id="cb301-1267"><a href="#cb301-1267"></a></span>
<span id="cb301-1268"><a href="#cb301-1268"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-1269"><a href="#cb301-1269"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(range.model2), <span class="fu">resid</span>(range.model2),</span>
<span id="cb301-1270"><a href="#cb301-1270"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">"Fitted"</span>,</span>
<span id="cb301-1271"><a href="#cb301-1271"></a>     <span class="at">ylab =</span> <span class="st">"Residual"</span>, <span class="at">main =</span> <span class="st">"Fitted versus Residuals"</span>,</span>
<span id="cb301-1272"><a href="#cb301-1272"></a>     <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb301-1273"><a href="#cb301-1273"></a></span>
<span id="cb301-1274"><a href="#cb301-1274"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"darkorange"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb301-1275"><a href="#cb301-1275"></a></span>
<span id="cb301-1276"><a href="#cb301-1276"></a></span>
<span id="cb301-1277"><a href="#cb301-1277"></a><span class="do">## Checking normality</span></span>
<span id="cb301-1278"><a href="#cb301-1278"></a></span>
<span id="cb301-1279"><a href="#cb301-1279"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(range.model2), <span class="at">col =</span> <span class="st">"darkgrey"</span>,</span>
<span id="cb301-1280"><a href="#cb301-1280"></a>       <span class="at">type =</span> <span class="st">'n'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="st">''</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb301-1281"><a href="#cb301-1281"></a>       <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb301-1282"><a href="#cb301-1282"></a></span>
<span id="cb301-1283"><a href="#cb301-1283"></a><span class="fu">grid</span>()</span>
<span id="cb301-1284"><a href="#cb301-1284"></a></span>
<span id="cb301-1285"><a href="#cb301-1285"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-1286"><a href="#cb301-1286"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(range.model2), <span class="at">col =</span> <span class="st">"darkgrey"</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb301-1287"><a href="#cb301-1287"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(range.model2), <span class="at">col =</span> <span class="st">"dodgerblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb301-1288"><a href="#cb301-1288"></a></span>
<span id="cb301-1289"><a href="#cb301-1289"></a><span class="in">```</span></span>
<span id="cb301-1290"><a href="#cb301-1290"></a></span>
<span id="cb301-1291"><a href="#cb301-1291"></a></span>
<span id="cb301-1294"><a href="#cb301-1294"></a><span class="in">```{r}</span></span>
<span id="cb301-1295"><a href="#cb301-1295"></a><span class="do">## setting up the data for modeling the reproductive output</span></span>
<span id="cb301-1296"><a href="#cb301-1296"></a></span>
<span id="cb301-1297"><a href="#cb301-1297"></a>rep.data <span class="ot">&lt;-</span> pruned.data.mrg[<span class="sc">!</span><span class="fu">is.na</span>(pruned.data.mrg<span class="sc">$</span><span class="st">'Reproductive output'</span>), ]</span>
<span id="cb301-1298"><a href="#cb301-1298"></a></span>
<span id="cb301-1299"><a href="#cb301-1299"></a></span>
<span id="cb301-1300"><a href="#cb301-1300"></a>check <span class="ot">&lt;-</span> <span class="fu">name.check</span>(lizard.tree, rep.data)</span>
<span id="cb301-1301"><a href="#cb301-1301"></a>rm_phy <span class="ot">&lt;-</span> check<span class="sc">$</span>tree_not_data</span>
<span id="cb301-1302"><a href="#cb301-1302"></a>rm_dat <span class="ot">&lt;-</span> check<span class="sc">$</span>data_not_tree</span>
<span id="cb301-1303"><a href="#cb301-1303"></a>tree.rep <span class="ot">&lt;-</span> <span class="fu">drop.tip</span>(lizard.tree, rm_phy)</span>
<span id="cb301-1304"><a href="#cb301-1304"></a></span>
<span id="cb301-1305"><a href="#cb301-1305"></a>data.rep.out <span class="ot">&lt;-</span> <span class="fu">subset</span>(rep.data,</span>
<span id="cb301-1306"><a href="#cb301-1306"></a>                      <span class="at">subset =</span> <span class="fu">rownames</span>(rep.data) <span class="sc">%in%</span> tree.rep<span class="sc">$</span>tip,</span>
<span id="cb301-1307"><a href="#cb301-1307"></a>                      <span class="at">select =</span> <span class="fu">names</span>(rep.data))</span>
<span id="cb301-1308"><a href="#cb301-1308"></a><span class="fu">name.check</span>(tree.rep, data.rep.out)</span>
<span id="cb301-1309"><a href="#cb301-1309"></a><span class="fu">names</span>(data.rep.out)[<span class="dv">30</span>] <span class="ot">&lt;-</span> <span class="st">'repro.output'</span></span>
<span id="cb301-1310"><a href="#cb301-1310"></a><span class="fu">names</span>(data.rep.out)[<span class="dv">14</span>] <span class="ot">&lt;-</span> <span class="st">'body.mass'</span></span>
<span id="cb301-1311"><a href="#cb301-1311"></a><span class="fu">names</span>(data.rep.out)[<span class="dv">29</span>] <span class="ot">&lt;-</span> <span class="st">'range'</span></span>
<span id="cb301-1312"><a href="#cb301-1312"></a><span class="fu">head</span>(data.rep.out[ , <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">29</span>, <span class="dv">30</span>)])</span>
<span id="cb301-1313"><a href="#cb301-1313"></a></span>
<span id="cb301-1314"><a href="#cb301-1314"></a><span class="do">## fitting models</span></span>
<span id="cb301-1315"><a href="#cb301-1315"></a></span>
<span id="cb301-1316"><a href="#cb301-1316"></a>repro.model1 <span class="ot">&lt;-</span> <span class="fu">gls</span>(repro.output <span class="sc">~</span> Foraging.mode<span class="sc">*</span>body.mass<span class="sc">*</span>range,</span>
<span id="cb301-1317"><a href="#cb301-1317"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1318"><a href="#cb301-1318"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.rep,</span>
<span id="cb301-1319"><a href="#cb301-1319"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1320"><a href="#cb301-1320"></a>                     <span class="at">data =</span> data.rep.out, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1321"><a href="#cb301-1321"></a></span>
<span id="cb301-1322"><a href="#cb301-1322"></a></span>
<span id="cb301-1323"><a href="#cb301-1323"></a>repro.model2 <span class="ot">&lt;-</span> <span class="fu">gls</span>(repro.output <span class="sc">~</span> Foraging.mode<span class="sc">*</span>body.mass <span class="sc">+</span></span>
<span id="cb301-1324"><a href="#cb301-1324"></a>                        range,</span>
<span id="cb301-1325"><a href="#cb301-1325"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1326"><a href="#cb301-1326"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.rep,</span>
<span id="cb301-1327"><a href="#cb301-1327"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1328"><a href="#cb301-1328"></a>                     <span class="at">data =</span> data.rep.out, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1329"><a href="#cb301-1329"></a></span>
<span id="cb301-1330"><a href="#cb301-1330"></a></span>
<span id="cb301-1331"><a href="#cb301-1331"></a>repro.model3 <span class="ot">&lt;-</span> <span class="fu">gls</span>(repro.output <span class="sc">~</span> Foraging.mode<span class="sc">*</span>range <span class="sc">+</span></span>
<span id="cb301-1332"><a href="#cb301-1332"></a>                        body.mass,</span>
<span id="cb301-1333"><a href="#cb301-1333"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1334"><a href="#cb301-1334"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.rep,</span>
<span id="cb301-1335"><a href="#cb301-1335"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1336"><a href="#cb301-1336"></a>                     <span class="at">data =</span> data.rep.out, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1337"><a href="#cb301-1337"></a></span>
<span id="cb301-1338"><a href="#cb301-1338"></a>repro.model4 <span class="ot">&lt;-</span> <span class="fu">gls</span>(repro.output <span class="sc">~</span> Foraging.mode <span class="sc">+</span> range <span class="sc">+</span></span>
<span id="cb301-1339"><a href="#cb301-1339"></a>                        body.mass,</span>
<span id="cb301-1340"><a href="#cb301-1340"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1341"><a href="#cb301-1341"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.rep,</span>
<span id="cb301-1342"><a href="#cb301-1342"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1343"><a href="#cb301-1343"></a>                     <span class="at">data =</span> data.rep.out, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1344"><a href="#cb301-1344"></a></span>
<span id="cb301-1345"><a href="#cb301-1345"></a></span>
<span id="cb301-1346"><a href="#cb301-1346"></a>repro.model5 <span class="ot">&lt;-</span> <span class="fu">gls</span>(repro.output <span class="sc">~</span> Foraging.mode <span class="sc">+</span></span>
<span id="cb301-1347"><a href="#cb301-1347"></a>                        body.mass,</span>
<span id="cb301-1348"><a href="#cb301-1348"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1349"><a href="#cb301-1349"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.rep,</span>
<span id="cb301-1350"><a href="#cb301-1350"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1351"><a href="#cb301-1351"></a>                     <span class="at">data =</span> data.rep.out, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1352"><a href="#cb301-1352"></a></span>
<span id="cb301-1353"><a href="#cb301-1353"></a>repro.model6 <span class="ot">&lt;-</span> <span class="fu">gls</span>(repro.output <span class="sc">~</span> Foraging.mode <span class="sc">+</span></span>
<span id="cb301-1354"><a href="#cb301-1354"></a>                        range,</span>
<span id="cb301-1355"><a href="#cb301-1355"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1356"><a href="#cb301-1356"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.rep,</span>
<span id="cb301-1357"><a href="#cb301-1357"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1358"><a href="#cb301-1358"></a>                     <span class="at">data =</span> data.rep.out, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1359"><a href="#cb301-1359"></a></span>
<span id="cb301-1360"><a href="#cb301-1360"></a>repro.model7 <span class="ot">&lt;-</span> <span class="fu">gls</span>(repro.output <span class="sc">~</span> Foraging.mode,</span>
<span id="cb301-1361"><a href="#cb301-1361"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1362"><a href="#cb301-1362"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.rep,</span>
<span id="cb301-1363"><a href="#cb301-1363"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1364"><a href="#cb301-1364"></a>                     <span class="at">data =</span> data.rep.out, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1365"><a href="#cb301-1365"></a></span>
<span id="cb301-1366"><a href="#cb301-1366"></a>repro.model8 <span class="ot">&lt;-</span> <span class="fu">gls</span>(repro.output <span class="sc">~</span> range,</span>
<span id="cb301-1367"><a href="#cb301-1367"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1368"><a href="#cb301-1368"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.rep,</span>
<span id="cb301-1369"><a href="#cb301-1369"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1370"><a href="#cb301-1370"></a>                     <span class="at">data =</span> data.rep.out, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1371"><a href="#cb301-1371"></a></span>
<span id="cb301-1372"><a href="#cb301-1372"></a>repro.model9 <span class="ot">&lt;-</span> <span class="fu">gls</span>(repro.output <span class="sc">~</span> body.mass,</span>
<span id="cb301-1373"><a href="#cb301-1373"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1374"><a href="#cb301-1374"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.rep,</span>
<span id="cb301-1375"><a href="#cb301-1375"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1376"><a href="#cb301-1376"></a>                     <span class="at">data =</span> data.rep.out, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1377"><a href="#cb301-1377"></a></span>
<span id="cb301-1378"><a href="#cb301-1378"></a></span>
<span id="cb301-1379"><a href="#cb301-1379"></a></span>
<span id="cb301-1380"><a href="#cb301-1380"></a>repro.models <span class="ot">&lt;-</span> <span class="fu">anova</span>(repro.model1, repro.model2,</span>
<span id="cb301-1381"><a href="#cb301-1381"></a>                      repro.model3, repro.model4,</span>
<span id="cb301-1382"><a href="#cb301-1382"></a>                      repro.model5, repro.model6,</span>
<span id="cb301-1383"><a href="#cb301-1383"></a>                      repro.model7, repro.model8,</span>
<span id="cb301-1384"><a href="#cb301-1384"></a>                      repro.model9)</span>
<span id="cb301-1385"><a href="#cb301-1385"></a></span>
<span id="cb301-1386"><a href="#cb301-1386"></a><span class="fu">round</span>(<span class="fu">aicw</span>(<span class="fu">setNames</span>(repro.models<span class="sc">$</span>AIC,</span>
<span id="cb301-1387"><a href="#cb301-1387"></a>              <span class="fu">rownames</span>(repro.models))), <span class="dv">3</span>)</span>
<span id="cb301-1388"><a href="#cb301-1388"></a><span class="fu">summary</span>(repro.model2)</span>
<span id="cb301-1389"><a href="#cb301-1389"></a></span>
<span id="cb301-1390"><a href="#cb301-1390"></a><span class="in">```</span></span>
<span id="cb301-1391"><a href="#cb301-1391"></a></span>
<span id="cb301-1394"><a href="#cb301-1394"></a><span class="in">```{r}</span></span>
<span id="cb301-1395"><a href="#cb301-1395"></a><span class="do">## plotting results of the model</span></span>
<span id="cb301-1396"><a href="#cb301-1396"></a></span>
<span id="cb301-1397"><a href="#cb301-1397"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>)</span>
<span id="cb301-1398"><a href="#cb301-1398"></a></span>
<span id="cb301-1399"><a href="#cb301-1399"></a><span class="fu">dim</span>(data.rep.out)</span>
<span id="cb301-1400"><a href="#cb301-1400"></a>pred.mod <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">body.mass =</span> <span class="fu">seq</span>(<span class="fu">min</span>(data.rep.out<span class="sc">$</span>body.mass),</span>
<span id="cb301-1401"><a href="#cb301-1401"></a>                                       <span class="fu">max</span>(data.rep.out<span class="sc">$</span>body.mass), <span class="at">len =</span> <span class="dv">251</span>),</span>
<span id="cb301-1402"><a href="#cb301-1402"></a>                       <span class="at">range =</span> <span class="fu">seq</span>(<span class="fu">min</span>(data.rep.out<span class="sc">$</span>range), <span class="fu">max</span>(data.rep.out<span class="sc">$</span>range),</span>
<span id="cb301-1403"><a href="#cb301-1403"></a>                                   <span class="at">len =</span> <span class="dv">251</span>), <span class="at">Foraging.mode =</span> data.rep.out<span class="sc">$</span>Foraging.mode,</span>
<span id="cb301-1404"><a href="#cb301-1404"></a>                       <span class="at">row.names =</span> <span class="fu">rownames</span>(data.rep.out))</span>
<span id="cb301-1405"><a href="#cb301-1405"></a>pred.mod<span class="sc">$</span>rep.out <span class="ot">&lt;-</span> <span class="fu">predict</span>(repro.model2, pred.mod,</span>
<span id="cb301-1406"><a href="#cb301-1406"></a>                            <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>fit</span>
<span id="cb301-1407"><a href="#cb301-1407"></a>pred.mod<span class="sc">$</span>se <span class="ot">&lt;-</span> <span class="fu">predict</span>(repro.model2, pred.mod,</span>
<span id="cb301-1408"><a href="#cb301-1408"></a>                       <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>se.fit</span>
<span id="cb301-1409"><a href="#cb301-1409"></a><span class="fu">head</span>(pred.mod)</span>
<span id="cb301-1410"><a href="#cb301-1410"></a></span>
<span id="cb301-1411"><a href="#cb301-1411"></a>active <span class="ot">&lt;-</span> pred.mod[data.rep.out<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'active'</span>, ]</span>
<span id="cb301-1412"><a href="#cb301-1412"></a>plastic <span class="ot">&lt;-</span> pred.mod[data.rep.out<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'plastic'</span>, ]</span>
<span id="cb301-1413"><a href="#cb301-1413"></a>sit.and.wait <span class="ot">&lt;-</span> pred.mod[data.rep.out<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'sit-and-wait'</span>, ]</span>
<span id="cb301-1414"><a href="#cb301-1414"></a></span>
<span id="cb301-1415"><a href="#cb301-1415"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb301-1416"><a href="#cb301-1416"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-1417"><a href="#cb301-1417"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-1418"><a href="#cb301-1418"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb301-1419"><a href="#cb301-1419"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb301-1420"><a href="#cb301-1420"></a></span>
<span id="cb301-1421"><a href="#cb301-1421"></a></span>
<span id="cb301-1422"><a href="#cb301-1422"></a><span class="do">##png('./imgs/figure3.png', width = 7, height = 7, units = 'in',</span></span>
<span id="cb301-1423"><a href="#cb301-1423"></a><span class="do">##    res = 360)</span></span>
<span id="cb301-1424"><a href="#cb301-1424"></a><span class="do">##pdf('./imgs/figuer3.pdf')</span></span>
<span id="cb301-1425"><a href="#cb301-1425"></a></span>
<span id="cb301-1426"><a href="#cb301-1426"></a></span>
<span id="cb301-1427"><a href="#cb301-1427"></a><span class="fu">plot</span>(repro.output <span class="sc">~</span> body.mass, <span class="at">data =</span> data.rep.out,</span>
<span id="cb301-1428"><a href="#cb301-1428"></a>     <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb301-1429"><a href="#cb301-1429"></a>     <span class="at">bg =</span> cols[<span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(data.rep.out<span class="sc">$</span>Foraging.mode))],</span>
<span id="cb301-1430"><a href="#cb301-1430"></a>     <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>, <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb301-1431"><a href="#cb301-1431"></a>     <span class="at">type =</span> <span class="st">'n'</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-1432"><a href="#cb301-1432"></a></span>
<span id="cb301-1433"><a href="#cb301-1433"></a><span class="fu">grid</span>(<span class="at">nx =</span> <span class="cn">NULL</span>, <span class="at">ny =</span> <span class="cn">NULL</span>, <span class="at">col =</span> <span class="st">"lightgray"</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb301-1434"><a href="#cb301-1434"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-1435"><a href="#cb301-1435"></a></span>
<span id="cb301-1436"><a href="#cb301-1436"></a><span class="fu">plot</span>(repro.output <span class="sc">~</span> body.mass, <span class="at">data =</span> data.rep.out,</span>
<span id="cb301-1437"><a href="#cb301-1437"></a>     <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb301-1438"><a href="#cb301-1438"></a>     <span class="at">bg =</span> cols[<span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(data.rep.out<span class="sc">$</span>Foraging.mode))],</span>
<span id="cb301-1439"><a href="#cb301-1439"></a>     <span class="at">col =</span> <span class="st">'black'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">"Maximum body mass"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(g)),</span>
<span id="cb301-1440"><a href="#cb301-1440"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Clutch size"</span><span class="sc">~</span>x<span class="sc">~</span><span class="st">"clutches per year"</span>), <span class="at">type =</span> <span class="st">'p'</span>)</span>
<span id="cb301-1441"><a href="#cb301-1441"></a></span>
<span id="cb301-1442"><a href="#cb301-1442"></a><span class="fu">lines</span>(active<span class="sc">$</span>rep.out <span class="sc">~</span> active<span class="sc">$</span>body.mass,</span>
<span id="cb301-1443"><a href="#cb301-1443"></a>      <span class="at">data =</span> active, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>)</span>
<span id="cb301-1444"><a href="#cb301-1444"></a></span>
<span id="cb301-1445"><a href="#cb301-1445"></a><span class="fu">lines</span>(plastic<span class="sc">$</span>rep.out <span class="sc">~</span> plastic<span class="sc">$</span>body.mass,</span>
<span id="cb301-1446"><a href="#cb301-1446"></a>      <span class="at">data =</span> plastic, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'green4'</span>)</span>
<span id="cb301-1447"><a href="#cb301-1447"></a></span>
<span id="cb301-1448"><a href="#cb301-1448"></a><span class="fu">lines</span>(sit.and.wait<span class="sc">$</span>rep.out <span class="sc">~</span> sit.and.wait<span class="sc">$</span>body.mass,</span>
<span id="cb301-1449"><a href="#cb301-1449"></a>      <span class="at">data =</span> sit.and.wait, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>)</span>
<span id="cb301-1450"><a href="#cb301-1450"></a></span>
<span id="cb301-1451"><a href="#cb301-1451"></a><span class="fu">legend</span>(<span class="st">'bottomright'</span>,</span>
<span id="cb301-1452"><a href="#cb301-1452"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">'active'</span>, <span class="st">'plastic'</span>,</span>
<span id="cb301-1453"><a href="#cb301-1453"></a>                  <span class="st">'sit-and-wait'</span>), <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb301-1454"><a href="#cb301-1454"></a>       <span class="at">pt.bg =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>),</span>
<span id="cb301-1455"><a href="#cb301-1455"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>), <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb301-1456"><a href="#cb301-1456"></a>       <span class="at">bty =</span> <span class="st">'n'</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb301-1457"><a href="#cb301-1457"></a></span>
<span id="cb301-1458"><a href="#cb301-1458"></a><span class="do">##dev.off()</span></span>
<span id="cb301-1459"><a href="#cb301-1459"></a></span>
<span id="cb301-1460"><a href="#cb301-1460"></a></span>
<span id="cb301-1461"><a href="#cb301-1461"></a><span class="fu">plot</span>(repro.output <span class="sc">~</span> range, <span class="at">data =</span> data.rep.out,</span>
<span id="cb301-1462"><a href="#cb301-1462"></a>     <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb301-1463"><a href="#cb301-1463"></a>     <span class="at">bg =</span> cols[<span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(data.rep.out<span class="sc">$</span>Foraging.mode))],</span>
<span id="cb301-1464"><a href="#cb301-1464"></a>     <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb301-1465"><a href="#cb301-1465"></a>     <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">''</span>,</span>
<span id="cb301-1466"><a href="#cb301-1466"></a>     <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb301-1467"><a href="#cb301-1467"></a>     <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-1468"><a href="#cb301-1468"></a></span>
<span id="cb301-1469"><a href="#cb301-1469"></a><span class="fu">grid</span>(<span class="at">nx =</span> <span class="cn">NULL</span>, <span class="at">ny =</span> <span class="cn">NULL</span>,</span>
<span id="cb301-1470"><a href="#cb301-1470"></a>     <span class="at">col =</span> <span class="st">"lightgray"</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb301-1471"><a href="#cb301-1471"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-1472"><a href="#cb301-1472"></a></span>
<span id="cb301-1473"><a href="#cb301-1473"></a><span class="fu">plot</span>(repro.output <span class="sc">~</span> range, <span class="at">data =</span> data.rep.out,</span>
<span id="cb301-1474"><a href="#cb301-1474"></a>     <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">bg =</span> cols[<span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(data.rep.out<span class="sc">$</span>Foraging.mode))],</span>
<span id="cb301-1475"><a href="#cb301-1475"></a>     <span class="at">col =</span> <span class="st">'black'</span>, <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb301-1476"><a href="#cb301-1476"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">"Area of geographic range"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(km<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb301-1477"><a href="#cb301-1477"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Clutch size"</span><span class="sc">~</span>x<span class="sc">~</span><span class="st">"clutches per year"</span>),</span>
<span id="cb301-1478"><a href="#cb301-1478"></a>     <span class="at">type =</span> <span class="st">'p'</span>)</span>
<span id="cb301-1479"><a href="#cb301-1479"></a></span>
<span id="cb301-1480"><a href="#cb301-1480"></a><span class="fu">lines</span>(active<span class="sc">$</span>rep.out <span class="sc">~</span> active<span class="sc">$</span>range,</span>
<span id="cb301-1481"><a href="#cb301-1481"></a>      <span class="at">data =</span> active,</span>
<span id="cb301-1482"><a href="#cb301-1482"></a>      <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>)</span>
<span id="cb301-1483"><a href="#cb301-1483"></a></span>
<span id="cb301-1484"><a href="#cb301-1484"></a><span class="fu">lines</span>(plastic<span class="sc">$</span>rep.out <span class="sc">~</span> plastic<span class="sc">$</span>range,</span>
<span id="cb301-1485"><a href="#cb301-1485"></a>      <span class="at">data =</span> plastic,</span>
<span id="cb301-1486"><a href="#cb301-1486"></a>      <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'green4'</span>)</span>
<span id="cb301-1487"><a href="#cb301-1487"></a></span>
<span id="cb301-1488"><a href="#cb301-1488"></a><span class="fu">lines</span>(sit.and.wait<span class="sc">$</span>rep.out <span class="sc">~</span> sit.and.wait<span class="sc">$</span>range,</span>
<span id="cb301-1489"><a href="#cb301-1489"></a>      <span class="at">data =</span> sit.and.wait,</span>
<span id="cb301-1490"><a href="#cb301-1490"></a>      <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>)</span>
<span id="cb301-1491"><a href="#cb301-1491"></a></span>
<span id="cb301-1492"><a href="#cb301-1492"></a><span class="fu">legend</span>(<span class="st">'topleft'</span>,</span>
<span id="cb301-1493"><a href="#cb301-1493"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">'active'</span>, <span class="st">'plastic'</span>,</span>
<span id="cb301-1494"><a href="#cb301-1494"></a>                  <span class="st">'sit-and-wait'</span>),</span>
<span id="cb301-1495"><a href="#cb301-1495"></a>       <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">pt.bg =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>,</span>
<span id="cb301-1496"><a href="#cb301-1496"></a>                           <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>),</span>
<span id="cb301-1497"><a href="#cb301-1497"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>,</span>
<span id="cb301-1498"><a href="#cb301-1498"></a>               <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>),</span>
<span id="cb301-1499"><a href="#cb301-1499"></a>       <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">'n'</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb301-1500"><a href="#cb301-1500"></a></span>
<span id="cb301-1501"><a href="#cb301-1501"></a></span>
<span id="cb301-1502"><a href="#cb301-1502"></a><span class="in">```</span></span>
<span id="cb301-1503"><a href="#cb301-1503"></a></span>
<span id="cb301-1506"><a href="#cb301-1506"></a><span class="in">```{r}</span></span>
<span id="cb301-1507"><a href="#cb301-1507"></a><span class="do">## Checking homogeneity of variance</span></span>
<span id="cb301-1508"><a href="#cb301-1508"></a></span>
<span id="cb301-1509"><a href="#cb301-1509"></a></span>
<span id="cb301-1510"><a href="#cb301-1510"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb301-1511"><a href="#cb301-1511"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-1512"><a href="#cb301-1512"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-1513"><a href="#cb301-1513"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb301-1514"><a href="#cb301-1514"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb301-1515"><a href="#cb301-1515"></a></span>
<span id="cb301-1516"><a href="#cb301-1516"></a><span class="fu">par</span>(<span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb301-1517"><a href="#cb301-1517"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(repro.model2), <span class="fu">resid</span>(repro.model2),</span>
<span id="cb301-1518"><a href="#cb301-1518"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb301-1519"><a href="#cb301-1519"></a>     <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">xlab =</span> <span class="st">''</span>)</span>
<span id="cb301-1520"><a href="#cb301-1520"></a></span>
<span id="cb301-1521"><a href="#cb301-1521"></a><span class="fu">grid</span>()</span>
<span id="cb301-1522"><a href="#cb301-1522"></a></span>
<span id="cb301-1523"><a href="#cb301-1523"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-1524"><a href="#cb301-1524"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(repro.model2), <span class="fu">resid</span>(repro.model2),</span>
<span id="cb301-1525"><a href="#cb301-1525"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">"Fitted"</span>,</span>
<span id="cb301-1526"><a href="#cb301-1526"></a>     <span class="at">ylab =</span> <span class="st">"Residual"</span>, <span class="at">main =</span> <span class="st">"Fitted versus Residuals"</span>,</span>
<span id="cb301-1527"><a href="#cb301-1527"></a>     <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb301-1528"><a href="#cb301-1528"></a></span>
<span id="cb301-1529"><a href="#cb301-1529"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"darkorange"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb301-1530"><a href="#cb301-1530"></a></span>
<span id="cb301-1531"><a href="#cb301-1531"></a></span>
<span id="cb301-1532"><a href="#cb301-1532"></a><span class="do">## Checking normality</span></span>
<span id="cb301-1533"><a href="#cb301-1533"></a></span>
<span id="cb301-1534"><a href="#cb301-1534"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(repro.model2), <span class="at">col =</span> <span class="st">"darkgrey"</span>,</span>
<span id="cb301-1535"><a href="#cb301-1535"></a>       <span class="at">type =</span> <span class="st">'n'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="st">''</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb301-1536"><a href="#cb301-1536"></a>       <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb301-1537"><a href="#cb301-1537"></a></span>
<span id="cb301-1538"><a href="#cb301-1538"></a><span class="fu">grid</span>()</span>
<span id="cb301-1539"><a href="#cb301-1539"></a></span>
<span id="cb301-1540"><a href="#cb301-1540"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-1541"><a href="#cb301-1541"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(repro.model2), <span class="at">col =</span> <span class="st">"darkgrey"</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb301-1542"><a href="#cb301-1542"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(repro.model2), <span class="at">col =</span> <span class="st">"dodgerblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb301-1543"><a href="#cb301-1543"></a></span>
<span id="cb301-1544"><a href="#cb301-1544"></a></span>
<span id="cb301-1545"><a href="#cb301-1545"></a></span>
<span id="cb301-1546"><a href="#cb301-1546"></a><span class="do">## setting up the data for modeling the body temperature</span></span>
<span id="cb301-1547"><a href="#cb301-1547"></a></span>
<span id="cb301-1548"><a href="#cb301-1548"></a>tb.data <span class="ot">&lt;-</span> pruned.data.mrg[<span class="sc">!</span><span class="fu">is.na</span>(pruned.data.mrg<span class="sc">$</span><span class="st">'Mean body temperature'</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(pruned.data.mrg<span class="sc">$</span><span class="st">'Reproductive output'</span>), ]</span>
<span id="cb301-1549"><a href="#cb301-1549"></a></span>
<span id="cb301-1550"><a href="#cb301-1550"></a>check <span class="ot">&lt;-</span> <span class="fu">name.check</span>(lizard.tree, tb.data)</span>
<span id="cb301-1551"><a href="#cb301-1551"></a>rm_phy <span class="ot">&lt;-</span> check<span class="sc">$</span>tree_not_data</span>
<span id="cb301-1552"><a href="#cb301-1552"></a>rm_dat <span class="ot">&lt;-</span> check<span class="sc">$</span>data_not_tree</span>
<span id="cb301-1553"><a href="#cb301-1553"></a>tree.tb <span class="ot">&lt;-</span> <span class="fu">drop.tip</span>(lizard.tree, rm_phy)</span>
<span id="cb301-1554"><a href="#cb301-1554"></a></span>
<span id="cb301-1555"><a href="#cb301-1555"></a>data.tb <span class="ot">&lt;-</span> <span class="fu">subset</span>(tb.data,</span>
<span id="cb301-1556"><a href="#cb301-1556"></a>                      <span class="at">subset =</span> <span class="fu">rownames</span>(tb.data) <span class="sc">%in%</span> tree.tb<span class="sc">$</span>tip,</span>
<span id="cb301-1557"><a href="#cb301-1557"></a>                      <span class="at">select =</span> <span class="fu">names</span>(tb.data))</span>
<span id="cb301-1558"><a href="#cb301-1558"></a><span class="fu">name.check</span>(tree.tb, data.tb)</span>
<span id="cb301-1559"><a href="#cb301-1559"></a><span class="fu">names</span>(data.tb)[<span class="dv">30</span>] <span class="ot">&lt;-</span> <span class="st">'repro.output'</span></span>
<span id="cb301-1560"><a href="#cb301-1560"></a><span class="fu">names</span>(data.tb)[<span class="dv">14</span>] <span class="ot">&lt;-</span> <span class="st">'body.mass'</span></span>
<span id="cb301-1561"><a href="#cb301-1561"></a><span class="fu">names</span>(data.tb)[<span class="dv">26</span>] <span class="ot">&lt;-</span> <span class="st">'mean.tb'</span></span>
<span id="cb301-1562"><a href="#cb301-1562"></a><span class="fu">names</span>(data.tb)[<span class="dv">29</span>] <span class="ot">&lt;-</span> <span class="st">'range'</span></span>
<span id="cb301-1563"><a href="#cb301-1563"></a></span>
<span id="cb301-1564"><a href="#cb301-1564"></a><span class="fu">head</span>(data.tb[ , <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">26</span>, <span class="dv">29</span>, <span class="dv">30</span>)])</span>
<span id="cb301-1565"><a href="#cb301-1565"></a><span class="fu">dim</span>(data.tb[ , <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">26</span>, <span class="dv">29</span>, <span class="dv">30</span>)])</span>
<span id="cb301-1566"><a href="#cb301-1566"></a></span>
<span id="cb301-1567"><a href="#cb301-1567"></a><span class="do">## fitting models</span></span>
<span id="cb301-1568"><a href="#cb301-1568"></a></span>
<span id="cb301-1569"><a href="#cb301-1569"></a>tb.model1 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode<span class="sc">*</span>body.mass<span class="sc">*</span>range<span class="sc">*</span>repro.output,</span>
<span id="cb301-1570"><a href="#cb301-1570"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1571"><a href="#cb301-1571"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb301-1572"><a href="#cb301-1572"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1573"><a href="#cb301-1573"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1574"><a href="#cb301-1574"></a></span>
<span id="cb301-1575"><a href="#cb301-1575"></a>tb.model2 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode<span class="sc">*</span>body.mass <span class="sc">+</span> range <span class="sc">+</span></span>
<span id="cb301-1576"><a href="#cb301-1576"></a>                repro.output,</span>
<span id="cb301-1577"><a href="#cb301-1577"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1578"><a href="#cb301-1578"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb301-1579"><a href="#cb301-1579"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1580"><a href="#cb301-1580"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1581"><a href="#cb301-1581"></a></span>
<span id="cb301-1582"><a href="#cb301-1582"></a>tb.model3 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode<span class="sc">*</span>range <span class="sc">+</span> body.mass <span class="sc">+</span></span>
<span id="cb301-1583"><a href="#cb301-1583"></a>                repro.output,</span>
<span id="cb301-1584"><a href="#cb301-1584"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1585"><a href="#cb301-1585"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb301-1586"><a href="#cb301-1586"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1587"><a href="#cb301-1587"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1588"><a href="#cb301-1588"></a></span>
<span id="cb301-1589"><a href="#cb301-1589"></a>tb.model4 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode<span class="sc">*</span>repro.output <span class="sc">+</span> body.mass <span class="sc">+</span></span>
<span id="cb301-1590"><a href="#cb301-1590"></a>                range,</span>
<span id="cb301-1591"><a href="#cb301-1591"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1592"><a href="#cb301-1592"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb301-1593"><a href="#cb301-1593"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1594"><a href="#cb301-1594"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1595"><a href="#cb301-1595"></a></span>
<span id="cb301-1596"><a href="#cb301-1596"></a>tb.model5 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode <span class="sc">+</span> repro.output <span class="sc">+</span> body.mass <span class="sc">+</span></span>
<span id="cb301-1597"><a href="#cb301-1597"></a>                range,</span>
<span id="cb301-1598"><a href="#cb301-1598"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1599"><a href="#cb301-1599"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb301-1600"><a href="#cb301-1600"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1601"><a href="#cb301-1601"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1602"><a href="#cb301-1602"></a></span>
<span id="cb301-1603"><a href="#cb301-1603"></a>tb.model6 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode <span class="sc">+</span> repro.output <span class="sc">+</span> body.mass,</span>
<span id="cb301-1604"><a href="#cb301-1604"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1605"><a href="#cb301-1605"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb301-1606"><a href="#cb301-1606"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1607"><a href="#cb301-1607"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1608"><a href="#cb301-1608"></a></span>
<span id="cb301-1609"><a href="#cb301-1609"></a>tb.model7 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode <span class="sc">+</span> repro.output <span class="sc">+</span> range,</span>
<span id="cb301-1610"><a href="#cb301-1610"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1611"><a href="#cb301-1611"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb301-1612"><a href="#cb301-1612"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1613"><a href="#cb301-1613"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1614"><a href="#cb301-1614"></a></span>
<span id="cb301-1615"><a href="#cb301-1615"></a>tb.model8 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode <span class="sc">+</span> body.mass <span class="sc">+</span> range,</span>
<span id="cb301-1616"><a href="#cb301-1616"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1617"><a href="#cb301-1617"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb301-1618"><a href="#cb301-1618"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1619"><a href="#cb301-1619"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1620"><a href="#cb301-1620"></a></span>
<span id="cb301-1621"><a href="#cb301-1621"></a>tb.model9 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode <span class="sc">+</span> range,</span>
<span id="cb301-1622"><a href="#cb301-1622"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1623"><a href="#cb301-1623"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb301-1624"><a href="#cb301-1624"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1625"><a href="#cb301-1625"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1626"><a href="#cb301-1626"></a></span>
<span id="cb301-1627"><a href="#cb301-1627"></a>tb.model10 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode <span class="sc">+</span> repro.output,</span>
<span id="cb301-1628"><a href="#cb301-1628"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1629"><a href="#cb301-1629"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb301-1630"><a href="#cb301-1630"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1631"><a href="#cb301-1631"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1632"><a href="#cb301-1632"></a></span>
<span id="cb301-1633"><a href="#cb301-1633"></a>tb.model11 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode <span class="sc">+</span> body.mass,</span>
<span id="cb301-1634"><a href="#cb301-1634"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1635"><a href="#cb301-1635"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb301-1636"><a href="#cb301-1636"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1637"><a href="#cb301-1637"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1638"><a href="#cb301-1638"></a></span>
<span id="cb301-1639"><a href="#cb301-1639"></a>tb.model12 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> Foraging.mode,</span>
<span id="cb301-1640"><a href="#cb301-1640"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1641"><a href="#cb301-1641"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb301-1642"><a href="#cb301-1642"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1643"><a href="#cb301-1643"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1644"><a href="#cb301-1644"></a></span>
<span id="cb301-1645"><a href="#cb301-1645"></a>tb.model13 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> body.mass,</span>
<span id="cb301-1646"><a href="#cb301-1646"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1647"><a href="#cb301-1647"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb301-1648"><a href="#cb301-1648"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1649"><a href="#cb301-1649"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1650"><a href="#cb301-1650"></a></span>
<span id="cb301-1651"><a href="#cb301-1651"></a>tb.model14 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> range,</span>
<span id="cb301-1652"><a href="#cb301-1652"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1653"><a href="#cb301-1653"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb301-1654"><a href="#cb301-1654"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1655"><a href="#cb301-1655"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1656"><a href="#cb301-1656"></a></span>
<span id="cb301-1657"><a href="#cb301-1657"></a>tb.model15 <span class="ot">&lt;-</span> <span class="fu">gls</span>(mean.tb <span class="sc">~</span> repro.output,</span>
<span id="cb301-1658"><a href="#cb301-1658"></a>                     <span class="at">correlation =</span></span>
<span id="cb301-1659"><a href="#cb301-1659"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> tree.tb,</span>
<span id="cb301-1660"><a href="#cb301-1660"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1661"><a href="#cb301-1661"></a>                     <span class="at">data =</span> data.tb, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1662"><a href="#cb301-1662"></a></span>
<span id="cb301-1663"><a href="#cb301-1663"></a></span>
<span id="cb301-1664"><a href="#cb301-1664"></a>tb.models <span class="ot">&lt;-</span> <span class="fu">anova</span>(tb.model1, tb.model2,</span>
<span id="cb301-1665"><a href="#cb301-1665"></a>                   tb.model3, tb.model4,</span>
<span id="cb301-1666"><a href="#cb301-1666"></a>                   tb.model5, tb.model6,</span>
<span id="cb301-1667"><a href="#cb301-1667"></a>                   tb.model7, tb.model8,</span>
<span id="cb301-1668"><a href="#cb301-1668"></a>                   tb.model9, tb.model10,</span>
<span id="cb301-1669"><a href="#cb301-1669"></a>                   tb.model11, tb.model12,</span>
<span id="cb301-1670"><a href="#cb301-1670"></a>                   tb.model13, tb.model14,</span>
<span id="cb301-1671"><a href="#cb301-1671"></a>                   tb.model15)</span>
<span id="cb301-1672"><a href="#cb301-1672"></a></span>
<span id="cb301-1673"><a href="#cb301-1673"></a><span class="fu">round</span>(<span class="fu">aicw</span>(<span class="fu">setNames</span>(tb.models<span class="sc">$</span>AIC,</span>
<span id="cb301-1674"><a href="#cb301-1674"></a>              <span class="fu">rownames</span>(tb.models))), <span class="dv">3</span>)</span>
<span id="cb301-1675"><a href="#cb301-1675"></a><span class="fu">summary</span>(tb.model9)</span>
<span id="cb301-1676"><a href="#cb301-1676"></a></span>
<span id="cb301-1677"><a href="#cb301-1677"></a><span class="in">```</span></span>
<span id="cb301-1678"><a href="#cb301-1678"></a></span>
<span id="cb301-1681"><a href="#cb301-1681"></a><span class="in">```{r}</span></span>
<span id="cb301-1682"><a href="#cb301-1682"></a><span class="do">## plotting results of the model</span></span>
<span id="cb301-1683"><a href="#cb301-1683"></a></span>
<span id="cb301-1684"><a href="#cb301-1684"></a><span class="do">##png('./imgs/figure4.png', width = 7, height = 7, units = 'in',</span></span>
<span id="cb301-1685"><a href="#cb301-1685"></a><span class="do">##    res = 360)</span></span>
<span id="cb301-1686"><a href="#cb301-1686"></a><span class="do">##pdf('./imgs/figuer4.pdf')</span></span>
<span id="cb301-1687"><a href="#cb301-1687"></a></span>
<span id="cb301-1688"><a href="#cb301-1688"></a></span>
<span id="cb301-1689"><a href="#cb301-1689"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>)</span>
<span id="cb301-1690"><a href="#cb301-1690"></a></span>
<span id="cb301-1691"><a href="#cb301-1691"></a><span class="fu">dim</span>(data.tb)</span>
<span id="cb301-1692"><a href="#cb301-1692"></a>pred.mod <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">range =</span> <span class="fu">seq</span>(<span class="fu">min</span>(data.tb<span class="sc">$</span>range),</span>
<span id="cb301-1693"><a href="#cb301-1693"></a>                                   <span class="fu">max</span>(data.tb<span class="sc">$</span>range),</span>
<span id="cb301-1694"><a href="#cb301-1694"></a>                                   <span class="at">len =</span> <span class="dv">214</span>),</span>
<span id="cb301-1695"><a href="#cb301-1695"></a>                       <span class="at">Foraging.mode =</span> data.tb<span class="sc">$</span>Foraging.mode,</span>
<span id="cb301-1696"><a href="#cb301-1696"></a>                       <span class="at">row.names =</span> <span class="fu">rownames</span>(data.tb))</span>
<span id="cb301-1697"><a href="#cb301-1697"></a>pred.mod<span class="sc">$</span>mean.tb <span class="ot">&lt;-</span> <span class="fu">predict</span>(tb.model9, pred.mod,</span>
<span id="cb301-1698"><a href="#cb301-1698"></a>                            <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>fit</span>
<span id="cb301-1699"><a href="#cb301-1699"></a>pred.mod<span class="sc">$</span>se <span class="ot">&lt;-</span> <span class="fu">predict</span>(tb.model9, pred.mod,</span>
<span id="cb301-1700"><a href="#cb301-1700"></a>                       <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>se.fit</span>
<span id="cb301-1701"><a href="#cb301-1701"></a><span class="fu">head</span>(pred.mod)</span>
<span id="cb301-1702"><a href="#cb301-1702"></a></span>
<span id="cb301-1703"><a href="#cb301-1703"></a>active <span class="ot">&lt;-</span> pred.mod[data.tb<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'active'</span>, ]</span>
<span id="cb301-1704"><a href="#cb301-1704"></a>plastic <span class="ot">&lt;-</span> pred.mod[data.tb<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'plastic'</span>, ]</span>
<span id="cb301-1705"><a href="#cb301-1705"></a>sit.and.wait <span class="ot">&lt;-</span> pred.mod[data.tb<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">'sit-and-wait'</span>, ]</span>
<span id="cb301-1706"><a href="#cb301-1706"></a></span>
<span id="cb301-1707"><a href="#cb301-1707"></a></span>
<span id="cb301-1708"><a href="#cb301-1708"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb301-1709"><a href="#cb301-1709"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-1710"><a href="#cb301-1710"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-1711"><a href="#cb301-1711"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb301-1712"><a href="#cb301-1712"></a></span>
<span id="cb301-1713"><a href="#cb301-1713"></a></span>
<span id="cb301-1714"><a href="#cb301-1714"></a><span class="fu">par</span>(<span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb301-1715"><a href="#cb301-1715"></a></span>
<span id="cb301-1716"><a href="#cb301-1716"></a><span class="fu">plot</span>(mean.tb <span class="sc">~</span> range, <span class="at">data =</span> data.tb,</span>
<span id="cb301-1717"><a href="#cb301-1717"></a>     <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb301-1718"><a href="#cb301-1718"></a>     <span class="at">bg =</span> cols[<span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(data.tb<span class="sc">$</span>Foraging.mode))],</span>
<span id="cb301-1719"><a href="#cb301-1719"></a>     <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>, <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb301-1720"><a href="#cb301-1720"></a>     <span class="at">type =</span> <span class="st">'n'</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-1721"><a href="#cb301-1721"></a></span>
<span id="cb301-1722"><a href="#cb301-1722"></a><span class="fu">grid</span>(<span class="at">nx =</span> <span class="cn">NULL</span>, <span class="at">ny =</span> <span class="cn">NULL</span>, <span class="at">col =</span> <span class="st">"lightgray"</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb301-1723"><a href="#cb301-1723"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-1724"><a href="#cb301-1724"></a></span>
<span id="cb301-1725"><a href="#cb301-1725"></a><span class="fu">plot</span>(mean.tb <span class="sc">~</span> range, <span class="at">data =</span> data.tb,</span>
<span id="cb301-1726"><a href="#cb301-1726"></a>     <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb301-1727"><a href="#cb301-1727"></a>     <span class="at">bg =</span> cols[<span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(data.tb<span class="sc">$</span>Foraging.mode))],</span>
<span id="cb301-1728"><a href="#cb301-1728"></a>     <span class="at">col =</span> <span class="st">'black'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">"Area of geographic range"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(km<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb301-1729"><a href="#cb301-1729"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Mean body temperature"</span><span class="sc">~</span>(<span class="st">'\u00B0C'</span>)), <span class="at">type =</span> <span class="st">'p'</span>)</span>
<span id="cb301-1730"><a href="#cb301-1730"></a></span>
<span id="cb301-1731"><a href="#cb301-1731"></a><span class="fu">lines</span>(active<span class="sc">$</span>mean.tb <span class="sc">~</span> active<span class="sc">$</span>range,</span>
<span id="cb301-1732"><a href="#cb301-1732"></a>      <span class="at">data =</span> active, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>)</span>
<span id="cb301-1733"><a href="#cb301-1733"></a></span>
<span id="cb301-1734"><a href="#cb301-1734"></a><span class="fu">lines</span>(plastic<span class="sc">$</span>mean.tb <span class="sc">~</span> plastic<span class="sc">$</span>range,</span>
<span id="cb301-1735"><a href="#cb301-1735"></a>      <span class="at">data =</span> plastic, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'green4'</span>)</span>
<span id="cb301-1736"><a href="#cb301-1736"></a></span>
<span id="cb301-1737"><a href="#cb301-1737"></a><span class="fu">lines</span>(sit.and.wait<span class="sc">$</span>mean.tb <span class="sc">~</span> sit.and.wait<span class="sc">$</span>range,</span>
<span id="cb301-1738"><a href="#cb301-1738"></a>      <span class="at">data =</span> sit.and.wait, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>)</span>
<span id="cb301-1739"><a href="#cb301-1739"></a></span>
<span id="cb301-1740"><a href="#cb301-1740"></a><span class="fu">legend</span>(<span class="st">'bottomright'</span>,</span>
<span id="cb301-1741"><a href="#cb301-1741"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">'active'</span>, <span class="st">'plastic'</span>,</span>
<span id="cb301-1742"><a href="#cb301-1742"></a>                  <span class="st">'sit-and-wait'</span>), <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb301-1743"><a href="#cb301-1743"></a>       <span class="at">pt.bg =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>),</span>
<span id="cb301-1744"><a href="#cb301-1744"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>), <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb301-1745"><a href="#cb301-1745"></a>       <span class="at">bty =</span> <span class="st">'n'</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb301-1746"><a href="#cb301-1746"></a><span class="fu">mtext</span>(<span class="st">'A'</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.7</span>, <span class="at">at =</span> <span class="dv">45</span>, <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb301-1747"><a href="#cb301-1747"></a></span>
<span id="cb301-1748"><a href="#cb301-1748"></a></span>
<span id="cb301-1749"><a href="#cb301-1749"></a><span class="do">## Distribution of residuals</span></span>
<span id="cb301-1750"><a href="#cb301-1750"></a></span>
<span id="cb301-1751"><a href="#cb301-1751"></a>res.act <span class="ot">&lt;-</span> <span class="fu">density</span>(<span class="fu">residuals</span>(tb.model9)[data.tb<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"active"</span>])</span>
<span id="cb301-1752"><a href="#cb301-1752"></a>res.pla <span class="ot">&lt;-</span> <span class="fu">density</span>(<span class="fu">residuals</span>(tb.model9)[data.tb<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"plastic"</span>])</span>
<span id="cb301-1753"><a href="#cb301-1753"></a>res.sit <span class="ot">&lt;-</span> <span class="fu">density</span>(<span class="fu">residuals</span>(tb.model9)[data.tb<span class="sc">$</span>Foraging.mode <span class="sc">==</span> <span class="st">"sit-and-wait"</span>])</span>
<span id="cb301-1754"><a href="#cb301-1754"></a></span>
<span id="cb301-1755"><a href="#cb301-1755"></a><span class="fu">plot</span>(<span class="cn">NA</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(res.act<span class="sc">$</span>y)),</span>
<span id="cb301-1756"><a href="#cb301-1756"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fu">min</span>(res.pla<span class="sc">$</span>x), <span class="fu">max</span>(res.pla<span class="sc">$</span>x)),</span>
<span id="cb301-1757"><a href="#cb301-1757"></a>     <span class="at">ann =</span> <span class="cn">FALSE</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">xaxt =</span> <span class="st">"n"</span>,</span>
<span id="cb301-1758"><a href="#cb301-1758"></a>     <span class="at">yaxt =</span> <span class="st">"n"</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb301-1759"><a href="#cb301-1759"></a><span class="fu">grid</span>()</span>
<span id="cb301-1760"><a href="#cb301-1760"></a></span>
<span id="cb301-1761"><a href="#cb301-1761"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>, <span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb301-1762"><a href="#cb301-1762"></a><span class="fu">plot</span>(res.act, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(res.act<span class="sc">$</span>y)),</span>
<span id="cb301-1763"><a href="#cb301-1763"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fu">min</span>(res.pla<span class="sc">$</span>x), <span class="fu">max</span>(res.pla<span class="sc">$</span>x)),</span>
<span id="cb301-1764"><a href="#cb301-1764"></a>     <span class="at">xlab =</span> <span class="st">'Residuals'</span>,</span>
<span id="cb301-1765"><a href="#cb301-1765"></a>     <span class="at">ylab =</span> <span class="st">'Density'</span>,</span>
<span id="cb301-1766"><a href="#cb301-1766"></a>     <span class="at">type =</span> <span class="st">'n'</span>, <span class="at">main =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb301-1767"><a href="#cb301-1767"></a></span>
<span id="cb301-1768"><a href="#cb301-1768"></a><span class="fu">polygon</span>(res.act,</span>
<span id="cb301-1769"><a href="#cb301-1769"></a>        <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">'#39568CFF'</span>, <span class="fl">0.3</span>),</span>
<span id="cb301-1770"><a href="#cb301-1770"></a>        <span class="at">border =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-1771"><a href="#cb301-1771"></a><span class="fu">polygon</span>(res.pla,</span>
<span id="cb301-1772"><a href="#cb301-1772"></a>        <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">'green4'</span>, <span class="fl">0.3</span>),</span>
<span id="cb301-1773"><a href="#cb301-1773"></a>        <span class="at">border =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-1774"><a href="#cb301-1774"></a><span class="fu">polygon</span>(res.sit,</span>
<span id="cb301-1775"><a href="#cb301-1775"></a>        <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">'#DCE319FF'</span>, <span class="fl">0.3</span>),</span>
<span id="cb301-1776"><a href="#cb301-1776"></a>        <span class="at">border =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-1777"><a href="#cb301-1777"></a></span>
<span id="cb301-1778"><a href="#cb301-1778"></a><span class="fu">legend</span>(<span class="st">'topleft'</span>,</span>
<span id="cb301-1779"><a href="#cb301-1779"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">'active'</span>, <span class="st">'plastic'</span>,</span>
<span id="cb301-1780"><a href="#cb301-1780"></a>                  <span class="st">'sit-and-wait'</span>),</span>
<span id="cb301-1781"><a href="#cb301-1781"></a>       <span class="at">fill =</span> <span class="fu">alpha</span>(<span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>,</span>
<span id="cb301-1782"><a href="#cb301-1782"></a>                      <span class="st">'#DCE319FF'</span>), <span class="fl">0.3</span>),</span>
<span id="cb301-1783"><a href="#cb301-1783"></a>       <span class="at">bty =</span> <span class="st">'n'</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb301-1784"><a href="#cb301-1784"></a><span class="fu">mtext</span>(<span class="st">'B'</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">3.1</span>, <span class="at">at =</span> <span class="fl">0.127</span>, <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb301-1785"><a href="#cb301-1785"></a></span>
<span id="cb301-1786"><a href="#cb301-1786"></a><span class="do">##dev.off()</span></span>
<span id="cb301-1787"><a href="#cb301-1787"></a></span>
<span id="cb301-1788"><a href="#cb301-1788"></a><span class="in">```</span></span>
<span id="cb301-1789"><a href="#cb301-1789"></a></span>
<span id="cb301-1790"><a href="#cb301-1790"></a></span>
<span id="cb301-1793"><a href="#cb301-1793"></a><span class="in">```{r}</span></span>
<span id="cb301-1794"><a href="#cb301-1794"></a><span class="do">## Checking homogeneity of variance</span></span>
<span id="cb301-1795"><a href="#cb301-1795"></a></span>
<span id="cb301-1796"><a href="#cb301-1796"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb301-1797"><a href="#cb301-1797"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-1798"><a href="#cb301-1798"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-1799"><a href="#cb301-1799"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb301-1800"><a href="#cb301-1800"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb301-1801"><a href="#cb301-1801"></a></span>
<span id="cb301-1802"><a href="#cb301-1802"></a><span class="fu">par</span>(<span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb301-1803"><a href="#cb301-1803"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(tb.model9), <span class="fu">resid</span>(tb.model9),</span>
<span id="cb301-1804"><a href="#cb301-1804"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb301-1805"><a href="#cb301-1805"></a>     <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">xlab =</span> <span class="st">''</span>)</span>
<span id="cb301-1806"><a href="#cb301-1806"></a></span>
<span id="cb301-1807"><a href="#cb301-1807"></a><span class="fu">grid</span>()</span>
<span id="cb301-1808"><a href="#cb301-1808"></a></span>
<span id="cb301-1809"><a href="#cb301-1809"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-1810"><a href="#cb301-1810"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(tb.model9), <span class="fu">resid</span>(tb.model9),</span>
<span id="cb301-1811"><a href="#cb301-1811"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">"Fitted"</span>,</span>
<span id="cb301-1812"><a href="#cb301-1812"></a>     <span class="at">ylab =</span> <span class="st">"Residual"</span>, <span class="at">main =</span> <span class="st">"Fitted versus Residuals"</span>,</span>
<span id="cb301-1813"><a href="#cb301-1813"></a>     <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb301-1814"><a href="#cb301-1814"></a></span>
<span id="cb301-1815"><a href="#cb301-1815"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"darkorange"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb301-1816"><a href="#cb301-1816"></a></span>
<span id="cb301-1817"><a href="#cb301-1817"></a></span>
<span id="cb301-1818"><a href="#cb301-1818"></a><span class="do">## Checking normality</span></span>
<span id="cb301-1819"><a href="#cb301-1819"></a></span>
<span id="cb301-1820"><a href="#cb301-1820"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(tb.model9), <span class="at">col =</span> <span class="st">"darkgrey"</span>,</span>
<span id="cb301-1821"><a href="#cb301-1821"></a>       <span class="at">type =</span> <span class="st">'n'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="st">''</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb301-1822"><a href="#cb301-1822"></a>       <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb301-1823"><a href="#cb301-1823"></a></span>
<span id="cb301-1824"><a href="#cb301-1824"></a><span class="fu">grid</span>()</span>
<span id="cb301-1825"><a href="#cb301-1825"></a></span>
<span id="cb301-1826"><a href="#cb301-1826"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-1827"><a href="#cb301-1827"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(tb.model9), <span class="at">col =</span> <span class="st">"darkgrey"</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb301-1828"><a href="#cb301-1828"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(tb.model9), <span class="at">col =</span> <span class="st">"dodgerblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb301-1829"><a href="#cb301-1829"></a></span>
<span id="cb301-1830"><a href="#cb301-1830"></a><span class="in">```</span></span>
<span id="cb301-1831"><a href="#cb301-1831"></a></span>
<span id="cb301-1834"><a href="#cb301-1834"></a><span class="in">```{r}</span></span>
<span id="cb301-1835"><a href="#cb301-1835"></a>genomes <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"squamates-comparative-genomic-data.tsv"</span>,</span>
<span id="cb301-1836"><a href="#cb301-1836"></a>                      <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb301-1837"><a href="#cb301-1837"></a></span>
<span id="cb301-1838"><a href="#cb301-1838"></a><span class="fu">names</span>(genomes)</span>
<span id="cb301-1839"><a href="#cb301-1839"></a>genome.annotation <span class="ot">&lt;-</span> genomes[ , <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">12</span><span class="sc">:</span><span class="dv">14</span>, <span class="dv">17</span><span class="sc">:</span><span class="dv">18</span>, <span class="dv">21</span><span class="sc">:</span><span class="dv">22</span>, <span class="dv">27</span><span class="sc">:</span><span class="dv">29</span>)]</span>
<span id="cb301-1840"><a href="#cb301-1840"></a></span>
<span id="cb301-1841"><a href="#cb301-1841"></a><span class="fu">names</span>(genome.annotation) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'species'</span>, <span class="st">'genome.size'</span>, <span class="st">'chr.number'</span>, <span class="st">'assem.level'</span>, <span class="st">'contig.N50'</span>,</span>
<span id="cb301-1842"><a href="#cb301-1842"></a>                              <span class="st">'scaffold.N50'</span>,</span>
<span id="cb301-1843"><a href="#cb301-1843"></a>                              <span class="st">'BUSCO.single.copy'</span>,</span>
<span id="cb301-1844"><a href="#cb301-1844"></a>                              <span class="st">'BUSCO.duplicate'</span>,</span>
<span id="cb301-1845"><a href="#cb301-1845"></a>                              <span class="st">'total.gene.number'</span>,</span>
<span id="cb301-1846"><a href="#cb301-1846"></a>                              <span class="st">'protein.coding.genes'</span>,</span>
<span id="cb301-1847"><a href="#cb301-1847"></a>                              <span class="st">'pseudogene.number'</span>)</span>
<span id="cb301-1848"><a href="#cb301-1848"></a><span class="fu">head</span>(genome.annotation)</span>
<span id="cb301-1849"><a href="#cb301-1849"></a>genome.annotation<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">' '</span>, <span class="st">'_'</span>,</span>
<span id="cb301-1850"><a href="#cb301-1850"></a>                                  genome.annotation<span class="sc">$</span>species)</span>
<span id="cb301-1851"><a href="#cb301-1851"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Crotalus_viridis_viridis"</span>] <span class="ot">&lt;-</span> <span class="st">"Crotalus_viridis"</span></span>
<span id="cb301-1852"><a href="#cb301-1852"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Elgaria_multicarinata_webbii"</span>] <span class="ot">&lt;-</span> <span class="st">"Elgaria_multicarinata"</span></span>
<span id="cb301-1853"><a href="#cb301-1853"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Coluber_constrictor_foxii"</span>] <span class="ot">&lt;-</span> <span class="st">"Coluber_constrictor"</span></span>
<span id="cb301-1854"><a href="#cb301-1854"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Diadophis_punctatus_similis"</span>] <span class="ot">&lt;-</span> <span class="st">"Diadophis_punctatus"</span></span>
<span id="cb301-1855"><a href="#cb301-1855"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Pituophis_catenifer_annectens"</span>] <span class="ot">&lt;-</span> <span class="st">"Pituophis_catenifer"</span></span>
<span id="cb301-1856"><a href="#cb301-1856"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Plestiodon_gilberti_rubricaudatus"</span>] <span class="ot">&lt;-</span> <span class="st">"Plestiodon_gilberti"</span></span>
<span id="cb301-1857"><a href="#cb301-1857"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Aspidoscelis_tigris_stejnegeri"</span>] <span class="ot">&lt;-</span> <span class="st">"Aspidoscelis_tigris"</span></span>
<span id="cb301-1858"><a href="#cb301-1858"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Varanus_salvator_macromaculatus"</span>] <span class="ot">&lt;-</span> <span class="st">"Varanus_salvator"</span></span>
<span id="cb301-1859"><a href="#cb301-1859"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Podarcis_muralis_nigriventris"</span>] <span class="ot">&lt;-</span> <span class="st">"Podarcis_muralis"</span></span>
<span id="cb301-1860"><a href="#cb301-1860"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Dibamus_cf._smithi"</span>] <span class="ot">&lt;-</span> <span class="st">"Dibamus_smithi"</span></span>
<span id="cb301-1861"><a href="#cb301-1861"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Thamnophis_sirtalis_fitchi"</span>] <span class="ot">&lt;-</span> <span class="st">"Thamnophis_sirtalis"</span></span>
<span id="cb301-1862"><a href="#cb301-1862"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Elgaria_multicarinata_webbii"</span>] <span class="ot">&lt;-</span> <span class="st">"Elgaria_multicarinata"</span></span>
<span id="cb301-1863"><a href="#cb301-1863"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Coluber_constrictor_foxii"</span>] <span class="ot">&lt;-</span> <span class="st">"Coluber_constrictor"</span></span>
<span id="cb301-1864"><a href="#cb301-1864"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Diadophis_punctatus_similis"</span>] <span class="ot">&lt;-</span> <span class="st">"Diadophis_punctatus"</span></span>
<span id="cb301-1865"><a href="#cb301-1865"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Pituophis_catenifer_annectens"</span>] <span class="ot">&lt;-</span> <span class="st">"Pituophis_catenifer"</span></span>
<span id="cb301-1866"><a href="#cb301-1866"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Pituophis_catenifer_pumilus"</span>] <span class="ot">&lt;-</span> <span class="st">"Pituophis_catenifer"</span></span>
<span id="cb301-1867"><a href="#cb301-1867"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Vipera_berus_berus"</span>] <span class="ot">&lt;-</span> <span class="st">"Vipera_berus"</span></span>
<span id="cb301-1868"><a href="#cb301-1868"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Plestiodon_gilberti_rubricaudatus"</span>] <span class="ot">&lt;-</span> <span class="st">"Plestiodon_gilberti"</span></span>
<span id="cb301-1869"><a href="#cb301-1869"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Aspidoscelis_tigris_stejnegeri"</span>] <span class="ot">&lt;-</span> <span class="st">"Aspidoscelis_tigris"</span></span>
<span id="cb301-1870"><a href="#cb301-1870"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Natrix_helvetica_helvetica"</span>] <span class="ot">&lt;-</span> <span class="st">"Natrix_helvetica"</span></span>
<span id="cb301-1871"><a href="#cb301-1871"></a>genome.annotation<span class="sc">$</span>species[genome.annotation<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"Anolis_sagrei_ordinatus"</span>] <span class="ot">&lt;-</span> <span class="st">"Anolis_sagrei"</span></span>
<span id="cb301-1872"><a href="#cb301-1872"></a></span>
<span id="cb301-1873"><a href="#cb301-1873"></a>geno.size <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(genome.annotation<span class="sc">$</span>genome.size, <span class="at">by =</span> <span class="fu">list</span>(genome.annotation<span class="sc">$</span>species), mean)</span>
<span id="cb301-1874"><a href="#cb301-1874"></a><span class="fu">names</span>(geno.size) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Species'</span>, <span class="st">'genome.size'</span>)</span>
<span id="cb301-1875"><a href="#cb301-1875"></a><span class="fu">rownames</span>(geno.size) <span class="ot">&lt;-</span> geno.size<span class="sc">$</span>Species</span>
<span id="cb301-1876"><a href="#cb301-1876"></a></span>
<span id="cb301-1877"><a href="#cb301-1877"></a>check <span class="ot">&lt;-</span> <span class="fu">name.check</span>(lizard.tree, geno.size)</span>
<span id="cb301-1878"><a href="#cb301-1878"></a>rm_phy <span class="ot">&lt;-</span> check<span class="sc">$</span>tree_not_data</span>
<span id="cb301-1879"><a href="#cb301-1879"></a>rm_dat <span class="ot">&lt;-</span> check<span class="sc">$</span>data_not_tree</span>
<span id="cb301-1880"><a href="#cb301-1880"></a>geno.size.tree <span class="ot">&lt;-</span> <span class="fu">drop.tip</span>(lizard.tree, rm_phy)</span>
<span id="cb301-1881"><a href="#cb301-1881"></a></span>
<span id="cb301-1882"><a href="#cb301-1882"></a>pruned.geno.size.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(geno.size,</span>
<span id="cb301-1883"><a href="#cb301-1883"></a>                      <span class="at">subset =</span> <span class="fu">rownames</span>(geno.size) <span class="sc">%in%</span> geno.size.tree<span class="sc">$</span>tip,</span>
<span id="cb301-1884"><a href="#cb301-1884"></a>                      <span class="at">select =</span> <span class="fu">names</span>(geno.size))</span>
<span id="cb301-1885"><a href="#cb301-1885"></a><span class="fu">name.check</span>(geno.size.tree, pruned.geno.size.data)</span>
<span id="cb301-1886"><a href="#cb301-1886"></a><span class="fu">str</span>(pruned.geno.size.data)</span>
<span id="cb301-1887"><a href="#cb301-1887"></a>geno.size.tree</span>
<span id="cb301-1888"><a href="#cb301-1888"></a></span>
<span id="cb301-1889"><a href="#cb301-1889"></a>pruned.geno.size.data <span class="ot">&lt;-</span> <span class="fu">merge</span>(pruned.geno.size.data, pruned.data, <span class="at">by =</span> <span class="st">'Species'</span>)</span>
<span id="cb301-1890"><a href="#cb301-1890"></a></span>
<span id="cb301-1891"><a href="#cb301-1891"></a><span class="fu">tapply</span>(<span class="at">X =</span> pruned.geno.size.data<span class="sc">$</span>Species,</span>
<span id="cb301-1892"><a href="#cb301-1892"></a>       <span class="at">INDEX =</span> <span class="fu">list</span>(pruned.geno.size.data<span class="sc">$</span>Foraging.mode),</span>
<span id="cb301-1893"><a href="#cb301-1893"></a>       <span class="at">FUN =</span> <span class="cf">function</span>(X) <span class="fu">length</span>(<span class="fu">na.omit</span>(X)))</span>
<span id="cb301-1894"><a href="#cb301-1894"></a></span>
<span id="cb301-1895"><a href="#cb301-1895"></a><span class="fu">rownames</span>(pruned.geno.size.data) <span class="ot">&lt;-</span> pruned.geno.size.data<span class="sc">$</span>Species</span>
<span id="cb301-1896"><a href="#cb301-1896"></a><span class="fu">names</span>(pruned.geno.size.data)</span>
<span id="cb301-1897"><a href="#cb301-1897"></a><span class="fu">names</span>(pruned.geno.size.data)[<span class="dv">15</span>] <span class="ot">&lt;-</span> <span class="st">'max.body.mass'</span></span>
<span id="cb301-1898"><a href="#cb301-1898"></a>pruned.geno.size.data<span class="sc">$</span>max.body.mass <span class="ot">&lt;-</span> <span class="fu">log10</span>(pruned.geno.size.data<span class="sc">$</span>max.body.mass)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb301-1899"><a href="#cb301-1899"></a>pruned.geno.size.data<span class="sc">$</span>genome.size <span class="ot">&lt;-</span> <span class="fu">log10</span>(pruned.geno.size.data<span class="sc">$</span>genome.size)</span>
<span id="cb301-1900"><a href="#cb301-1900"></a><span class="fu">head</span>(pruned.geno.size.data[ , <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">13</span>, <span class="dv">15</span>)])</span>
<span id="cb301-1901"><a href="#cb301-1901"></a></span>
<span id="cb301-1902"><a href="#cb301-1902"></a></span>
<span id="cb301-1903"><a href="#cb301-1903"></a><span class="do">## modeling genome size among foraging behavior categories</span></span>
<span id="cb301-1904"><a href="#cb301-1904"></a></span>
<span id="cb301-1905"><a href="#cb301-1905"></a>gs.model1 <span class="ot">&lt;-</span> <span class="fu">gls</span>(genome.size <span class="sc">~</span> Foraging.mode<span class="sc">*</span>max.body.mass,</span>
<span id="cb301-1906"><a href="#cb301-1906"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-1907"><a href="#cb301-1907"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> geno.size.tree,</span>
<span id="cb301-1908"><a href="#cb301-1908"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1909"><a href="#cb301-1909"></a>                     <span class="at">data =</span> pruned.geno.size.data, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1910"><a href="#cb301-1910"></a></span>
<span id="cb301-1911"><a href="#cb301-1911"></a></span>
<span id="cb301-1912"><a href="#cb301-1912"></a>gs.model2 <span class="ot">&lt;-</span> <span class="fu">gls</span>(genome.size <span class="sc">~</span> Foraging.mode <span class="sc">+</span> max.body.mass,</span>
<span id="cb301-1913"><a href="#cb301-1913"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-1914"><a href="#cb301-1914"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> geno.size.tree,</span>
<span id="cb301-1915"><a href="#cb301-1915"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1916"><a href="#cb301-1916"></a>                     <span class="at">data =</span> pruned.geno.size.data, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1917"><a href="#cb301-1917"></a></span>
<span id="cb301-1918"><a href="#cb301-1918"></a></span>
<span id="cb301-1919"><a href="#cb301-1919"></a>gs.model3 <span class="ot">&lt;-</span> <span class="fu">gls</span>(genome.size <span class="sc">~</span> Foraging.mode,</span>
<span id="cb301-1920"><a href="#cb301-1920"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-1921"><a href="#cb301-1921"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> geno.size.tree,</span>
<span id="cb301-1922"><a href="#cb301-1922"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1923"><a href="#cb301-1923"></a>                 <span class="at">data =</span> pruned.geno.size.data, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1924"><a href="#cb301-1924"></a></span>
<span id="cb301-1925"><a href="#cb301-1925"></a></span>
<span id="cb301-1926"><a href="#cb301-1926"></a>gs.model4 <span class="ot">&lt;-</span> <span class="fu">gls</span>(genome.size <span class="sc">~</span> max.body.mass,</span>
<span id="cb301-1927"><a href="#cb301-1927"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-1928"><a href="#cb301-1928"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> geno.size.tree,</span>
<span id="cb301-1929"><a href="#cb301-1929"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-1930"><a href="#cb301-1930"></a>                     <span class="at">data =</span> pruned.geno.size.data, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-1931"><a href="#cb301-1931"></a></span>
<span id="cb301-1932"><a href="#cb301-1932"></a></span>
<span id="cb301-1933"><a href="#cb301-1933"></a></span>
<span id="cb301-1934"><a href="#cb301-1934"></a>gs.models <span class="ot">&lt;-</span> <span class="fu">anova</span>(gs.model1, gs.model2,</span>
<span id="cb301-1935"><a href="#cb301-1935"></a>                   gs.model3, gs.model4)</span>
<span id="cb301-1936"><a href="#cb301-1936"></a><span class="fu">round</span>(<span class="fu">aicw</span>(<span class="fu">setNames</span>(gs.models<span class="sc">$</span>AIC,</span>
<span id="cb301-1937"><a href="#cb301-1937"></a>                    <span class="fu">rownames</span>(gs.models))), <span class="dv">3</span>)</span>
<span id="cb301-1938"><a href="#cb301-1938"></a>gs.lmodel1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(genome.size <span class="sc">~</span> Foraging.mode<span class="sc">*</span>max.body.mass,</span>
<span id="cb301-1939"><a href="#cb301-1939"></a>                 <span class="at">data =</span> pruned.geno.size.data)</span>
<span id="cb301-1940"><a href="#cb301-1940"></a><span class="fu">summary</span>(gs.model1)</span>
<span id="cb301-1941"><a href="#cb301-1941"></a><span class="fu">summary</span>(gs.lmodel1)</span>
<span id="cb301-1942"><a href="#cb301-1942"></a></span>
<span id="cb301-1943"><a href="#cb301-1943"></a><span class="do">## estimating differences in genome size mean among foraging</span></span>
<span id="cb301-1944"><a href="#cb301-1944"></a><span class="do">## behavior categories</span></span>
<span id="cb301-1945"><a href="#cb301-1945"></a></span>
<span id="cb301-1946"><a href="#cb301-1946"></a><span class="fu">anova</span>(gs.model1, gs.lmodel1)</span>
<span id="cb301-1947"><a href="#cb301-1947"></a></span>
<span id="cb301-1948"><a href="#cb301-1948"></a><span class="do">## running an anova over the most likely model</span></span>
<span id="cb301-1949"><a href="#cb301-1949"></a></span>
<span id="cb301-1950"><a href="#cb301-1950"></a><span class="fu">anova</span>(gs.lmodel1)</span>
<span id="cb301-1951"><a href="#cb301-1951"></a></span>
<span id="cb301-1952"><a href="#cb301-1952"></a><span class="do">## computing genome size mean among foraging behavior categories</span></span>
<span id="cb301-1953"><a href="#cb301-1953"></a></span>
<span id="cb301-1954"><a href="#cb301-1954"></a><span class="fu">tapply</span>(pruned.geno.size.data<span class="sc">$</span>genome.size,</span>
<span id="cb301-1955"><a href="#cb301-1955"></a>       <span class="fu">list</span>(pruned.geno.size.data<span class="sc">$</span>Foraging.mode), mean)</span>
<span id="cb301-1956"><a href="#cb301-1956"></a></span>
<span id="cb301-1957"><a href="#cb301-1957"></a><span class="do">## plotting raw data</span></span>
<span id="cb301-1958"><a href="#cb301-1958"></a></span>
<span id="cb301-1959"><a href="#cb301-1959"></a></span>
<span id="cb301-1960"><a href="#cb301-1960"></a><span class="fu">dim</span>(pruned.geno.size.data)</span>
<span id="cb301-1961"><a href="#cb301-1961"></a>pred.mod <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">max.body.mass =</span> <span class="fu">seq</span>(<span class="fu">min</span>(pruned.geno.size.data<span class="sc">$</span>max.body.mass),</span>
<span id="cb301-1962"><a href="#cb301-1962"></a>                                       <span class="fu">max</span>(pruned.geno.size.data<span class="sc">$</span>max.body.mass),</span>
<span id="cb301-1963"><a href="#cb301-1963"></a>                                       <span class="at">len =</span> <span class="dv">99</span>),</span>
<span id="cb301-1964"><a href="#cb301-1964"></a>                       <span class="at">Foraging.mode =</span> pruned.geno.size.data<span class="sc">$</span>Foraging.mode,</span>
<span id="cb301-1965"><a href="#cb301-1965"></a>                       <span class="at">row.names =</span> <span class="fu">rownames</span>(pruned.geno.size.data))</span>
<span id="cb301-1966"><a href="#cb301-1966"></a></span>
<span id="cb301-1967"><a href="#cb301-1967"></a>pred.mod<span class="sc">$</span>genome.size <span class="ot">&lt;-</span> <span class="fu">predict</span>(gs.lmodel1, pred.mod,</span>
<span id="cb301-1968"><a href="#cb301-1968"></a>                          <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>fit</span>
<span id="cb301-1969"><a href="#cb301-1969"></a>pred.mod<span class="sc">$</span>se <span class="ot">&lt;-</span> <span class="fu">predict</span>(gs.lmodel1, pred.mod,</span>
<span id="cb301-1970"><a href="#cb301-1970"></a>                       <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>se.fit</span>
<span id="cb301-1971"><a href="#cb301-1971"></a></span>
<span id="cb301-1972"><a href="#cb301-1972"></a></span>
<span id="cb301-1973"><a href="#cb301-1973"></a></span>
<span id="cb301-1974"><a href="#cb301-1974"></a><span class="do">## Plotting results of the model</span></span>
<span id="cb301-1975"><a href="#cb301-1975"></a></span>
<span id="cb301-1976"><a href="#cb301-1976"></a></span>
<span id="cb301-1977"><a href="#cb301-1977"></a></span>
<span id="cb301-1978"><a href="#cb301-1978"></a><span class="do">##png('./imgs/figure5.png', width = 7, height = 7, units = 'in',</span></span>
<span id="cb301-1979"><a href="#cb301-1979"></a><span class="do">##    res = 360)</span></span>
<span id="cb301-1980"><a href="#cb301-1980"></a><span class="do">##pdf('./imgs/figuer5.pdf')</span></span>
<span id="cb301-1981"><a href="#cb301-1981"></a></span>
<span id="cb301-1982"><a href="#cb301-1982"></a></span>
<span id="cb301-1983"><a href="#cb301-1983"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>)</span>
<span id="cb301-1984"><a href="#cb301-1984"></a></span>
<span id="cb301-1985"><a href="#cb301-1985"></a></span>
<span id="cb301-1986"><a href="#cb301-1986"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(genome.size <span class="sc">~</span> max.body.mass <span class="sc">|</span> Foraging.mode,</span>
<span id="cb301-1987"><a href="#cb301-1987"></a>       <span class="at">data =</span> pruned.geno.size.data,</span>
<span id="cb301-1988"><a href="#cb301-1988"></a>       <span class="at">par.settings =</span> <span class="fu">list</span>(<span class="at">layout.widths =</span></span>
<span id="cb301-1989"><a href="#cb301-1989"></a>                               <span class="fu">list</span>(<span class="at">ylab.axis.padding =</span> <span class="dv">1</span>)),</span>
<span id="cb301-1990"><a href="#cb301-1990"></a>       <span class="at">superpose =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">"p"</span>,</span>
<span id="cb301-1991"><a href="#cb301-1991"></a>       <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Genome size"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(Mb)),       </span>
<span id="cb301-1992"><a href="#cb301-1992"></a>       <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">"Maximum body mass"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(g)),</span>
<span id="cb301-1993"><a href="#cb301-1993"></a>       <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">grid =</span> <span class="cn">TRUE</span>,</span>
<span id="cb301-1994"><a href="#cb301-1994"></a>       <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">strip =</span> <span class="cn">TRUE</span>, <span class="at">group =</span> Foraging.mode,</span>
<span id="cb301-1995"><a href="#cb301-1995"></a>       <span class="at">col =</span> cols, <span class="at">aspect =</span> <span class="fl">0.77</span>, <span class="at">bg =</span> <span class="st">"black"</span>,</span>
<span id="cb301-1996"><a href="#cb301-1996"></a>       <span class="at">scale =</span> <span class="fu">list</span>(<span class="at">alternating =</span> <span class="dv">1</span>, <span class="at">tck =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)))</span>
<span id="cb301-1997"><a href="#cb301-1997"></a></span>
<span id="cb301-1998"><a href="#cb301-1998"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(genome.size <span class="sc">~</span> max.body.mass <span class="sc">|</span> Foraging.mode,</span>
<span id="cb301-1999"><a href="#cb301-1999"></a>       <span class="at">data =</span> pred.mod,</span>
<span id="cb301-2000"><a href="#cb301-2000"></a>       <span class="at">superpose =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">"l"</span>,</span>
<span id="cb301-2001"><a href="#cb301-2001"></a>       <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Genome size"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(Mb)),       </span>
<span id="cb301-2002"><a href="#cb301-2002"></a>       <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">grid =</span> <span class="cn">FALSE</span>,</span>
<span id="cb301-2003"><a href="#cb301-2003"></a>       <span class="at">col.line =</span> <span class="fu">c</span>(<span class="st">"#39568CFF"</span>, <span class="st">"green4"</span>, <span class="st">"#DCE319FF"</span>),</span>
<span id="cb301-2004"><a href="#cb301-2004"></a>       <span class="at">strip =</span> <span class="cn">TRUE</span>, <span class="at">group =</span> Foraging.mode,</span>
<span id="cb301-2005"><a href="#cb301-2005"></a>       <span class="at">col =</span> cols, <span class="at">aspect =</span> <span class="fl">0.77</span>, <span class="at">bg =</span> <span class="st">"black"</span>,</span>
<span id="cb301-2006"><a href="#cb301-2006"></a>       <span class="at">scale =</span> <span class="fu">list</span>(<span class="at">alternating =</span> <span class="dv">1</span>, <span class="at">tck =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)))</span>
<span id="cb301-2007"><a href="#cb301-2007"></a></span>
<span id="cb301-2008"><a href="#cb301-2008"></a></span>
<span id="cb301-2009"><a href="#cb301-2009"></a>plot1 <span class="sc">+</span> <span class="fu">as.layer</span>(plot2)</span>
<span id="cb301-2010"><a href="#cb301-2010"></a></span>
<span id="cb301-2011"><a href="#cb301-2011"></a><span class="do">##dev.off()</span></span>
<span id="cb301-2012"><a href="#cb301-2012"></a></span>
<span id="cb301-2013"><a href="#cb301-2013"></a></span>
<span id="cb301-2014"><a href="#cb301-2014"></a></span>
<span id="cb301-2015"><a href="#cb301-2015"></a><span class="in">```</span></span>
<span id="cb301-2016"><a href="#cb301-2016"></a></span>
<span id="cb301-2017"><a href="#cb301-2017"></a></span>
<span id="cb301-2018"><a href="#cb301-2018"></a></span>
<span id="cb301-2021"><a href="#cb301-2021"></a><span class="in">```{r}</span></span>
<span id="cb301-2022"><a href="#cb301-2022"></a>gc.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"squamate-gc-values.csv"</span>)</span>
<span id="cb301-2023"><a href="#cb301-2023"></a><span class="fu">str</span>(gc.data)</span>
<span id="cb301-2024"><a href="#cb301-2024"></a></span>
<span id="cb301-2025"><a href="#cb301-2025"></a>gc.mean.data <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(gc.data<span class="sc">$</span>C.value,</span>
<span id="cb301-2026"><a href="#cb301-2026"></a>                          <span class="at">by =</span> <span class="fu">list</span>(gc.data<span class="sc">$</span>Species), mean)</span>
<span id="cb301-2027"><a href="#cb301-2027"></a><span class="fu">names</span>(gc.mean.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Species'</span>, <span class="st">'c.value'</span>)</span>
<span id="cb301-2028"><a href="#cb301-2028"></a>gc.mean.data<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, gc.mean.data<span class="sc">$</span>Species)</span>
<span id="cb301-2029"><a href="#cb301-2029"></a><span class="fu">rownames</span>(gc.mean.data) <span class="ot">&lt;-</span> gc.mean.data<span class="sc">$</span>Species</span>
<span id="cb301-2030"><a href="#cb301-2030"></a></span>
<span id="cb301-2031"><a href="#cb301-2031"></a>check <span class="ot">&lt;-</span> <span class="fu">name.check</span>(lizard.tree, gc.mean.data)</span>
<span id="cb301-2032"><a href="#cb301-2032"></a>rm_phy <span class="ot">&lt;-</span> check<span class="sc">$</span>tree_not_data</span>
<span id="cb301-2033"><a href="#cb301-2033"></a>rm_dat <span class="ot">&lt;-</span> check<span class="sc">$</span>data_not_tree</span>
<span id="cb301-2034"><a href="#cb301-2034"></a>gc.mean.data.tree <span class="ot">&lt;-</span> <span class="fu">drop.tip</span>(lizard.tree, rm_phy)</span>
<span id="cb301-2035"><a href="#cb301-2035"></a></span>
<span id="cb301-2036"><a href="#cb301-2036"></a>pruned.gc.mean.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(gc.mean.data,</span>
<span id="cb301-2037"><a href="#cb301-2037"></a>                      <span class="at">subset =</span> <span class="fu">rownames</span>(gc.mean.data) <span class="sc">%in%</span> gc.mean.data.tree<span class="sc">$</span>tip,</span>
<span id="cb301-2038"><a href="#cb301-2038"></a>                      <span class="at">select =</span> <span class="fu">names</span>(gc.mean.data))</span>
<span id="cb301-2039"><a href="#cb301-2039"></a><span class="fu">name.check</span>(gc.mean.data.tree, pruned.gc.mean.data)</span>
<span id="cb301-2040"><a href="#cb301-2040"></a><span class="fu">str</span>(pruned.gc.mean.data)</span>
<span id="cb301-2041"><a href="#cb301-2041"></a>gc.mean.data.tree</span>
<span id="cb301-2042"><a href="#cb301-2042"></a></span>
<span id="cb301-2043"><a href="#cb301-2043"></a>pruned.gc.data <span class="ot">&lt;-</span> <span class="fu">merge</span>(pruned.gc.mean.data, pruned.data, <span class="at">by =</span> <span class="st">'Species'</span>)</span>
<span id="cb301-2044"><a href="#cb301-2044"></a></span>
<span id="cb301-2045"><a href="#cb301-2045"></a><span class="fu">tapply</span>(<span class="at">X =</span> pruned.gc.data<span class="sc">$</span>Species,</span>
<span id="cb301-2046"><a href="#cb301-2046"></a>       <span class="at">INDEX =</span> <span class="fu">list</span>(pruned.gc.data<span class="sc">$</span>Foraging.mode),</span>
<span id="cb301-2047"><a href="#cb301-2047"></a>       <span class="at">FUN =</span> <span class="cf">function</span>(X) <span class="fu">length</span>(<span class="fu">na.omit</span>(X)))</span>
<span id="cb301-2048"><a href="#cb301-2048"></a></span>
<span id="cb301-2049"><a href="#cb301-2049"></a><span class="fu">rownames</span>(pruned.gc.data) <span class="ot">&lt;-</span> pruned.gc.data<span class="sc">$</span>Species</span>
<span id="cb301-2050"><a href="#cb301-2050"></a><span class="fu">names</span>(pruned.gc.data)</span>
<span id="cb301-2051"><a href="#cb301-2051"></a><span class="fu">names</span>(pruned.gc.data)[<span class="dv">15</span>] <span class="ot">&lt;-</span> <span class="st">'max.body.mass'</span></span>
<span id="cb301-2052"><a href="#cb301-2052"></a>pruned.gc.data<span class="sc">$</span>max.body.mass <span class="ot">&lt;-</span> <span class="fu">log10</span>(pruned.gc.data<span class="sc">$</span>max.body.mass)</span>
<span id="cb301-2053"><a href="#cb301-2053"></a><span class="fu">head</span>(pruned.gc.data[ , <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">13</span>, <span class="dv">15</span>)])</span>
<span id="cb301-2054"><a href="#cb301-2054"></a></span>
<span id="cb301-2055"><a href="#cb301-2055"></a></span>
<span id="cb301-2056"><a href="#cb301-2056"></a><span class="do">## modeling genome size among foraging behavior categories</span></span>
<span id="cb301-2057"><a href="#cb301-2057"></a></span>
<span id="cb301-2058"><a href="#cb301-2058"></a>gc.model1 <span class="ot">&lt;-</span> <span class="fu">gls</span>(c.value <span class="sc">~</span> Foraging.mode<span class="sc">*</span>max.body.mass,</span>
<span id="cb301-2059"><a href="#cb301-2059"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-2060"><a href="#cb301-2060"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gc.mean.data.tree,</span>
<span id="cb301-2061"><a href="#cb301-2061"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-2062"><a href="#cb301-2062"></a>                     <span class="at">data =</span> pruned.gc.data, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-2063"><a href="#cb301-2063"></a></span>
<span id="cb301-2064"><a href="#cb301-2064"></a></span>
<span id="cb301-2065"><a href="#cb301-2065"></a>gc.model2 <span class="ot">&lt;-</span> <span class="fu">gls</span>(c.value <span class="sc">~</span> Foraging.mode <span class="sc">+</span> max.body.mass,</span>
<span id="cb301-2066"><a href="#cb301-2066"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-2067"><a href="#cb301-2067"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gc.mean.data.tree,</span>
<span id="cb301-2068"><a href="#cb301-2068"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-2069"><a href="#cb301-2069"></a>                     <span class="at">data =</span> pruned.gc.data, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-2070"><a href="#cb301-2070"></a></span>
<span id="cb301-2071"><a href="#cb301-2071"></a></span>
<span id="cb301-2072"><a href="#cb301-2072"></a>gc.model3 <span class="ot">&lt;-</span> <span class="fu">gls</span>(c.value <span class="sc">~</span> Foraging.mode,</span>
<span id="cb301-2073"><a href="#cb301-2073"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-2074"><a href="#cb301-2074"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gc.mean.data.tree,</span>
<span id="cb301-2075"><a href="#cb301-2075"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-2076"><a href="#cb301-2076"></a>                 <span class="at">data =</span> pruned.gc.data, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-2077"><a href="#cb301-2077"></a></span>
<span id="cb301-2078"><a href="#cb301-2078"></a></span>
<span id="cb301-2079"><a href="#cb301-2079"></a>gc.model4 <span class="ot">&lt;-</span> <span class="fu">gls</span>(c.value <span class="sc">~</span> max.body.mass,</span>
<span id="cb301-2080"><a href="#cb301-2080"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-2081"><a href="#cb301-2081"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gc.mean.data.tree,</span>
<span id="cb301-2082"><a href="#cb301-2082"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-2083"><a href="#cb301-2083"></a>                     <span class="at">data =</span> pruned.gc.data, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-2084"><a href="#cb301-2084"></a></span>
<span id="cb301-2085"><a href="#cb301-2085"></a></span>
<span id="cb301-2086"><a href="#cb301-2086"></a></span>
<span id="cb301-2087"><a href="#cb301-2087"></a>gc.models <span class="ot">&lt;-</span> <span class="fu">anova</span>(gc.model1, gc.model2,</span>
<span id="cb301-2088"><a href="#cb301-2088"></a>                   gc.model3, gc.model4)</span>
<span id="cb301-2089"><a href="#cb301-2089"></a><span class="fu">round</span>(<span class="fu">aicw</span>(<span class="fu">setNames</span>(gc.models<span class="sc">$</span>AIC,</span>
<span id="cb301-2090"><a href="#cb301-2090"></a>                    <span class="fu">rownames</span>(gc.models))), <span class="dv">3</span>)</span>
<span id="cb301-2091"><a href="#cb301-2091"></a>gc.lmodel4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(c.value <span class="sc">~</span> max.body.mass,</span>
<span id="cb301-2092"><a href="#cb301-2092"></a>                 <span class="at">data =</span> pruned.gc.data)</span>
<span id="cb301-2093"><a href="#cb301-2093"></a><span class="fu">summary</span>(gc.model4)</span>
<span id="cb301-2094"><a href="#cb301-2094"></a><span class="fu">summary</span>(gc.lmodel4)</span>
<span id="cb301-2095"><a href="#cb301-2095"></a></span>
<span id="cb301-2096"><a href="#cb301-2096"></a><span class="do">## estimating differences in genome size mean among foraging</span></span>
<span id="cb301-2097"><a href="#cb301-2097"></a><span class="do">## behavior categories</span></span>
<span id="cb301-2098"><a href="#cb301-2098"></a></span>
<span id="cb301-2099"><a href="#cb301-2099"></a><span class="fu">anova</span>(gc.model4, gc.lmodel4)</span>
<span id="cb301-2100"><a href="#cb301-2100"></a></span>
<span id="cb301-2101"><a href="#cb301-2101"></a><span class="do">## computing genome size mean among foraging behavior categories</span></span>
<span id="cb301-2102"><a href="#cb301-2102"></a></span>
<span id="cb301-2103"><a href="#cb301-2103"></a><span class="fu">tapply</span>(pruned.gc.data<span class="sc">$</span>c.value,</span>
<span id="cb301-2104"><a href="#cb301-2104"></a>       <span class="fu">list</span>(pruned.gc.data<span class="sc">$</span>Foraging.mode), mean)</span>
<span id="cb301-2105"><a href="#cb301-2105"></a></span>
<span id="cb301-2106"><a href="#cb301-2106"></a><span class="do">## plotting raw data</span></span>
<span id="cb301-2107"><a href="#cb301-2107"></a></span>
<span id="cb301-2108"><a href="#cb301-2108"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>)</span>
<span id="cb301-2109"><a href="#cb301-2109"></a></span>
<span id="cb301-2110"><a href="#cb301-2110"></a><span class="fu">xyplot</span>(c.value <span class="sc">~</span> max.body.mass <span class="sc">|</span> Foraging.mode,</span>
<span id="cb301-2111"><a href="#cb301-2111"></a>       <span class="at">data =</span> pruned.gc.data,</span>
<span id="cb301-2112"><a href="#cb301-2112"></a>       <span class="at">superpose =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"r"</span>),</span>
<span id="cb301-2113"><a href="#cb301-2113"></a>       <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"C-value"</span>),</span>
<span id="cb301-2114"><a href="#cb301-2114"></a>       <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">"Maximum body mass"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(g)),</span>
<span id="cb301-2115"><a href="#cb301-2115"></a>       <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">grid =</span> <span class="cn">TRUE</span>,</span>
<span id="cb301-2116"><a href="#cb301-2116"></a>       <span class="at">col.line =</span> <span class="fu">c</span>(<span class="st">"#39568CFF"</span>, <span class="st">"green4"</span>, <span class="st">"#DCE319FF"</span>),</span>
<span id="cb301-2117"><a href="#cb301-2117"></a>       <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">strip =</span> <span class="cn">TRUE</span>, <span class="at">group =</span> Foraging.mode,</span>
<span id="cb301-2118"><a href="#cb301-2118"></a>       <span class="at">col =</span> cols, <span class="at">aspect =</span> <span class="fl">0.77</span>, <span class="at">bg =</span> <span class="st">"black"</span>,</span>
<span id="cb301-2119"><a href="#cb301-2119"></a>       <span class="at">scale =</span> <span class="fu">list</span>(<span class="at">alternating =</span> <span class="dv">1</span>, <span class="at">tck =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)))</span>
<span id="cb301-2120"><a href="#cb301-2120"></a></span>
<span id="cb301-2121"><a href="#cb301-2121"></a></span>
<span id="cb301-2122"><a href="#cb301-2122"></a><span class="in">```</span></span>
<span id="cb301-2123"><a href="#cb301-2123"></a></span>
<span id="cb301-2124"><a href="#cb301-2124"></a></span>
<span id="cb301-2127"><a href="#cb301-2127"></a><span class="in">```{r}</span></span>
<span id="cb301-2128"><a href="#cb301-2128"></a>geno.alt.data <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">'genome_size_alternative.tsv'</span>,</span>
<span id="cb301-2129"><a href="#cb301-2129"></a>                        <span class="at">sep =</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span>)</span>
<span id="cb301-2130"><a href="#cb301-2130"></a><span class="fu">str</span>(geno.alt.data)</span>
<span id="cb301-2131"><a href="#cb301-2131"></a>geno.alt.data <span class="ot">&lt;-</span> geno.alt.data[<span class="sc">!</span><span class="fu">is.na</span>(geno.alt.data<span class="sc">$</span>assembly_span), ]</span>
<span id="cb301-2132"><a href="#cb301-2132"></a></span>
<span id="cb301-2133"><a href="#cb301-2133"></a></span>
<span id="cb301-2134"><a href="#cb301-2134"></a>geno.mean.alt <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(geno.alt.data<span class="sc">$</span>assembly_span,</span>
<span id="cb301-2135"><a href="#cb301-2135"></a>                           <span class="at">by =</span> <span class="fu">list</span>(geno.alt.data<span class="sc">$</span>scientific_name),</span>
<span id="cb301-2136"><a href="#cb301-2136"></a>                           mean)</span>
<span id="cb301-2137"><a href="#cb301-2137"></a><span class="fu">names</span>(geno.mean.alt) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Species'</span>, <span class="st">'genome.size'</span>)</span>
<span id="cb301-2138"><a href="#cb301-2138"></a>geno.mean.alt<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, geno.mean.alt<span class="sc">$</span>Species)</span>
<span id="cb301-2139"><a href="#cb301-2139"></a><span class="fu">rownames</span>(geno.mean.alt) <span class="ot">&lt;-</span> geno.mean.alt<span class="sc">$</span>Species</span>
<span id="cb301-2140"><a href="#cb301-2140"></a></span>
<span id="cb301-2141"><a href="#cb301-2141"></a>check <span class="ot">&lt;-</span> <span class="fu">name.check</span>(lizard.tree, geno.mean.alt)</span>
<span id="cb301-2142"><a href="#cb301-2142"></a>rm_phy <span class="ot">&lt;-</span> check<span class="sc">$</span>tree_not_data</span>
<span id="cb301-2143"><a href="#cb301-2143"></a>rm_dat <span class="ot">&lt;-</span> check<span class="sc">$</span>data_not_tree</span>
<span id="cb301-2144"><a href="#cb301-2144"></a>geno.mean.alt.tree <span class="ot">&lt;-</span> <span class="fu">drop.tip</span>(lizard.tree, rm_phy)</span>
<span id="cb301-2145"><a href="#cb301-2145"></a></span>
<span id="cb301-2146"><a href="#cb301-2146"></a>pruned.geno.mean.alt <span class="ot">&lt;-</span> <span class="fu">subset</span>(geno.mean.alt,</span>
<span id="cb301-2147"><a href="#cb301-2147"></a>                      <span class="at">subset =</span> <span class="fu">rownames</span>(geno.mean.alt) <span class="sc">%in%</span> geno.mean.alt.tree<span class="sc">$</span>tip,</span>
<span id="cb301-2148"><a href="#cb301-2148"></a>                      <span class="at">select =</span> <span class="fu">names</span>(geno.mean.alt))</span>
<span id="cb301-2149"><a href="#cb301-2149"></a><span class="fu">name.check</span>(geno.mean.alt.tree, pruned.geno.mean.alt)</span>
<span id="cb301-2150"><a href="#cb301-2150"></a><span class="fu">str</span>(pruned.geno.mean.alt)</span>
<span id="cb301-2151"><a href="#cb301-2151"></a>geno.mean.alt.tree</span>
<span id="cb301-2152"><a href="#cb301-2152"></a></span>
<span id="cb301-2153"><a href="#cb301-2153"></a>pruned.geno.alt <span class="ot">&lt;-</span> <span class="fu">merge</span>(pruned.geno.mean.alt, pruned.data, <span class="at">by =</span> <span class="st">'Species'</span>)</span>
<span id="cb301-2154"><a href="#cb301-2154"></a></span>
<span id="cb301-2155"><a href="#cb301-2155"></a><span class="fu">tapply</span>(<span class="at">X =</span> pruned.geno.alt<span class="sc">$</span>Species,</span>
<span id="cb301-2156"><a href="#cb301-2156"></a>       <span class="at">INDEX =</span> <span class="fu">list</span>(pruned.geno.alt<span class="sc">$</span>Foraging.mode),</span>
<span id="cb301-2157"><a href="#cb301-2157"></a>       <span class="at">FUN =</span> <span class="cf">function</span>(X) <span class="fu">length</span>(<span class="fu">na.omit</span>(X)))</span>
<span id="cb301-2158"><a href="#cb301-2158"></a></span>
<span id="cb301-2159"><a href="#cb301-2159"></a><span class="fu">rownames</span>(pruned.geno.alt) <span class="ot">&lt;-</span> pruned.geno.alt<span class="sc">$</span>Species</span>
<span id="cb301-2160"><a href="#cb301-2160"></a><span class="fu">names</span>(pruned.geno.alt)</span>
<span id="cb301-2161"><a href="#cb301-2161"></a><span class="fu">names</span>(pruned.geno.alt)[<span class="dv">15</span>] <span class="ot">&lt;-</span> <span class="st">'max.body.mass'</span></span>
<span id="cb301-2162"><a href="#cb301-2162"></a>pruned.geno.alt<span class="sc">$</span>max.body.mass <span class="ot">&lt;-</span> <span class="fu">log10</span>(pruned.geno.alt<span class="sc">$</span>max.body.mass)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb301-2163"><a href="#cb301-2163"></a>pruned.geno.alt<span class="sc">$</span>genome.size <span class="ot">&lt;-</span> <span class="fu">log10</span>(pruned.geno.alt<span class="sc">$</span>genome.size)</span>
<span id="cb301-2164"><a href="#cb301-2164"></a><span class="fu">head</span>(pruned.geno.alt[ , <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">13</span>, <span class="dv">15</span>)])</span>
<span id="cb301-2165"><a href="#cb301-2165"></a></span>
<span id="cb301-2166"><a href="#cb301-2166"></a></span>
<span id="cb301-2167"><a href="#cb301-2167"></a><span class="do">## modeling genome size among foraging behavior categories</span></span>
<span id="cb301-2168"><a href="#cb301-2168"></a></span>
<span id="cb301-2169"><a href="#cb301-2169"></a>gs.alt1 <span class="ot">&lt;-</span> <span class="fu">gls</span>(genome.size <span class="sc">~</span> Foraging.mode<span class="sc">*</span>max.body.mass,</span>
<span id="cb301-2170"><a href="#cb301-2170"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-2171"><a href="#cb301-2171"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> geno.mean.alt.tree,</span>
<span id="cb301-2172"><a href="#cb301-2172"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-2173"><a href="#cb301-2173"></a>                     <span class="at">data =</span> pruned.geno.alt, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-2174"><a href="#cb301-2174"></a></span>
<span id="cb301-2175"><a href="#cb301-2175"></a></span>
<span id="cb301-2176"><a href="#cb301-2176"></a>gs.alt2 <span class="ot">&lt;-</span> <span class="fu">gls</span>(genome.size <span class="sc">~</span> Foraging.mode <span class="sc">+</span> max.body.mass,</span>
<span id="cb301-2177"><a href="#cb301-2177"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-2178"><a href="#cb301-2178"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> geno.mean.alt.tree,</span>
<span id="cb301-2179"><a href="#cb301-2179"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-2180"><a href="#cb301-2180"></a>                     <span class="at">data =</span> pruned.geno.alt, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-2181"><a href="#cb301-2181"></a></span>
<span id="cb301-2182"><a href="#cb301-2182"></a></span>
<span id="cb301-2183"><a href="#cb301-2183"></a>gs.alt3 <span class="ot">&lt;-</span> <span class="fu">gls</span>(genome.size <span class="sc">~</span> Foraging.mode,</span>
<span id="cb301-2184"><a href="#cb301-2184"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-2185"><a href="#cb301-2185"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> geno.mean.alt.tree,</span>
<span id="cb301-2186"><a href="#cb301-2186"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-2187"><a href="#cb301-2187"></a>                 <span class="at">data =</span> pruned.geno.alt, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-2188"><a href="#cb301-2188"></a></span>
<span id="cb301-2189"><a href="#cb301-2189"></a></span>
<span id="cb301-2190"><a href="#cb301-2190"></a>gs.alt4 <span class="ot">&lt;-</span> <span class="fu">gls</span>(genome.size <span class="sc">~</span> max.body.mass,</span>
<span id="cb301-2191"><a href="#cb301-2191"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-2192"><a href="#cb301-2192"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> geno.mean.alt.tree,</span>
<span id="cb301-2193"><a href="#cb301-2193"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-2194"><a href="#cb301-2194"></a>                     <span class="at">data =</span> pruned.geno.alt, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-2195"><a href="#cb301-2195"></a></span>
<span id="cb301-2196"><a href="#cb301-2196"></a></span>
<span id="cb301-2197"><a href="#cb301-2197"></a></span>
<span id="cb301-2198"><a href="#cb301-2198"></a>gs.alts <span class="ot">&lt;-</span> <span class="fu">anova</span>(gs.alt1, gs.alt2,</span>
<span id="cb301-2199"><a href="#cb301-2199"></a>                   gs.alt3, gs.alt4)</span>
<span id="cb301-2200"><a href="#cb301-2200"></a><span class="fu">round</span>(<span class="fu">aicw</span>(<span class="fu">setNames</span>(gs.alts<span class="sc">$</span>AIC,</span>
<span id="cb301-2201"><a href="#cb301-2201"></a>                    <span class="fu">rownames</span>(gs.alts))), <span class="dv">3</span>)</span>
<span id="cb301-2202"><a href="#cb301-2202"></a>gs.lalt1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(genome.size <span class="sc">~</span> Foraging.mode<span class="sc">*</span>max.body.mass,</span>
<span id="cb301-2203"><a href="#cb301-2203"></a>                 <span class="at">data =</span> pruned.geno.alt)</span>
<span id="cb301-2204"><a href="#cb301-2204"></a><span class="fu">summary</span>(gs.alt1)</span>
<span id="cb301-2205"><a href="#cb301-2205"></a><span class="fu">summary</span>(gs.lalt1)</span>
<span id="cb301-2206"><a href="#cb301-2206"></a></span>
<span id="cb301-2207"><a href="#cb301-2207"></a><span class="do">## estimating differences in genome size mean among foraging</span></span>
<span id="cb301-2208"><a href="#cb301-2208"></a><span class="do">## behavior categories</span></span>
<span id="cb301-2209"><a href="#cb301-2209"></a></span>
<span id="cb301-2210"><a href="#cb301-2210"></a><span class="fu">anova</span>(gs.alt1, gs.lalt1)</span>
<span id="cb301-2211"><a href="#cb301-2211"></a></span>
<span id="cb301-2212"><a href="#cb301-2212"></a><span class="do">## running anova over the most likely model</span></span>
<span id="cb301-2213"><a href="#cb301-2213"></a></span>
<span id="cb301-2214"><a href="#cb301-2214"></a><span class="fu">anova</span>(gs.lalt1)</span>
<span id="cb301-2215"><a href="#cb301-2215"></a></span>
<span id="cb301-2216"><a href="#cb301-2216"></a><span class="do">## computing genome size mean among foraging behavior categories</span></span>
<span id="cb301-2217"><a href="#cb301-2217"></a></span>
<span id="cb301-2218"><a href="#cb301-2218"></a><span class="fu">tapply</span>(pruned.geno.alt<span class="sc">$</span>genome.size,</span>
<span id="cb301-2219"><a href="#cb301-2219"></a>       <span class="fu">list</span>(pruned.geno.alt<span class="sc">$</span>Foraging.mode), mean)</span>
<span id="cb301-2220"><a href="#cb301-2220"></a></span>
<span id="cb301-2221"><a href="#cb301-2221"></a><span class="do">## plotting raw data</span></span>
<span id="cb301-2222"><a href="#cb301-2222"></a></span>
<span id="cb301-2223"><a href="#cb301-2223"></a><span class="fu">dim</span>(pruned.geno.alt)</span>
<span id="cb301-2224"><a href="#cb301-2224"></a>pred.mod <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">max.body.mass =</span> <span class="fu">seq</span>(<span class="fu">min</span>(pruned.geno.alt<span class="sc">$</span>max.body.mass),</span>
<span id="cb301-2225"><a href="#cb301-2225"></a>                                       <span class="fu">max</span>(pruned.geno.alt<span class="sc">$</span>max.body.mass),</span>
<span id="cb301-2226"><a href="#cb301-2226"></a>                                       <span class="at">len =</span> <span class="dv">96</span>),</span>
<span id="cb301-2227"><a href="#cb301-2227"></a>                       <span class="at">Foraging.mode =</span> pruned.geno.alt<span class="sc">$</span>Foraging.mode,</span>
<span id="cb301-2228"><a href="#cb301-2228"></a>                       <span class="at">row.names =</span> <span class="fu">rownames</span>(pruned.geno.alt))</span>
<span id="cb301-2229"><a href="#cb301-2229"></a></span>
<span id="cb301-2230"><a href="#cb301-2230"></a>pred.mod<span class="sc">$</span>genome.size <span class="ot">&lt;-</span> <span class="fu">predict</span>(gs.lalt1, pred.mod,</span>
<span id="cb301-2231"><a href="#cb301-2231"></a>                          <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>fit</span>
<span id="cb301-2232"><a href="#cb301-2232"></a>pred.mod<span class="sc">$</span>se <span class="ot">&lt;-</span> <span class="fu">predict</span>(gs.lalt1, pred.mod,</span>
<span id="cb301-2233"><a href="#cb301-2233"></a>                       <span class="at">type =</span> <span class="st">'response'</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>se.fit</span>
<span id="cb301-2234"><a href="#cb301-2234"></a></span>
<span id="cb301-2235"><a href="#cb301-2235"></a></span>
<span id="cb301-2236"><a href="#cb301-2236"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>)</span>
<span id="cb301-2237"><a href="#cb301-2237"></a></span>
<span id="cb301-2238"><a href="#cb301-2238"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(genome.size <span class="sc">~</span> max.body.mass <span class="sc">|</span> Foraging.mode,</span>
<span id="cb301-2239"><a href="#cb301-2239"></a>       <span class="at">data =</span> pruned.geno.alt,</span>
<span id="cb301-2240"><a href="#cb301-2240"></a>       <span class="at">superpose =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">"p"</span>,</span>
<span id="cb301-2241"><a href="#cb301-2241"></a>       <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Genome size"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">~</span>(Mb)),</span>
<span id="cb301-2242"><a href="#cb301-2242"></a>       <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">"Maximum body mass"</span><span class="sc">~</span>log[<span class="dv">10</span>]<span class="sc">+</span><span class="dv">1</span><span class="sc">~</span>(g)),</span>
<span id="cb301-2243"><a href="#cb301-2243"></a>       <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">grid =</span> <span class="cn">TRUE</span>,</span>
<span id="cb301-2244"><a href="#cb301-2244"></a>       <span class="at">col.line =</span> <span class="fu">c</span>(<span class="st">"#39568CFF"</span>, <span class="st">"green4"</span>, <span class="st">"#DCE319FF"</span>),</span>
<span id="cb301-2245"><a href="#cb301-2245"></a>       <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">strip =</span> <span class="cn">TRUE</span>, <span class="at">group =</span> Foraging.mode,</span>
<span id="cb301-2246"><a href="#cb301-2246"></a>       <span class="at">col =</span> cols, <span class="at">aspect =</span> <span class="fl">0.77</span>, <span class="at">bg =</span> <span class="st">"black"</span>,</span>
<span id="cb301-2247"><a href="#cb301-2247"></a>       <span class="at">scale =</span> <span class="fu">list</span>(<span class="at">alternating =</span> <span class="dv">1</span>, <span class="at">tck =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)))</span>
<span id="cb301-2248"><a href="#cb301-2248"></a></span>
<span id="cb301-2249"><a href="#cb301-2249"></a></span>
<span id="cb301-2250"><a href="#cb301-2250"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(genome.size <span class="sc">~</span> max.body.mass <span class="sc">|</span> Foraging.mode,</span>
<span id="cb301-2251"><a href="#cb301-2251"></a>       <span class="at">data =</span> pred.mod,</span>
<span id="cb301-2252"><a href="#cb301-2252"></a>       <span class="at">superpose =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">"l"</span>,</span>
<span id="cb301-2253"><a href="#cb301-2253"></a>       <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">grid =</span> <span class="cn">FALSE</span>,</span>
<span id="cb301-2254"><a href="#cb301-2254"></a>       <span class="at">col.line =</span> <span class="fu">c</span>(<span class="st">"#39568CFF"</span>, <span class="st">"green4"</span>, <span class="st">"#DCE319FF"</span>),</span>
<span id="cb301-2255"><a href="#cb301-2255"></a>       <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">strip =</span> <span class="cn">TRUE</span>, <span class="at">group =</span> Foraging.mode,</span>
<span id="cb301-2256"><a href="#cb301-2256"></a>       <span class="at">col =</span> cols, <span class="at">aspect =</span> <span class="fl">0.77</span>, <span class="at">bg =</span> <span class="st">"black"</span>,</span>
<span id="cb301-2257"><a href="#cb301-2257"></a>       <span class="at">scale =</span> <span class="fu">list</span>(<span class="at">alternating =</span> <span class="dv">1</span>, <span class="at">tck =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)))</span>
<span id="cb301-2258"><a href="#cb301-2258"></a></span>
<span id="cb301-2259"><a href="#cb301-2259"></a>plot1 <span class="sc">+</span> <span class="fu">as.layer</span>(plot2)</span>
<span id="cb301-2260"><a href="#cb301-2260"></a></span>
<span id="cb301-2261"><a href="#cb301-2261"></a></span>
<span id="cb301-2262"><a href="#cb301-2262"></a><span class="in">```</span></span>
<span id="cb301-2263"><a href="#cb301-2263"></a></span>
<span id="cb301-2264"><a href="#cb301-2264"></a></span>
<span id="cb301-2265"><a href="#cb301-2265"></a><span class="in">```{r, include = FALSE, eval = FALSE}</span></span>
<span id="cb301-2266"><a href="#cb301-2266"></a></span>
<span id="cb301-2267"><a href="#cb301-2267"></a><span class="in">## visualizing results</span></span>
<span id="cb301-2268"><a href="#cb301-2268"></a></span>
<span id="cb301-2269"><a href="#cb301-2269"></a><span class="in">dim(pruned.geno.size.data)</span></span>
<span id="cb301-2270"><a href="#cb301-2270"></a><span class="in">pred.mod &lt;- data.frame(max.body.mass = seq(min(pruned.geno.size.data$max.body.mass),</span></span>
<span id="cb301-2271"><a href="#cb301-2271"></a><span class="in">                                       max(pruned.geno.size.data$max.body.mass),</span></span>
<span id="cb301-2272"><a href="#cb301-2272"></a><span class="in">                                       len = 99),</span></span>
<span id="cb301-2273"><a href="#cb301-2273"></a><span class="in">                       Foraging.mode = pruned.geno.size.data$Foraging.mode,</span></span>
<span id="cb301-2274"><a href="#cb301-2274"></a><span class="in">                       row.names = rownames(pruned.geno.size.data))</span></span>
<span id="cb301-2275"><a href="#cb301-2275"></a></span>
<span id="cb301-2276"><a href="#cb301-2276"></a><span class="in">pred.mod$genome.size &lt;- predict(gs.model1, pred.mod,</span></span>
<span id="cb301-2277"><a href="#cb301-2277"></a><span class="in">                          type = 'response', se = TRUE)$fit</span></span>
<span id="cb301-2278"><a href="#cb301-2278"></a><span class="in">pred.mod$se &lt;- predict(gs.model1, pred.mod,</span></span>
<span id="cb301-2279"><a href="#cb301-2279"></a><span class="in">                       type = 'response', se = TRUE)$se.fit</span></span>
<span id="cb301-2280"><a href="#cb301-2280"></a><span class="in">head(pred.mod)</span></span>
<span id="cb301-2281"><a href="#cb301-2281"></a></span>
<span id="cb301-2282"><a href="#cb301-2282"></a><span class="in">active &lt;- pred.mod[pruned.geno.size.data$Foraging.mode == 'active', ]</span></span>
<span id="cb301-2283"><a href="#cb301-2283"></a><span class="in">plastic &lt;- pred.mod[pruned.geno.size.data$Foraging.mode == 'plastic', ]</span></span>
<span id="cb301-2284"><a href="#cb301-2284"></a><span class="in">sit.and.wait &lt;- pred.mod[pruned.geno.size.data$Foraging.mode == 'sit-and-wait', ]</span></span>
<span id="cb301-2285"><a href="#cb301-2285"></a></span>
<span id="cb301-2286"><a href="#cb301-2286"></a><span class="in">cols &lt;- c('#39568CFF', 'green4', '#DCE319FF')</span></span>
<span id="cb301-2287"><a href="#cb301-2287"></a></span>
<span id="cb301-2288"><a href="#cb301-2288"></a><span class="in">par(mgp = c(2.5, 1, 0))</span></span>
<span id="cb301-2289"><a href="#cb301-2289"></a></span>
<span id="cb301-2290"><a href="#cb301-2290"></a><span class="in">plot(genome.size ~ max.body.mass, data = pruned.geno.size.data,</span></span>
<span id="cb301-2291"><a href="#cb301-2291"></a><span class="in">     pch = 21, bg = cols[as.numeric(as.factor(pruned.geno.size.data$Foraging.mode))],</span></span>
<span id="cb301-2292"><a href="#cb301-2292"></a><span class="in">     las = 1, xaxt = 'n', yaxt = 'n', xlab = '', ylab = '',</span></span>
<span id="cb301-2293"><a href="#cb301-2293"></a><span class="in">     type = 'n', axes = FALSE)</span></span>
<span id="cb301-2294"><a href="#cb301-2294"></a></span>
<span id="cb301-2295"><a href="#cb301-2295"></a><span class="in">grid(nx = NULL, ny = NULL, col = "lightgray", lwd = 1)</span></span>
<span id="cb301-2296"><a href="#cb301-2296"></a><span class="in">par(new = TRUE)</span></span>
<span id="cb301-2297"><a href="#cb301-2297"></a></span>
<span id="cb301-2298"><a href="#cb301-2298"></a><span class="in">plot(genome.size ~ max.body.mass, data = pruned.geno.size.data,</span></span>
<span id="cb301-2299"><a href="#cb301-2299"></a><span class="in">     pch = 21, bg = cols[as.numeric(as.factor(pruned.geno.size.data$Foraging.mode))],</span></span>
<span id="cb301-2300"><a href="#cb301-2300"></a><span class="in">     col = 'black', las = 1,</span></span>
<span id="cb301-2301"><a href="#cb301-2301"></a><span class="in">     xlab = expression("Maximum body mass"~log[10]+1~(g)),</span></span>
<span id="cb301-2302"><a href="#cb301-2302"></a><span class="in">     ylab = expression("Genome size"~log[10]~(Mb)),</span></span>
<span id="cb301-2303"><a href="#cb301-2303"></a><span class="in">     type = 'p')</span></span>
<span id="cb301-2304"><a href="#cb301-2304"></a></span>
<span id="cb301-2305"><a href="#cb301-2305"></a><span class="in">lines(active$genome.size ~ active$max.body.mass,</span></span>
<span id="cb301-2306"><a href="#cb301-2306"></a><span class="in">      data = active, lwd = 2.5, col = '#39568CFF')</span></span>
<span id="cb301-2307"><a href="#cb301-2307"></a></span>
<span id="cb301-2308"><a href="#cb301-2308"></a><span class="in">lines(plastic$genome.size ~ plastic$max.body.mass,</span></span>
<span id="cb301-2309"><a href="#cb301-2309"></a><span class="in">      data = plastic, lwd = 2.5, col = 'green4')</span></span>
<span id="cb301-2310"><a href="#cb301-2310"></a></span>
<span id="cb301-2311"><a href="#cb301-2311"></a><span class="in">lines(sit.and.wait$genome.size ~ sit.and.wait$max.body.mass,</span></span>
<span id="cb301-2312"><a href="#cb301-2312"></a><span class="in">      data = sit.and.wait, lwd = 2.5, col = '#DCE319FF')</span></span>
<span id="cb301-2313"><a href="#cb301-2313"></a></span>
<span id="cb301-2314"><a href="#cb301-2314"></a><span class="in">legend('bottomleft',</span></span>
<span id="cb301-2315"><a href="#cb301-2315"></a><span class="in">       legend = c('active', 'plastic', 'sit-and-wait'),</span></span>
<span id="cb301-2316"><a href="#cb301-2316"></a><span class="in">       pch = 21, pt.bg = c('#39568CFF', 'green4', '#DCE319FF'),</span></span>
<span id="cb301-2317"><a href="#cb301-2317"></a><span class="in">       col = c('#39568CFF', 'green4', '#DCE319FF'), lwd = 1,</span></span>
<span id="cb301-2318"><a href="#cb301-2318"></a><span class="in">       bty = 'n', cex = 0.8)</span></span>
<span id="cb301-2319"><a href="#cb301-2319"></a></span>
<span id="cb301-2320"><a href="#cb301-2320"></a></span>
<span id="cb301-2321"><a href="#cb301-2321"></a><span class="in">```</span></span>
<span id="cb301-2322"><a href="#cb301-2322"></a></span>
<span id="cb301-2325"><a href="#cb301-2325"></a><span class="in">```{r}</span></span>
<span id="cb301-2326"><a href="#cb301-2326"></a><span class="do">## model diagnosis</span></span>
<span id="cb301-2327"><a href="#cb301-2327"></a></span>
<span id="cb301-2328"><a href="#cb301-2328"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb301-2329"><a href="#cb301-2329"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-2330"><a href="#cb301-2330"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-2331"><a href="#cb301-2331"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb301-2332"><a href="#cb301-2332"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb301-2333"><a href="#cb301-2333"></a></span>
<span id="cb301-2334"><a href="#cb301-2334"></a><span class="fu">par</span>(<span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb301-2335"><a href="#cb301-2335"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(gs.lmodel1), <span class="fu">resid</span>(gs.lmodel1),</span>
<span id="cb301-2336"><a href="#cb301-2336"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb301-2337"><a href="#cb301-2337"></a>     <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">xlab =</span> <span class="st">''</span>)</span>
<span id="cb301-2338"><a href="#cb301-2338"></a></span>
<span id="cb301-2339"><a href="#cb301-2339"></a><span class="fu">grid</span>()</span>
<span id="cb301-2340"><a href="#cb301-2340"></a></span>
<span id="cb301-2341"><a href="#cb301-2341"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-2342"><a href="#cb301-2342"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(gs.lmodel1), <span class="fu">resid</span>(gs.lmodel1),</span>
<span id="cb301-2343"><a href="#cb301-2343"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">"Fitted"</span>,</span>
<span id="cb301-2344"><a href="#cb301-2344"></a>     <span class="at">ylab =</span> <span class="st">"Residual"</span>, <span class="at">main =</span> <span class="st">"Fitted versus Residuals"</span>,</span>
<span id="cb301-2345"><a href="#cb301-2345"></a>     <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb301-2346"><a href="#cb301-2346"></a></span>
<span id="cb301-2347"><a href="#cb301-2347"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"darkorange"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb301-2348"><a href="#cb301-2348"></a></span>
<span id="cb301-2349"><a href="#cb301-2349"></a></span>
<span id="cb301-2350"><a href="#cb301-2350"></a><span class="do">## Checking normality</span></span>
<span id="cb301-2351"><a href="#cb301-2351"></a></span>
<span id="cb301-2352"><a href="#cb301-2352"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(gs.lmodel1), <span class="at">col =</span> <span class="st">"darkgrey"</span>,</span>
<span id="cb301-2353"><a href="#cb301-2353"></a>       <span class="at">type =</span> <span class="st">'n'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="st">''</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb301-2354"><a href="#cb301-2354"></a>       <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb301-2355"><a href="#cb301-2355"></a></span>
<span id="cb301-2356"><a href="#cb301-2356"></a><span class="fu">grid</span>()</span>
<span id="cb301-2357"><a href="#cb301-2357"></a></span>
<span id="cb301-2358"><a href="#cb301-2358"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-2359"><a href="#cb301-2359"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(gs.lmodel1), <span class="at">col =</span> <span class="st">"darkgrey"</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb301-2360"><a href="#cb301-2360"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(gs.lmodel1), <span class="at">col =</span> <span class="st">"dodgerblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb301-2361"><a href="#cb301-2361"></a></span>
<span id="cb301-2362"><a href="#cb301-2362"></a><span class="in">```</span></span>
<span id="cb301-2363"><a href="#cb301-2363"></a></span>
<span id="cb301-2364"><a href="#cb301-2364"></a></span>
<span id="cb301-2365"><a href="#cb301-2365"></a></span>
<span id="cb301-2368"><a href="#cb301-2368"></a><span class="in">```{r}</span></span>
<span id="cb301-2369"><a href="#cb301-2369"></a><span class="do">## setting up the data of protein coding genes</span></span>
<span id="cb301-2370"><a href="#cb301-2370"></a></span>
<span id="cb301-2371"><a href="#cb301-2371"></a><span class="fu">names</span>(genome.annotation)</span>
<span id="cb301-2372"><a href="#cb301-2372"></a>new.mat <span class="ot">&lt;-</span> genome.annotation[<span class="sc">!</span><span class="fu">is.na</span>(genome.annotation<span class="sc">$</span>protein.coding.genes), ]</span>
<span id="cb301-2373"><a href="#cb301-2373"></a><span class="fu">names</span>(new.mat)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">'Species'</span></span>
<span id="cb301-2374"><a href="#cb301-2374"></a><span class="fu">dim</span>(new.mat)</span>
<span id="cb301-2375"><a href="#cb301-2375"></a></span>
<span id="cb301-2376"><a href="#cb301-2376"></a>gen.mat <span class="ot">&lt;-</span> <span class="fu">merge</span>(pruned.data, new.mat, <span class="at">by =</span> <span class="st">'Species'</span>)</span>
<span id="cb301-2377"><a href="#cb301-2377"></a>gen.mat <span class="ot">&lt;-</span> gen.mat[ , <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">29</span>, <span class="dv">36</span><span class="sc">:</span><span class="dv">38</span>)]</span>
<span id="cb301-2378"><a href="#cb301-2378"></a><span class="fu">names</span>(gen.mat)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">'max.body.mass'</span></span>
<span id="cb301-2379"><a href="#cb301-2379"></a></span>
<span id="cb301-2380"><a href="#cb301-2380"></a>cod.mat <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(gen.mat[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">7</span>)], <span class="fu">list</span>(gen.mat<span class="sc">$</span>Species, gen.mat<span class="sc">$</span>Foraging.mode), mean)</span>
<span id="cb301-2381"><a href="#cb301-2381"></a><span class="fu">names</span>(cod.mat)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Species'</span>, <span class="st">'Foraging.mode'</span>)</span>
<span id="cb301-2382"><a href="#cb301-2382"></a><span class="fu">rownames</span>(cod.mat) <span class="ot">&lt;-</span> cod.mat<span class="sc">$</span>Species</span>
<span id="cb301-2383"><a href="#cb301-2383"></a></span>
<span id="cb301-2384"><a href="#cb301-2384"></a>check <span class="ot">&lt;-</span> <span class="fu">name.check</span>(lizard.tree, cod.mat)</span>
<span id="cb301-2385"><a href="#cb301-2385"></a>rm_phy <span class="ot">&lt;-</span> check<span class="sc">$</span>tree_not_data</span>
<span id="cb301-2386"><a href="#cb301-2386"></a>rm_dat <span class="ot">&lt;-</span> check<span class="sc">$</span>data_not_tree</span>
<span id="cb301-2387"><a href="#cb301-2387"></a>gen.tree <span class="ot">&lt;-</span> <span class="fu">drop.tip</span>(lizard.tree, rm_phy)</span>
<span id="cb301-2388"><a href="#cb301-2388"></a></span>
<span id="cb301-2389"><a href="#cb301-2389"></a>prot.mat <span class="ot">&lt;-</span> <span class="fu">subset</span>(cod.mat,</span>
<span id="cb301-2390"><a href="#cb301-2390"></a>                      <span class="at">subset =</span> <span class="fu">rownames</span>(cod.mat) <span class="sc">%in%</span> gen.tree<span class="sc">$</span>tip,</span>
<span id="cb301-2391"><a href="#cb301-2391"></a>                      <span class="at">select =</span> <span class="fu">names</span>(cod.mat))</span>
<span id="cb301-2392"><a href="#cb301-2392"></a><span class="fu">name.check</span>(gen.tree, prot.mat)</span>
<span id="cb301-2393"><a href="#cb301-2393"></a><span class="fu">str</span>(prot.mat)</span>
<span id="cb301-2394"><a href="#cb301-2394"></a>gen.tree</span>
<span id="cb301-2395"><a href="#cb301-2395"></a></span>
<span id="cb301-2396"><a href="#cb301-2396"></a>log.prot.mat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">apply</span>(prot.mat[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)], <span class="dv">2</span>, log10))</span>
<span id="cb301-2397"><a href="#cb301-2397"></a>log.prot.mat<span class="sc">$</span>Species <span class="ot">&lt;-</span> prot.mat<span class="sc">$</span>Species</span>
<span id="cb301-2398"><a href="#cb301-2398"></a>log.prot.mat<span class="sc">$</span>Foraging.mode <span class="ot">&lt;-</span> prot.mat<span class="sc">$</span>Foraging.mode</span>
<span id="cb301-2399"><a href="#cb301-2399"></a>log.prot.mat</span>
<span id="cb301-2400"><a href="#cb301-2400"></a></span>
<span id="cb301-2401"><a href="#cb301-2401"></a>log.prot.mat <span class="ot">&lt;-</span> log.prot.mat[log.prot.mat<span class="sc">$</span>protein.coding.genes <span class="sc">&lt;</span> <span class="fl">4.35</span> <span class="sc">&amp;</span> log.prot.mat<span class="sc">$</span>protein.coding.genes <span class="sc">&gt;</span> <span class="fl">4.23</span>, ]</span>
<span id="cb301-2402"><a href="#cb301-2402"></a></span>
<span id="cb301-2403"><a href="#cb301-2403"></a></span>
<span id="cb301-2404"><a href="#cb301-2404"></a>gene.model1 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> Foraging.mode<span class="sc">*</span>max.body.mass <span class="sc">+</span></span>
<span id="cb301-2405"><a href="#cb301-2405"></a>                    total.gene.number <span class="sc">+</span> genome.size,</span>
<span id="cb301-2406"><a href="#cb301-2406"></a>    <span class="at">correlation =</span></span>
<span id="cb301-2407"><a href="#cb301-2407"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb301-2408"><a href="#cb301-2408"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-2409"><a href="#cb301-2409"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-2410"><a href="#cb301-2410"></a></span>
<span id="cb301-2411"><a href="#cb301-2411"></a></span>
<span id="cb301-2412"><a href="#cb301-2412"></a>gene.model2 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> Foraging.mode<span class="sc">*</span>total.gene.number <span class="sc">+</span></span>
<span id="cb301-2413"><a href="#cb301-2413"></a>                    max.body.mass <span class="sc">+</span> genome.size,</span>
<span id="cb301-2414"><a href="#cb301-2414"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-2415"><a href="#cb301-2415"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb301-2416"><a href="#cb301-2416"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-2417"><a href="#cb301-2417"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-2418"><a href="#cb301-2418"></a></span>
<span id="cb301-2419"><a href="#cb301-2419"></a>gene.model3 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> Foraging.mode<span class="sc">*</span>genome.size <span class="sc">+</span></span>
<span id="cb301-2420"><a href="#cb301-2420"></a>                    max.body.mass <span class="sc">+</span> total.gene.number,</span>
<span id="cb301-2421"><a href="#cb301-2421"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-2422"><a href="#cb301-2422"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb301-2423"><a href="#cb301-2423"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-2424"><a href="#cb301-2424"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-2425"><a href="#cb301-2425"></a></span>
<span id="cb301-2426"><a href="#cb301-2426"></a>gene.model4 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> Foraging.mode <span class="sc">+</span> genome.size <span class="sc">+</span></span>
<span id="cb301-2427"><a href="#cb301-2427"></a>                    max.body.mass <span class="sc">+</span> total.gene.number,</span>
<span id="cb301-2428"><a href="#cb301-2428"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-2429"><a href="#cb301-2429"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb301-2430"><a href="#cb301-2430"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-2431"><a href="#cb301-2431"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-2432"><a href="#cb301-2432"></a></span>
<span id="cb301-2433"><a href="#cb301-2433"></a>gene.model5 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> Foraging.mode <span class="sc">+</span> genome.size <span class="sc">+</span></span>
<span id="cb301-2434"><a href="#cb301-2434"></a>                    max.body.mass,</span>
<span id="cb301-2435"><a href="#cb301-2435"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-2436"><a href="#cb301-2436"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb301-2437"><a href="#cb301-2437"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-2438"><a href="#cb301-2438"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-2439"><a href="#cb301-2439"></a></span>
<span id="cb301-2440"><a href="#cb301-2440"></a>gene.model6 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> Foraging.mode <span class="sc">+</span> genome.size <span class="sc">+</span></span>
<span id="cb301-2441"><a href="#cb301-2441"></a>                    total.gene.number,</span>
<span id="cb301-2442"><a href="#cb301-2442"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-2443"><a href="#cb301-2443"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb301-2444"><a href="#cb301-2444"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-2445"><a href="#cb301-2445"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-2446"><a href="#cb301-2446"></a></span>
<span id="cb301-2447"><a href="#cb301-2447"></a>gene.model7 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> Foraging.mode <span class="sc">+</span> genome.size,</span>
<span id="cb301-2448"><a href="#cb301-2448"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-2449"><a href="#cb301-2449"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb301-2450"><a href="#cb301-2450"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-2451"><a href="#cb301-2451"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-2452"><a href="#cb301-2452"></a></span>
<span id="cb301-2453"><a href="#cb301-2453"></a>gene.model8 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> Foraging.mode <span class="sc">+</span> total.gene.number,</span>
<span id="cb301-2454"><a href="#cb301-2454"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-2455"><a href="#cb301-2455"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb301-2456"><a href="#cb301-2456"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-2457"><a href="#cb301-2457"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-2458"><a href="#cb301-2458"></a></span>
<span id="cb301-2459"><a href="#cb301-2459"></a>gene.model9 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> Foraging.mode <span class="sc">+</span> max.body.mass,</span>
<span id="cb301-2460"><a href="#cb301-2460"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-2461"><a href="#cb301-2461"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb301-2462"><a href="#cb301-2462"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-2463"><a href="#cb301-2463"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-2464"><a href="#cb301-2464"></a></span>
<span id="cb301-2465"><a href="#cb301-2465"></a>gene.model10 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> Foraging.mode,</span>
<span id="cb301-2466"><a href="#cb301-2466"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-2467"><a href="#cb301-2467"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb301-2468"><a href="#cb301-2468"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-2469"><a href="#cb301-2469"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-2470"><a href="#cb301-2470"></a></span>
<span id="cb301-2471"><a href="#cb301-2471"></a>gene.model11 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> max.body.mass,</span>
<span id="cb301-2472"><a href="#cb301-2472"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-2473"><a href="#cb301-2473"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb301-2474"><a href="#cb301-2474"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-2475"><a href="#cb301-2475"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-2476"><a href="#cb301-2476"></a></span>
<span id="cb301-2477"><a href="#cb301-2477"></a>gene.model12 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> total.gene.number,</span>
<span id="cb301-2478"><a href="#cb301-2478"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-2479"><a href="#cb301-2479"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb301-2480"><a href="#cb301-2480"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-2481"><a href="#cb301-2481"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-2482"><a href="#cb301-2482"></a></span>
<span id="cb301-2483"><a href="#cb301-2483"></a>gene.model13 <span class="ot">&lt;-</span> <span class="fu">gls</span>(protein.coding.genes <span class="sc">~</span> genome.size,</span>
<span id="cb301-2484"><a href="#cb301-2484"></a>                 <span class="at">correlation =</span></span>
<span id="cb301-2485"><a href="#cb301-2485"></a>                         <span class="fu">corBrownian</span>(<span class="at">phy =</span> gen.tree,</span>
<span id="cb301-2486"><a href="#cb301-2486"></a>                                     <span class="at">form =</span> <span class="sc">~</span>Species),</span>
<span id="cb301-2487"><a href="#cb301-2487"></a>                     <span class="at">data =</span> log.prot.mat, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb301-2488"><a href="#cb301-2488"></a></span>
<span id="cb301-2489"><a href="#cb301-2489"></a></span>
<span id="cb301-2490"><a href="#cb301-2490"></a></span>
<span id="cb301-2491"><a href="#cb301-2491"></a>gene.models <span class="ot">&lt;-</span> <span class="fu">anova</span>(gene.model1, gene.model2,</span>
<span id="cb301-2492"><a href="#cb301-2492"></a>                   gene.model3, gene.model4,</span>
<span id="cb301-2493"><a href="#cb301-2493"></a>                   gene.model5, gene.model6,</span>
<span id="cb301-2494"><a href="#cb301-2494"></a>                   gene.model7, gene.model8,</span>
<span id="cb301-2495"><a href="#cb301-2495"></a>                   gene.model9, gene.model10,</span>
<span id="cb301-2496"><a href="#cb301-2496"></a>                   gene.model11, gene.model12,</span>
<span id="cb301-2497"><a href="#cb301-2497"></a>                   gene.model13)</span>
<span id="cb301-2498"><a href="#cb301-2498"></a></span>
<span id="cb301-2499"><a href="#cb301-2499"></a><span class="fu">round</span>(<span class="fu">aicw</span>(<span class="fu">setNames</span>(gene.models<span class="sc">$</span>AIC,</span>
<span id="cb301-2500"><a href="#cb301-2500"></a>              <span class="fu">rownames</span>(gene.models))), <span class="dv">3</span>)</span>
<span id="cb301-2501"><a href="#cb301-2501"></a><span class="fu">summary</span>(gene.model12)</span>
<span id="cb301-2502"><a href="#cb301-2502"></a></span>
<span id="cb301-2503"><a href="#cb301-2503"></a></span>
<span id="cb301-2504"><a href="#cb301-2504"></a></span>
<span id="cb301-2505"><a href="#cb301-2505"></a></span>
<span id="cb301-2506"><a href="#cb301-2506"></a><span class="fu">par</span>(<span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">2.8</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb301-2507"><a href="#cb301-2507"></a></span>
<span id="cb301-2508"><a href="#cb301-2508"></a><span class="fu">plot</span>(protein.coding.genes <span class="sc">~</span> total.gene.number, <span class="at">data =</span> log.prot.mat,</span>
<span id="cb301-2509"><a href="#cb301-2509"></a>     <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb301-2510"><a href="#cb301-2510"></a>     <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>, <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb301-2511"><a href="#cb301-2511"></a>     <span class="at">type =</span> <span class="st">'n'</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-2512"><a href="#cb301-2512"></a></span>
<span id="cb301-2513"><a href="#cb301-2513"></a><span class="fu">grid</span>(<span class="at">nx =</span> <span class="cn">NULL</span>, <span class="at">ny =</span> <span class="cn">NULL</span>, <span class="at">col =</span> <span class="st">"lightgray"</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb301-2514"><a href="#cb301-2514"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-2515"><a href="#cb301-2515"></a></span>
<span id="cb301-2516"><a href="#cb301-2516"></a><span class="fu">plot</span>(protein.coding.genes <span class="sc">~</span> total.gene.number, <span class="at">data =</span> log.prot.mat,</span>
<span id="cb301-2517"><a href="#cb301-2517"></a>     <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">bg =</span> cols[<span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(log.prot.mat<span class="sc">$</span>Foraging.mode))],</span>
<span id="cb301-2518"><a href="#cb301-2518"></a>     <span class="at">col =</span> <span class="st">'black'</span>, <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb301-2519"><a href="#cb301-2519"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(log[<span class="dv">10</span>]<span class="sc">~</span><span class="st">"Total gene number"</span>),</span>
<span id="cb301-2520"><a href="#cb301-2520"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(log[<span class="dv">10</span>]<span class="sc">~</span><span class="st">"Protein-coding genes"</span>),</span>
<span id="cb301-2521"><a href="#cb301-2521"></a>     <span class="at">type =</span> <span class="st">'p'</span>)</span>
<span id="cb301-2522"><a href="#cb301-2522"></a></span>
<span id="cb301-2523"><a href="#cb301-2523"></a><span class="fu">abline</span>(<span class="fu">coef</span>(gene.model12)[<span class="dv">1</span>], <span class="fu">coef</span>(gene.model12)[<span class="dv">2</span>],</span>
<span id="cb301-2524"><a href="#cb301-2524"></a>      <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">'black'</span>)</span>
<span id="cb301-2525"><a href="#cb301-2525"></a></span>
<span id="cb301-2526"><a href="#cb301-2526"></a><span class="fu">legend</span>(<span class="st">'topleft'</span>,</span>
<span id="cb301-2527"><a href="#cb301-2527"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">'active'</span>, <span class="st">'plastic'</span>, <span class="st">'sit-and-wait'</span>),</span>
<span id="cb301-2528"><a href="#cb301-2528"></a>       <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">pt.bg =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>),</span>
<span id="cb301-2529"><a href="#cb301-2529"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">'#39568CFF'</span>, <span class="st">'green4'</span>, <span class="st">'#DCE319FF'</span>), <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb301-2530"><a href="#cb301-2530"></a>       <span class="at">bty =</span> <span class="st">'n'</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb301-2531"><a href="#cb301-2531"></a></span>
<span id="cb301-2532"><a href="#cb301-2532"></a><span class="in">```</span></span>
<span id="cb301-2533"><a href="#cb301-2533"></a></span>
<span id="cb301-2536"><a href="#cb301-2536"></a><span class="in">```{r}</span></span>
<span id="cb301-2537"><a href="#cb301-2537"></a><span class="do">## model diagnosis</span></span>
<span id="cb301-2538"><a href="#cb301-2538"></a></span>
<span id="cb301-2539"><a href="#cb301-2539"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb301-2540"><a href="#cb301-2540"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-2541"><a href="#cb301-2541"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-2542"><a href="#cb301-2542"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb301-2543"><a href="#cb301-2543"></a>              <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb301-2544"><a href="#cb301-2544"></a></span>
<span id="cb301-2545"><a href="#cb301-2545"></a><span class="fu">par</span>(<span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb301-2546"><a href="#cb301-2546"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(gene.model12), <span class="fu">resid</span>(gene.model12),</span>
<span id="cb301-2547"><a href="#cb301-2547"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb301-2548"><a href="#cb301-2548"></a>     <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">ylab =</span> <span class="st">''</span>, <span class="at">xlab =</span> <span class="st">''</span>)</span>
<span id="cb301-2549"><a href="#cb301-2549"></a></span>
<span id="cb301-2550"><a href="#cb301-2550"></a><span class="fu">grid</span>()</span>
<span id="cb301-2551"><a href="#cb301-2551"></a></span>
<span id="cb301-2552"><a href="#cb301-2552"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-2553"><a href="#cb301-2553"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(gene.model12), <span class="fu">resid</span>(gene.model12),</span>
<span id="cb301-2554"><a href="#cb301-2554"></a>     <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">"Fitted"</span>,</span>
<span id="cb301-2555"><a href="#cb301-2555"></a>     <span class="at">ylab =</span> <span class="st">"Residual"</span>, <span class="at">main =</span> <span class="st">"Fitted versus Residuals"</span>,</span>
<span id="cb301-2556"><a href="#cb301-2556"></a>     <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb301-2557"><a href="#cb301-2557"></a></span>
<span id="cb301-2558"><a href="#cb301-2558"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"darkorange"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb301-2559"><a href="#cb301-2559"></a></span>
<span id="cb301-2560"><a href="#cb301-2560"></a></span>
<span id="cb301-2561"><a href="#cb301-2561"></a><span class="do">## Checking normality</span></span>
<span id="cb301-2562"><a href="#cb301-2562"></a></span>
<span id="cb301-2563"><a href="#cb301-2563"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(gene.model12), <span class="at">col =</span> <span class="st">"darkgrey"</span>,</span>
<span id="cb301-2564"><a href="#cb301-2564"></a>       <span class="at">type =</span> <span class="st">'n'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="st">''</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb301-2565"><a href="#cb301-2565"></a>       <span class="at">yaxt =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">''</span>)</span>
<span id="cb301-2566"><a href="#cb301-2566"></a></span>
<span id="cb301-2567"><a href="#cb301-2567"></a><span class="fu">grid</span>()</span>
<span id="cb301-2568"><a href="#cb301-2568"></a></span>
<span id="cb301-2569"><a href="#cb301-2569"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-2570"><a href="#cb301-2570"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(gene.model12), <span class="at">col =</span> <span class="st">"darkgrey"</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb301-2571"><a href="#cb301-2571"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(gene.model12), <span class="at">col =</span> <span class="st">"dodgerblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb301-2572"><a href="#cb301-2572"></a></span>
<span id="cb301-2573"><a href="#cb301-2573"></a><span class="in">```</span></span>
<span id="cb301-2574"><a href="#cb301-2574"></a></span>
<span id="cb301-2575"><a href="#cb301-2575"></a></span>
<span id="cb301-2578"><a href="#cb301-2578"></a><span class="in">```{r}</span></span>
<span id="cb301-2579"><a href="#cb301-2579"></a><span class="do">## looking for species with multiple genomes</span></span>
<span id="cb301-2580"><a href="#cb301-2580"></a></span>
<span id="cb301-2581"><a href="#cb301-2581"></a>dupl.genomes <span class="ot">&lt;-</span> <span class="fu">tapply</span>(genomes<span class="sc">$</span>Assembly.Accession,</span>
<span id="cb301-2582"><a href="#cb301-2582"></a>                       <span class="fu">list</span>(genomes<span class="sc">$</span>Organism.Name), length)</span>
<span id="cb301-2583"><a href="#cb301-2583"></a>((mult.genomes <span class="ot">&lt;-</span> dupl.genomes[dupl.genomes <span class="sc">&gt;</span> <span class="dv">2</span>]))</span>
<span id="cb301-2584"><a href="#cb301-2584"></a>spp <span class="ot">&lt;-</span> <span class="fu">names</span>(mult.genomes)</span>
<span id="cb301-2585"><a href="#cb301-2585"></a></span>
<span id="cb301-2586"><a href="#cb301-2586"></a><span class="do">## getting the accession number of the genomes</span></span>
<span id="cb301-2587"><a href="#cb301-2587"></a></span>
<span id="cb301-2588"><a href="#cb301-2588"></a>obj <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb301-2589"><a href="#cb301-2589"></a><span class="cf">for</span>(i <span class="cf">in</span> spp){</span>
<span id="cb301-2590"><a href="#cb301-2590"></a>    row <span class="ot">&lt;-</span> genomes[genomes<span class="sc">$</span>Organism.Name <span class="sc">==</span> i, ]</span>
<span id="cb301-2591"><a href="#cb301-2591"></a>    obj <span class="ot">&lt;-</span> <span class="fu">rbind</span>(obj, row)</span>
<span id="cb301-2592"><a href="#cb301-2592"></a>}</span>
<span id="cb301-2593"><a href="#cb301-2593"></a>obj[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">16</span>)]</span>
<span id="cb301-2594"><a href="#cb301-2594"></a></span>
<span id="cb301-2595"><a href="#cb301-2595"></a><span class="do">## determining how many species per foraging behavior</span></span>
<span id="cb301-2596"><a href="#cb301-2596"></a><span class="do">## category we have</span></span>
<span id="cb301-2597"><a href="#cb301-2597"></a></span>
<span id="cb301-2598"><a href="#cb301-2598"></a>spp <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">' '</span>, <span class="st">'_'</span>, spp)</span>
<span id="cb301-2599"><a href="#cb301-2599"></a>mult.genomes.forg <span class="ot">&lt;-</span> pruned.data[pruned.data<span class="sc">$</span>Species <span class="sc">%in%</span> spp, ]</span>
<span id="cb301-2600"><a href="#cb301-2600"></a>mult.genomes.forg[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">12</span>)]</span>
<span id="cb301-2601"><a href="#cb301-2601"></a></span>
<span id="cb301-2602"><a href="#cb301-2602"></a></span>
<span id="cb301-2603"><a href="#cb301-2603"></a><span class="in">```</span></span>
<span id="cb301-2604"><a href="#cb301-2604"></a></span>
<span id="cb301-2607"><a href="#cb301-2607"></a><span class="in">```{r}</span></span>
<span id="cb301-2608"><a href="#cb301-2608"></a>sagrei.nd <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">'A.sagrei_pi.windowed.pi'</span>, <span class="at">sep =</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span>)</span>
<span id="cb301-2609"><a href="#cb301-2609"></a><span class="fu">str</span>(sagrei.nd)</span>
<span id="cb301-2610"><a href="#cb301-2610"></a>sagrei.td <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">'A.sagrei_D.Tajima.D'</span>, <span class="at">sep =</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span>)</span>
<span id="cb301-2611"><a href="#cb301-2611"></a><span class="fu">str</span>(sagrei.td)</span>
<span id="cb301-2612"><a href="#cb301-2612"></a></span>
<span id="cb301-2613"><a href="#cb301-2613"></a>carolinensis.nd <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">'A.carolinensis.pop_pi.windowed.pi'</span>, <span class="at">sep =</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span>)</span>
<span id="cb301-2614"><a href="#cb301-2614"></a><span class="fu">str</span>(carolinensis.nd)</span>
<span id="cb301-2615"><a href="#cb301-2615"></a>carolinensis.td <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">'A.carolinensis.pop_D.Tajima.D'</span>, <span class="at">sep =</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span>)</span>
<span id="cb301-2616"><a href="#cb301-2616"></a><span class="fu">str</span>(carolinensis.td)</span>
<span id="cb301-2617"><a href="#cb301-2617"></a></span>
<span id="cb301-2618"><a href="#cb301-2618"></a>siculus.nd <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">'P.siculus_pi.windowed.pi'</span>, <span class="at">sep =</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span>)</span>
<span id="cb301-2619"><a href="#cb301-2619"></a><span class="fu">str</span>(siculus.nd)</span>
<span id="cb301-2620"><a href="#cb301-2620"></a>siculus.td <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">'P.siculus_D.Tajima.D'</span>, <span class="at">sep =</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span>)</span>
<span id="cb301-2621"><a href="#cb301-2621"></a><span class="fu">str</span>(siculus.td)</span>
<span id="cb301-2622"><a href="#cb301-2622"></a></span>
<span id="cb301-2623"><a href="#cb301-2623"></a>muralis.nd <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">'P.muralis.pop_pi.windowed.pi'</span>, <span class="at">sep =</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span>)</span>
<span id="cb301-2624"><a href="#cb301-2624"></a><span class="fu">str</span>(muralis.nd)</span>
<span id="cb301-2625"><a href="#cb301-2625"></a>muralis.td <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">'P.muralis.pop_D.Tajima.D'</span>, <span class="at">sep =</span> <span class="st">'</span><span class="sc">\t</span><span class="st">'</span>)</span>
<span id="cb301-2626"><a href="#cb301-2626"></a><span class="fu">str</span>(muralis.td)</span>
<span id="cb301-2627"><a href="#cb301-2627"></a></span>
<span id="cb301-2628"><a href="#cb301-2628"></a></span>
<span id="cb301-2629"><a href="#cb301-2629"></a><span class="do">## fixing chromosome labels</span></span>
<span id="cb301-2630"><a href="#cb301-2630"></a><span class="do">## we need to confirm what chromosome corresponds to</span></span>
<span id="cb301-2631"><a href="#cb301-2631"></a><span class="do">## labels JBBBDO010000003.1 (it seems to be sex chromosomes)</span></span>
<span id="cb301-2632"><a href="#cb301-2632"></a></span>
<span id="cb301-2633"><a href="#cb301-2633"></a></span>
<span id="cb301-2634"><a href="#cb301-2634"></a><span class="do">## Nucleotide diveristy</span></span>
<span id="cb301-2635"><a href="#cb301-2635"></a></span>
<span id="cb301-2636"><a href="#cb301-2636"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073870.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr1'</span></span>
<span id="cb301-2637"><a href="#cb301-2637"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073871.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr2'</span></span>
<span id="cb301-2638"><a href="#cb301-2638"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073872.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr3'</span></span>
<span id="cb301-2639"><a href="#cb301-2639"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073873.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr4'</span></span>
<span id="cb301-2640"><a href="#cb301-2640"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073874.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr5'</span></span>
<span id="cb301-2641"><a href="#cb301-2641"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073875.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr6'</span></span>
<span id="cb301-2642"><a href="#cb301-2642"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073876.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr7'</span></span>
<span id="cb301-2643"><a href="#cb301-2643"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073877.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr8'</span></span>
<span id="cb301-2644"><a href="#cb301-2644"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073878.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr9'</span></span>
<span id="cb301-2645"><a href="#cb301-2645"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073879.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr10'</span></span>
<span id="cb301-2646"><a href="#cb301-2646"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073880.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr11'</span></span>
<span id="cb301-2647"><a href="#cb301-2647"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073881.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr12'</span></span>
<span id="cb301-2648"><a href="#cb301-2648"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073882.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr13'</span></span>
<span id="cb301-2649"><a href="#cb301-2649"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073883.1'</span>] <span class="ot">&lt;-</span> <span class="st">'X'</span></span>
<span id="cb301-2650"><a href="#cb301-2650"></a>sagrei.nd<span class="sc">$</span>CHROM[sagrei.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073884.1'</span>] <span class="ot">&lt;-</span> <span class="st">'Y'</span></span>
<span id="cb301-2651"><a href="#cb301-2651"></a></span>
<span id="cb301-2652"><a href="#cb301-2652"></a></span>
<span id="cb301-2653"><a href="#cb301-2653"></a><span class="fu">str</span>(sagrei.nd)</span>
<span id="cb301-2654"><a href="#cb301-2654"></a></span>
<span id="cb301-2655"><a href="#cb301-2655"></a>pi.chr.sagrei <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(sagrei.nd<span class="sc">$</span>PI,</span>
<span id="cb301-2656"><a href="#cb301-2656"></a>                           <span class="fu">list</span>(sagrei.nd<span class="sc">$</span>CHROM), mean)</span>
<span id="cb301-2657"><a href="#cb301-2657"></a><span class="fu">colnames</span>(pi.chr.sagrei) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CHROM'</span>, <span class="st">'pi'</span>)</span>
<span id="cb301-2658"><a href="#cb301-2658"></a><span class="fu">head</span>(pi.chr.sagrei)</span>
<span id="cb301-2659"><a href="#cb301-2659"></a></span>
<span id="cb301-2660"><a href="#cb301-2660"></a>chrom <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'chr1'</span>, <span class="st">'chr2'</span>, <span class="st">'chr3'</span>, <span class="st">'chr4'</span>, <span class="st">'chr5'</span>, <span class="st">'chr6'</span>,</span>
<span id="cb301-2661"><a href="#cb301-2661"></a>  <span class="st">'chr7'</span>, <span class="st">'chr8'</span>, <span class="st">'chr9'</span>, <span class="st">'chr10'</span>, <span class="st">'chr11'</span>, <span class="st">'chr12'</span>,</span>
<span id="cb301-2662"><a href="#cb301-2662"></a>  <span class="st">'chr13'</span>, <span class="st">'X'</span>, <span class="st">'Y'</span>)</span>
<span id="cb301-2663"><a href="#cb301-2663"></a></span>
<span id="cb301-2664"><a href="#cb301-2664"></a>pi.chr.sagrei <span class="ot">&lt;-</span> pi.chr.sagrei[pi.chr.sagrei<span class="sc">$</span>CHROM <span class="sc">%in%</span> chrom, ]</span>
<span id="cb301-2665"><a href="#cb301-2665"></a>ordered <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb301-2666"><a href="#cb301-2666"></a><span class="cf">for</span>(i <span class="cf">in</span> chrom){</span>
<span id="cb301-2667"><a href="#cb301-2667"></a>    obj <span class="ot">&lt;-</span> pi.chr.sagrei[pi.chr.sagrei<span class="sc">$</span>CHROM <span class="sc">==</span> i, ]</span>
<span id="cb301-2668"><a href="#cb301-2668"></a>    ordered <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ordered, obj)</span>
<span id="cb301-2669"><a href="#cb301-2669"></a>}</span>
<span id="cb301-2670"><a href="#cb301-2670"></a>pi.chr.sagrei <span class="ot">&lt;-</span> ordered</span>
<span id="cb301-2671"><a href="#cb301-2671"></a></span>
<span id="cb301-2672"><a href="#cb301-2672"></a></span>
<span id="cb301-2673"><a href="#cb301-2673"></a>pi.chr.sagrei</span>
<span id="cb301-2674"><a href="#cb301-2674"></a><span class="fu">str</span>(pi.chr.sagrei)</span>
<span id="cb301-2675"><a href="#cb301-2675"></a>value <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.sagrei<span class="sc">$</span>CHROM)</span>
<span id="cb301-2676"><a href="#cb301-2676"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="fl">5.4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb301-2677"><a href="#cb301-2677"></a><span class="fu">plot</span>(pi.chr.sagrei<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb301-2678"><a href="#cb301-2678"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>,</span>
<span id="cb301-2679"><a href="#cb301-2679"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">'Nucleotide diversity'</span><span class="sc">~</span>(pi)),</span>
<span id="cb301-2680"><a href="#cb301-2680"></a>     <span class="at">xlab =</span> <span class="st">'Genomic position'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>)</span>
<span id="cb301-2681"><a href="#cb301-2681"></a><span class="fu">grid</span>()</span>
<span id="cb301-2682"><a href="#cb301-2682"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-2683"><a href="#cb301-2683"></a><span class="fu">plot</span>(pi.chr.sagrei<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb301-2684"><a href="#cb301-2684"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb301-2685"><a href="#cb301-2685"></a>     <span class="at">xlab =</span> <span class="st">' '</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-2686"><a href="#cb301-2686"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.sagrei<span class="sc">$</span>CHROM),</span>
<span id="cb301-2687"><a href="#cb301-2687"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-2688"><a href="#cb301-2688"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.sagrei<span class="sc">$</span>CHROM), <span class="at">y =</span> <span class="fl">0.00045</span>, </span>
<span id="cb301-2689"><a href="#cb301-2689"></a>     <span class="at">labels =</span> pi.chr.sagrei<span class="sc">$</span>CHROM, <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">xpd =</span> <span class="cn">NA</span>,</span>
<span id="cb301-2690"><a href="#cb301-2690"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb301-2691"><a href="#cb301-2691"></a></span>
<span id="cb301-2692"><a href="#cb301-2692"></a></span>
<span id="cb301-2693"><a href="#cb301-2693"></a><span class="do">## Tajima's D</span></span>
<span id="cb301-2694"><a href="#cb301-2694"></a></span>
<span id="cb301-2695"><a href="#cb301-2695"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073870.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr1'</span></span>
<span id="cb301-2696"><a href="#cb301-2696"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073871.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr2'</span></span>
<span id="cb301-2697"><a href="#cb301-2697"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073872.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr3'</span></span>
<span id="cb301-2698"><a href="#cb301-2698"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073873.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr4'</span></span>
<span id="cb301-2699"><a href="#cb301-2699"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073874.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr5'</span></span>
<span id="cb301-2700"><a href="#cb301-2700"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073875.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr6'</span></span>
<span id="cb301-2701"><a href="#cb301-2701"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073876.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr7'</span></span>
<span id="cb301-2702"><a href="#cb301-2702"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073877.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr8'</span></span>
<span id="cb301-2703"><a href="#cb301-2703"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073878.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr9'</span></span>
<span id="cb301-2704"><a href="#cb301-2704"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073879.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr10'</span></span>
<span id="cb301-2705"><a href="#cb301-2705"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073880.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr11'</span></span>
<span id="cb301-2706"><a href="#cb301-2706"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073881.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr12'</span></span>
<span id="cb301-2707"><a href="#cb301-2707"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073882.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr13'</span></span>
<span id="cb301-2708"><a href="#cb301-2708"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073883.1'</span>] <span class="ot">&lt;-</span> <span class="st">'X'</span></span>
<span id="cb301-2709"><a href="#cb301-2709"></a>sagrei.td<span class="sc">$</span>CHROM[sagrei.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM073884.1'</span>] <span class="ot">&lt;-</span> <span class="st">'Y'</span></span>
<span id="cb301-2710"><a href="#cb301-2710"></a></span>
<span id="cb301-2711"><a href="#cb301-2711"></a><span class="fu">str</span>(sagrei.td)</span>
<span id="cb301-2712"><a href="#cb301-2712"></a></span>
<span id="cb301-2713"><a href="#cb301-2713"></a>d.chr.sagrei <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(sagrei.td<span class="sc">$</span>TajimaD,</span>
<span id="cb301-2714"><a href="#cb301-2714"></a>                          <span class="fu">list</span>(sagrei.td<span class="sc">$</span>CHROM),</span>
<span id="cb301-2715"><a href="#cb301-2715"></a>                          <span class="cf">function</span>(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb301-2716"><a href="#cb301-2716"></a><span class="fu">colnames</span>(d.chr.sagrei) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CHROM'</span>, <span class="st">'d'</span>)</span>
<span id="cb301-2717"><a href="#cb301-2717"></a><span class="fu">head</span>(d.chr.sagrei)</span>
<span id="cb301-2718"><a href="#cb301-2718"></a></span>
<span id="cb301-2719"><a href="#cb301-2719"></a>chrom <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'chr1'</span>, <span class="st">'chr2'</span>, <span class="st">'chr3'</span>, <span class="st">'chr4'</span>, <span class="st">'chr5'</span>, <span class="st">'chr6'</span>,</span>
<span id="cb301-2720"><a href="#cb301-2720"></a>  <span class="st">'chr7'</span>, <span class="st">'chr8'</span>, <span class="st">'chr9'</span>, <span class="st">'chr10'</span>, <span class="st">'chr11'</span>, <span class="st">'chr12'</span>,</span>
<span id="cb301-2721"><a href="#cb301-2721"></a>  <span class="st">'chr13'</span>, <span class="st">'X'</span>, <span class="st">'Y'</span>)</span>
<span id="cb301-2722"><a href="#cb301-2722"></a></span>
<span id="cb301-2723"><a href="#cb301-2723"></a>d.chr.sagrei <span class="ot">&lt;-</span> d.chr.sagrei[d.chr.sagrei<span class="sc">$</span>CHROM <span class="sc">%in%</span> chrom, ]</span>
<span id="cb301-2724"><a href="#cb301-2724"></a>ordered <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb301-2725"><a href="#cb301-2725"></a><span class="cf">for</span>(i <span class="cf">in</span> chrom){</span>
<span id="cb301-2726"><a href="#cb301-2726"></a>    obj <span class="ot">&lt;-</span> d.chr.sagrei[d.chr.sagrei<span class="sc">$</span>CHROM <span class="sc">==</span> i, ]</span>
<span id="cb301-2727"><a href="#cb301-2727"></a>    ordered <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ordered, obj)</span>
<span id="cb301-2728"><a href="#cb301-2728"></a>}</span>
<span id="cb301-2729"><a href="#cb301-2729"></a>d.chr.sagrei <span class="ot">&lt;-</span> ordered</span>
<span id="cb301-2730"><a href="#cb301-2730"></a></span>
<span id="cb301-2731"><a href="#cb301-2731"></a></span>
<span id="cb301-2732"><a href="#cb301-2732"></a>value <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.sagrei<span class="sc">$</span>CHROM)</span>
<span id="cb301-2733"><a href="#cb301-2733"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="fl">5.4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb301-2734"><a href="#cb301-2734"></a><span class="fu">plot</span>(d.chr.sagrei<span class="sc">$</span>d <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb301-2735"><a href="#cb301-2735"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Tajima's D"</span>),</span>
<span id="cb301-2736"><a href="#cb301-2736"></a>     <span class="at">xlab =</span> <span class="st">'Genomic position'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>)</span>
<span id="cb301-2737"><a href="#cb301-2737"></a><span class="fu">grid</span>()</span>
<span id="cb301-2738"><a href="#cb301-2738"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-2739"><a href="#cb301-2739"></a><span class="fu">plot</span>(d.chr.sagrei<span class="sc">$</span>d <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb301-2740"><a href="#cb301-2740"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb301-2741"><a href="#cb301-2741"></a>     <span class="at">xlab =</span> <span class="st">' '</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-2742"><a href="#cb301-2742"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.sagrei<span class="sc">$</span>CHROM),</span>
<span id="cb301-2743"><a href="#cb301-2743"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-2744"><a href="#cb301-2744"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.sagrei<span class="sc">$</span>CHROM), <span class="at">y =</span> <span class="fl">1.33</span>, </span>
<span id="cb301-2745"><a href="#cb301-2745"></a>     <span class="at">labels =</span> d.chr.sagrei<span class="sc">$</span>CHROM, <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">xpd =</span> <span class="cn">NA</span>,</span>
<span id="cb301-2746"><a href="#cb301-2746"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb301-2747"><a href="#cb301-2747"></a></span>
<span id="cb301-2748"><a href="#cb301-2748"></a></span>
<span id="cb301-2749"><a href="#cb301-2749"></a><span class="do">## Nucleotide diveristy</span></span>
<span id="cb301-2750"><a href="#cb301-2750"></a></span>
<span id="cb301-2751"><a href="#cb301-2751"></a>carolinensis.nd<span class="sc">$</span>CHROM[carolinensis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069367.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr1'</span></span>
<span id="cb301-2752"><a href="#cb301-2752"></a>carolinensis.nd<span class="sc">$</span>CHROM[carolinensis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069368.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr2'</span></span>
<span id="cb301-2753"><a href="#cb301-2753"></a>carolinensis.nd<span class="sc">$</span>CHROM[carolinensis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069369.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr3'</span></span>
<span id="cb301-2754"><a href="#cb301-2754"></a>carolinensis.nd<span class="sc">$</span>CHROM[carolinensis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069370.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr4'</span></span>
<span id="cb301-2755"><a href="#cb301-2755"></a>carolinensis.nd<span class="sc">$</span>CHROM[carolinensis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069371.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr5'</span></span>
<span id="cb301-2756"><a href="#cb301-2756"></a>carolinensis.nd<span class="sc">$</span>CHROM[carolinensis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069372.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr6'</span></span>
<span id="cb301-2757"><a href="#cb301-2757"></a>carolinensis.nd<span class="sc">$</span>CHROM[carolinensis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069373.1'</span>] <span class="ot">&lt;-</span> <span class="st">'X'</span></span>
<span id="cb301-2758"><a href="#cb301-2758"></a>carolinensis.nd<span class="sc">$</span>CHROM[carolinensis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069374.1'</span>] <span class="ot">&lt;-</span> <span class="st">'Y'</span></span>
<span id="cb301-2759"><a href="#cb301-2759"></a></span>
<span id="cb301-2760"><a href="#cb301-2760"></a><span class="fu">str</span>(carolinensis.nd)</span>
<span id="cb301-2761"><a href="#cb301-2761"></a></span>
<span id="cb301-2762"><a href="#cb301-2762"></a>pi.chr.carolinensis <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(carolinensis.nd<span class="sc">$</span>PI,</span>
<span id="cb301-2763"><a href="#cb301-2763"></a>                                 <span class="fu">list</span>(carolinensis.nd<span class="sc">$</span>CHROM), mean)</span>
<span id="cb301-2764"><a href="#cb301-2764"></a>pi.chr.carolinensis_sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(carolinensis.nd<span class="sc">$</span>PI,</span>
<span id="cb301-2765"><a href="#cb301-2765"></a>                           <span class="fu">list</span>(carolinensis.nd<span class="sc">$</span>CHROM), sd)</span>
<span id="cb301-2766"><a href="#cb301-2766"></a><span class="fu">colnames</span>(pi.chr.carolinensis) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CHROM'</span>, <span class="st">'pi'</span>)</span>
<span id="cb301-2767"><a href="#cb301-2767"></a><span class="fu">colnames</span>(pi.chr.carolinensis_sd) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CHROM'</span>, <span class="st">'sd'</span>)</span>
<span id="cb301-2768"><a href="#cb301-2768"></a><span class="fu">head</span>(pi.chr.carolinensis)</span>
<span id="cb301-2769"><a href="#cb301-2769"></a><span class="fu">head</span>(pi.chr.carolinensis_sd)</span>
<span id="cb301-2770"><a href="#cb301-2770"></a></span>
<span id="cb301-2771"><a href="#cb301-2771"></a>chrom <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'chr1'</span>, <span class="st">'chr2'</span>, <span class="st">'chr3'</span>, <span class="st">'chr4'</span>, <span class="st">'chr5'</span>, <span class="st">'chr6'</span>,</span>
<span id="cb301-2772"><a href="#cb301-2772"></a>           <span class="st">'X'</span>, <span class="st">'Y'</span>)</span>
<span id="cb301-2773"><a href="#cb301-2773"></a></span>
<span id="cb301-2774"><a href="#cb301-2774"></a>pi.chr.carolinensis <span class="ot">&lt;-</span> pi.chr.carolinensis[pi.chr.carolinensis<span class="sc">$</span>CHROM <span class="sc">%in%</span> chrom, ]</span>
<span id="cb301-2775"><a href="#cb301-2775"></a>pi.chr.carolinensis_sd <span class="ot">&lt;-</span> pi.chr.carolinensis_sd[pi.chr.carolinensis_sd<span class="sc">$</span>CHROM <span class="sc">%in%</span></span>
<span id="cb301-2776"><a href="#cb301-2776"></a>                                                 chrom, ]</span>
<span id="cb301-2777"><a href="#cb301-2777"></a></span>
<span id="cb301-2778"><a href="#cb301-2778"></a></span>
<span id="cb301-2779"><a href="#cb301-2779"></a>pi.chr.carolinensis<span class="sc">$</span>sd <span class="ot">&lt;-</span> pi.chr.carolinensis_sd<span class="sc">$</span>sd</span>
<span id="cb301-2780"><a href="#cb301-2780"></a><span class="fu">str</span>(pi.chr.carolinensis)</span>
<span id="cb301-2781"><a href="#cb301-2781"></a></span>
<span id="cb301-2782"><a href="#cb301-2782"></a>value <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.carolinensis<span class="sc">$</span>CHROM)</span>
<span id="cb301-2783"><a href="#cb301-2783"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="fl">5.4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb301-2784"><a href="#cb301-2784"></a><span class="fu">plot</span>(pi.chr.carolinensis<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb301-2785"><a href="#cb301-2785"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>,</span>
<span id="cb301-2786"><a href="#cb301-2786"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">'Nucleotide diversity'</span><span class="sc">~</span>(pi)),</span>
<span id="cb301-2787"><a href="#cb301-2787"></a>     <span class="at">xlab =</span> <span class="st">'Genomic position'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb301-2788"><a href="#cb301-2788"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.carolinensis<span class="sc">$</span>sd),</span>
<span id="cb301-2789"><a href="#cb301-2789"></a>              <span class="fu">max</span>(pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.carolinensis<span class="sc">$</span>sd)))</span>
<span id="cb301-2790"><a href="#cb301-2790"></a><span class="fu">grid</span>()</span>
<span id="cb301-2791"><a href="#cb301-2791"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-2792"><a href="#cb301-2792"></a><span class="fu">plot</span>(pi.chr.carolinensis<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb301-2793"><a href="#cb301-2793"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb301-2794"><a href="#cb301-2794"></a>     <span class="at">xlab =</span> <span class="st">' '</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb301-2795"><a href="#cb301-2795"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.carolinensis<span class="sc">$</span>sd),</span>
<span id="cb301-2796"><a href="#cb301-2796"></a>              <span class="fu">max</span>(pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.carolinensis<span class="sc">$</span>sd)))</span>
<span id="cb301-2797"><a href="#cb301-2797"></a><span class="fu">segments</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pi.chr.carolinensis),</span>
<span id="cb301-2798"><a href="#cb301-2798"></a>         pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.carolinensis<span class="sc">$</span>sd,</span>
<span id="cb301-2799"><a href="#cb301-2799"></a>         <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pi.chr.carolinensis),</span>
<span id="cb301-2800"><a href="#cb301-2800"></a>         pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.carolinensis<span class="sc">$</span>sd,</span>
<span id="cb301-2801"><a href="#cb301-2801"></a>         <span class="at">lwd =</span> <span class="fl">2.2</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>)</span>
<span id="cb301-2802"><a href="#cb301-2802"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.carolinensis<span class="sc">$</span>CHROM),</span>
<span id="cb301-2803"><a href="#cb301-2803"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-2804"><a href="#cb301-2804"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.carolinensis<span class="sc">$</span>CHROM), <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.0007</span>, </span>
<span id="cb301-2805"><a href="#cb301-2805"></a>     <span class="at">labels =</span> pi.chr.carolinensis<span class="sc">$</span>CHROM, <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">xpd =</span> <span class="cn">NA</span>,</span>
<span id="cb301-2806"><a href="#cb301-2806"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb301-2807"><a href="#cb301-2807"></a></span>
<span id="cb301-2808"><a href="#cb301-2808"></a></span>
<span id="cb301-2809"><a href="#cb301-2809"></a><span class="do">## Tajima's D</span></span>
<span id="cb301-2810"><a href="#cb301-2810"></a></span>
<span id="cb301-2811"><a href="#cb301-2811"></a>carolinensis.td<span class="sc">$</span>CHROM[carolinensis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069367.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr1'</span></span>
<span id="cb301-2812"><a href="#cb301-2812"></a>carolinensis.td<span class="sc">$</span>CHROM[carolinensis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069368.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr2'</span></span>
<span id="cb301-2813"><a href="#cb301-2813"></a>carolinensis.td<span class="sc">$</span>CHROM[carolinensis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069369.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr3'</span></span>
<span id="cb301-2814"><a href="#cb301-2814"></a>carolinensis.td<span class="sc">$</span>CHROM[carolinensis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069370.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr4'</span></span>
<span id="cb301-2815"><a href="#cb301-2815"></a>carolinensis.td<span class="sc">$</span>CHROM[carolinensis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069371.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr5'</span></span>
<span id="cb301-2816"><a href="#cb301-2816"></a>carolinensis.td<span class="sc">$</span>CHROM[carolinensis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069372.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr6'</span></span>
<span id="cb301-2817"><a href="#cb301-2817"></a>carolinensis.td<span class="sc">$</span>CHROM[carolinensis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069373.1'</span>] <span class="ot">&lt;-</span> <span class="st">'X'</span></span>
<span id="cb301-2818"><a href="#cb301-2818"></a>carolinensis.td<span class="sc">$</span>CHROM[carolinensis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'CM069374.1'</span>] <span class="ot">&lt;-</span> <span class="st">'Y'</span></span>
<span id="cb301-2819"><a href="#cb301-2819"></a></span>
<span id="cb301-2820"><a href="#cb301-2820"></a><span class="fu">str</span>(carolinensis.td)</span>
<span id="cb301-2821"><a href="#cb301-2821"></a></span>
<span id="cb301-2822"><a href="#cb301-2822"></a>d.chr.carolinensis <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(carolinensis.td<span class="sc">$</span>TajimaD,</span>
<span id="cb301-2823"><a href="#cb301-2823"></a>                                <span class="fu">list</span>(carolinensis.td<span class="sc">$</span>CHROM),</span>
<span id="cb301-2824"><a href="#cb301-2824"></a>                                <span class="cf">function</span>(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb301-2825"><a href="#cb301-2825"></a><span class="fu">colnames</span>(d.chr.carolinensis) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CHROM'</span>, <span class="st">'d'</span>)</span>
<span id="cb301-2826"><a href="#cb301-2826"></a><span class="fu">head</span>(d.chr.carolinensis)</span>
<span id="cb301-2827"><a href="#cb301-2827"></a></span>
<span id="cb301-2828"><a href="#cb301-2828"></a>chrom <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'chr1'</span>, <span class="st">'chr2'</span>, <span class="st">'chr3'</span>, <span class="st">'chr4'</span>, <span class="st">'chr5'</span>, <span class="st">'chr6'</span>,</span>
<span id="cb301-2829"><a href="#cb301-2829"></a>           <span class="st">'X'</span>, <span class="st">'Y'</span>)</span>
<span id="cb301-2830"><a href="#cb301-2830"></a></span>
<span id="cb301-2831"><a href="#cb301-2831"></a>d.chr.carolinensis <span class="ot">&lt;-</span> d.chr.carolinensis[d.chr.carolinensis<span class="sc">$</span>CHROM <span class="sc">%in%</span> chrom, ]</span>
<span id="cb301-2832"><a href="#cb301-2832"></a></span>
<span id="cb301-2833"><a href="#cb301-2833"></a>d.chr.carolinensis</span>
<span id="cb301-2834"><a href="#cb301-2834"></a><span class="fu">str</span>(d.chr.carolinensis)</span>
<span id="cb301-2835"><a href="#cb301-2835"></a></span>
<span id="cb301-2836"><a href="#cb301-2836"></a>value <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.carolinensis<span class="sc">$</span>CHROM)</span>
<span id="cb301-2837"><a href="#cb301-2837"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="fl">5.4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb301-2838"><a href="#cb301-2838"></a><span class="fu">plot</span>(d.chr.carolinensis<span class="sc">$</span>d <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb301-2839"><a href="#cb301-2839"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Tajima's D"</span>),</span>
<span id="cb301-2840"><a href="#cb301-2840"></a>     <span class="at">xlab =</span> <span class="st">'Genomic position'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>)</span>
<span id="cb301-2841"><a href="#cb301-2841"></a><span class="fu">grid</span>()</span>
<span id="cb301-2842"><a href="#cb301-2842"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-2843"><a href="#cb301-2843"></a><span class="fu">plot</span>(d.chr.carolinensis<span class="sc">$</span>d <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb301-2844"><a href="#cb301-2844"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb301-2845"><a href="#cb301-2845"></a>     <span class="at">xlab =</span> <span class="st">' '</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-2846"><a href="#cb301-2846"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.carolinensis<span class="sc">$</span>CHROM),</span>
<span id="cb301-2847"><a href="#cb301-2847"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-2848"><a href="#cb301-2848"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.carolinensis<span class="sc">$</span>CHROM), <span class="at">y =</span> <span class="fl">0.05</span>, </span>
<span id="cb301-2849"><a href="#cb301-2849"></a>     <span class="at">labels =</span> d.chr.carolinensis<span class="sc">$</span>CHROM, <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">xpd =</span> <span class="cn">NA</span>,</span>
<span id="cb301-2850"><a href="#cb301-2850"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb301-2851"><a href="#cb301-2851"></a></span>
<span id="cb301-2852"><a href="#cb301-2852"></a></span>
<span id="cb301-2853"><a href="#cb301-2853"></a><span class="do">## Nucleotide diveristy</span></span>
<span id="cb301-2854"><a href="#cb301-2854"></a></span>
<span id="cb301-2855"><a href="#cb301-2855"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076838.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr1'</span></span>
<span id="cb301-2856"><a href="#cb301-2856"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076839.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr2'</span></span>
<span id="cb301-2857"><a href="#cb301-2857"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076840.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr3'</span></span>
<span id="cb301-2858"><a href="#cb301-2858"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076841.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr4'</span></span>
<span id="cb301-2859"><a href="#cb301-2859"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076842.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr5'</span></span>
<span id="cb301-2860"><a href="#cb301-2860"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076843.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr6'</span></span>
<span id="cb301-2861"><a href="#cb301-2861"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076844.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr7'</span></span>
<span id="cb301-2862"><a href="#cb301-2862"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076845.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr8'</span></span>
<span id="cb301-2863"><a href="#cb301-2863"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076846.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr9'</span></span>
<span id="cb301-2864"><a href="#cb301-2864"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076847.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr10'</span></span>
<span id="cb301-2865"><a href="#cb301-2865"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076848.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr11'</span></span>
<span id="cb301-2866"><a href="#cb301-2866"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076849.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr12'</span></span>
<span id="cb301-2867"><a href="#cb301-2867"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076850.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr13'</span></span>
<span id="cb301-2868"><a href="#cb301-2868"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076851.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr14'</span></span>
<span id="cb301-2869"><a href="#cb301-2869"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076853.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr15'</span></span>
<span id="cb301-2870"><a href="#cb301-2870"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076854.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr16'</span></span>
<span id="cb301-2871"><a href="#cb301-2871"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076855.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr17'</span></span>
<span id="cb301-2872"><a href="#cb301-2872"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076857.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr18'</span></span>
<span id="cb301-2873"><a href="#cb301-2873"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076856.1'</span>] <span class="ot">&lt;-</span> <span class="st">'W'</span></span>
<span id="cb301-2874"><a href="#cb301-2874"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076852.1'</span>] <span class="ot">&lt;-</span> <span class="st">'Z'</span></span>
<span id="cb301-2875"><a href="#cb301-2875"></a>siculus.nd<span class="sc">$</span>CHROM[siculus.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076858.1'</span>] <span class="ot">&lt;-</span> <span class="st">'MT'</span></span>
<span id="cb301-2876"><a href="#cb301-2876"></a></span>
<span id="cb301-2877"><a href="#cb301-2877"></a><span class="fu">str</span>(siculus.nd)</span>
<span id="cb301-2878"><a href="#cb301-2878"></a></span>
<span id="cb301-2879"><a href="#cb301-2879"></a>pi.chr.siculus <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(siculus.nd<span class="sc">$</span>PI,</span>
<span id="cb301-2880"><a href="#cb301-2880"></a>                           <span class="fu">list</span>(siculus.nd<span class="sc">$</span>CHROM), mean)</span>
<span id="cb301-2881"><a href="#cb301-2881"></a><span class="fu">colnames</span>(pi.chr.siculus) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CHROM'</span>, <span class="st">'pi'</span>)</span>
<span id="cb301-2882"><a href="#cb301-2882"></a><span class="fu">head</span>(pi.chr.siculus)</span>
<span id="cb301-2883"><a href="#cb301-2883"></a></span>
<span id="cb301-2884"><a href="#cb301-2884"></a>chrom <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'chr1'</span>, <span class="st">'chr2'</span>, <span class="st">'chr3'</span>, <span class="st">'chr4'</span>, <span class="st">'chr5'</span>, <span class="st">'chr6'</span>,</span>
<span id="cb301-2885"><a href="#cb301-2885"></a>  <span class="st">'chr7'</span>, <span class="st">'chr8'</span>, <span class="st">'chr9'</span>, <span class="st">'chr10'</span>, <span class="st">'chr11'</span>, <span class="st">'chr12'</span>,</span>
<span id="cb301-2886"><a href="#cb301-2886"></a>  <span class="st">'chr13'</span>, <span class="st">'chr14'</span>, <span class="st">'chr15'</span>, <span class="st">'chr16'</span>, <span class="st">'chr17'</span>, <span class="st">'chr18'</span>,</span>
<span id="cb301-2887"><a href="#cb301-2887"></a>  <span class="st">'W'</span>, <span class="st">'Z'</span>, <span class="st">'MT'</span>)</span>
<span id="cb301-2888"><a href="#cb301-2888"></a></span>
<span id="cb301-2889"><a href="#cb301-2889"></a>pi.chr.siculus <span class="ot">&lt;-</span> pi.chr.siculus[pi.chr.siculus<span class="sc">$</span>CHROM <span class="sc">%in%</span> chrom, ]</span>
<span id="cb301-2890"><a href="#cb301-2890"></a>ordered <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb301-2891"><a href="#cb301-2891"></a><span class="cf">for</span>(i <span class="cf">in</span> chrom){</span>
<span id="cb301-2892"><a href="#cb301-2892"></a>    obj <span class="ot">&lt;-</span> pi.chr.siculus[pi.chr.siculus<span class="sc">$</span>CHROM <span class="sc">==</span> i, ]</span>
<span id="cb301-2893"><a href="#cb301-2893"></a>    ordered <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ordered, obj)</span>
<span id="cb301-2894"><a href="#cb301-2894"></a>}</span>
<span id="cb301-2895"><a href="#cb301-2895"></a>pi.chr.siculus <span class="ot">&lt;-</span> ordered</span>
<span id="cb301-2896"><a href="#cb301-2896"></a></span>
<span id="cb301-2897"><a href="#cb301-2897"></a></span>
<span id="cb301-2898"><a href="#cb301-2898"></a>value <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.siculus<span class="sc">$</span>CHROM)</span>
<span id="cb301-2899"><a href="#cb301-2899"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="fl">5.4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb301-2900"><a href="#cb301-2900"></a><span class="fu">plot</span>(pi.chr.siculus<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb301-2901"><a href="#cb301-2901"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>,</span>
<span id="cb301-2902"><a href="#cb301-2902"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">'Nucleotide diversity'</span><span class="sc">~</span>(pi)),</span>
<span id="cb301-2903"><a href="#cb301-2903"></a>     <span class="at">xlab =</span> <span class="st">'Genomic position'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>)</span>
<span id="cb301-2904"><a href="#cb301-2904"></a><span class="fu">grid</span>()</span>
<span id="cb301-2905"><a href="#cb301-2905"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-2906"><a href="#cb301-2906"></a><span class="fu">plot</span>(pi.chr.siculus<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb301-2907"><a href="#cb301-2907"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb301-2908"><a href="#cb301-2908"></a>     <span class="at">xlab =</span> <span class="st">' '</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-2909"><a href="#cb301-2909"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.siculus<span class="sc">$</span>CHROM),</span>
<span id="cb301-2910"><a href="#cb301-2910"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-2911"><a href="#cb301-2911"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.siculus<span class="sc">$</span>CHROM), <span class="at">y =</span> <span class="fl">0.0028</span>, </span>
<span id="cb301-2912"><a href="#cb301-2912"></a>     <span class="at">labels =</span> pi.chr.siculus<span class="sc">$</span>CHROM, <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">xpd =</span> <span class="cn">NA</span>,</span>
<span id="cb301-2913"><a href="#cb301-2913"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb301-2914"><a href="#cb301-2914"></a></span>
<span id="cb301-2915"><a href="#cb301-2915"></a></span>
<span id="cb301-2916"><a href="#cb301-2916"></a><span class="do">## Tajima's D</span></span>
<span id="cb301-2917"><a href="#cb301-2917"></a></span>
<span id="cb301-2918"><a href="#cb301-2918"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076838.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr1'</span></span>
<span id="cb301-2919"><a href="#cb301-2919"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076839.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr2'</span></span>
<span id="cb301-2920"><a href="#cb301-2920"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076840.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr3'</span></span>
<span id="cb301-2921"><a href="#cb301-2921"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076841.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr4'</span></span>
<span id="cb301-2922"><a href="#cb301-2922"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076842.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr5'</span></span>
<span id="cb301-2923"><a href="#cb301-2923"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076843.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr6'</span></span>
<span id="cb301-2924"><a href="#cb301-2924"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076844.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr7'</span></span>
<span id="cb301-2925"><a href="#cb301-2925"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076845.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr8'</span></span>
<span id="cb301-2926"><a href="#cb301-2926"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076846.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr9'</span></span>
<span id="cb301-2927"><a href="#cb301-2927"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076847.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr10'</span></span>
<span id="cb301-2928"><a href="#cb301-2928"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076848.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr11'</span></span>
<span id="cb301-2929"><a href="#cb301-2929"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076849.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr12'</span></span>
<span id="cb301-2930"><a href="#cb301-2930"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076850.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr13'</span></span>
<span id="cb301-2931"><a href="#cb301-2931"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076851.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr14'</span></span>
<span id="cb301-2932"><a href="#cb301-2932"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076853.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr15'</span></span>
<span id="cb301-2933"><a href="#cb301-2933"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076854.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr16'</span></span>
<span id="cb301-2934"><a href="#cb301-2934"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076855.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr17'</span></span>
<span id="cb301-2935"><a href="#cb301-2935"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076857.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr18'</span></span>
<span id="cb301-2936"><a href="#cb301-2936"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076856.1'</span>] <span class="ot">&lt;-</span> <span class="st">'W'</span></span>
<span id="cb301-2937"><a href="#cb301-2937"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076852.1'</span>] <span class="ot">&lt;-</span> <span class="st">'Z'</span></span>
<span id="cb301-2938"><a href="#cb301-2938"></a>siculus.td<span class="sc">$</span>CHROM[siculus.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'OZ076858.1'</span>] <span class="ot">&lt;-</span> <span class="st">'MT'</span></span>
<span id="cb301-2939"><a href="#cb301-2939"></a></span>
<span id="cb301-2940"><a href="#cb301-2940"></a><span class="fu">str</span>(siculus.td)</span>
<span id="cb301-2941"><a href="#cb301-2941"></a></span>
<span id="cb301-2942"><a href="#cb301-2942"></a>d.chr.siculus <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(siculus.td<span class="sc">$</span>TajimaD,</span>
<span id="cb301-2943"><a href="#cb301-2943"></a>                           <span class="fu">list</span>(siculus.td<span class="sc">$</span>CHROM),</span>
<span id="cb301-2944"><a href="#cb301-2944"></a>                           <span class="cf">function</span>(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb301-2945"><a href="#cb301-2945"></a><span class="fu">colnames</span>(d.chr.siculus) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CHROM'</span>, <span class="st">'d'</span>)</span>
<span id="cb301-2946"><a href="#cb301-2946"></a><span class="fu">head</span>(d.chr.siculus)</span>
<span id="cb301-2947"><a href="#cb301-2947"></a></span>
<span id="cb301-2948"><a href="#cb301-2948"></a>chrom <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'chr1'</span>, <span class="st">'chr2'</span>, <span class="st">'chr3'</span>, <span class="st">'chr4'</span>, <span class="st">'chr5'</span>, <span class="st">'chr6'</span>,</span>
<span id="cb301-2949"><a href="#cb301-2949"></a>  <span class="st">'chr7'</span>, <span class="st">'chr8'</span>, <span class="st">'chr9'</span>, <span class="st">'chr10'</span>, <span class="st">'chr11'</span>, <span class="st">'chr12'</span>,</span>
<span id="cb301-2950"><a href="#cb301-2950"></a>  <span class="st">'chr13'</span>, <span class="st">'chr14'</span>, <span class="st">'chr15'</span>, <span class="st">'chr16'</span>, <span class="st">'chr17'</span>, <span class="st">'chr18'</span>,</span>
<span id="cb301-2951"><a href="#cb301-2951"></a>  <span class="st">'W'</span>, <span class="st">'Z'</span>, <span class="st">'MT'</span>)</span>
<span id="cb301-2952"><a href="#cb301-2952"></a></span>
<span id="cb301-2953"><a href="#cb301-2953"></a>d.chr.siculus <span class="ot">&lt;-</span> d.chr.siculus[d.chr.siculus<span class="sc">$</span>CHROM <span class="sc">%in%</span> chrom, ]</span>
<span id="cb301-2954"><a href="#cb301-2954"></a>ordered <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb301-2955"><a href="#cb301-2955"></a><span class="cf">for</span>(i <span class="cf">in</span> chrom){</span>
<span id="cb301-2956"><a href="#cb301-2956"></a>    obj <span class="ot">&lt;-</span> d.chr.siculus[d.chr.siculus<span class="sc">$</span>CHROM <span class="sc">==</span> i, ]</span>
<span id="cb301-2957"><a href="#cb301-2957"></a>    ordered <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ordered, obj)</span>
<span id="cb301-2958"><a href="#cb301-2958"></a>}</span>
<span id="cb301-2959"><a href="#cb301-2959"></a>d.chr.siculus <span class="ot">&lt;-</span> ordered</span>
<span id="cb301-2960"><a href="#cb301-2960"></a></span>
<span id="cb301-2961"><a href="#cb301-2961"></a></span>
<span id="cb301-2962"><a href="#cb301-2962"></a>value <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.siculus<span class="sc">$</span>CHROM)</span>
<span id="cb301-2963"><a href="#cb301-2963"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="fl">5.4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb301-2964"><a href="#cb301-2964"></a><span class="fu">plot</span>(d.chr.siculus<span class="sc">$</span>d <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb301-2965"><a href="#cb301-2965"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Tajima's D"</span>),</span>
<span id="cb301-2966"><a href="#cb301-2966"></a>     <span class="at">xlab =</span> <span class="st">'Genomic position'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>)</span>
<span id="cb301-2967"><a href="#cb301-2967"></a><span class="fu">grid</span>()</span>
<span id="cb301-2968"><a href="#cb301-2968"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-2969"><a href="#cb301-2969"></a><span class="fu">plot</span>(d.chr.siculus<span class="sc">$</span>d <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb301-2970"><a href="#cb301-2970"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb301-2971"><a href="#cb301-2971"></a>     <span class="at">xlab =</span> <span class="st">' '</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-2972"><a href="#cb301-2972"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.siculus<span class="sc">$</span>CHROM),</span>
<span id="cb301-2973"><a href="#cb301-2973"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-2974"><a href="#cb301-2974"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.siculus<span class="sc">$</span>CHROM), <span class="at">y =</span> <span class="fl">0.65</span>, </span>
<span id="cb301-2975"><a href="#cb301-2975"></a>     <span class="at">labels =</span> d.chr.siculus<span class="sc">$</span>CHROM, <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">xpd =</span> <span class="cn">NA</span>,</span>
<span id="cb301-2976"><a href="#cb301-2976"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb301-2977"><a href="#cb301-2977"></a></span>
<span id="cb301-2978"><a href="#cb301-2978"></a></span>
<span id="cb301-2979"><a href="#cb301-2979"></a><span class="do">## Nucleotide diveristy</span></span>
<span id="cb301-2980"><a href="#cb301-2980"></a></span>
<span id="cb301-2981"><a href="#cb301-2981"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041312.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr1'</span></span>
<span id="cb301-2982"><a href="#cb301-2982"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041313.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr2'</span></span>
<span id="cb301-2983"><a href="#cb301-2983"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041314.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr3'</span></span>
<span id="cb301-2984"><a href="#cb301-2984"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041315.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr4'</span></span>
<span id="cb301-2985"><a href="#cb301-2985"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041316.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr5'</span></span>
<span id="cb301-2986"><a href="#cb301-2986"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041317.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr6'</span></span>
<span id="cb301-2987"><a href="#cb301-2987"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041318.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr7'</span></span>
<span id="cb301-2988"><a href="#cb301-2988"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041319.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr8'</span></span>
<span id="cb301-2989"><a href="#cb301-2989"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041320.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr9'</span></span>
<span id="cb301-2990"><a href="#cb301-2990"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041321.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr10'</span></span>
<span id="cb301-2991"><a href="#cb301-2991"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041322.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr11'</span></span>
<span id="cb301-2992"><a href="#cb301-2992"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041323.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr12'</span></span>
<span id="cb301-2993"><a href="#cb301-2993"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041324.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr13'</span></span>
<span id="cb301-2994"><a href="#cb301-2994"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041325.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr14'</span></span>
<span id="cb301-2995"><a href="#cb301-2995"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041326.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr15'</span></span>
<span id="cb301-2996"><a href="#cb301-2996"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041327.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr16'</span></span>
<span id="cb301-2997"><a href="#cb301-2997"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041328.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr17'</span></span>
<span id="cb301-2998"><a href="#cb301-2998"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041329.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr18'</span></span>
<span id="cb301-2999"><a href="#cb301-2999"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041330.1'</span>] <span class="ot">&lt;-</span> <span class="st">'Z'</span></span>
<span id="cb301-3000"><a href="#cb301-3000"></a>muralis.nd<span class="sc">$</span>CHROM[muralis.nd<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_011607.1'</span>] <span class="ot">&lt;-</span> <span class="st">'MT'</span></span>
<span id="cb301-3001"><a href="#cb301-3001"></a></span>
<span id="cb301-3002"><a href="#cb301-3002"></a></span>
<span id="cb301-3003"><a href="#cb301-3003"></a><span class="fu">str</span>(muralis.nd)</span>
<span id="cb301-3004"><a href="#cb301-3004"></a></span>
<span id="cb301-3005"><a href="#cb301-3005"></a>pi.chr.muralis <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(muralis.nd<span class="sc">$</span>PI,</span>
<span id="cb301-3006"><a href="#cb301-3006"></a>                           <span class="fu">list</span>(muralis.nd<span class="sc">$</span>CHROM), mean)</span>
<span id="cb301-3007"><a href="#cb301-3007"></a>pi.chr.muralis_sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(muralis.nd<span class="sc">$</span>PI,</span>
<span id="cb301-3008"><a href="#cb301-3008"></a>                           <span class="fu">list</span>(muralis.nd<span class="sc">$</span>CHROM), sd)</span>
<span id="cb301-3009"><a href="#cb301-3009"></a></span>
<span id="cb301-3010"><a href="#cb301-3010"></a><span class="fu">colnames</span>(pi.chr.muralis) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CHROM'</span>, <span class="st">'pi'</span>)</span>
<span id="cb301-3011"><a href="#cb301-3011"></a><span class="fu">colnames</span>(pi.chr.muralis_sd) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CHROM'</span>, <span class="st">'sd'</span>)</span>
<span id="cb301-3012"><a href="#cb301-3012"></a><span class="fu">head</span>(pi.chr.muralis)</span>
<span id="cb301-3013"><a href="#cb301-3013"></a><span class="fu">head</span>(pi.chr.muralis_sd)</span>
<span id="cb301-3014"><a href="#cb301-3014"></a></span>
<span id="cb301-3015"><a href="#cb301-3015"></a>chrom <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'chr1'</span>, <span class="st">'chr2'</span>, <span class="st">'chr3'</span>, <span class="st">'chr4'</span>, <span class="st">'chr5'</span>, <span class="st">'chr6'</span>,</span>
<span id="cb301-3016"><a href="#cb301-3016"></a>  <span class="st">'chr7'</span>, <span class="st">'chr8'</span>, <span class="st">'chr9'</span>, <span class="st">'chr10'</span>, <span class="st">'chr11'</span>, <span class="st">'chr12'</span>,</span>
<span id="cb301-3017"><a href="#cb301-3017"></a>  <span class="st">'chr13'</span>, <span class="st">'chr14'</span>, <span class="st">'chr15'</span>, <span class="st">'chr16'</span>, <span class="st">'chr17'</span>, <span class="st">'chr18'</span>,</span>
<span id="cb301-3018"><a href="#cb301-3018"></a>  <span class="st">'Z'</span>, <span class="st">'MT'</span>)</span>
<span id="cb301-3019"><a href="#cb301-3019"></a></span>
<span id="cb301-3020"><a href="#cb301-3020"></a>pi.chr.muralis <span class="ot">&lt;-</span> pi.chr.muralis[pi.chr.muralis<span class="sc">$</span>CHROM <span class="sc">%in%</span> chrom, ]</span>
<span id="cb301-3021"><a href="#cb301-3021"></a>ordered <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb301-3022"><a href="#cb301-3022"></a><span class="cf">for</span>(i <span class="cf">in</span> chrom){</span>
<span id="cb301-3023"><a href="#cb301-3023"></a>    obj <span class="ot">&lt;-</span> pi.chr.muralis[pi.chr.muralis<span class="sc">$</span>CHROM <span class="sc">==</span> i, ]</span>
<span id="cb301-3024"><a href="#cb301-3024"></a>    ordered <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ordered, obj)</span>
<span id="cb301-3025"><a href="#cb301-3025"></a>}</span>
<span id="cb301-3026"><a href="#cb301-3026"></a>pi.chr.muralis <span class="ot">&lt;-</span> ordered</span>
<span id="cb301-3027"><a href="#cb301-3027"></a></span>
<span id="cb301-3028"><a href="#cb301-3028"></a>pi.chr.muralis_sd <span class="ot">&lt;-</span> pi.chr.muralis_sd[pi.chr.muralis_sd<span class="sc">$</span>CHROM <span class="sc">%in%</span> chrom, ]</span>
<span id="cb301-3029"><a href="#cb301-3029"></a>ordered <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb301-3030"><a href="#cb301-3030"></a><span class="cf">for</span>(i <span class="cf">in</span> chrom){</span>
<span id="cb301-3031"><a href="#cb301-3031"></a>    obj <span class="ot">&lt;-</span> pi.chr.muralis_sd[pi.chr.muralis_sd<span class="sc">$</span>CHROM <span class="sc">==</span> i, ]</span>
<span id="cb301-3032"><a href="#cb301-3032"></a>    ordered <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ordered, obj)</span>
<span id="cb301-3033"><a href="#cb301-3033"></a>}</span>
<span id="cb301-3034"><a href="#cb301-3034"></a>pi.chr.muralis_sd <span class="ot">&lt;-</span> ordered</span>
<span id="cb301-3035"><a href="#cb301-3035"></a>pi.chr.muralis<span class="sc">$</span>sd <span class="ot">&lt;-</span> pi.chr.muralis_sd<span class="sc">$</span>sd</span>
<span id="cb301-3036"><a href="#cb301-3036"></a></span>
<span id="cb301-3037"><a href="#cb301-3037"></a>value <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.muralis<span class="sc">$</span>CHROM)</span>
<span id="cb301-3038"><a href="#cb301-3038"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="fl">5.4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb301-3039"><a href="#cb301-3039"></a><span class="fu">plot</span>(pi.chr.muralis<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb301-3040"><a href="#cb301-3040"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>,</span>
<span id="cb301-3041"><a href="#cb301-3041"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">'Nucleotide diversity'</span><span class="sc">~</span>(pi)),</span>
<span id="cb301-3042"><a href="#cb301-3042"></a>     <span class="at">xlab =</span> <span class="st">'Genomic position'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb301-3043"><a href="#cb301-3043"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(pi.chr.muralis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.muralis<span class="sc">$</span>sd),</span>
<span id="cb301-3044"><a href="#cb301-3044"></a>              <span class="fu">max</span>(pi.chr.muralis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.muralis<span class="sc">$</span>sd)))</span>
<span id="cb301-3045"><a href="#cb301-3045"></a><span class="fu">grid</span>()</span>
<span id="cb301-3046"><a href="#cb301-3046"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-3047"><a href="#cb301-3047"></a><span class="fu">plot</span>(pi.chr.muralis<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb301-3048"><a href="#cb301-3048"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb301-3049"><a href="#cb301-3049"></a>     <span class="at">xlab =</span> <span class="st">' '</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb301-3050"><a href="#cb301-3050"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(pi.chr.muralis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.muralis<span class="sc">$</span>sd),</span>
<span id="cb301-3051"><a href="#cb301-3051"></a>              <span class="fu">max</span>(pi.chr.muralis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.muralis<span class="sc">$</span>sd)))</span>
<span id="cb301-3052"><a href="#cb301-3052"></a><span class="fu">segments</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pi.chr.muralis),</span>
<span id="cb301-3053"><a href="#cb301-3053"></a>         pi.chr.muralis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.muralis<span class="sc">$</span>sd,</span>
<span id="cb301-3054"><a href="#cb301-3054"></a>         <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pi.chr.muralis),</span>
<span id="cb301-3055"><a href="#cb301-3055"></a>         pi.chr.muralis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.muralis<span class="sc">$</span>sd,</span>
<span id="cb301-3056"><a href="#cb301-3056"></a>         <span class="at">lwd =</span> <span class="fl">2.2</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>)</span>
<span id="cb301-3057"><a href="#cb301-3057"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.muralis<span class="sc">$</span>CHROM),</span>
<span id="cb301-3058"><a href="#cb301-3058"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-3059"><a href="#cb301-3059"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.muralis<span class="sc">$</span>CHROM), <span class="at">y =</span> <span class="fl">0.0029</span>, </span>
<span id="cb301-3060"><a href="#cb301-3060"></a>     <span class="at">labels =</span> pi.chr.muralis<span class="sc">$</span>CHROM, <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">xpd =</span> <span class="cn">NA</span>,</span>
<span id="cb301-3061"><a href="#cb301-3061"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb301-3062"><a href="#cb301-3062"></a></span>
<span id="cb301-3063"><a href="#cb301-3063"></a></span>
<span id="cb301-3064"><a href="#cb301-3064"></a><span class="do">## Tajima's D</span></span>
<span id="cb301-3065"><a href="#cb301-3065"></a></span>
<span id="cb301-3066"><a href="#cb301-3066"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041312.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr1'</span></span>
<span id="cb301-3067"><a href="#cb301-3067"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041313.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr2'</span></span>
<span id="cb301-3068"><a href="#cb301-3068"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041314.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr3'</span></span>
<span id="cb301-3069"><a href="#cb301-3069"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041315.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr4'</span></span>
<span id="cb301-3070"><a href="#cb301-3070"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041316.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr5'</span></span>
<span id="cb301-3071"><a href="#cb301-3071"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041317.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr6'</span></span>
<span id="cb301-3072"><a href="#cb301-3072"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041318.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr7'</span></span>
<span id="cb301-3073"><a href="#cb301-3073"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041319.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr8'</span></span>
<span id="cb301-3074"><a href="#cb301-3074"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041320.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr9'</span></span>
<span id="cb301-3075"><a href="#cb301-3075"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041321.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr10'</span></span>
<span id="cb301-3076"><a href="#cb301-3076"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041322.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr11'</span></span>
<span id="cb301-3077"><a href="#cb301-3077"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041323.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr12'</span></span>
<span id="cb301-3078"><a href="#cb301-3078"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041324.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr13'</span></span>
<span id="cb301-3079"><a href="#cb301-3079"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041325.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr14'</span></span>
<span id="cb301-3080"><a href="#cb301-3080"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041326.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr15'</span></span>
<span id="cb301-3081"><a href="#cb301-3081"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041327.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr16'</span></span>
<span id="cb301-3082"><a href="#cb301-3082"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041328.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr17'</span></span>
<span id="cb301-3083"><a href="#cb301-3083"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041329.1'</span>] <span class="ot">&lt;-</span> <span class="st">'chr18'</span></span>
<span id="cb301-3084"><a href="#cb301-3084"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_041330.1'</span>] <span class="ot">&lt;-</span> <span class="st">'Z'</span></span>
<span id="cb301-3085"><a href="#cb301-3085"></a>muralis.td<span class="sc">$</span>CHROM[muralis.td<span class="sc">$</span>CHROM <span class="sc">==</span> <span class="st">'NC_011607.1'</span>] <span class="ot">&lt;-</span> <span class="st">'MT'</span></span>
<span id="cb301-3086"><a href="#cb301-3086"></a></span>
<span id="cb301-3087"><a href="#cb301-3087"></a><span class="fu">str</span>(muralis.td)</span>
<span id="cb301-3088"><a href="#cb301-3088"></a></span>
<span id="cb301-3089"><a href="#cb301-3089"></a>d.chr.muralis <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(muralis.td<span class="sc">$</span>TajimaD,</span>
<span id="cb301-3090"><a href="#cb301-3090"></a>                           <span class="fu">list</span>(muralis.td<span class="sc">$</span>CHROM),</span>
<span id="cb301-3091"><a href="#cb301-3091"></a>                           <span class="cf">function</span>(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb301-3092"><a href="#cb301-3092"></a><span class="fu">colnames</span>(d.chr.muralis) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CHROM'</span>, <span class="st">'d'</span>)</span>
<span id="cb301-3093"><a href="#cb301-3093"></a><span class="fu">head</span>(d.chr.muralis)</span>
<span id="cb301-3094"><a href="#cb301-3094"></a></span>
<span id="cb301-3095"><a href="#cb301-3095"></a>chrom <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'chr1'</span>, <span class="st">'chr2'</span>, <span class="st">'chr3'</span>, <span class="st">'chr4'</span>, <span class="st">'chr5'</span>, <span class="st">'chr6'</span>,</span>
<span id="cb301-3096"><a href="#cb301-3096"></a>  <span class="st">'chr7'</span>, <span class="st">'chr8'</span>, <span class="st">'chr9'</span>, <span class="st">'chr10'</span>, <span class="st">'chr11'</span>, <span class="st">'chr12'</span>,</span>
<span id="cb301-3097"><a href="#cb301-3097"></a>  <span class="st">'chr13'</span>, <span class="st">'chr14'</span>, <span class="st">'chr15'</span>, <span class="st">'chr16'</span>, <span class="st">'chr17'</span>, <span class="st">'chr18'</span>,</span>
<span id="cb301-3098"><a href="#cb301-3098"></a>  <span class="st">'Z'</span>, <span class="st">'MT'</span>)</span>
<span id="cb301-3099"><a href="#cb301-3099"></a></span>
<span id="cb301-3100"><a href="#cb301-3100"></a>d.chr.muralis <span class="ot">&lt;-</span> d.chr.muralis[d.chr.muralis<span class="sc">$</span>CHROM <span class="sc">%in%</span> chrom, ]</span>
<span id="cb301-3101"><a href="#cb301-3101"></a>ordered <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb301-3102"><a href="#cb301-3102"></a><span class="cf">for</span>(i <span class="cf">in</span> chrom){</span>
<span id="cb301-3103"><a href="#cb301-3103"></a>    obj <span class="ot">&lt;-</span> d.chr.muralis[d.chr.muralis<span class="sc">$</span>CHROM <span class="sc">==</span> i, ]</span>
<span id="cb301-3104"><a href="#cb301-3104"></a>    ordered <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ordered, obj)</span>
<span id="cb301-3105"><a href="#cb301-3105"></a>}</span>
<span id="cb301-3106"><a href="#cb301-3106"></a>d.chr.muralis <span class="ot">&lt;-</span> ordered</span>
<span id="cb301-3107"><a href="#cb301-3107"></a></span>
<span id="cb301-3108"><a href="#cb301-3108"></a></span>
<span id="cb301-3109"><a href="#cb301-3109"></a>value <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.muralis<span class="sc">$</span>CHROM)</span>
<span id="cb301-3110"><a href="#cb301-3110"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="fl">5.4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb301-3111"><a href="#cb301-3111"></a><span class="fu">plot</span>(d.chr.muralis<span class="sc">$</span>d <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb301-3112"><a href="#cb301-3112"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Tajima's D"</span>),</span>
<span id="cb301-3113"><a href="#cb301-3113"></a>     <span class="at">xlab =</span> <span class="st">'Genomic position'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>)</span>
<span id="cb301-3114"><a href="#cb301-3114"></a><span class="fu">grid</span>()</span>
<span id="cb301-3115"><a href="#cb301-3115"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-3116"><a href="#cb301-3116"></a><span class="fu">plot</span>(d.chr.muralis<span class="sc">$</span>d <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb301-3117"><a href="#cb301-3117"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb301-3118"><a href="#cb301-3118"></a>     <span class="at">xlab =</span> <span class="st">' '</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-3119"><a href="#cb301-3119"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.muralis<span class="sc">$</span>CHROM),</span>
<span id="cb301-3120"><a href="#cb301-3120"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-3121"><a href="#cb301-3121"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d.chr.muralis<span class="sc">$</span>CHROM), <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.029</span>, </span>
<span id="cb301-3122"><a href="#cb301-3122"></a>     <span class="at">labels =</span> d.chr.muralis<span class="sc">$</span>CHROM, <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">xpd =</span> <span class="cn">NA</span>,</span>
<span id="cb301-3123"><a href="#cb301-3123"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb301-3124"><a href="#cb301-3124"></a></span>
<span id="cb301-3125"><a href="#cb301-3125"></a></span>
<span id="cb301-3126"><a href="#cb301-3126"></a></span>
<span id="cb301-3127"><a href="#cb301-3127"></a></span>
<span id="cb301-3128"><a href="#cb301-3128"></a></span>
<span id="cb301-3129"><a href="#cb301-3129"></a></span>
<span id="cb301-3130"><a href="#cb301-3130"></a><span class="in">```</span></span>
<span id="cb301-3131"><a href="#cb301-3131"></a></span>
<span id="cb301-3132"><a href="#cb301-3132"></a></span>
<span id="cb301-3133"><a href="#cb301-3133"></a></span>
<span id="cb301-3136"><a href="#cb301-3136"></a><span class="in">```{r}</span></span>
<span id="cb301-3137"><a href="#cb301-3137"></a><span class="do">##png('./imgs/figure6.png', width = 7, height = 7, units = 'in',</span></span>
<span id="cb301-3138"><a href="#cb301-3138"></a><span class="do">##    res = 360)</span></span>
<span id="cb301-3139"><a href="#cb301-3139"></a></span>
<span id="cb301-3140"><a href="#cb301-3140"></a></span>
<span id="cb301-3141"><a href="#cb301-3141"></a><span class="do">## Creating a multipanel figure</span></span>
<span id="cb301-3142"><a href="#cb301-3142"></a></span>
<span id="cb301-3143"><a href="#cb301-3143"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb301-3144"><a href="#cb301-3144"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-3145"><a href="#cb301-3145"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb301-3146"><a href="#cb301-3146"></a>                <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">4</span>,</span>
<span id="cb301-3147"><a href="#cb301-3147"></a>              <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb301-3148"><a href="#cb301-3148"></a></span>
<span id="cb301-3149"><a href="#cb301-3149"></a></span>
<span id="cb301-3150"><a href="#cb301-3150"></a><span class="do">## Anolis carolinensis (pi)</span></span>
<span id="cb301-3151"><a href="#cb301-3151"></a></span>
<span id="cb301-3152"><a href="#cb301-3152"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="fl">3.8</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb301-3153"><a href="#cb301-3153"></a></span>
<span id="cb301-3154"><a href="#cb301-3154"></a>value <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.carolinensis<span class="sc">$</span>CHROM)</span>
<span id="cb301-3155"><a href="#cb301-3155"></a><span class="fu">plot</span>(pi.chr.carolinensis<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb301-3156"><a href="#cb301-3156"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>,</span>
<span id="cb301-3157"><a href="#cb301-3157"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">'Nucleotide diversity'</span><span class="sc">~</span>(pi)),</span>
<span id="cb301-3158"><a href="#cb301-3158"></a>     <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>, <span class="at">cex.lab =</span> <span class="fl">1.5</span>,</span>
<span id="cb301-3159"><a href="#cb301-3159"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.carolinensis<span class="sc">$</span>sd),</span>
<span id="cb301-3160"><a href="#cb301-3160"></a>              <span class="fu">max</span>(pi.chr.muralis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.muralis<span class="sc">$</span>sd)))     </span>
<span id="cb301-3161"><a href="#cb301-3161"></a><span class="fu">grid</span>()</span>
<span id="cb301-3162"><a href="#cb301-3162"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-3163"><a href="#cb301-3163"></a><span class="fu">plot</span>(pi.chr.carolinensis<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb301-3164"><a href="#cb301-3164"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb301-3165"><a href="#cb301-3165"></a>     <span class="at">xlab =</span> <span class="st">' '</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb301-3166"><a href="#cb301-3166"></a><span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.carolinensis<span class="sc">$</span>sd),</span>
<span id="cb301-3167"><a href="#cb301-3167"></a>              <span class="fu">max</span>(pi.chr.muralis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.muralis<span class="sc">$</span>sd)))</span>
<span id="cb301-3168"><a href="#cb301-3168"></a><span class="fu">legend</span>(<span class="st">'topleft'</span>, <span class="at">legend =</span> <span class="st">'n = 5'</span>, <span class="at">bty =</span> <span class="st">'n'</span>)</span>
<span id="cb301-3169"><a href="#cb301-3169"></a><span class="fu">segments</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pi.chr.carolinensis),</span>
<span id="cb301-3170"><a href="#cb301-3170"></a>         pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.carolinensis<span class="sc">$</span>sd,</span>
<span id="cb301-3171"><a href="#cb301-3171"></a>         <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pi.chr.carolinensis),</span>
<span id="cb301-3172"><a href="#cb301-3172"></a>         pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.carolinensis<span class="sc">$</span>sd,</span>
<span id="cb301-3173"><a href="#cb301-3173"></a>         <span class="at">lwd =</span> <span class="fl">2.2</span>, <span class="at">col =</span> <span class="st">'#DCE319FF'</span>)</span>
<span id="cb301-3174"><a href="#cb301-3174"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.carolinensis<span class="sc">$</span>CHROM),</span>
<span id="cb301-3175"><a href="#cb301-3175"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-3176"><a href="#cb301-3176"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.carolinensis<span class="sc">$</span>CHROM), <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.0027</span>, </span>
<span id="cb301-3177"><a href="#cb301-3177"></a>     <span class="at">labels =</span> pi.chr.carolinensis<span class="sc">$</span>CHROM, <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">xpd =</span> <span class="cn">NA</span>,</span>
<span id="cb301-3178"><a href="#cb301-3178"></a>     <span class="at">cex =</span> <span class="dv">1</span>)</span>
<span id="cb301-3179"><a href="#cb301-3179"></a>caro.img <span class="ot">&lt;-</span> <span class="fu">readPNG</span>(<span class="st">'imgs/anole.png'</span>, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-3180"><a href="#cb301-3180"></a><span class="fu">rasterImage</span>(caro.img, <span class="dv">1</span>, <span class="fl">0.018</span>, <span class="dv">2</span>, <span class="fl">0.020</span>)</span>
<span id="cb301-3181"><a href="#cb301-3181"></a><span class="fu">mtext</span>(<span class="st">'A'</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">at =</span> <span class="fl">0.027</span>, <span class="at">las =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">4.5</span>)</span>
<span id="cb301-3182"><a href="#cb301-3182"></a></span>
<span id="cb301-3183"><a href="#cb301-3183"></a></span>
<span id="cb301-3184"><a href="#cb301-3184"></a><span class="do">## Podarcis muralis (pi)</span></span>
<span id="cb301-3185"><a href="#cb301-3185"></a></span>
<span id="cb301-3186"><a href="#cb301-3186"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb301-3187"><a href="#cb301-3187"></a></span>
<span id="cb301-3188"><a href="#cb301-3188"></a>value <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.muralis<span class="sc">$</span>CHROM)</span>
<span id="cb301-3189"><a href="#cb301-3189"></a><span class="fu">plot</span>(pi.chr.muralis<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'n'</span>,</span>
<span id="cb301-3190"><a href="#cb301-3190"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>,</span>
<span id="cb301-3191"><a href="#cb301-3191"></a>     <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb301-3192"><a href="#cb301-3192"></a>     <span class="at">xlab =</span> <span class="st">''</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xaxt =</span> <span class="st">'n'</span>,</span>
<span id="cb301-3193"><a href="#cb301-3193"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.carolinensis<span class="sc">$</span>sd),</span>
<span id="cb301-3194"><a href="#cb301-3194"></a>              <span class="fu">max</span>(pi.chr.muralis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.muralis<span class="sc">$</span>sd)))</span>
<span id="cb301-3195"><a href="#cb301-3195"></a><span class="fu">grid</span>()</span>
<span id="cb301-3196"><a href="#cb301-3196"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-3197"><a href="#cb301-3197"></a><span class="fu">plot</span>(pi.chr.muralis<span class="sc">$</span>pi <span class="sc">~</span> value, <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb301-3198"><a href="#cb301-3198"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>, <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb301-3199"><a href="#cb301-3199"></a>     <span class="at">xlab =</span> <span class="st">' '</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb301-3200"><a href="#cb301-3200"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(pi.chr.carolinensis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.carolinensis<span class="sc">$</span>sd),</span>
<span id="cb301-3201"><a href="#cb301-3201"></a>              <span class="fu">max</span>(pi.chr.muralis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.muralis<span class="sc">$</span>sd)))     </span>
<span id="cb301-3202"><a href="#cb301-3202"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.muralis<span class="sc">$</span>CHROM),</span>
<span id="cb301-3203"><a href="#cb301-3203"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb301-3204"><a href="#cb301-3204"></a><span class="fu">legend</span>(<span class="st">'topleft'</span>, <span class="at">legend =</span> <span class="st">'n = 5'</span>, <span class="at">bty =</span> <span class="st">'n'</span>)</span>
<span id="cb301-3205"><a href="#cb301-3205"></a><span class="fu">segments</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pi.chr.muralis),</span>
<span id="cb301-3206"><a href="#cb301-3206"></a>         pi.chr.muralis<span class="sc">$</span>pi<span class="sc">+</span>pi.chr.muralis<span class="sc">$</span>sd,</span>
<span id="cb301-3207"><a href="#cb301-3207"></a>         <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pi.chr.muralis),</span>
<span id="cb301-3208"><a href="#cb301-3208"></a>         pi.chr.muralis<span class="sc">$</span>pi<span class="sc">-</span>pi.chr.muralis<span class="sc">$</span>sd,</span>
<span id="cb301-3209"><a href="#cb301-3209"></a>         <span class="at">lwd =</span> <span class="fl">2.2</span>, <span class="at">col =</span> <span class="st">'#39568CFF'</span>)</span>
<span id="cb301-3210"><a href="#cb301-3210"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pi.chr.muralis<span class="sc">$</span>CHROM), <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.0027</span>, </span>
<span id="cb301-3211"><a href="#cb301-3211"></a>     <span class="at">labels =</span> pi.chr.muralis<span class="sc">$</span>CHROM, <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">xpd =</span> <span class="cn">NA</span>,</span>
<span id="cb301-3212"><a href="#cb301-3212"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb301-3213"><a href="#cb301-3213"></a>muralis.img <span class="ot">&lt;-</span> <span class="fu">readPNG</span>(<span class="st">'imgs/p.muralis.png'</span>, <span class="at">native =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-3214"><a href="#cb301-3214"></a><span class="fu">rasterImage</span>(muralis.img, <span class="dv">1</span>, <span class="fl">0.018</span>, <span class="dv">5</span>, <span class="fl">0.021</span>)</span>
<span id="cb301-3215"><a href="#cb301-3215"></a><span class="fu">mtext</span>(<span class="st">'B'</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">at =</span> <span class="fl">0.027</span>, <span class="at">las =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.5</span>)</span>
<span id="cb301-3216"><a href="#cb301-3216"></a></span>
<span id="cb301-3217"><a href="#cb301-3217"></a><span class="fu">par</span>(<span class="at">xpd =</span> <span class="cn">TRUE</span>)</span>
<span id="cb301-3218"><a href="#cb301-3218"></a><span class="fu">mtext</span>(<span class="st">'Genomic position'</span>, <span class="at">at =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="dv">3</span>)</span>
<span id="cb301-3219"><a href="#cb301-3219"></a></span>
<span id="cb301-3220"><a href="#cb301-3220"></a></span>
<span id="cb301-3221"><a href="#cb301-3221"></a><span class="do">##dev.off()</span></span>
<span id="cb301-3222"><a href="#cb301-3222"></a></span>
<span id="cb301-3223"><a href="#cb301-3223"></a></span>
<span id="cb301-3224"><a href="#cb301-3224"></a></span>
<span id="cb301-3225"><a href="#cb301-3225"></a></span>
<span id="cb301-3226"><a href="#cb301-3226"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>